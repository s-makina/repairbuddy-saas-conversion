{"version":3,"sources":["../../../../../frontend/src/app/app/%5Btenant%5D/devices/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React from \"react\";\r\nimport { useParams, useRouter } from \"next/navigation\";\r\nimport { RequireAuth } from \"@/components/RequireAuth\";\r\nimport { useAuth } from \"@/lib/auth\";\r\nimport { Button } from \"@/components/ui/Button\";\r\nimport { Badge } from \"@/components/ui/Badge\";\r\nimport { Card, CardContent } from \"@/components/ui/Card\";\r\nimport { ConfirmDialog } from \"@/components/ui/ConfirmDialog\";\r\nimport { DataGrid } from \"@/components/ui/DataGrid\";\r\nimport { DataTable, type DataTableColumn } from \"@/components/ui/DataTable\";\r\nimport { DropdownMenu, DropdownMenuItem, DropdownMenuSeparator } from \"@/components/ui/DropdownMenu\";\r\nimport { DataViewToggle, type DataViewMode } from \"@/components/ui/DataViewToggle\";\r\nimport { Modal } from \"@/components/ui/Modal\";\r\nimport { TableSkeleton } from \"@/components/ui/Skeleton\";\r\nimport { ListPageShell } from \"@/components/shells/ListPageShell\";\r\nimport { useUrlDataGridState } from \"@/components/ui/useUrlDataGridState\";\r\nimport { apiFetch, ApiError } from \"@/lib/api\";\r\nimport { MoreHorizontal } from \"lucide-react\";\r\n\r\ntype ApiDeviceType = {\r\n  id: number;\r\n  name: string;\r\n  is_active: boolean;\r\n};\r\n\r\ntype ApiDeviceBrand = {\r\n  id: number;\r\n  name: string;\r\n  image_path: string | null;\r\n  is_active: boolean;\r\n};\r\n\r\ntype ApiDevice = {\r\n  id: number;\r\n  model: string;\r\n  device_type_id: number;\r\n  device_brand_id: number;\r\n  parent_device_id: number | null;\r\n  disable_in_booking_form: boolean;\r\n  is_other: boolean;\r\n  is_active: boolean;\r\n};\r\n\r\ntype DevicesPayload = {\r\n  devices: ApiDevice[];\r\n  meta?: {\r\n    current_page: number;\r\n    per_page: number;\r\n    total: number;\r\n    last_page: number;\r\n  };\r\n};\r\n\r\nexport default function TenantDevicesPage() {\r\n  const auth = useAuth();\r\n  const router = useRouter();\r\n  const params = useParams() as { tenant?: string; business?: string };\r\n  const tenantSlug = params.business ?? params.tenant;\r\n\r\n  const grid = useUrlDataGridState({ defaultPageSize: 12 });\r\n  const statusFilter = grid.getParam(\"is_active\") ?? \"all\";\r\n  const viewParam = grid.getParam(\"view\");\r\n  const view: DataViewMode = viewParam === \"grid\" ? \"grid\" : \"table\";\r\n\r\n  const [loading, setLoading] = React.useState(true);\r\n  const [error, setError] = React.useState<string | null>(null);\r\n  const [status, setStatus] = React.useState<string | null>(null);\r\n  const [busy, setBusy] = React.useState(false);\r\n\r\n  const [devices, setDevices] = React.useState<ApiDevice[]>([]);\r\n  const [brands, setBrands] = React.useState<ApiDeviceBrand[]>([]);\r\n  const [types, setTypes] = React.useState<ApiDeviceType[]>([]);\r\n\r\n  const [parentOptions, setParentOptions] = React.useState<ApiDevice[]>([]);\r\n  const [reloadNonce, setReloadNonce] = React.useState(0);\r\n\r\n  const [editOpen, setEditOpen] = React.useState(false);\r\n  const [editId, setEditId] = React.useState<number | null>(null);\r\n  const [editModel, setEditModel] = React.useState(\"\");\r\n  const [editTypeId, setEditTypeId] = React.useState<number | null>(null);\r\n  const [editBrandId, setEditBrandId] = React.useState<number | null>(null);\r\n  const [editParentId, setEditParentId] = React.useState<number | null>(null);\r\n  const [editDisableInBooking, setEditDisableInBooking] = React.useState(false);\r\n  const [editIsOther, setEditIsOther] = React.useState(false);\r\n  const [editIsActive, setEditIsActive] = React.useState(true);\r\n\r\n  const [confirmOpen, setConfirmOpen] = React.useState(false);\r\n  const [confirmTitle, setConfirmTitle] = React.useState(\"\");\r\n  const [confirmMessage, setConfirmMessage] = React.useState<React.ReactNode>(\"\");\r\n  const [confirmAction, setConfirmAction] = React.useState<(() => Promise<void>) | null>(null);\r\n\r\n  const [totalRows, setTotalRows] = React.useState(0);\r\n\r\n  const canManage = auth.can(\"devices.manage\");\r\n\r\n  const loadParentOptions = React.useCallback(async () => {\r\n    if (typeof tenantSlug !== \"string\" || tenantSlug.length === 0) return;\r\n    try {\r\n      const res = await apiFetch<{ devices: ApiDevice[] }>(`/api/${tenantSlug}/app/repairbuddy/devices?limit=200`);\r\n      setParentOptions(Array.isArray(res.devices) ? res.devices : []);\r\n    } catch {\r\n      setParentOptions([]);\r\n    }\r\n  }, [tenantSlug]);\r\n\r\n  const load = React.useCallback(async () => {\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n\r\n      if (typeof tenantSlug !== \"string\" || tenantSlug.length === 0) {\r\n        throw new Error(\"Business is missing.\");\r\n      }\r\n\r\n      const qs = new URLSearchParams();\r\n      if (grid.query.trim().length > 0) qs.set(\"q\", grid.query.trim());\r\n      qs.set(\"page\", String(grid.pageIndex + 1));\r\n      qs.set(\"per_page\", String(grid.pageSize));\r\n      if (statusFilter !== \"all\") qs.set(\"is_active\", statusFilter);\r\n\r\n      const [devicesRes, brandsRes, typesRes] = await Promise.all([\r\n        apiFetch<DevicesPayload>(`/api/${tenantSlug}/app/repairbuddy/devices?${qs.toString()}`),\r\n        apiFetch<{ device_brands: ApiDeviceBrand[] }>(`/api/${tenantSlug}/app/repairbuddy/device-brands?limit=200`),\r\n        apiFetch<{ device_types: ApiDeviceType[] }>(`/api/${tenantSlug}/app/repairbuddy/device-types?limit=200`),\r\n      ]);\r\n\r\n      setDevices(Array.isArray(devicesRes.devices) ? devicesRes.devices : []);\r\n      setTotalRows(typeof devicesRes.meta?.total === \"number\" ? devicesRes.meta.total : 0);\r\n      setBrands(Array.isArray(brandsRes.device_brands) ? brandsRes.device_brands : []);\r\n      setTypes(Array.isArray(typesRes.device_types) ? typesRes.device_types : []);\r\n    } catch (e) {\r\n      if (e instanceof ApiError && e.status === 428 && typeof tenantSlug === \"string\" && tenantSlug.length > 0) {\r\n        const next = `/app/${tenantSlug}/devices`;\r\n        router.replace(`/app/${tenantSlug}/branches/select?next=${encodeURIComponent(next)}`);\r\n        return;\r\n      }\r\n\r\n      setError(e instanceof Error ? e.message : \"Failed to load devices.\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [grid.pageIndex, grid.pageSize, grid.query, reloadNonce, router, statusFilter, tenantSlug]);\r\n\r\n  React.useEffect(() => {\r\n    void load();\r\n  }, [load]);\r\n\r\n  React.useEffect(() => {\r\n    if (!editOpen) return;\r\n    void loadParentOptions();\r\n  }, [editOpen, loadParentOptions]);\r\n\r\n  function openEdit(row: ApiDevice) {\r\n    if (!canManage) return;\r\n    setEditId(row.id);\r\n    setEditModel(row.model);\r\n    setEditTypeId(row.device_type_id);\r\n    setEditBrandId(row.device_brand_id);\r\n    setEditParentId(typeof row.parent_device_id === \"number\" ? row.parent_device_id : null);\r\n    setEditDisableInBooking(Boolean(row.disable_in_booking_form));\r\n    setEditIsOther(Boolean(row.is_other));\r\n    setEditIsActive(Boolean(row.is_active));\r\n    setEditOpen(true);\r\n    setError(null);\r\n    setStatus(null);\r\n  }\r\n\r\n  function openConfirm(args: { title: string; message: React.ReactNode; action: () => Promise<void> }) {\r\n    setConfirmTitle(args.title);\r\n    setConfirmMessage(args.message);\r\n    setConfirmAction(() => args.action);\r\n    setConfirmOpen(true);\r\n  }\r\n\r\n  async function onSave(e: React.FormEvent) {\r\n    e.preventDefault();\r\n    if (busy) return;\r\n    if (typeof tenantSlug !== \"string\" || tenantSlug.length === 0) return;\r\n    if (!canManage) {\r\n      setError(\"Forbidden.\");\r\n      return;\r\n    }\r\n\r\n    setBusy(true);\r\n    setError(null);\r\n    setStatus(null);\r\n\r\n    try {\r\n      const model = editModel.trim();\r\n      if (model.length === 0) {\r\n        setError(\"Model is required.\");\r\n        return;\r\n      }\r\n\r\n      if (typeof editTypeId !== \"number\") {\r\n        setError(\"Device type is required.\");\r\n        return;\r\n      }\r\n\r\n      if (typeof editBrandId !== \"number\") {\r\n        setError(\"Device brand is required.\");\r\n        return;\r\n      }\r\n\r\n      const payload = {\r\n        model,\r\n        device_type_id: editTypeId,\r\n        device_brand_id: editBrandId,\r\n        parent_device_id: editParentId,\r\n        disable_in_booking_form: editDisableInBooking,\r\n        is_other: editIsOther,\r\n        is_active: editIsActive,\r\n      };\r\n\r\n      if (editId) {\r\n        await apiFetch<{ device: ApiDevice }>(`/api/${tenantSlug}/app/repairbuddy/devices/${editId}`, {\r\n          method: \"PATCH\",\r\n          body: payload,\r\n        });\r\n        setStatus(\"Device updated.\");\r\n      } else {\r\n        await apiFetch<{ device: ApiDevice }>(`/api/${tenantSlug}/app/repairbuddy/devices`, {\r\n          method: \"POST\",\r\n          body: payload,\r\n        });\r\n        setStatus(\"Device created.\");\r\n      }\r\n\r\n      setEditOpen(false);\r\n      grid.onPageIndexChange(0);\r\n      setReloadNonce((n) => n + 1);\r\n    } catch (err) {\r\n      if (err instanceof ApiError) {\r\n        setError(err.message);\r\n      } else {\r\n        setError(editId ? \"Failed to update device.\" : \"Failed to create device.\");\r\n      }\r\n    } finally {\r\n      setBusy(false);\r\n    }\r\n  }\r\n\r\n  async function onDelete(row: ApiDevice) {\r\n    if (busy) return;\r\n    if (typeof tenantSlug !== \"string\" || tenantSlug.length === 0) return;\r\n    if (!canManage) {\r\n      setError(\"Forbidden.\");\r\n      return;\r\n    }\r\n\r\n    openConfirm({\r\n      title: \"Delete device\",\r\n      message: (\r\n        <div>\r\n          Delete <span className=\"font-semibold\">{row.model}</span>?\r\n        </div>\r\n      ),\r\n      action: async () => {\r\n        setBusy(true);\r\n        setError(null);\r\n        setStatus(null);\r\n        try {\r\n          await apiFetch<{ message: string }>(`/api/${tenantSlug}/app/repairbuddy/devices/${row.id}`, {\r\n            method: \"DELETE\",\r\n          });\r\n          setStatus(\"Device deleted.\");\r\n          grid.onPageIndexChange(0);\r\n          setReloadNonce((n) => n + 1);\r\n        } catch (err) {\r\n          if (err instanceof ApiError) {\r\n            setError(err.message);\r\n          } else {\r\n            setError(\"Failed to delete device.\");\r\n          }\r\n        } finally {\r\n          setBusy(false);\r\n        }\r\n      },\r\n    });\r\n  }\r\n\r\n  const brandById = React.useMemo(() => new Map(brands.map((b) => [b.id, b])), [brands]);\r\n  const typeById = React.useMemo(() => new Map(types.map((t) => [t.id, t])), [types]);\r\n\r\n  const pageRows = devices;\r\n\r\n  const parentSelectOptions = React.useMemo(() => {\r\n    const excludeId = editId ?? null;\r\n    return parentOptions\r\n      .filter((d) => (excludeId ? d.id !== excludeId : true))\r\n      .slice()\r\n      .sort((a, b) => a.model.localeCompare(b.model));\r\n  }, [editId, parentOptions]);\r\n\r\n  const columns = React.useMemo<Array<DataTableColumn<ApiDevice>>>(\r\n    () => [\r\n      {\r\n        id: \"model\",\r\n        header: \"Device\",\r\n        cell: (row) => (\r\n          <div className=\"min-w-0\">\r\n            <div className=\"truncate font-semibold text-[var(--rb-text)]\">{row.model}</div>\r\n            <div className=\"truncate text-xs text-zinc-600\">{row.id}</div>\r\n          </div>\r\n        ),\r\n        className: \"min-w-[240px]\",\r\n      },\r\n      {\r\n        id: \"brand\",\r\n        header: \"Brand\",\r\n        cell: (row) => <div className=\"text-sm text-zinc-700\">{brandById.get(row.device_brand_id)?.name ?? String(row.device_brand_id)}</div>,\r\n        className: \"min-w-[200px]\",\r\n      },\r\n      {\r\n        id: \"type\",\r\n        header: \"Type\",\r\n        cell: (row) => <div className=\"text-sm text-zinc-700\">{typeById.get(row.device_type_id)?.name ?? String(row.device_type_id)}</div>,\r\n        className: \"min-w-[200px]\",\r\n      },\r\n      {\r\n        id: \"active\",\r\n        header: \"Active\",\r\n        className: \"whitespace-nowrap\",\r\n        cell: (row) => <div className=\"text-sm text-zinc-700\">{row.is_active ? \"Yes\" : \"No\"}</div>,\r\n      },\r\n      {\r\n        id: \"actions\",\r\n        header: \"\",\r\n        headerClassName: \"text-right\",\r\n        className: \"whitespace-nowrap text-right\",\r\n        cell: (row) => {\r\n          if (!canManage) return null;\r\n          return (\r\n            <DropdownMenu\r\n              align=\"right\"\r\n              trigger={({ toggle }) => (\r\n                <Button\r\n                  variant=\"ghost\"\r\n                  size=\"sm\"\r\n                  onClick={toggle}\r\n                  disabled={busy}\r\n                  className=\"px-2\"\r\n                  aria-label=\"Actions\"\r\n                  title=\"Actions\"\r\n                >\r\n                  <MoreHorizontal className=\"h-4 w-4\" />\r\n                </Button>\r\n              )}\r\n            >\r\n              {({ close }) => (\r\n                <>\r\n                  <DropdownMenuItem\r\n                    onSelect={() => {\r\n                      close();\r\n                      openEdit(row);\r\n                    }}\r\n                    disabled={busy}\r\n                  >\r\n                    Edit\r\n                  </DropdownMenuItem>\r\n                  <DropdownMenuSeparator />\r\n                  <DropdownMenuItem\r\n                    destructive\r\n                    onSelect={() => {\r\n                      close();\r\n                      void onDelete(row);\r\n                    }}\r\n                    disabled={busy}\r\n                  >\r\n                    Delete\r\n                  </DropdownMenuItem>\r\n                </>\r\n              )}\r\n            </DropdownMenu>\r\n          );\r\n        },\r\n      },\r\n    ],\r\n    [brandById, busy, canManage, typeById],\r\n  );\r\n\r\n  return (\r\n    <RequireAuth requiredPermission=\"devices.view\">\r\n      <div className=\"space-y-4\">\r\n        <ConfirmDialog\r\n          open={confirmOpen}\r\n          title={confirmTitle}\r\n          message={confirmMessage}\r\n          busy={busy}\r\n          confirmText=\"Delete\"\r\n          confirmVariant=\"secondary\"\r\n          onCancel={() => {\r\n            if (busy) return;\r\n            setConfirmOpen(false);\r\n            setConfirmAction(null);\r\n          }}\r\n          onConfirm={() => {\r\n            if (!confirmAction) return;\r\n            void (async () => {\r\n              await confirmAction();\r\n              setConfirmOpen(false);\r\n              setConfirmAction(null);\r\n            })();\r\n          }}\r\n        />\r\n\r\n        <Modal\r\n          open={editOpen}\r\n          onClose={() => {\r\n            if (busy) return;\r\n            setEditOpen(false);\r\n          }}\r\n          title=\"Edit device\"\r\n          footer={\r\n            <div className=\"flex items-center justify-end gap-2\">\r\n              <Button variant=\"outline\" onClick={() => setEditOpen(false)} disabled={busy}>\r\n                Cancel\r\n              </Button>\r\n              <Button disabled={busy} type=\"submit\" form=\"rb_device_form\">\r\n                {busy ? \"Saving...\" : \"Save\"}\r\n              </Button>\r\n            </div>\r\n          }\r\n        >\r\n          <form id=\"rb_device_form\" className=\"space-y-3\" onSubmit={onSave}>\r\n            <div className=\"space-y-1\">\r\n              <label className=\"text-sm font-medium\" htmlFor=\"device_model\">\r\n                Model\r\n              </label>\r\n              <input\r\n                id=\"device_model\"\r\n                className=\"w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm\"\r\n                value={editModel}\r\n                onChange={(e) => setEditModel(e.target.value)}\r\n                required\r\n                disabled={busy}\r\n              />\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 gap-3 sm:grid-cols-2\">\r\n              <div className=\"space-y-1\">\r\n                <label className=\"text-sm font-medium\" htmlFor=\"device_type\">\r\n                  Device type\r\n                </label>\r\n                <select\r\n                  id=\"device_type\"\r\n                  className=\"w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm\"\r\n                  value={editTypeId ?? \"\"}\r\n                  onChange={(e) => {\r\n                    const raw = e.target.value;\r\n                    if (!raw) {\r\n                      setEditTypeId(null);\r\n                      return;\r\n                    }\r\n                    const n = Number(raw);\r\n                    setEditTypeId(Number.isFinite(n) ? n : null);\r\n                  }}\r\n                  disabled={busy}\r\n                >\r\n                  {types\r\n                    .slice()\r\n                    .sort((a, b) => a.name.localeCompare(b.name))\r\n                    .map((t) => (\r\n                      <option key={t.id} value={t.id}>\r\n                        {t.name}\r\n                      </option>\r\n                    ))}\r\n                </select>\r\n              </div>\r\n\r\n              <div className=\"space-y-1\">\r\n                <label className=\"text-sm font-medium\" htmlFor=\"device_brand\">\r\n                  Device brand\r\n                </label>\r\n                <select\r\n                  id=\"device_brand\"\r\n                  className=\"w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm\"\r\n                  value={editBrandId ?? \"\"}\r\n                  onChange={(e) => {\r\n                    const raw = e.target.value;\r\n                    if (!raw) {\r\n                      setEditBrandId(null);\r\n                      return;\r\n                    }\r\n                    const n = Number(raw);\r\n                    setEditBrandId(Number.isFinite(n) ? n : null);\r\n                  }}\r\n                  disabled={busy}\r\n                >\r\n                  {brands\r\n                    .slice()\r\n                    .sort((a, b) => a.name.localeCompare(b.name))\r\n                    .map((b) => (\r\n                      <option key={b.id} value={b.id}>\r\n                        {b.name}\r\n                      </option>\r\n                    ))}\r\n                </select>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"space-y-1\">\r\n              <label className=\"text-sm font-medium\" htmlFor=\"device_parent\">\r\n                Parent device (variation base)\r\n              </label>\r\n              <select\r\n                id=\"device_parent\"\r\n                className=\"w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm\"\r\n                value={editParentId ?? \"\"}\r\n                onChange={(e) => {\r\n                  const raw = e.target.value;\r\n                  if (!raw) {\r\n                    setEditParentId(null);\r\n                    return;\r\n                  }\r\n                  const n = Number(raw);\r\n                  setEditParentId(Number.isFinite(n) ? n : null);\r\n                }}\r\n                disabled={busy}\r\n              >\r\n                <option value=\"\">(none)</option>\r\n                {parentSelectOptions.map((d) => (\r\n                  <option key={d.id} value={d.id}>\r\n                    {d.model}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n\r\n            <label className=\"flex items-center gap-2 text-sm\">\r\n              <input type=\"checkbox\" checked={editDisableInBooking} onChange={(e) => setEditDisableInBooking(e.target.checked)} disabled={busy} />\r\n              Disable in booking form\r\n            </label>\r\n\r\n            <label className=\"flex items-center gap-2 text-sm\">\r\n              <input type=\"checkbox\" checked={editIsOther} onChange={(e) => setEditIsOther(e.target.checked)} disabled={busy} />\r\n              Is {\"\\\"Other\\\"\"} device\r\n            </label>\r\n\r\n            <label className=\"flex items-center gap-2 text-sm\">\r\n              <input type=\"checkbox\" checked={editIsActive} onChange={(e) => setEditIsActive(e.target.checked)} disabled={busy} />\r\n              Active\r\n            </label>\r\n          </form>\r\n        </Modal>\r\n\r\n        {status ? <div className=\"text-sm text-green-700\">{status}</div> : null}\r\n        {error ? <div className=\"text-sm text-red-600\">{error}</div> : null}\r\n\r\n        <ListPageShell\r\n          title=\"Devices\"\r\n          description=\"Supported device models for your repair catalog.\"\r\n          actions={\r\n            <>\r\n              <DataViewToggle\r\n                value={view}\r\n                onChange={(next) => {\r\n                  grid.setParam(\"view\", next === \"table\" ? null : next);\r\n                }}\r\n                disabled={loading || busy}\r\n              />\r\n\r\n              <Button\r\n                variant=\"primary\"\r\n                size=\"sm\"\r\n                onClick={() => {\r\n                  if (!canManage) return;\r\n                  if (typeof tenantSlug !== \"string\" || tenantSlug.length === 0) return;\r\n                  router.push(`/app/${tenantSlug}/devices/new`);\r\n                }}\r\n                disabled={!canManage || loading || busy}\r\n              >\r\n                New device\r\n              </Button>\r\n            </>\r\n          }\r\n          loading={loading}\r\n          loadingFallback={\r\n            <Card className=\"shadow-none\">\r\n              <CardContent className=\"pt-5\">\r\n                <TableSkeleton rows={8} columns={5} className=\"shadow-none\" />\r\n              </CardContent>\r\n            </Card>\r\n          }\r\n          error={null}\r\n          empty={!loading && !error && devices.length === 0}\r\n          emptyTitle=\"No devices\"\r\n          emptyDescription=\"Add device models to standardize intake and quoting.\"\r\n        >\r\n          <Card className=\"shadow-none\">\r\n            <CardContent className=\"pt-5\">\r\n              {view === \"table\" ? (\r\n                <DataTable\r\n                  // title={typeof tenantSlug === \"string\" ? `Devices · ${tenantSlug}` : \"Devices\"}\r\n                  data={pageRows}\r\n                  loading={loading}\r\n                  emptyMessage=\"No devices.\"\r\n                  columns={columns}\r\n                  getRowId={(row) => row.id}\r\n                  search={{\r\n                    placeholder: \"Search devices...\",\r\n                  }}\r\n                  filters={[\r\n                    {\r\n                      id: \"is_active\",\r\n                      label: \"Status\",\r\n                      value: statusFilter,\r\n                      options: [\r\n                        { label: \"All\", value: \"all\" },\r\n                        { label: \"Active\", value: \"1\" },\r\n                        { label: \"Inactive\", value: \"0\" },\r\n                      ],\r\n                      onChange: (value) => {\r\n                        const next = String(value);\r\n                        grid.setParam(\"is_active\", next === \"all\" ? null : next, { resetPage: true });\r\n                      },\r\n                    },\r\n                  ]}\r\n                  server={{\r\n                    query: grid.query,\r\n                    onQueryChange: grid.onQueryChange,\r\n                    pageIndex: grid.pageIndex,\r\n                    onPageIndexChange: grid.onPageIndexChange,\r\n                    pageSize: grid.pageSize,\r\n                    onPageSizeChange: grid.onPageSizeChange,\r\n                    totalRows,\r\n                  }}\r\n                />\r\n              ) : (\r\n                <DataGrid\r\n                  title={typeof tenantSlug === \"string\" ? `Devices · ${tenantSlug}` : \"Devices\"}\r\n                  data={pageRows}\r\n                  loading={loading}\r\n                  emptyMessage=\"No devices.\"\r\n                  getItemId={(row) => row.id}\r\n                  search={{ placeholder: \"Search devices...\" }}\r\n                  filters={[\r\n                    {\r\n                      id: \"is_active\",\r\n                      label: \"Status\",\r\n                      value: statusFilter,\r\n                      options: [\r\n                        { label: \"All\", value: \"all\" },\r\n                        { label: \"Active\", value: \"1\" },\r\n                        { label: \"Inactive\", value: \"0\" },\r\n                      ],\r\n                      onChange: (value) => {\r\n                        const next = String(value);\r\n                        grid.setParam(\"is_active\", next === \"all\" ? null : next, { resetPage: true });\r\n                      },\r\n                    },\r\n                  ]}\r\n                  server={{\r\n                    query: grid.query,\r\n                    onQueryChange: grid.onQueryChange,\r\n                    pageIndex: grid.pageIndex,\r\n                    onPageIndexChange: grid.onPageIndexChange,\r\n                    pageSize: grid.pageSize,\r\n                    onPageSizeChange: grid.onPageSizeChange,\r\n                    totalRows,\r\n                  }}\r\n                  onItemClick={canManage ? openEdit : undefined}\r\n                  renderItem={(row) => {\r\n                    const brandName = brandById.get(row.device_brand_id)?.name ?? String(row.device_brand_id);\r\n                    const typeName = typeById.get(row.device_type_id)?.name ?? String(row.device_type_id);\r\n                    return (\r\n                      <Card className=\"overflow-hidden shadow-none\">\r\n                        <div className=\"flex h-20 items-center justify-between gap-3 bg-[var(--rb-surface-muted)] px-4\">\r\n                          <div className=\"min-w-0\">\r\n                            <div className=\"truncate text-sm font-semibold text-[var(--rb-text)]\">{row.model}</div>\r\n                            <div className=\"truncate text-xs text-zinc-600\">{row.id}</div>\r\n                          </div>\r\n\r\n                          {canManage ? (\r\n                            <DropdownMenu\r\n                              align=\"right\"\r\n                              trigger={({ toggle }) => (\r\n                                <Button\r\n                                  variant=\"ghost\"\r\n                                  size=\"sm\"\r\n                                  onClick={(e) => {\r\n                                    e.stopPropagation();\r\n                                    toggle();\r\n                                  }}\r\n                                  disabled={busy}\r\n                                  className=\"px-2\"\r\n                                  aria-label=\"Actions\"\r\n                                  title=\"Actions\"\r\n                                >\r\n                                  <MoreHorizontal className=\"h-4 w-4\" />\r\n                                </Button>\r\n                              )}\r\n                            >\r\n                              {({ close }) => (\r\n                                <>\r\n                                  <DropdownMenuItem\r\n                                    onSelect={() => {\r\n                                      close();\r\n                                      openEdit(row);\r\n                                    }}\r\n                                    disabled={busy}\r\n                                  >\r\n                                    Edit\r\n                                  </DropdownMenuItem>\r\n                                  <DropdownMenuSeparator />\r\n                                  <DropdownMenuItem\r\n                                    destructive\r\n                                    onSelect={() => {\r\n                                      close();\r\n                                      void onDelete(row);\r\n                                    }}\r\n                                    disabled={busy}\r\n                                  >\r\n                                    Delete\r\n                                  </DropdownMenuItem>\r\n                                </>\r\n                              )}\r\n                            </DropdownMenu>\r\n                          ) : null}\r\n                        </div>\r\n\r\n                        <CardContent className=\"pt-4\">\r\n                          <div className=\"space-y-2\">\r\n                            <div className=\"text-sm text-zinc-700\">\r\n                              <span className=\"font-medium text-[var(--rb-text)]\">Brand:</span> {brandName}\r\n                            </div>\r\n                            <div className=\"text-sm text-zinc-700\">\r\n                              <span className=\"font-medium text-[var(--rb-text)]\">Type:</span> {typeName}\r\n                            </div>\r\n                          </div>\r\n\r\n                          <div className=\"mt-3 flex flex-wrap items-center gap-2\">\r\n                            <Badge variant={row.is_active ? \"success\" : \"default\"}>{row.is_active ? \"Active\" : \"Inactive\"}</Badge>\r\n                            {row.disable_in_booking_form ? <Badge variant=\"default\">Hidden in booking</Badge> : null}\r\n                            {row.is_other ? <Badge variant=\"default\">Other</Badge> : null}\r\n                          </div>\r\n                        </CardContent>\r\n                      </Card>\r\n                    );\r\n                  }}\r\n                />\r\n              )}\r\n            </CardContent>\r\n          </Card>\r\n        </ListPageShell>\r\n      </div>\r\n    </RequireAuth>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}