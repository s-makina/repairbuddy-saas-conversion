module.exports=[94703,a=>{"use strict";var b=a.i(57850),c=a.i(45056),d=a.i(7160);function e({open:a,onClose:e,title:f,children:g,footer:h,position:i="center",variant:j="glass",className:k}){if((0,c.useEffect)(()=>{function b(b){a&&"Escape"===b.key&&e()}return document.addEventListener("keydown",b),()=>document.removeEventListener("keydown",b)},[e,a]),!a)return null;let l="solid"===j?(0,d.cn)("relative w-full max-w-lg overflow-hidden rounded-[var(--rb-radius-lg)]","border border-[var(--rb-border)]","bg-white","shadow-[var(--rb-shadow)]"):(0,d.cn)("relative w-full max-w-lg overflow-hidden rounded-[var(--rb-radius-lg)]","border border-[color:color-mix(in_srgb,var(--rb-border),white_55%)]","bg-white/75 backdrop-blur-xl","shadow-[0_18px_55px_-18px_rgba(0,0,0,0.55)]","ring-1 ring-white/25");return(0,b.jsxs)("div",{className:"top-center"===i?"fixed inset-0 z-50 flex items-start justify-center px-4 pt-8":"fixed inset-0 z-50 flex items-center justify-center px-4",children:[(0,b.jsx)("button",{type:"button",className:(0,d.cn)("absolute inset-0","bg-black/35 backdrop-blur-md","bg-[radial-gradient(900px_600px_at_20%_20%,color-mix(in_srgb,#16a34a,transparent_82%)_0%,transparent_60%),radial-gradient(900px_600px_at_80%_30%,color-mix(in_srgb,var(--rb-blue),transparent_82%)_0%,transparent_60%),radial-gradient(900px_600px_at_50%_85%,color-mix(in_srgb,var(--rb-orange),transparent_85%)_0%,transparent_65%)]"),"aria-label":"Close",onClick:e}),(0,b.jsxs)("div",{role:"dialog","aria-modal":"true",className:(0,d.cn)(l,k),children:["glass"===j?(0,b.jsx)("div",{className:"pointer-events-none absolute inset-0 bg-[radial-gradient(650px_420px_at_20%_15%,color-mix(in_srgb,#16a34a,transparent_88%)_0%,transparent_60%),radial-gradient(650px_420px_at_80%_5%,color-mix(in_srgb,var(--rb-blue),transparent_90%)_0%,transparent_60%)]"}):null,f?(0,b.jsx)("div",{className:(0,d.cn)("relative px-5 py-4","solid"===j?"border-b border-[var(--rb-border)]":"border-b border-[color:color-mix(in_srgb,var(--rb-border),white_60%)]"),children:(0,b.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:f})}):null,(0,b.jsx)("div",{className:"relative px-5 py-4",children:g}),h?(0,b.jsx)("div",{className:(0,d.cn)("relative px-5 py-4","solid"===j?"border-t border-[var(--rb-border)]":"border-t border-[color:color-mix(in_srgb,var(--rb-border),white_60%)]"),children:h}):null]})]})}a.s(["Modal",()=>e])},21282,a=>{"use strict";var b=a.i(57850),c=a.i(94703),d=a.i(97867);function e({open:a,title:e,message:f,confirmText:g="Confirm",confirmVariant:h="primary",cancelText:i="Cancel",busy:j=!1,onCancel:k,onConfirm:l}){return(0,b.jsx)(c.Modal,{open:a,onClose:()=>{j||k()},title:e,footer:(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,b.jsx)(d.Button,{variant:"outline",onClick:k,disabled:j,children:i}),(0,b.jsx)(d.Button,{variant:h,onClick:l,disabled:j,children:j?"Working...":g})]}),children:(0,b.jsx)("div",{className:"text-sm text-zinc-700",children:f})})}a.s(["ConfirmDialog",()=>e])},54804,a=>{"use strict";var b=a.i(57850),c=a.i(648),d=a.i(75385),e=a.i(4600);function f({title:a,description:f,actions:g,filters:h,loading:i,loadingFallback:j,error:k,empty:l,emptyTitle:m="Nothing here yet",emptyDescription:n="No items to display.",children:o}){return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(c.PageHeader,{title:a,description:f,actions:g}),h?(0,b.jsx)(e.Card,{className:"shadow-none",children:(0,b.jsx)(e.CardContent,{className:"pt-5",children:h})}):null,k?(0,b.jsx)(d.Alert,{variant:"danger",title:"Something went wrong",children:k}):null,i?j??(0,b.jsx)("div",{className:"text-sm text-zinc-500",children:"Loading..."}):null,i||k||!l?null:(0,b.jsx)(e.Card,{className:"shadow-none",children:(0,b.jsxs)(e.CardContent,{className:"pt-5",children:[(0,b.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:m}),(0,b.jsx)("div",{className:"mt-1 text-sm text-zinc-600",children:n})]})}),i||k||l?null:o]})}a.s(["ListPageShell",()=>f])},86409,a=>{"use strict";var b=a.i(57850),c=a.i(45056),d=a.i(97867);function e({className:a}){return(0,b.jsxs)("svg",{viewBox:"0 0 24 24",width:"16",height:"16","aria-hidden":"true",className:a,fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,b.jsx)("path",{d:"M18 6 6 18"}),(0,b.jsx)("path",{d:"M6 6l12 12"})]})}function f({label:a="Image",file:f,existingUrl:g,disabled:h,accept:i="image/png,image/jpeg,image/webp",maxBytes:j=5242880,onFileChange:k,onRemoveExisting:l,onError:m}){let n=c.default.useRef(null),[o,p]=c.default.useState(null);c.default.useEffect(()=>{if(!f){p(null),n.current&&(n.current.value="");return}let a=URL.createObjectURL(f);return p(a),()=>{URL.revokeObjectURL(a)}},[f]);let q=o??g??null,r=!o&&!!g,s=!!f||r&&!!l;return(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("div",{className:"text-sm font-medium",children:a}),(0,b.jsx)("input",{ref:n,type:"file",accept:i,className:"hidden",onChange:function(a){let b=a.target.files?.[0]??null;if(b){if(!function(a){if(!a.type.startsWith("image/"))return m?.("Please select an image file."),!1;if(a.size>j){let a=Math.floor(j/1048576);return m?.(`Image must be ${a}MB or smaller.`),!1}return!0}(b)){n.current&&(n.current.value="");return}k(b)}},disabled:h}),(0,b.jsx)("div",{className:"flex flex-wrap items-center gap-2",children:(0,b.jsx)(d.Button,{variant:"outline",size:"sm",type:"button",onClick:()=>n.current?.click(),disabled:h,children:f?"Change selected image":"Choose image"})}),q?(0,b.jsxs)("div",{className:"relative inline-block",children:[(0,b.jsx)("img",{src:q,alt:"Selected image",className:"max-h-40 rounded border border-[var(--rb-border)]"}),s?(0,b.jsx)("button",{type:"button",onClick:()=>{f?k(null):l?.()},disabled:h,"aria-label":f?"Remove selected image":"Remove image",className:"absolute right-2 top-2 inline-flex h-7 w-7 items-center justify-center rounded-full border border-[var(--rb-border)] bg-white/90 text-zinc-700 shadow-sm transition hover:bg-white disabled:pointer-events-none disabled:opacity-50",children:(0,b.jsx)(e,{})}):null]}):null]})}a.s(["ImagePickerWithPreview",()=>f])},16606,a=>{"use strict";var b=a.i(57850),c=a.i(45056),d=a.i(93609),e=a.i(91601),f=a.i(75458),g=a.i(97867),h=a.i(4600),i=a.i(21282),j=a.i(54177),k=a.i(46036),l=a.i(86409),m=a.i(94703),n=a.i(26606),o=a.i(54804),p=a.i(34075);function q(){let a=(0,f.useAuth)(),q=(0,d.useRouter)(),r=(0,d.useParams)(),s=r.business??r.tenant,[t,u]=c.default.useState(!0),[v,w]=c.default.useState(null),[x,y]=c.default.useState(null),[z,A]=c.default.useState(!1),[B,C]=c.default.useState([]),[D,E]=c.default.useState(!1),[F,G]=c.default.useState(null),[H,I]=c.default.useState(""),[J,K]=c.default.useState(""),[L,M]=c.default.useState(!0),[N,O]=c.default.useState(null),[P,Q]=c.default.useState(null),[R,S]=c.default.useState(!1),[T,U]=c.default.useState(""),[V,W]=c.default.useState(""),[X,Y]=c.default.useState(null),[Z,$]=c.default.useState(""),[_,aa]=c.default.useState(0),[ab,ac]=c.default.useState(10),[ad,ae]=c.default.useState(0),[af,ag]=c.default.useState(null),ah=a.can("parts.manage"),ai=c.default.useCallback(async()=>{try{if(u(!0),w(null),"string"!=typeof s||0===s.length)throw Error("Business is missing.");let a=new URLSearchParams;Z.trim().length>0&&a.set("q",Z.trim()),a.set("page",String(_+1)),a.set("per_page",String(ab)),af?.id&&af?.dir&&(a.set("sort",af.id),a.set("dir",af.dir));let b=await (0,p.apiFetch)(`/api/${s}/app/repairbuddy/part-brands?${a.toString()}`);C(Array.isArray(b.part_brands)?b.part_brands:[]),ae("number"==typeof b.meta?.total?b.meta.total:0),ac("number"==typeof b.meta?.per_page?b.meta.per_page:ab)}catch(a){if(a instanceof p.ApiError&&428===a.status&&"string"==typeof s&&s.length>0){let a=`/app/${s}/part-brands`;q.replace(`/app/${s}/branches/select?next=${encodeURIComponent(a)}`);return}w(a instanceof Error?a.message:"Failed to load part brands.")}finally{u(!1)}},[_,ab,Z,q,af?.dir,af?.id,s]);async function aj(a){if((a.preventDefault(),!z)&&"string"==typeof s&&0!==s.length){if(!ah)return void w("Forbidden.");A(!0),w(null),y(null);try{let a=H.trim();if(0===a.length)return void w("Name is required.");let b={...{name:a,is_active:L},description:J.trim().length>0?J.trim():null},c=null;F?(c=(await (0,p.apiFetch)(`/api/${s}/app/repairbuddy/part-brands/${F}`,{method:"PATCH",body:b})).part_brand??null,y("Part brand updated.")):(c=(await (0,p.apiFetch)(`/api/${s}/app/repairbuddy/part-brands`,{method:"POST",body:b})).part_brand??null,y("Part brand created."));let d=c?.id??F;if(d&&P){let a=new FormData;a.append("image",P);let b=await (0,p.apiFetch)(`/api/${s}/app/repairbuddy/part-brands/${d}/image`,{method:"POST",body:a});O(b.part_brand?.image_url??null)}E(!1),aa(0),await ai()}catch(a){a instanceof p.ApiError?w(a.message):w(F?"Failed to update part brand.":"Failed to create part brand.")}finally{A(!1)}}}async function ak(){if(!z&&F&&"string"==typeof s&&0!==s.length&&ah){A(!0),w(null),y(null);try{let a=await (0,p.apiFetch)(`/api/${s}/app/repairbuddy/part-brands/${F}/image`,{method:"DELETE"});O(a.part_brand?.image_url??null),y("Image removed."),Q(null),aa(0),await ai()}catch(a){a instanceof p.ApiError?w(a.message):w("Failed to remove image.")}finally{A(!1)}}}async function al(a){if(!z&&"string"==typeof s&&0!==s.length){var c;if(!ah)return void w("Forbidden.");c={title:"Delete part brand",message:(0,b.jsxs)("div",{children:["Delete ",(0,b.jsx)("span",{className:"font-semibold",children:a.name}),"?"]}),action:async()=>{A(!0),w(null),y(null);try{await (0,p.apiFetch)(`/api/${s}/app/repairbuddy/part-brands/${a.id}`,{method:"DELETE"}),y("Part brand deleted."),aa(0),await ai()}catch(a){a instanceof p.ApiError?w(a.message):w("Failed to delete part brand.")}finally{A(!1)}}},U(c.title),W(c.message),Y(()=>c.action),S(!0)}}c.default.useEffect(()=>{ai()},[ai]);let am=c.default.useMemo(()=>[{id:"name",header:"Brand",sortId:"name",cell:a=>(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("div",{className:"truncate font-semibold text-[var(--rb-text)]",children:a.name}),(0,b.jsx)("div",{className:"truncate text-xs text-zinc-600",children:a.id})]}),className:"min-w-[260px]"},{id:"active",header:"Active",sortId:"is_active",className:"whitespace-nowrap",cell:a=>(0,b.jsx)("div",{className:"text-sm text-zinc-700",children:a.is_active?"Yes":"No"})},{id:"description",header:"Description",cell:a=>(0,b.jsx)("div",{className:"text-sm text-zinc-700",children:a.description??"â€”"}),className:"min-w-[320px]"},{id:"actions",header:"",headerClassName:"text-right",className:"whitespace-nowrap text-right",cell:a=>ah?(0,b.jsx)(k.DropdownMenu,{align:"right",trigger:({toggle:a})=>(0,b.jsx)(g.Button,{variant:"ghost",size:"sm",onClick:a,disabled:z,className:"px-2",children:"Actions"}),children:({close:c})=>(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(k.DropdownMenuItem,{onSelect:()=>{c(),ah&&(G(a.id),I(a.name),K(a.description??""),M(!!a.is_active),O(a.image_url??null),Q(null),E(!0),w(null),y(null))},disabled:z,children:"Edit"}),(0,b.jsx)(k.DropdownMenuSeparator,{}),(0,b.jsx)(k.DropdownMenuItem,{destructive:!0,onSelect:()=>{c(),al(a)},disabled:z,children:"Delete"})]})}):null}],[z,ah]);return(0,b.jsx)(e.RequireAuth,{requiredPermission:"parts.view",children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(i.ConfirmDialog,{open:R,title:T,message:V,busy:z,confirmText:"Delete",confirmVariant:"secondary",onCancel:()=>{z||(S(!1),Y(null))},onConfirm:()=>{X&&(async()=>{await X(),S(!1),Y(null)})()}}),(0,b.jsx)(m.Modal,{open:D,onClose:()=>{z||E(!1)},title:F?"Edit part brand":"New part brand",footer:(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,b.jsx)(g.Button,{variant:"outline",onClick:()=>E(!1),disabled:z,children:"Cancel"}),(0,b.jsx)(g.Button,{disabled:z,type:"submit",form:"rb_part_brand_form",children:z?"Saving...":"Save"})]}),children:(0,b.jsxs)("form",{id:"rb_part_brand_form",className:"space-y-3",onSubmit:aj,children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-sm font-medium",htmlFor:"part_brand_name",children:"Name"}),(0,b.jsx)("input",{id:"part_brand_name",className:"w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:H,onChange:a=>I(a.target.value),required:!0,disabled:z})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-sm font-medium",htmlFor:"part_brand_description",children:"Description"}),(0,b.jsx)("textarea",{id:"part_brand_description",className:"w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:J,onChange:a=>K(a.target.value),disabled:z,rows:3})]}),(0,b.jsx)(l.ImagePickerWithPreview,{label:"Image",file:P,existingUrl:N,disabled:z,onFileChange:a=>{w(null),y(null),Q(a)},onRemoveExisting:F?()=>void ak():void 0,onError:a=>{w(a),y(null)}}),(0,b.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,b.jsx)("input",{type:"checkbox",checked:L,onChange:a=>M(a.target.checked),disabled:z}),"Active"]})]})}),x?(0,b.jsx)("div",{className:"text-sm text-green-700",children:x}):null,v?(0,b.jsx)("div",{className:"text-sm text-red-600",children:v}):null,(0,b.jsx)(o.ListPageShell,{title:"Part Brands",description:"Brands for parts (Apple, Samsung, etc.).",actions:(0,b.jsx)(g.Button,{variant:"primary",size:"sm",onClick:function(){ah&&(G(null),I(""),K(""),M(!0),O(null),Q(null),E(!0),w(null),y(null))},disabled:!ah||t||z,children:"New part brand"}),loading:t,loadingFallback:(0,b.jsx)(h.Card,{className:"shadow-none",children:(0,b.jsx)(h.CardContent,{className:"pt-5",children:(0,b.jsx)(n.TableSkeleton,{rows:8,columns:5,className:"shadow-none"})})}),error:null,empty:!t&&!v&&0===B.length,emptyTitle:"No part brands",emptyDescription:"Add part brands to organize your inventory.",children:(0,b.jsx)(h.Card,{className:"shadow-none",children:(0,b.jsx)(h.CardContent,{className:"pt-5",children:(0,b.jsx)(j.DataTable,{title:"string"==typeof s?`Part Brands \xb7 ${s}`:"Part Brands",data:B,loading:t,emptyMessage:"No part brands.",columns:am,getRowId:a=>a.id,search:{placeholder:"Search brands..."},server:{query:Z,onQueryChange:a=>{$(a),aa(0)},pageIndex:_,onPageIndexChange:aa,pageSize:ab,onPageSizeChange:a=>{ac(a),aa(0)},totalRows:ad,sort:af,onSortChange:a=>{ag(a),aa(0)}}})})})})]})})}a.s(["default",()=>q])}];

//# sourceMappingURL=frontend_src_3001d6ff._.js.map