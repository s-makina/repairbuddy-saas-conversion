{"version":3,"sources":["../../../../../frontend/src/app/t/%5Btenant%5D/book/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React from \"react\";\r\nimport Image from \"next/image\";\r\nimport Link from \"next/link\";\r\nimport { useParams } from \"next/navigation\";\r\nimport { PublicPageShell } from \"@/components/PublicPageShell\";\r\nimport { Card, CardContent } from \"@/components/ui/Card\";\r\nimport { Alert } from \"@/components/ui/Alert\";\r\nimport { Button } from \"@/components/ui/Button\";\r\nimport { Input } from \"@/components/ui/Input\";\r\nimport { Badge } from \"@/components/ui/Badge\";\r\nimport { Select } from \"@/components/ui/Select\";\r\nimport { Skeleton } from \"@/components/ui/Skeleton\";\r\nimport { WizardShell } from \"@/components/repairbuddy/wizard/WizardShell\";\r\nimport { apiFetch, ApiError } from \"@/lib/api\";\r\nimport { cn } from \"@/lib/cn\";\r\nimport { formatMoney } from \"@/lib/money\";\r\n\r\ntype BookingConfig = {\r\n  disabled: boolean;\r\n  general: {\r\n    gdprAcceptanceText: string | null;\r\n    gdprLinkLabel: string | null;\r\n    gdprLinkUrl: string | null;\r\n    defaultCountry: string | null;\r\n  };\r\n  devicesBrands: {\r\n    enablePinCodeField: boolean;\r\n    labels: unknown;\r\n    additionalDeviceFields: Array<{ id?: unknown; label?: unknown; type?: unknown; displayInBookingForm?: unknown }>;\r\n  };\r\n  booking: {\r\n    publicBookingMode: \"ungrouped\" | \"grouped\" | \"warranty\";\r\n    publicBookingUiStyle: \"wizard\" | \"images\";\r\n    sendBookingQuoteToJobs: boolean;\r\n    customerCreationEmailBehavior: \"send_login_credentials\" | \"no_email\";\r\n    turnOffOtherDeviceBrand: boolean;\r\n    turnOffOtherService: boolean;\r\n    turnOffServicePrice: boolean;\r\n    turnOffIdImeiInBooking: boolean;\r\n    defaultType: string;\r\n    defaultBrand: string;\r\n    defaultDevice: string;\r\n  };\r\n};\r\n\r\ntype ApiDeviceType = { id: number; parent_id: number | null; name: string; description: string | null; image_url: string | null };\r\ntype ApiBrand = { id: number; name: string; image_url: string | null };\r\ntype ApiDevice = { id: number; model: string; device_type_id: number | null; device_brand_id: number | null; parent_device_id: number | null; is_other: boolean };\r\ntype ApiServiceType = { id: number; name: string };\r\ntype ApiService = {\r\n  id: number;\r\n  name: string;\r\n  description: string | null;\r\n  service_type: ApiServiceType | null;\r\n  is_active: boolean;\r\n  price: { currency: string; amount_cents: number } | null;\r\n  tax_id: number | null;\r\n};\r\ntype ApiServiceGroup = { service_type: ApiServiceType | null; services: ApiService[] };\r\n\r\ntype ExtraFieldDraft = { key: string; label: string; value_text: string };\r\n\r\ntype SubmitResult = {\r\n  entity: \"job\" | \"estimate\";\r\n  id: number;\r\n  case_number: string;\r\n  customer_id: number;\r\n};\r\n\r\ntype BookingUiStyle = \"wizard\" | \"images\";\r\n\r\nfunction portalSessionKey(tenantSlug: string) {\r\n  return `rb.portal.session:v1:${tenantSlug}`;\r\n}\r\n\r\nfunction safeInt(value: string): number | null {\r\n  const n = Number(value);\r\n  return Number.isFinite(n) && n > 0 ? Math.trunc(n) : null;\r\n}\r\n\r\nfunction errorMessage(e: unknown): string {\r\n  if (e instanceof ApiError) {\r\n    const data = e.data;\r\n    if (data && typeof data === \"object\" && \"errors\" in (data as Record<string, unknown>)) {\r\n      const errors = (data as Record<string, unknown>).errors;\r\n      if (errors && typeof errors === \"object\") {\r\n        const first = Object.values(errors as Record<string, unknown>)[0];\r\n        if (Array.isArray(first) && typeof first[0] === \"string\") {\r\n          return first[0];\r\n        }\r\n      }\r\n    }\r\n    return e.message;\r\n  }\r\n  return e instanceof Error ? e.message : \"Booking failed.\";\r\n}\r\n\r\nfunction PublicBookingPageSkeleton() {\r\n  return (\r\n    <div className=\"space-y-5\">\r\n      <div className=\"space-y-2\">\r\n        <Skeleton className=\"h-6 w-56 rounded-[var(--rb-radius-sm)]\" />\r\n        <Skeleton className=\"h-4 w-4/5 rounded-[var(--rb-radius-sm)]\" />\r\n      </div>\r\n\r\n      <div className=\"grid gap-4 lg:grid-cols-[280px_minmax(0,1fr)]\">\r\n        <div className=\"space-y-4\">\r\n          <Skeleton className=\"h-4 w-32 rounded-[var(--rb-radius-sm)]\" />\r\n          <div className=\"space-y-2\">\r\n            <Skeleton className=\"h-10 w-full rounded-[var(--rb-radius-md)]\" />\r\n            <Skeleton className=\"h-10 w-full rounded-[var(--rb-radius-md)]\" />\r\n            <Skeleton className=\"h-10 w-full rounded-[var(--rb-radius-md)]\" />\r\n            <Skeleton className=\"h-10 w-full rounded-[var(--rb-radius-md)]\" />\r\n          </div>\r\n          <Skeleton className=\"h-28 w-full rounded-[var(--rb-radius-md)]\" />\r\n        </div>\r\n\r\n        <div className=\"space-y-4\">\r\n          <div className=\"space-y-2\">\r\n            <Skeleton className=\"h-6 w-64 rounded-[var(--rb-radius-sm)]\" />\r\n            <Skeleton className=\"h-4 w-full rounded-[var(--rb-radius-sm)]\" />\r\n          </div>\r\n          <div className=\"space-y-3\">\r\n            <Skeleton className=\"h-10 w-full rounded-[var(--rb-radius-md)]\" />\r\n            <Skeleton className=\"h-10 w-full rounded-[var(--rb-radius-md)]\" />\r\n            <Skeleton className=\"h-10 w-11/12 rounded-[var(--rb-radius-md)]\" />\r\n            <Skeleton className=\"h-10 w-10/12 rounded-[var(--rb-radius-md)]\" />\r\n          </div>\r\n          <div className=\"flex items-center justify-end gap-2 pt-2\">\r\n            <Skeleton className=\"h-10 w-28 rounded-[var(--rb-radius-md)]\" />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default function PublicBookingPage() {\r\n  const params = useParams() as { tenant?: string };\r\n  const tenantSlug = typeof params.tenant === \"string\" ? params.tenant : \"\";\r\n\r\n  const [configLoading, setConfigLoading] = React.useState(true);\r\n  const [configError, setConfigError] = React.useState<string | null>(null);\r\n  const [config, setConfig] = React.useState<BookingConfig | null>(null);\r\n\r\n  const [step, setStep] = React.useState<1 | 2 | 3 | 4>(1);\r\n  const [flowError, setFlowError] = React.useState<string | null>(null);\r\n\r\n  const [uiStyle, setUiStyle] = React.useState<BookingUiStyle>(\"wizard\");\r\n\r\n  const [typeId, setTypeId] = React.useState<string>(\"\");\r\n  const [brandId, setBrandId] = React.useState<string>(\"\");\r\n  const [deviceId, setDeviceId] = React.useState<string>(\"\");\r\n  const [otherDeviceLabel, setOtherDeviceLabel] = React.useState<string>(\"\");\r\n\r\n  const [serial, setSerial] = React.useState<string>(\"\");\r\n  const [pin, setPin] = React.useState<string>(\"\");\r\n  const [deviceNotes, setDeviceNotes] = React.useState<string>(\"\");\r\n\r\n  const [extraFields, setExtraFields] = React.useState<ExtraFieldDraft[]>([]);\r\n\r\n  const [serviceId, setServiceId] = React.useState<string>(\"\");\r\n  const [serviceQty, setServiceQty] = React.useState<number>(1);\r\n  const [otherService, setOtherService] = React.useState<string>(\"\");\r\n  const [serviceQuery, setServiceQuery] = React.useState<string>(\"\");\r\n\r\n  const [customerFirstName, setCustomerFirstName] = React.useState<string>(\"\");\r\n  const [customerLastName, setCustomerLastName] = React.useState<string>(\"\");\r\n  const [customerEmail, setCustomerEmail] = React.useState<string>(\"\");\r\n  const [customerPhone, setCustomerPhone] = React.useState<string>(\"\");\r\n  const [customerCompany, setCustomerCompany] = React.useState<string>(\"\");\r\n  const [customerTaxId, setCustomerTaxId] = React.useState<string>(\"\");\r\n  const [addressLine1, setAddressLine1] = React.useState<string>(\"\");\r\n  const [addressLine2, setAddressLine2] = React.useState<string>(\"\");\r\n  const [addressCity, setAddressCity] = React.useState<string>(\"\");\r\n  const [addressState, setAddressState] = React.useState<string>(\"\");\r\n  const [addressPostalCode, setAddressPostalCode] = React.useState<string>(\"\");\r\n  const [addressCountry, setAddressCountry] = React.useState<string>(\"\");\r\n\r\n  const [jobDetails, setJobDetails] = React.useState<string>(\"\");\r\n  const [gdprAccepted, setGdprAccepted] = React.useState<boolean>(false);\r\n  const [dateOfPurchase, setDateOfPurchase] = React.useState<string>(\"\");\r\n\r\n  const [attachments, setAttachments] = React.useState<File[]>([]);\r\n\r\n  const [catalogLoading, setCatalogLoading] = React.useState<boolean>(false);\r\n  const [catalogError, setCatalogError] = React.useState<string | null>(null);\r\n  const [deviceTypes, setDeviceTypes] = React.useState<ApiDeviceType[]>([]);\r\n  const [brands, setBrands] = React.useState<ApiBrand[]>([]);\r\n  const [devices, setDevices] = React.useState<ApiDevice[]>([]);\r\n  const [serviceGroups, setServiceGroups] = React.useState<ApiServiceGroup[]>([]);\r\n\r\n  const [submitBusy, setSubmitBusy] = React.useState(false);\r\n  const [submitError, setSubmitError] = React.useState<string | null>(null);\r\n  const [submitResult, setSubmitResult] = React.useState<SubmitResult | null>(null);\r\n\r\n  React.useEffect(() => {\r\n    let alive = true;\r\n\r\n    async function loadConfig() {\r\n      try {\r\n        setConfigLoading(true);\r\n        setConfigError(null);\r\n\r\n        if (!tenantSlug) {\r\n          setConfig(null);\r\n          return;\r\n        }\r\n\r\n        const c = await apiFetch<BookingConfig>(`/api/t/${tenantSlug}/booking/config`, {\r\n          token: null,\r\n          impersonationSessionId: null,\r\n        });\r\n        if (!alive) return;\r\n        setConfig(c);\r\n\r\n        const style = c?.booking?.publicBookingUiStyle;\r\n        if (style === \"wizard\" || style === \"images\") {\r\n          setUiStyle(style);\r\n        } else {\r\n          setUiStyle(\"wizard\");\r\n        }\r\n\r\n        const nextExtraFields: ExtraFieldDraft[] = (Array.isArray(c?.devicesBrands?.additionalDeviceFields) ? c.devicesBrands.additionalDeviceFields : [])\r\n          .map((f) => {\r\n            const key = typeof f?.id === \"string\" ? f.id : \"\";\r\n            const label = typeof f?.label === \"string\" ? f.label : \"\";\r\n            const display = typeof f?.displayInBookingForm === \"boolean\" ? f.displayInBookingForm : true;\r\n            if (!key || !label || !display) return null;\r\n            return { key, label, value_text: \"\" };\r\n          })\r\n          .filter((x): x is ExtraFieldDraft => Boolean(x));\r\n        setExtraFields(nextExtraFields);\r\n\r\n        const nextCountry = (c?.general?.defaultCountry ?? \"\").trim();\r\n        setAddressCountry(nextCountry);\r\n\r\n        if (c?.booking?.defaultType) setTypeId(c.booking.defaultType);\r\n        if (c?.booking?.defaultBrand) setBrandId(c.booking.defaultBrand);\r\n        if (c?.booking?.defaultDevice) setDeviceId(c.booking.defaultDevice);\r\n      } catch (e) {\r\n        if (!alive) return;\r\n        setConfigError(errorMessage(e));\r\n        setConfig(null);\r\n      } finally {\r\n        if (!alive) return;\r\n        setConfigLoading(false);\r\n      }\r\n    }\r\n\r\n    void loadConfig();\r\n\r\n    return () => {\r\n      alive = false;\r\n    };\r\n  }, [tenantSlug]);\r\n\r\n  React.useEffect(() => {\r\n    let alive = true;\r\n\r\n    async function loadTypes() {\r\n      try {\r\n        setCatalogLoading(true);\r\n        setCatalogError(null);\r\n\r\n        if (!tenantSlug) {\r\n          setDeviceTypes([]);\r\n          return;\r\n        }\r\n\r\n        const res = await apiFetch<{ device_types: ApiDeviceType[] }>(`/api/t/${tenantSlug}/booking/device-types`, {\r\n          token: null,\r\n          impersonationSessionId: null,\r\n        });\r\n        if (!alive) return;\r\n        setDeviceTypes(Array.isArray(res?.device_types) ? res.device_types : []);\r\n      } catch (e) {\r\n        if (!alive) return;\r\n        setCatalogError(errorMessage(e));\r\n        setDeviceTypes([]);\r\n      } finally {\r\n        if (!alive) return;\r\n        setCatalogLoading(false);\r\n      }\r\n    }\r\n\r\n    void loadTypes();\r\n\r\n    return () => {\r\n      alive = false;\r\n    };\r\n  }, [tenantSlug]);\r\n\r\n  React.useEffect(() => {\r\n    let alive = true;\r\n\r\n    async function loadBrands() {\r\n      try {\r\n        setCatalogError(null);\r\n\r\n        if (!tenantSlug) {\r\n          setBrands([]);\r\n          return;\r\n        }\r\n\r\n        const nextTypeId = safeInt(typeId);\r\n        const res = await apiFetch<{ brands: ApiBrand[] }>(`/api/t/${tenantSlug}/booking/brands${nextTypeId ? `?typeId=${nextTypeId}` : \"\"}`, {\r\n          token: null,\r\n          impersonationSessionId: null,\r\n        });\r\n        if (!alive) return;\r\n        setBrands(Array.isArray(res?.brands) ? res.brands : []);\r\n      } catch (e) {\r\n        if (!alive) return;\r\n        setCatalogError(errorMessage(e));\r\n        setBrands([]);\r\n      }\r\n    }\r\n\r\n    void loadBrands();\r\n\r\n    return () => {\r\n      alive = false;\r\n    };\r\n  }, [tenantSlug, typeId]);\r\n\r\n  React.useEffect(() => {\r\n    let alive = true;\r\n\r\n    async function loadDevices() {\r\n      try {\r\n        setCatalogError(null);\r\n\r\n        if (!tenantSlug) {\r\n          setDevices([]);\r\n          return;\r\n        }\r\n\r\n        const nextTypeId = safeInt(typeId);\r\n        const nextBrandId = safeInt(brandId);\r\n\r\n        const qs = new URLSearchParams();\r\n        if (nextTypeId) qs.set(\"typeId\", String(nextTypeId));\r\n        if (nextBrandId) qs.set(\"brandId\", String(nextBrandId));\r\n\r\n        const res = await apiFetch<{ devices: ApiDevice[] }>(`/api/t/${tenantSlug}/booking/devices${qs.toString() ? `?${qs.toString()}` : \"\"}`,\r\n          {\r\n            token: null,\r\n            impersonationSessionId: null,\r\n          },\r\n        );\r\n        if (!alive) return;\r\n        setDevices(Array.isArray(res?.devices) ? res.devices : []);\r\n      } catch (e) {\r\n        if (!alive) return;\r\n        setCatalogError(errorMessage(e));\r\n        setDevices([]);\r\n      }\r\n    }\r\n\r\n    void loadDevices();\r\n\r\n    return () => {\r\n      alive = false;\r\n    };\r\n  }, [tenantSlug, typeId, brandId]);\r\n\r\n  React.useEffect(() => {\r\n    let alive = true;\r\n\r\n    async function loadServices() {\r\n      try {\r\n        setCatalogError(null);\r\n        if (!tenantSlug || !config) {\r\n          setServiceGroups([]);\r\n          return;\r\n        }\r\n\r\n        const nextDeviceId = safeInt(deviceId);\r\n        const qs = new URLSearchParams();\r\n        if (nextDeviceId) qs.set(\"deviceId\", String(nextDeviceId));\r\n        qs.set(\"mode\", config.booking.publicBookingMode);\r\n\r\n        const res = await apiFetch<{ mode: string; services?: ApiService[]; groups?: ApiServiceGroup[] }>(\r\n          `/api/t/${tenantSlug}/booking/services?${qs.toString()}`,\r\n          {\r\n            token: null,\r\n            impersonationSessionId: null,\r\n          },\r\n        );\r\n        if (!alive) return;\r\n\r\n        if (Array.isArray(res?.groups)) {\r\n          setServiceGroups(res.groups.map((g) => ({ service_type: g.service_type ?? null, services: Array.isArray(g.services) ? g.services : [] })));\r\n        } else {\r\n          const list = Array.isArray(res?.services) ? res.services : [];\r\n          const grouped: Record<string, ApiServiceGroup> = {};\r\n          for (const s of list) {\r\n            const k = s.service_type?.id ? String(s.service_type.id) : \"none\";\r\n            if (!grouped[k]) grouped[k] = { service_type: s.service_type ?? null, services: [] };\r\n            grouped[k].services.push(s);\r\n          }\r\n          setServiceGroups(Object.values(grouped));\r\n        }\r\n      } catch (e) {\r\n        if (!alive) return;\r\n        setCatalogError(errorMessage(e));\r\n        setServiceGroups([]);\r\n      }\r\n    }\r\n\r\n    void loadServices();\r\n\r\n    return () => {\r\n      alive = false;\r\n    };\r\n  }, [tenantSlug, deviceId, config]);\r\n\r\n  const allowOtherDevice = config ? !config.booking.turnOffOtherDeviceBrand : true;\r\n  const allowOtherService = config ? !config.booking.turnOffOtherService : true;\r\n\r\n  const gdprText = (config?.general?.gdprAcceptanceText ?? \"\").trim();\r\n  const needsGdpr = gdprText.length > 0;\r\n\r\n  const selectedService = React.useMemo(() => {\r\n    const sid = safeInt(serviceId);\r\n    if (!sid) return null;\r\n    for (const g of serviceGroups) {\r\n      const found = g.services.find((s) => s.id === sid);\r\n      if (found) return found;\r\n    }\r\n    return null;\r\n  }, [serviceGroups, serviceId]);\r\n\r\n  const selectedDeviceLabel = React.useMemo(() => {\r\n    const did = safeInt(deviceId);\r\n    if (did) {\r\n      return devices.find((d) => d.id === did)?.model ?? \"\";\r\n    }\r\n    return otherDeviceLabel.trim();\r\n  }, [devices, deviceId, otherDeviceLabel]);\r\n\r\n  const selectedServiceLabel = React.useMemo(() => {\r\n    const sid = safeInt(serviceId);\r\n    if (sid) return selectedService?.name ?? \"\";\r\n    return otherService.trim();\r\n  }, [otherService, selectedService, serviceId]);\r\n\r\n  const nextDisabled = submitBusy\r\n    ? true\r\n    : step === 1\r\n      ? Boolean(canGoStep2())\r\n      : step === 2\r\n        ? Boolean(canGoStep3())\r\n        : step === 3\r\n          ? Boolean(canGoStep4())\r\n          : false;\r\n\r\n  const statusCheckLink = tenantSlug && submitResult?.case_number ? `/t/${tenantSlug}/status?caseNumber=${encodeURIComponent(submitResult.case_number)}` : \"\";\r\n\r\n  function canGoStep2(): string | null {\r\n    if (!allowOtherDevice && !safeInt(deviceId)) return \"Please select a device.\";\r\n    if (allowOtherDevice && !safeInt(deviceId) && otherDeviceLabel.trim().length === 0) return \"Please select a device or enter a device label.\";\r\n    return null;\r\n  }\r\n\r\n  function canGoStep3(): string | null {\r\n    const selected = safeInt(serviceId);\r\n    if (selected && otherService.trim().length > 0) return \"Choose a service or enter other service, not both.\";\r\n    if (!allowOtherService && !selected) return \"Please select a service.\";\r\n    if (allowOtherService && !selected && otherService.trim().length === 0) return \"Please select a service or enter other service.\";\r\n    if (serviceQty < 1) return \"Quantity must be at least 1.\";\r\n    return null;\r\n  }\r\n\r\n  function canGoStep4(): string | null {\r\n    if (config?.booking?.publicBookingMode === \"warranty\" && dateOfPurchase.trim().length === 0) return \"Date of purchase is required.\";\r\n    if (customerFirstName.trim().length === 0) return \"First name is required.\";\r\n    if (customerLastName.trim().length === 0) return \"Last name is required.\";\r\n    if (customerEmail.trim().length === 0) return \"Email is required.\";\r\n    if (jobDetails.trim().length === 0) return \"Job details are required.\";\r\n    if (needsGdpr && !gdprAccepted) return \"Please accept GDPR.\";\r\n    return null;\r\n  }\r\n\r\n  function currentStepValidationError(nextStep: 1 | 2 | 3 | 4): string | null {\r\n    if (nextStep <= step) return null;\r\n    if (step === 1) return canGoStep2();\r\n    if (step === 2) return canGoStep3();\r\n    if (step === 3) return canGoStep4();\r\n    return null;\r\n  }\r\n\r\n  async function submitBooking() {\r\n    setSubmitError(null);\r\n    setFlowError(null);\r\n\r\n    if (!tenantSlug) {\r\n      setSubmitError(\"Tenant slug is required in the URL.\");\r\n      return;\r\n    }\r\n    if (!config) {\r\n      setSubmitError(\"Booking configuration is not loaded.\");\r\n      return;\r\n    }\r\n\r\n    const stepError = canGoStep4();\r\n    if (stepError) {\r\n      setFlowError(stepError);\r\n      return;\r\n    }\r\n\r\n    const nextDeviceId = safeInt(deviceId);\r\n    const nextServiceId = safeInt(serviceId);\r\n    const nextQty = Number.isFinite(serviceQty) ? Math.trunc(serviceQty) : 1;\r\n\r\n    const payload = {\r\n      mode: config.booking.publicBookingMode,\r\n      gdprAccepted: needsGdpr ? gdprAccepted : undefined,\r\n      jobDetails: jobDetails.trim(),\r\n      warranty: config.booking.publicBookingMode === \"warranty\" ? { dateOfPurchase: dateOfPurchase.trim() } : undefined,\r\n      customer: {\r\n        firstName: customerFirstName.trim(),\r\n        lastName: customerLastName.trim(),\r\n        userEmail: customerEmail.trim(),\r\n        phone: customerPhone.trim().length > 0 ? customerPhone.trim() : null,\r\n        company: customerCompany.trim().length > 0 ? customerCompany.trim() : null,\r\n        taxId: customerTaxId.trim().length > 0 ? customerTaxId.trim() : null,\r\n        addressLine1: addressLine1.trim().length > 0 ? addressLine1.trim() : null,\r\n        addressLine2: addressLine2.trim().length > 0 ? addressLine2.trim() : null,\r\n        city: addressCity.trim().length > 0 ? addressCity.trim() : null,\r\n        state: addressState.trim().length > 0 ? addressState.trim() : null,\r\n        postalCode: addressPostalCode.trim().length > 0 ? addressPostalCode.trim() : null,\r\n        country: addressCountry.trim().length > 0 ? addressCountry.trim() : null,\r\n      },\r\n      devices: [\r\n        {\r\n          device_id: nextDeviceId,\r\n          device_label: nextDeviceId ? null : otherDeviceLabel.trim().length > 0 ? otherDeviceLabel.trim() : null,\r\n          serial: config.booking.turnOffIdImeiInBooking ? null : serial.trim().length > 0 ? serial.trim() : null,\r\n          pin: config.devicesBrands.enablePinCodeField ? (pin.trim().length > 0 ? pin.trim() : null) : null,\r\n          notes: deviceNotes.trim().length > 0 ? deviceNotes.trim() : null,\r\n          extra_fields: extraFields\r\n            .map((f) => ({ key: f.key, label: f.label, value_text: f.value_text.trim().length > 0 ? f.value_text.trim() : null }))\r\n            .filter((f) => typeof f.key === \"string\" && f.key.trim().length > 0),\r\n          services: nextServiceId ? [{ service_id: nextServiceId, qty: nextQty }] : [],\r\n          other_service: otherService.trim().length > 0 ? otherService.trim() : null,\r\n        },\r\n      ],\r\n    };\r\n\r\n    const form = new FormData();\r\n    form.set(\"payload_json\", JSON.stringify(payload));\r\n    for (const f of attachments.slice(0, 5)) {\r\n      form.append(\"attachments[]\", f);\r\n    }\r\n\r\n    setSubmitBusy(true);\r\n    try {\r\n      const res = await apiFetch<SubmitResult>(`/api/t/${tenantSlug}/booking/submit`, {\r\n        method: \"POST\",\r\n        body: form,\r\n        token: null,\r\n        impersonationSessionId: null,\r\n      });\r\n\r\n      setSubmitResult(res);\r\n\r\n      try {\r\n        if (typeof window !== \"undefined\") {\r\n          window.localStorage.setItem(\r\n            portalSessionKey(tenantSlug),\r\n            JSON.stringify({\r\n              job_id: String(res.id),\r\n              case_number: res.case_number,\r\n            }),\r\n          );\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n    } catch (e) {\r\n      setSubmitError(errorMessage(e));\r\n    } finally {\r\n      setSubmitBusy(false);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <PublicPageShell\r\n      badge={\r\n        <span className=\"inline-flex items-center gap-2\">\r\n          <span>RepairBuddy</span>\r\n          {tenantSlug ? <Badge variant=\"info\">{tenantSlug}</Badge> : null}\r\n        </span>\r\n      }\r\n      actions={\r\n        tenantSlug ? (\r\n          <div className=\"flex items-center gap-3\">\r\n            <Link href={`/t/${tenantSlug}/status`} className=\"text-sm font-semibold text-[var(--rb-blue)] hover:underline\">\r\n              Status check\r\n            </Link>\r\n            <Link href={`/t/${tenantSlug}/portal`} className=\"text-sm font-semibold text-[var(--rb-blue)] hover:underline\">\r\n              Portal\r\n            </Link>\r\n          </div>\r\n        ) : null\r\n      }\r\n      centerContent\r\n    >\r\n      <div className=\"mx-auto w-full max-w-5xl px-4\">\r\n        <Card className=\"shadow-none\">\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"space-y-5\">\r\n              <div>\r\n                <div className=\"text-xl font-semibold text-[var(--rb-text)]\">Book an appointment</div>\r\n                <div className=\"mt-1 text-sm text-zinc-600\">Tell us what you need and we’ll create your booking and send you a case number.</div>\r\n              </div>\r\n\r\n              {!tenantSlug ? (\r\n                <Alert variant=\"warning\" title=\"Missing tenant\">\r\n                  Tenant slug is required in the URL.\r\n                </Alert>\r\n              ) : null}\r\n\r\n              {config?.disabled ? (\r\n                <Alert variant=\"warning\" title=\"Booking disabled\">\r\n                  This business has disabled public booking.\r\n                </Alert>\r\n              ) : null}\r\n\r\n              {configError ? (\r\n                <Alert variant=\"danger\" title=\"Could not load booking settings\">\r\n                  {configError}\r\n                </Alert>\r\n              ) : null}\r\n\r\n              {catalogError ? (\r\n                <Alert variant=\"danger\" title=\"Could not load catalog\">\r\n                  {catalogError}\r\n                </Alert>\r\n              ) : null}\r\n\r\n              {configLoading || catalogLoading ? <PublicBookingPageSkeleton /> : null}\r\n\r\n              {submitError ? (\r\n                <Alert variant=\"danger\" title=\"Booking failed\">\r\n                  {submitError}\r\n                </Alert>\r\n              ) : null}\r\n\r\n              {flowError ? (\r\n                <Alert variant=\"warning\" title=\"Please review this step\">\r\n                  {flowError}\r\n                </Alert>\r\n              ) : null}\r\n\r\n              {submitResult ? (\r\n                <Alert variant=\"success\" title=\"Booking submitted\">\r\n                  <div className=\"space-y-2\">\r\n                    <div>\r\n                      Case number: <span className=\"font-semibold\">{submitResult.case_number}</span>\r\n                    </div>\r\n                    <div className=\"flex flex-wrap items-center gap-3\">\r\n                      <Link href={statusCheckLink} className=\"text-sm font-semibold text-[var(--rb-blue)] hover:underline\">\r\n                        Status check\r\n                      </Link>\r\n                      <Link href={`/t/${tenantSlug}/portal`} className=\"text-sm font-semibold text-[var(--rb-blue)] hover:underline\">\r\n                        Portal\r\n                      </Link>\r\n                    </div>\r\n                  </div>\r\n                </Alert>\r\n              ) : null}\r\n\r\n              {!configLoading && !catalogLoading && !configError && !catalogError && config && !config.disabled && !submitResult ? (\r\n                <WizardShell\r\n                  steps={[\r\n                    {\r\n                      id: 1,\r\n                      navTitle: \"Device\",\r\n                      navDescription: \"Choose the device you want to book for.\",\r\n                      pageTitle: \"Choose your device\",\r\n                      pageDescription: \"Select a type, brand and model (or enter it manually).\",\r\n                      footerTitle: \"Device\",\r\n                    },\r\n                    {\r\n                      id: 2,\r\n                      navTitle: \"Service\",\r\n                      navDescription: \"Pick what you need.\",\r\n                      pageTitle: \"Select a service\",\r\n                      pageDescription: \"Choose one service for this device.\",\r\n                      footerTitle: \"Service\",\r\n                    },\r\n                    {\r\n                      id: 3,\r\n                      navTitle: \"Details\",\r\n                      navDescription: \"Your contact details and notes.\",\r\n                      pageTitle: \"Your details\",\r\n                      pageDescription: \"Add your info so we can confirm and follow up.\",\r\n                      footerTitle: \"Details\",\r\n                    },\r\n                    {\r\n                      id: 4,\r\n                      navTitle: \"Review\",\r\n                      navDescription: \"Confirm and submit.\",\r\n                      pageTitle: \"Review & submit\",\r\n                      pageDescription: \"Double-check everything before submitting.\",\r\n                      footerTitle: \"Review\",\r\n                    },\r\n                  ]}\r\n                  step={step}\r\n                  disabled={submitBusy}\r\n                  nextDisabled={nextDisabled}\r\n                  sidebarTitle=\"Booking steps\"\r\n                  sidebarDescription=\"Complete the steps to submit your booking.\"\r\n                  sidebarAriaLabel=\"Booking steps\"\r\n                  sidebarFooter={\r\n                    <div className=\"space-y-3\">\r\n                      <div className=\"text-xs font-semibold uppercase tracking-wide text-zinc-500\">Your booking</div>\r\n\r\n                      <div className=\"space-y-2\">\r\n                        <div className=\"flex items-start justify-between gap-3\">\r\n                          <div className=\"min-w-0\">\r\n                            <div className=\"text-xs text-zinc-500\">Device</div>\r\n                            <div className=\"truncate text-sm font-semibold text-[var(--rb-text)]\">{selectedDeviceLabel || \"—\"}</div>\r\n                          </div>\r\n                          <Button variant=\"ghost\" size=\"sm\" type=\"button\" disabled={submitBusy} onClick={() => setStep(1)}>\r\n                            Edit\r\n                          </Button>\r\n                        </div>\r\n\r\n                        <div className=\"flex items-start justify-between gap-3\">\r\n                          <div className=\"min-w-0\">\r\n                            <div className=\"text-xs text-zinc-500\">Service</div>\r\n                            <div className=\"truncate text-sm font-semibold text-[var(--rb-text)]\">{selectedServiceLabel || \"—\"}</div>\r\n                            <div className=\"mt-0.5 text-xs text-zinc-500\">Qty: {Math.max(1, Number.isFinite(serviceQty) ? Math.trunc(serviceQty) : 1)}</div>\r\n                            {!config.booking.turnOffServicePrice && selectedService?.price ? (\r\n                              <div className=\"mt-0.5 text-xs text-zinc-500\">\r\n                                Starting: {formatMoney({ amountCents: selectedService.price.amount_cents * Math.max(1, Math.trunc(serviceQty || 1)), currency: selectedService.price.currency })}\r\n                              </div>\r\n                            ) : null}\r\n                          </div>\r\n                          <Button variant=\"ghost\" size=\"sm\" type=\"button\" disabled={submitBusy} onClick={() => setStep(2)}>\r\n                            Edit\r\n                          </Button>\r\n                        </div>\r\n\r\n                        <div className=\"flex items-start justify-between gap-3\">\r\n                          <div className=\"min-w-0\">\r\n                            <div className=\"text-xs text-zinc-500\">Contact</div>\r\n                            <div className=\"truncate text-sm font-semibold text-[var(--rb-text)]\">\r\n                              {(customerFirstName.trim() || customerLastName.trim())\r\n                                ? `${customerFirstName.trim()} ${customerLastName.trim()}`.trim()\r\n                                : \"—\"}\r\n                            </div>\r\n                            <div className=\"truncate text-xs text-zinc-500\">{customerEmail.trim() || \"\"}</div>\r\n                          </div>\r\n                          <Button variant=\"ghost\" size=\"sm\" type=\"button\" disabled={submitBusy} onClick={() => setStep(3)}>\r\n                            Edit\r\n                          </Button>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  }\r\n                  onStepChange={(next) => {\r\n                    setSubmitError(null);\r\n                    if (next > step) {\r\n                      const err = currentStepValidationError(next as 1 | 2 | 3 | 4);\r\n                      if (err) {\r\n                        setFlowError(err);\r\n                        return;\r\n                      }\r\n                    }\r\n                    setFlowError(null);\r\n                    setStep(next as 1 | 2 | 3 | 4);\r\n                  }}\r\n                  footerRight={\r\n                    <Button disabled={submitBusy} onClick={() => void submitBooking()} type=\"button\">\r\n                      {submitBusy ? \"Submitting...\" : \"Submit booking\"}\r\n                    </Button>\r\n                  }\r\n                >\r\n                  {step === 1 ? (\r\n                    <div className=\"space-y-4\">\r\n                      {uiStyle === \"wizard\" ? (\r\n                        <div className=\"grid gap-4 sm:grid-cols-2\">\r\n                          <div>\r\n                            <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Device type</div>\r\n                            <div className=\"mt-2\">\r\n                              <Select\r\n                                value={typeId}\r\n                                onChange={(e) => {\r\n                                  setFlowError(null);\r\n                                  setTypeId(e.target.value);\r\n                                  setBrandId(\"\");\r\n                                  setDeviceId(\"\");\r\n                                }}\r\n                              >\r\n                                <option value=\"\">Select type</option>\r\n                                {deviceTypes.map((t) => (\r\n                                  <option key={t.id} value={String(t.id)}>\r\n                                    {t.name}\r\n                                  </option>\r\n                                ))}\r\n                              </Select>\r\n                            </div>\r\n                          </div>\r\n\r\n                          <div>\r\n                            <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Brand</div>\r\n                            <div className=\"mt-2\">\r\n                              <Select\r\n                                value={brandId}\r\n                                disabled={!typeId}\r\n                                onChange={(e) => {\r\n                                  setFlowError(null);\r\n                                  setBrandId(e.target.value);\r\n                                  setDeviceId(\"\");\r\n                                }}\r\n                              >\r\n                                <option value=\"\">Select brand</option>\r\n                                {brands.map((b) => (\r\n                                  <option key={b.id} value={String(b.id)}>\r\n                                    {b.name}\r\n                                  </option>\r\n                                ))}\r\n                              </Select>\r\n                            </div>\r\n                          </div>\r\n\r\n                          <div className=\"sm:col-span-2\">\r\n                            <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Device</div>\r\n                            <div className=\"mt-2\">\r\n                              <Select\r\n                                value={deviceId}\r\n                                disabled={!typeId || !brandId}\r\n                                onChange={(e) => {\r\n                                  setFlowError(null);\r\n                                  setDeviceId(e.target.value);\r\n                                }}\r\n                              >\r\n                                <option value=\"\">Select device</option>\r\n                                {devices.map((d) => (\r\n                                  <option key={d.id} value={String(d.id)}>\r\n                                    {d.model}\r\n                                  </option>\r\n                                ))}\r\n                              </Select>\r\n                            </div>\r\n                            {allowOtherDevice ? <div className=\"mt-2 text-xs text-zinc-500\">If your device is not listed, enter it below.</div> : null}\r\n                          </div>\r\n\r\n                          {allowOtherDevice ? (\r\n                            <div className=\"sm:col-span-2\">\r\n                              <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Other device</div>\r\n                              <div className=\"mt-2\">\r\n                                <Input\r\n                                  value={otherDeviceLabel}\r\n                                  onChange={(e) => {\r\n                                    setFlowError(null);\r\n                                    setOtherDeviceLabel(e.target.value);\r\n                                  }}\r\n                                  placeholder=\"e.g. Custom PC, Unknown model\"\r\n                                />\r\n                              </div>\r\n                            </div>\r\n                          ) : null}\r\n\r\n                          {!config.booking.turnOffIdImeiInBooking ? (\r\n                            <div>\r\n                              <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Serial / IMEI (optional)</div>\r\n                              <div className=\"mt-2\">\r\n                                <Input value={serial} onChange={(e) => setSerial(e.target.value)} placeholder=\"Serial, IMEI\" />\r\n                              </div>\r\n                            </div>\r\n                          ) : null}\r\n\r\n                          {config.devicesBrands.enablePinCodeField ? (\r\n                            <div>\r\n                              <div className=\"text-sm font-semibold text-[var(--rb-text)]\">PIN (optional)</div>\r\n                              <div className=\"mt-2\">\r\n                                <Input value={pin} onChange={(e) => setPin(e.target.value)} placeholder=\"Device PIN\" />\r\n                              </div>\r\n                            </div>\r\n                          ) : null}\r\n\r\n                          <div className=\"sm:col-span-2\">\r\n                            <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Device notes (optional)</div>\r\n                            <div className=\"mt-2\">\r\n                              <textarea\r\n                                value={deviceNotes}\r\n                                onChange={(e) => setDeviceNotes(e.target.value)}\r\n                                placeholder=\"Condition, accessories included, passcode notes, etc.\"\r\n                                className=\"w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm text-[var(--rb-text)] shadow-sm outline-none transition placeholder:text-zinc-400 focus-visible:ring-2 focus-visible:ring-[color:color-mix(in_srgb,var(--rb-orange),white_65%)] focus-visible:ring-offset-2 focus-visible:ring-offset-white\"\r\n                                rows={4}\r\n                              />\r\n                            </div>\r\n                          </div>\r\n\r\n                          {extraFields.length > 0 ? (\r\n                            <div className=\"sm:col-span-2\">\r\n                              <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Additional device info (optional)</div>\r\n                              <div className=\"mt-3 grid gap-3 sm:grid-cols-2\">\r\n                                {extraFields.map((f, idx) => (\r\n                                  <label key={f.key} className=\"grid gap-1 text-sm\">\r\n                                    <span className=\"font-semibold text-[var(--rb-text)]\">{f.label}</span>\r\n                                    <Input\r\n                                      value={f.value_text}\r\n                                      onChange={(e) => {\r\n                                        setExtraFields((prev) => {\r\n                                          const next = prev.slice();\r\n                                          next[idx] = { ...next[idx], value_text: e.target.value };\r\n                                          return next;\r\n                                        });\r\n                                      }}\r\n                                    />\r\n                                  </label>\r\n                                ))}\r\n                              </div>\r\n                            </div>\r\n                          ) : null}\r\n                        </div>\r\n                      ) : (\r\n                        <div className=\"space-y-5\">\r\n                          <div>\r\n                            <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Device type</div>\r\n                            <div className=\"mt-2 grid gap-3 sm:grid-cols-3\">\r\n                              {deviceTypes.map((t) => {\r\n                                const isSelected = typeId === String(t.id);\r\n                                const src = typeof t.image_url === \"string\" ? t.image_url : null;\r\n\r\n                                return (\r\n                                  <button\r\n                                    key={t.id}\r\n                                    type=\"button\"\r\n                                    onClick={() => {\r\n                                      setFlowError(null);\r\n                                      setTypeId(String(t.id));\r\n                                      setBrandId(\"\");\r\n                                      setDeviceId(\"\");\r\n                                    }}\r\n                                    className={cn(\r\n                                      \"group overflow-hidden rounded-[var(--rb-radius-md)] border bg-white text-left transition\",\r\n                                      isSelected\r\n                                        ? \"border-[color:color-mix(in_srgb,var(--rb-blue),white_60%)] bg-[color:color-mix(in_srgb,var(--rb-blue),white_96%)]\"\r\n                                        : \"border-[var(--rb-border)] hover:bg-[var(--rb-surface-muted)]\",\r\n                                    )}\r\n                                  >\r\n                                    <span className=\"relative block aspect-[16/10] w-full overflow-hidden bg-[var(--rb-surface-muted)]\">\r\n                                      {src ? (\r\n                                        <Image\r\n                                          alt={t.name}\r\n                                          src={src}\r\n                                          fill\r\n                                          sizes=\"(min-width: 1024px) 320px, (min-width: 640px) 33vw, 100vw\"\r\n                                          className=\"object-cover\"\r\n                                          loader={({ src }) => src}\r\n                                          unoptimized\r\n                                        />\r\n                                      ) : (\r\n                                        <span className=\"flex h-full w-full items-center justify-center text-sm font-semibold text-zinc-500\">\r\n                                          {t.name.slice(0, 2).toUpperCase()}\r\n                                        </span>\r\n                                      )}\r\n                                      <span className=\"pointer-events-none absolute inset-0 ring-1 ring-inset ring-black/5\" />\r\n                                    </span>\r\n                                    <span className=\"block p-3\">\r\n                                      <span className=\"block truncate text-sm font-semibold text-[var(--rb-text)]\">{t.name}</span>\r\n                                      {t.description ? <span className=\"mt-0.5 block line-clamp-2 text-xs text-zinc-600\">{t.description}</span> : null}\r\n                                    </span>\r\n                                  </button>\r\n                                );\r\n                              })}\r\n                            </div>\r\n                          </div>\r\n\r\n                          <div>\r\n                            <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Brand</div>\r\n                            {!typeId ? <div className=\"mt-1 text-xs text-zinc-500\">Select a device type to see brands.</div> : null}\r\n                            <div className=\"mt-2 grid grid-cols-2 gap-3 sm:grid-cols-4\">\r\n                              {brands.map((b) => {\r\n                                const isSelected = brandId === String(b.id);\r\n                                const src = typeof b.image_url === \"string\" ? b.image_url : null;\r\n\r\n                                return (\r\n                                  <button\r\n                                    key={b.id}\r\n                                    type=\"button\"\r\n                                    disabled={!typeId}\r\n                                    onClick={() => {\r\n                                      setFlowError(null);\r\n                                      setBrandId(String(b.id));\r\n                                      setDeviceId(\"\");\r\n                                    }}\r\n                                    className={cn(\r\n                                      \"group overflow-hidden rounded-[var(--rb-radius-md)] border bg-white text-left transition\",\r\n                                      !typeId ? \"pointer-events-none opacity-60\" : \"\",\r\n                                      isSelected\r\n                                        ? \"border-[color:color-mix(in_srgb,var(--rb-blue),white_60%)] bg-[color:color-mix(in_srgb,var(--rb-blue),white_96%)]\"\r\n                                        : \"border-[var(--rb-border)] hover:bg-[var(--rb-surface-muted)]\",\r\n                                    )}\r\n                                  >\r\n                                    <span className=\"relative block aspect-[4/3] w-full overflow-hidden bg-white\">\r\n                                      {src ? (\r\n                                        <Image\r\n                                          alt={b.name}\r\n                                          src={src}\r\n                                          fill\r\n                                          sizes=\"(min-width: 1024px) 240px, (min-width: 640px) 25vw, 50vw\"\r\n                                          className=\"object-contain p-4\"\r\n                                          loader={({ src }) => src}\r\n                                          unoptimized\r\n                                        />\r\n                                      ) : (\r\n                                        <span className=\"flex h-full w-full items-center justify-center text-sm font-semibold text-zinc-500\">\r\n                                          {b.name.slice(0, 2).toUpperCase()}\r\n                                        </span>\r\n                                      )}\r\n                                      <span className=\"pointer-events-none absolute inset-0 ring-1 ring-inset ring-black/5\" />\r\n                                    </span>\r\n                                    <span className=\"block p-3 pt-2\">\r\n                                      <span className=\"block truncate text-sm font-semibold text-[var(--rb-text)]\">{b.name}</span>\r\n                                    </span>\r\n                                  </button>\r\n                                );\r\n                              })}\r\n                            </div>\r\n                          </div>\r\n\r\n                          <div>\r\n                            <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Device</div>\r\n                            {!typeId || !brandId ? <div className=\"mt-1 text-xs text-zinc-500\">Select a type and brand to see devices.</div> : null}\r\n                            <div className=\"mt-2 grid gap-3 sm:grid-cols-3\">\r\n                              {devices.map((d) => {\r\n                                const isSelected = deviceId === String(d.id);\r\n\r\n                                return (\r\n                                  <button\r\n                                    key={d.id}\r\n                                    type=\"button\"\r\n                                    disabled={!typeId || !brandId}\r\n                                    onClick={() => {\r\n                                      setFlowError(null);\r\n                                      setDeviceId(String(d.id));\r\n                                    }}\r\n                                    className={cn(\r\n                                      \"rounded-[var(--rb-radius-md)] border bg-white p-3 text-left transition\",\r\n                                      !typeId || !brandId ? \"pointer-events-none opacity-60\" : \"hover:bg-[var(--rb-surface-muted)]\",\r\n                                      isSelected\r\n                                        ? \"border-[color:color-mix(in_srgb,var(--rb-blue),white_60%)] bg-[color:color-mix(in_srgb,var(--rb-blue),white_94%)]\"\r\n                                        : \"border-[var(--rb-border)]\",\r\n                                    )}\r\n                                  >\r\n                                    <div className=\"text-sm font-semibold text-[var(--rb-text)]\">{d.model}</div>\r\n                                  </button>\r\n                                );\r\n                              })}\r\n                            </div>\r\n                            {allowOtherDevice ? <div className=\"mt-2 text-xs text-zinc-500\">If your device is not listed, enter it below.</div> : null}\r\n                          </div>\r\n\r\n                          {allowOtherDevice ? (\r\n                            <div>\r\n                              <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Other device</div>\r\n                              <div className=\"mt-2\">\r\n                                <Input\r\n                                  value={otherDeviceLabel}\r\n                                  onChange={(e) => {\r\n                                    setFlowError(null);\r\n                                    setOtherDeviceLabel(e.target.value);\r\n                                  }}\r\n                                  placeholder=\"e.g. Custom PC, Unknown model\"\r\n                                />\r\n                              </div>\r\n                            </div>\r\n                          ) : null}\r\n\r\n                          <div className=\"grid gap-4 sm:grid-cols-2\">\r\n                            {!config.booking.turnOffIdImeiInBooking ? (\r\n                              <div>\r\n                                <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Serial / IMEI (optional)</div>\r\n                                <div className=\"mt-2\">\r\n                                  <Input value={serial} onChange={(e) => setSerial(e.target.value)} placeholder=\"Serial, IMEI\" />\r\n                                </div>\r\n                              </div>\r\n                            ) : null}\r\n\r\n                            {config.devicesBrands.enablePinCodeField ? (\r\n                              <div>\r\n                                <div className=\"text-sm font-semibold text-[var(--rb-text)]\">PIN (optional)</div>\r\n                                <div className=\"mt-2\">\r\n                                  <Input value={pin} onChange={(e) => setPin(e.target.value)} placeholder=\"Device PIN\" />\r\n                                </div>\r\n                              </div>\r\n                            ) : null}\r\n                          </div>\r\n\r\n                          <div>\r\n                            <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Device notes (optional)</div>\r\n                            <div className=\"mt-2\">\r\n                              <textarea\r\n                                value={deviceNotes}\r\n                                onChange={(e) => setDeviceNotes(e.target.value)}\r\n                                placeholder=\"Condition, accessories included, passcode notes, etc.\"\r\n                                className=\"w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm text-[var(--rb-text)] shadow-sm outline-none transition placeholder:text-zinc-400 focus-visible:ring-2 focus-visible:ring-[color:color-mix(in_srgb,var(--rb-orange),white_65%)] focus-visible:ring-offset-2 focus-visible:ring-offset-white\"\r\n                                rows={4}\r\n                              />\r\n                            </div>\r\n                          </div>\r\n\r\n                          {extraFields.length > 0 ? (\r\n                            <div>\r\n                              <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Additional device info (optional)</div>\r\n                              <div className=\"mt-3 grid gap-3 sm:grid-cols-2\">\r\n                                {extraFields.map((f, idx) => (\r\n                                  <label key={f.key} className=\"grid gap-1 text-sm\">\r\n                                    <span className=\"font-semibold text-[var(--rb-text)]\">{f.label}</span>\r\n                                    <Input\r\n                                      value={f.value_text}\r\n                                      onChange={(e) => {\r\n                                        setExtraFields((prev) => {\r\n                                          const next = prev.slice();\r\n                                          next[idx] = { ...next[idx], value_text: e.target.value };\r\n                                          return next;\r\n                                        });\r\n                                      }}\r\n                                    />\r\n                                  </label>\r\n                                ))}\r\n                              </div>\r\n                            </div>\r\n                          ) : null}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  ) : null}\r\n\r\n                  {step === 2 ? (\r\n                    <div className=\"space-y-4\">\r\n                      <div className=\"grid gap-4\">\r\n                        <div>\r\n                          <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Search</div>\r\n                          <div className=\"mt-2\">\r\n                            <Input value={serviceQuery} onChange={(e) => setServiceQuery(e.target.value)} placeholder=\"Search services\" />\r\n                          </div>\r\n                        </div>\r\n\r\n                        <div className=\"space-y-3\">\r\n                          {serviceGroups.map((g) => (\r\n                            <div key={g.service_type?.id ?? \"none\"} className=\"rounded-[var(--rb-radius-md)] border border-[var(--rb-border)] bg-white p-3\">\r\n                              <div className=\"text-sm font-semibold text-[var(--rb-text)]\">{g.service_type?.name ?? \"Services\"}</div>\r\n                              <div className={cn(\"mt-2\", uiStyle === \"images\" ? \"grid gap-2 sm:grid-cols-2\" : \"grid gap-2\")}>\r\n                                {g.services\r\n                                  .filter((s) => s.is_active)\r\n                                  .filter((s) => {\r\n                                    const q = serviceQuery.trim().toLowerCase();\r\n                                    if (!q) return true;\r\n                                    return (s.name ?? \"\").toLowerCase().includes(q) || (s.description ?? \"\").toLowerCase().includes(q);\r\n                                  })\r\n                                  .map((s) => {\r\n                                    const isSelected = serviceId === String(s.id);\r\n                                    return (\r\n                                      <button\r\n                                        key={s.id}\r\n                                        type=\"button\"\r\n                                        onClick={() => {\r\n                                          setFlowError(null);\r\n                                          setServiceId(String(s.id));\r\n                                          setOtherService(\"\");\r\n                                        }}\r\n                                        className={cn(\r\n                                          \"w-full rounded-[var(--rb-radius-sm)] border p-3 text-left transition\",\r\n                                          isSelected\r\n                                            ? \"border-[color:color-mix(in_srgb,var(--rb-blue),white_65%)] bg-[color:color-mix(in_srgb,var(--rb-blue),white_92%)]\"\r\n                                            : \"border-zinc-200 bg-white hover:bg-[var(--rb-surface-muted)]\",\r\n                                        )}\r\n                                      >\r\n                                        <div className=\"flex items-start justify-between gap-3\">\r\n                                          <div className=\"min-w-0 flex-1\">\r\n                                            <div className=\"text-sm font-semibold text-[var(--rb-text)]\">{s.name}</div>\r\n                                            {s.description ? <div className=\"mt-1 text-sm text-zinc-600\">{s.description}</div> : null}\r\n                                          </div>\r\n                                          {!config.booking.turnOffServicePrice ? (\r\n                                            <div className=\"shrink-0 text-sm font-semibold text-[var(--rb-text)]\">\r\n                                              {formatMoney({ amountCents: s.price?.amount_cents, currency: s.price?.currency })}\r\n                                            </div>\r\n                                          ) : null}\r\n                                        </div>\r\n                                      </button>\r\n                                    );\r\n                                  })}\r\n                              </div>\r\n                            </div>\r\n                          ))}\r\n\r\n                          {!allowOtherService ? null : (\r\n                            <div className=\"rounded-[var(--rb-radius-md)] border border-[var(--rb-border)] bg-white p-3\">\r\n                              <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Other service</div>\r\n                              <div className=\"mt-2\">\r\n                                <Input\r\n                                  value={otherService}\r\n                                  onChange={(e) => {\r\n                                    setFlowError(null);\r\n                                    setOtherService(e.target.value);\r\n                                    if (e.target.value.trim().length > 0) setServiceId(\"\");\r\n                                  }}\r\n                                  placeholder=\"Describe the service you need\"\r\n                                />\r\n                              </div>\r\n                            </div>\r\n                          )}\r\n\r\n                          <div className=\"grid gap-4 sm:grid-cols-2\">\r\n                            <div>\r\n                              <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Quantity</div>\r\n                              <div className=\"mt-2\">\r\n                                <Input\r\n                                  type=\"number\"\r\n                                  min={1}\r\n                                  max={9999}\r\n                                  value={String(serviceQty)}\r\n                                  onChange={(e) => setServiceQty(Math.max(1, Math.min(9999, Number(e.target.value) || 1)))}\r\n                                />\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  ) : null}\r\n\r\n                  {step === 3 ? (\r\n                    <div className=\"space-y-4\">\r\n                      {config.booking.publicBookingMode === \"warranty\" ? (\r\n                        <div>\r\n                          <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Warranty: date of purchase</div>\r\n                          <div className=\"mt-2\">\r\n                            <Input type=\"date\" value={dateOfPurchase} onChange={(e) => setDateOfPurchase(e.target.value)} />\r\n                          </div>\r\n                        </div>\r\n                      ) : null}\r\n\r\n                      <div className=\"grid gap-4 sm:grid-cols-2\">\r\n                        <div>\r\n                          <div className=\"text-sm font-semibold text-[var(--rb-text)]\">First name</div>\r\n                          <div className=\"mt-2\">\r\n                            <Input value={customerFirstName} onChange={(e) => setCustomerFirstName(e.target.value)} autoComplete=\"given-name\" />\r\n                          </div>\r\n                        </div>\r\n                        <div>\r\n                          <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Last name</div>\r\n                          <div className=\"mt-2\">\r\n                            <Input value={customerLastName} onChange={(e) => setCustomerLastName(e.target.value)} autoComplete=\"family-name\" />\r\n                          </div>\r\n                        </div>\r\n                        <div>\r\n                          <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Email</div>\r\n                          <div className=\"mt-2\">\r\n                            <Input type=\"email\" value={customerEmail} onChange={(e) => setCustomerEmail(e.target.value)} placeholder=\"you@example.com\" autoComplete=\"email\" />\r\n                          </div>\r\n                        </div>\r\n                        <div>\r\n                          <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Phone (optional)</div>\r\n                          <div className=\"mt-2\">\r\n                            <Input type=\"tel\" value={customerPhone} onChange={(e) => setCustomerPhone(e.target.value)} autoComplete=\"tel\" />\r\n                          </div>\r\n                        </div>\r\n                        <div>\r\n                          <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Company (optional)</div>\r\n                          <div className=\"mt-2\">\r\n                            <Input value={customerCompany} onChange={(e) => setCustomerCompany(e.target.value)} autoComplete=\"organization\" />\r\n                          </div>\r\n                        </div>\r\n                        <div>\r\n                          <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Tax ID (optional)</div>\r\n                          <div className=\"mt-2\">\r\n                            <Input value={customerTaxId} onChange={(e) => setCustomerTaxId(e.target.value)} />\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"sm:col-span-2\">\r\n                          <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Address line 1 (optional)</div>\r\n                          <div className=\"mt-2\">\r\n                            <Input value={addressLine1} onChange={(e) => setAddressLine1(e.target.value)} autoComplete=\"address-line1\" />\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"sm:col-span-2\">\r\n                          <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Address line 2 (optional)</div>\r\n                          <div className=\"mt-2\">\r\n                            <Input value={addressLine2} onChange={(e) => setAddressLine2(e.target.value)} autoComplete=\"address-line2\" />\r\n                          </div>\r\n                        </div>\r\n                        <div>\r\n                          <div className=\"text-sm font-semibold text-[var(--rb-text)]\">City (optional)</div>\r\n                          <div className=\"mt-2\">\r\n                            <Input value={addressCity} onChange={(e) => setAddressCity(e.target.value)} autoComplete=\"address-level2\" />\r\n                          </div>\r\n                        </div>\r\n                        <div>\r\n                          <div className=\"text-sm font-semibold text-[var(--rb-text)]\">State (optional)</div>\r\n                          <div className=\"mt-2\">\r\n                            <Input value={addressState} onChange={(e) => setAddressState(e.target.value)} autoComplete=\"address-level1\" />\r\n                          </div>\r\n                        </div>\r\n                        <div>\r\n                          <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Postal code (optional)</div>\r\n                          <div className=\"mt-2\">\r\n                            <Input value={addressPostalCode} onChange={(e) => setAddressPostalCode(e.target.value)} autoComplete=\"postal-code\" />\r\n                          </div>\r\n                        </div>\r\n                        <div>\r\n                          <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Country (optional)</div>\r\n                          <div className=\"mt-2\">\r\n                            <Input value={addressCountry} onChange={(e) => setAddressCountry(e.target.value)} placeholder=\"US\" autoComplete=\"country\" />\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"sm:col-span-2\">\r\n                          <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Job details</div>\r\n                          <div className=\"mt-2\">\r\n                            <textarea\r\n                              value={jobDetails}\r\n                              onChange={(e) => setJobDetails(e.target.value)}\r\n                              placeholder=\"Describe the issue, symptoms, error messages, and any constraints.\"\r\n                              className=\"w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm text-[var(--rb-text)] shadow-sm outline-none transition placeholder:text-zinc-400 focus-visible:ring-2 focus-visible:ring-[color:color-mix(in_srgb,var(--rb-orange),white_65%)] focus-visible:ring-offset-2 focus-visible:ring-offset-white\"\r\n                              rows={6}\r\n                            />\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"sm:col-span-2\">\r\n                          <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Attachments (optional)</div>\r\n                          <div className=\"mt-2 space-y-2\">\r\n                            <input\r\n                              type=\"file\"\r\n                              multiple\r\n                              onChange={(e) => {\r\n                                const files = Array.from(e.target.files ?? []);\r\n                                setAttachments(files.slice(0, 5));\r\n                              }}\r\n                              className=\"block w-full text-sm\"\r\n                            />\r\n                            <div className=\"text-xs text-zinc-500\">Up to 5 files.</div>\r\n                            {attachments.length > 0 ? (\r\n                              <div className=\"grid gap-2\">\r\n                                {attachments.map((f, idx) => (\r\n                                  <div key={idx} className=\"flex items-center justify-between gap-3 rounded-[var(--rb-radius-md)] border border-[var(--rb-border)] bg-white px-3 py-2\">\r\n                                    <div className=\"min-w-0\">\r\n                                      <div className=\"truncate text-sm font-medium text-[var(--rb-text)]\">{f.name}</div>\r\n                                      <div className=\"text-xs text-zinc-500\">{Math.max(1, Math.round(f.size / 1024))} KB</div>\r\n                                    </div>\r\n                                    <Button\r\n                                      variant=\"ghost\"\r\n                                      size=\"sm\"\r\n                                      type=\"button\"\r\n                                      onClick={() => {\r\n                                        setAttachments((prev) => prev.filter((_, i) => i !== idx));\r\n                                      }}\r\n                                    >\r\n                                      Remove\r\n                                    </Button>\r\n                                  </div>\r\n                                ))}\r\n                              </div>\r\n                            ) : null}\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n\r\n                      {needsGdpr ? (\r\n                        <label className=\"flex items-start gap-3 rounded-[var(--rb-radius-md)] border border-[var(--rb-border)] bg-white p-3 text-sm\">\r\n                          <input type=\"checkbox\" checked={gdprAccepted} onChange={(e) => setGdprAccepted(e.target.checked)} />\r\n                          <div className=\"space-y-1\">\r\n                            <div className=\"font-semibold text-[var(--rb-text)]\">GDPR</div>\r\n                            <div className=\"text-zinc-600\">\r\n                              {gdprText}\r\n                              {config.general.gdprLinkUrl && config.general.gdprLinkLabel ? (\r\n                                <span>\r\n                                  {\" \"}\r\n                                  <a href={config.general.gdprLinkUrl} target=\"_blank\" rel=\"noreferrer\" className=\"font-semibold text-[var(--rb-blue)] hover:underline\">\r\n                                    {config.general.gdprLinkLabel}\r\n                                  </a>\r\n                                </span>\r\n                              ) : null}\r\n                            </div>\r\n                          </div>\r\n                        </label>\r\n                      ) : null}\r\n                    </div>\r\n                  ) : null}\r\n\r\n                  {step === 4 ? (\r\n                    <div className=\"space-y-4\">\r\n                      <div className=\"rounded-[var(--rb-radius-md)] border border-[var(--rb-border)] bg-white p-4\">\r\n                        <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Review</div>\r\n                        <div className=\"mt-3 grid gap-2 text-sm text-zinc-700\">\r\n                          <div>\r\n                            <span className=\"font-semibold\">Device:</span> {safeInt(deviceId) ? (devices.find((d) => String(d.id) === deviceId)?.model ?? \"\") : otherDeviceLabel.trim()}\r\n                          </div>\r\n                          <div>\r\n                            <span className=\"font-semibold\">Service:</span> {selectedService ? selectedService.name : otherService.trim()}\r\n                          </div>\r\n                          <div>\r\n                            <span className=\"font-semibold\">Qty:</span> {serviceQty}\r\n                          </div>\r\n                          {!config.booking.turnOffServicePrice && selectedService?.price ? (\r\n                            <div>\r\n                              <span className=\"font-semibold\">Starting price:</span> {formatMoney({ amountCents: selectedService.price.amount_cents, currency: selectedService.price.currency })}\r\n                            </div>\r\n                          ) : null}\r\n                          <div>\r\n                            <span className=\"font-semibold\">Name:</span> {customerFirstName.trim()} {customerLastName.trim()}\r\n                          </div>\r\n                          <div>\r\n                            <span className=\"font-semibold\">Email:</span> {customerEmail.trim()}\r\n                          </div>\r\n                          {customerPhone.trim().length > 0 ? (\r\n                            <div>\r\n                              <span className=\"font-semibold\">Phone:</span> {customerPhone.trim()}\r\n                            </div>\r\n                          ) : null}\r\n                          {config.booking.publicBookingMode === \"warranty\" ? (\r\n                            <div>\r\n                              <span className=\"font-semibold\">Date of purchase:</span> {dateOfPurchase.trim()}\r\n                            </div>\r\n                          ) : null}\r\n                        </div>\r\n                      </div>\r\n\r\n                      <div className=\"rounded-[var(--rb-radius-md)] border border-[var(--rb-border)] bg-white p-4\">\r\n                        <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Notes</div>\r\n                        <div className=\"mt-2 whitespace-pre-wrap text-sm text-zinc-700\">{jobDetails.trim()}</div>\r\n                      </div>\r\n                    </div>\r\n                  ) : null}\r\n                </WizardShell>\r\n              ) : null}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    </PublicPageShell>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}