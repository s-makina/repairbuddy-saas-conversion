module.exports=[94703,a=>{"use strict";var b=a.i(57850),c=a.i(45056),d=a.i(7160);function e({open:a,onClose:e,title:f,children:g,footer:h,position:i="center",variant:j="glass",className:k}){if((0,c.useEffect)(()=>{function b(b){a&&"Escape"===b.key&&e()}return document.addEventListener("keydown",b),()=>document.removeEventListener("keydown",b)},[e,a]),!a)return null;let l="solid"===j?(0,d.cn)("relative w-full max-w-lg overflow-hidden rounded-[var(--rb-radius-lg)]","border border-[var(--rb-border)]","bg-white","shadow-[var(--rb-shadow)]"):(0,d.cn)("relative w-full max-w-lg overflow-hidden rounded-[var(--rb-radius-lg)]","border border-[color:color-mix(in_srgb,var(--rb-border),white_55%)]","bg-white/75 backdrop-blur-xl","shadow-[0_18px_55px_-18px_rgba(0,0,0,0.55)]","ring-1 ring-white/25");return(0,b.jsxs)("div",{className:"top-center"===i?"fixed inset-0 z-50 flex items-start justify-center px-4 pt-8":"fixed inset-0 z-50 flex items-center justify-center px-4",children:[(0,b.jsx)("button",{type:"button",className:(0,d.cn)("absolute inset-0","bg-black/35 backdrop-blur-md","bg-[radial-gradient(900px_600px_at_20%_20%,color-mix(in_srgb,#16a34a,transparent_82%)_0%,transparent_60%),radial-gradient(900px_600px_at_80%_30%,color-mix(in_srgb,var(--rb-blue),transparent_82%)_0%,transparent_60%),radial-gradient(900px_600px_at_50%_85%,color-mix(in_srgb,var(--rb-orange),transparent_85%)_0%,transparent_65%)]"),"aria-label":"Close",onClick:e}),(0,b.jsxs)("div",{role:"dialog","aria-modal":"true",className:(0,d.cn)(l,k),children:["glass"===j?(0,b.jsx)("div",{className:"pointer-events-none absolute inset-0 bg-[radial-gradient(650px_420px_at_20%_15%,color-mix(in_srgb,#16a34a,transparent_88%)_0%,transparent_60%),radial-gradient(650px_420px_at_80%_5%,color-mix(in_srgb,var(--rb-blue),transparent_90%)_0%,transparent_60%)]"}):null,f?(0,b.jsx)("div",{className:(0,d.cn)("relative px-5 py-4","solid"===j?"border-b border-[var(--rb-border)]":"border-b border-[color:color-mix(in_srgb,var(--rb-border),white_60%)]"),children:(0,b.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:f})}):null,(0,b.jsx)("div",{className:"relative px-5 py-4",children:g}),h?(0,b.jsx)("div",{className:(0,d.cn)("relative px-5 py-4","solid"===j?"border-t border-[var(--rb-border)]":"border-t border-[color:color-mix(in_srgb,var(--rb-border),white_60%)]"),children:h}):null]})]})}a.s(["Modal",()=>e])},21282,a=>{"use strict";var b=a.i(57850),c=a.i(94703),d=a.i(97867);function e({open:a,title:e,message:f,confirmText:g="Confirm",confirmVariant:h="primary",cancelText:i="Cancel",busy:j=!1,onCancel:k,onConfirm:l}){return(0,b.jsx)(c.Modal,{open:a,onClose:()=>{j||k()},title:e,footer:(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,b.jsx)(d.Button,{variant:"outline",onClick:k,disabled:j,children:i}),(0,b.jsx)(d.Button,{variant:h,onClick:l,disabled:j,children:j?"Working...":g})]}),children:(0,b.jsx)("div",{className:"text-sm text-zinc-700",children:f})})}a.s(["ConfirmDialog",()=>e])},54804,a=>{"use strict";var b=a.i(57850),c=a.i(648),d=a.i(75385),e=a.i(4600);function f({title:a,description:f,actions:g,filters:h,loading:i,loadingFallback:j,error:k,empty:l,emptyTitle:m="Nothing here yet",emptyDescription:n="No items to display.",children:o}){return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(c.PageHeader,{title:a,description:f,actions:g}),h?(0,b.jsx)(e.Card,{className:"shadow-none",children:(0,b.jsx)(e.CardContent,{className:"pt-5",children:h})}):null,k?(0,b.jsx)(d.Alert,{variant:"danger",title:"Something went wrong",children:k}):null,i?j??(0,b.jsx)("div",{className:"text-sm text-zinc-500",children:"Loading..."}):null,i||k||!l?null:(0,b.jsx)(e.Card,{className:"shadow-none",children:(0,b.jsxs)(e.CardContent,{className:"pt-5",children:[(0,b.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:m}),(0,b.jsx)("div",{className:"mt-1 text-sm text-zinc-600",children:n})]})}),i||k||l?null:o]})}a.s(["ListPageShell",()=>f])},55381,a=>{"use strict";var b=a.i(57850),c=a.i(45056),d=a.i(93609),e=a.i(91601),f=a.i(75458),g=a.i(97867),h=a.i(4600),i=a.i(21282),j=a.i(54177),k=a.i(46036),l=a.i(54804),m=a.i(34075);function n(){let a=(0,f.useAuth)(),n=(0,d.useRouter)(),o=(0,d.useParams)(),p=o.business??o.tenant,[q,r]=c.default.useState(!0),[s,t]=c.default.useState(null),[u,v]=c.default.useState(null),[w,x]=c.default.useState(!1),[y,z]=c.default.useState([]),[A,B]=c.default.useState(null),[C,D]=c.default.useState(""),[E,F]=c.default.useState(!0),[G,H]=c.default.useState(!1),[I,J]=c.default.useState(""),[K,L]=c.default.useState(""),[M,N]=c.default.useState(null),[O,P]=c.default.useState(""),[Q,R]=c.default.useState(0),[S,T]=c.default.useState(10),[U,V]=c.default.useState(0),[W,X]=c.default.useState(null),Y=a.can("service_types.manage"),Z=c.default.useCallback(async()=>{try{if(r(!0),t(null),"string"!=typeof p||0===p.length)throw Error("Business is missing.");let a=new URLSearchParams;O.trim().length>0&&a.set("q",O.trim()),a.set("page",String(Q+1)),a.set("per_page",String(S)),W?.id&&W?.dir&&(a.set("sort",W.id),a.set("dir",W.dir));let b=await (0,m.apiFetch)(`/api/${p}/app/repairbuddy/service-types?${a.toString()}`);z(Array.isArray(b.service_types)?b.service_types:[]),V("number"==typeof b.meta?.total?b.meta.total:0),T("number"==typeof b.meta?.per_page?b.meta.per_page:S)}catch(a){if(a instanceof m.ApiError&&428===a.status&&"string"==typeof p&&p.length>0){let a=`/app/${p}/service-types`;n.replace(`/app/${p}/branches/select?next=${encodeURIComponent(a)}`);return}t(a instanceof Error?a.message:"Failed to load service types.")}finally{r(!1)}},[Q,S,O,n,W?.dir,W?.id,p]);function $(){if(console.log("openCreate "+Y),!Y){t("Forbidden."),v(null);return}B(null),D(""),F(!0),t(null),v(null)}function _(a){if(!Y){t("Forbidden."),v(null);return}B(a.id),D(a.name),F(!!a.is_active),t(null),v(null)}async function aa(a){if((a.preventDefault(),!w)&&"string"==typeof p&&0!==p.length){if(!Y)return void t("Forbidden.");x(!0),t(null),v(null);try{let a=C.trim();if(0===a.length)return void t("Name is required.");let b={name:a,is_active:E};A?(await (0,m.apiFetch)(`/api/${p}/app/repairbuddy/service-types/${A}`,{method:"PATCH",body:b}),v("Service type updated.")):(await (0,m.apiFetch)(`/api/${p}/app/repairbuddy/service-types`,{method:"POST",body:b}),v("Service type created.")),$(),R(0),await Z()}catch(a){a instanceof m.ApiError?t(a.message):t(A?"Failed to update service type.":"Failed to create service type.")}finally{x(!1)}}}async function ab(a){if(!w&&"string"==typeof p&&0!==p.length){var c;if(!Y)return void t("Forbidden.");c={title:"Delete service type",message:(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{children:["You are about to delete ",(0,b.jsx)("span",{className:"font-semibold",children:a.name}),"."]}),(0,b.jsx)("div",{className:"text-sm text-zinc-600",children:"This action cannot be undone."})]}),action:async()=>{x(!0),t(null),v(null);try{await (0,m.apiFetch)(`/api/${p}/app/repairbuddy/service-types/${a.id}`,{method:"DELETE"}),v("Service type deleted."),R(0),await Z()}catch(a){a instanceof m.ApiError?t(a.message):t("Failed to delete service type.")}finally{x(!1)}}},J(c.title),L(c.message),N(()=>c.action),H(!0)}}c.default.useEffect(()=>{Z()},[Z]);let ac=c.default.useMemo(()=>[{id:"name",header:"Type",cell:a=>(0,b.jsxs)("div",{className:"min-w-0",children:[Y?(0,b.jsx)("button",{type:"button",className:"truncate text-left font-semibold text-[var(--rb-text)] hover:underline",onClick:()=>_(a),children:a.name}):(0,b.jsx)("div",{className:"truncate font-semibold text-[var(--rb-text)]",children:a.name}),(0,b.jsx)("div",{className:"truncate text-xs text-zinc-600",children:a.id})]}),className:"min-w-[260px]"},{id:"active",header:"Status",cell:a=>(0,b.jsx)("div",{className:a.is_active?"text-sm text-emerald-700":"text-sm text-zinc-600",children:a.is_active?"Active":"Inactive"}),className:"whitespace-nowrap"},{id:"actions",header:"",cell:a=>Y?(0,b.jsx)(k.DropdownMenu,{trigger:({toggle:a})=>(0,b.jsx)(g.Button,{size:"sm",variant:"outline",disabled:w,onClick:a,children:"Actions"}),children:({close:c})=>(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(k.DropdownMenuItem,{onSelect:()=>{c(),_(a)},children:"Edit"}),(0,b.jsx)(k.DropdownMenuSeparator,{}),(0,b.jsx)(k.DropdownMenuItem,{destructive:!0,onSelect:()=>{c(),ab(a)},children:"Delete"})]})}):null,className:"w-[1%] whitespace-nowrap"}],[w,Y]);return(0,b.jsx)(e.RequireAuth,{children:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(l.ListPageShell,{title:"Service Types",description:"Organize your service catalog.",actions:(0,b.jsx)(g.Button,{onClick:$,disabled:w,variant:"primary",size:"sm",children:"New type"}),loading:q,error:s,empty:!1,children:(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-12",children:[(0,b.jsx)("div",{className:"lg:col-span-4",children:(0,b.jsx)(h.Card,{className:"shadow-none",children:(0,b.jsxs)(h.CardContent,{className:"pt-5",children:[(0,b.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:A?"Edit service type":"New service type"}),(0,b.jsxs)("form",{className:"mt-4 space-y-4",onSubmit:aa,children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:"Name"}),(0,b.jsx)("input",{value:C,onChange:a=>D(a.target.value),placeholder:"e.g., Diagnostics",className:"h-10 w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 text-sm",disabled:w||!Y})]}),(0,b.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,b.jsx)("input",{type:"checkbox",checked:E,onChange:a=>F(a.target.checked),className:"h-4 w-4",disabled:w||!Y}),"Active"]}),(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[A?(0,b.jsx)(g.Button,{type:"button",variant:"outline",onClick:$,disabled:w,children:"Cancel"}):null,(0,b.jsx)(g.Button,{type:"submit",disabled:w||!Y,children:A?"Save":"Create"})]})]})]})})}),(0,b.jsx)("div",{className:"lg:col-span-8",children:(0,b.jsx)(h.Card,{className:"shadow-none",children:(0,b.jsx)(h.CardContent,{className:"pt-5",children:(0,b.jsx)(j.DataTable,{title:"string"==typeof p?`Service Types \xb7 ${p}`:"Service Types",data:y,loading:q,emptyMessage:"No service types.",columns:ac,getRowId:a=>a.id,server:{query:O,onQueryChange:a=>{P(a),R(0)},pageIndex:Q,onPageIndexChange:R,pageSize:S,onPageSizeChange:a=>{T(a),R(0)},totalRows:U,sort:W,onSortChange:X}})})})})]})}),(0,b.jsx)(i.ConfirmDialog,{open:G,title:I,message:K,confirmText:"Confirm",busy:w,onCancel:()=>H(!1),onConfirm:function(){(async()=>{M&&(await M(),H(!1))})()}}),u?(0,b.jsx)("div",{className:"mt-4 text-sm text-emerald-700",children:u}):null]})})}a.s(["default",()=>n])}];

//# sourceMappingURL=frontend_src_7ec364e1._.js.map