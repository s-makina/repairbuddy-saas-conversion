module.exports=[75385,a=>{"use strict";var b=a.i(57850),c=a.i(7160);function d({variant:a,className:d}){let e="h-4 w-4 shrink-0";return"success"===a?(0,b.jsx)("svg",{viewBox:"0 0 24 24",className:(0,c.cn)(e,d),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:(0,b.jsx)("path",{d:"M20 6L9 17l-5-5"})}):"warning"===a?(0,b.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,c.cn)(e,d),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,b.jsx)("path",{d:"M12 9v4"}),(0,b.jsx)("path",{d:"M12 17h.01"}),(0,b.jsx)("path",{d:"M10.3 3.6l-8.3 14.3A2 2 0 0 0 3.7 21h16.6a2 2 0 0 0 1.7-3.1L13.7 3.6a2 2 0 0 0-3.4 0z"})]}):"danger"===a?(0,b.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,c.cn)(e,d),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,b.jsx)("path",{d:"M18 6L6 18"}),(0,b.jsx)("path",{d:"M6 6l12 12"})]}):(0,b.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,c.cn)(e,d),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,b.jsx)("path",{d:"M12 16v-4"}),(0,b.jsx)("path",{d:"M12 8h.01"}),(0,b.jsx)("path",{d:"M12 22a10 10 0 1 0-10-10 10 10 0 0 0 10 10z"})]})}function e({className:a,variant:e="info",title:f,children:g,...h}){let i={info:{wrapper:"border-[color:color-mix(in_srgb,var(--rb-blue),white_75%)] bg-[color:color-mix(in_srgb,var(--rb-blue),white_92%)] text-[var(--rb-text)]",icon:"text-[var(--rb-blue)]",title:"text-[var(--rb-blue)]"},success:{wrapper:"border-[color:color-mix(in_srgb,#16a34a,white_75%)] bg-[color:color-mix(in_srgb,#16a34a,white_92%)] text-[var(--rb-text)]",icon:"text-[#166534]",title:"text-[#166534]"},warning:{wrapper:"border-[color:color-mix(in_srgb,var(--rb-orange),white_70%)] bg-[color:color-mix(in_srgb,var(--rb-orange),white_92%)] text-[var(--rb-text)]",icon:"text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)]",title:"text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)]"},danger:{wrapper:"border-[color:color-mix(in_srgb,#dc2626,white_75%)] bg-[color:color-mix(in_srgb,#dc2626,white_92%)] text-[var(--rb-text)]",icon:"text-[#991b1b]",title:"text-[#991b1b]"}}[e];return(0,b.jsx)("div",{role:"alert",className:(0,c.cn)("rounded-[var(--rb-radius-md)] border px-4 py-3",i.wrapper,a),...h,children:(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)(d,{variant:e,className:(0,c.cn)("mt-0.5",i.icon)}),(0,b.jsxs)("div",{className:"min-w-0",children:[f?(0,b.jsx)("div",{className:(0,c.cn)("text-sm font-semibold",i.title),children:f}):null,g?(0,b.jsx)("div",{className:(0,c.cn)("text-sm text-zinc-700",f?"mt-1":""),children:g}):null]})]})})}a.s(["Alert",()=>e])},17933,a=>{"use strict";var b=a.i(57850),c=a.i(7160);function d({className:a,variant:d="default",...e}){return(0,b.jsx)("span",{className:(0,c.cn)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-medium",{default:"bg-[var(--rb-surface-muted)] text-[var(--rb-text)] border-[var(--rb-border)]",info:"bg-[color:color-mix(in_srgb,var(--rb-blue),white_85%)] text-[var(--rb-blue)] border-[color:color-mix(in_srgb,var(--rb-blue),white_70%)]",success:"bg-[color:color-mix(in_srgb,#16a34a,white_85%)] text-[#166534] border-[color:color-mix(in_srgb,#16a34a,white_70%)]",warning:"bg-[color:color-mix(in_srgb,var(--rb-orange),white_85%)] text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)] border-[color:color-mix(in_srgb,var(--rb-orange),white_70%)]",danger:"bg-[color:color-mix(in_srgb,#dc2626,white_85%)] text-[#991b1b] border-[color:color-mix(in_srgb,#dc2626,white_70%)]"}[d],a),...e})}a.s(["Badge",()=>d])},29054,a=>{"use strict";var b=a.i(57850),c=a.i(7160);function d({className:a,type:d,...e}){return(0,b.jsx)("input",{type:d,className:(0,c.cn)("w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)] outline-none transition","placeholder:text-zinc-400","focus-visible:ring-2 focus-visible:ring-[color:color-mix(in_srgb,var(--rb-orange),white_65%)] focus-visible:ring-offset-2 focus-visible:ring-offset-white","disabled:cursor-not-allowed disabled:bg-[var(--rb-surface-muted)] disabled:opacity-70",a),...e})}a.s(["Input",()=>d])},4148,a=>{"use strict";function b(a){let b=a.amountCents,c=a.currency?.toUpperCase()??null;if("number"!=typeof b||!Number.isFinite(b))return a.fallback??"—";let d=b/100;if(!c||3!==c.length)return`${d.toFixed(2)}`;try{return new Intl.NumberFormat(void 0,{style:"currency",currency:c,minimumFractionDigits:2,maximumFractionDigits:2}).format(d)}catch{return`${c} ${d.toFixed(2)}`}}a.s(["formatMoney",()=>b])},26606,a=>{"use strict";var b=a.i(57850),c=a.i(7160),d=a.i(4600);function e({className:a,"aria-hidden":d=!0,...e}){return(0,b.jsx)("div",{"aria-hidden":d,className:(0,c.cn)("rb-skeleton",a),...e})}function f({lines:a=3,className:f}){let g=Math.max(1,Math.min(a,12));return(0,b.jsx)(d.Card,{className:(0,c.cn)("overflow-hidden",f),children:(0,b.jsxs)(d.CardContent,{className:"space-y-3 pt-5",children:[(0,b.jsx)(e,{className:"h-4 w-32 rounded-[var(--rb-radius-sm)]"}),Array.from({length:g}).map((a,d)=>(0,b.jsx)(e,{className:(0,c.cn)("h-3 rounded-[var(--rb-radius-sm)]",d===g-1?"w-3/5":"w-full")},d))]})})}function g({rows:a=6,columns:d=5,className:f}){let g=Math.max(1,Math.min(a,20)),h=Math.max(1,Math.min(d,10));return(0,b.jsxs)("div",{className:(0,c.cn)("overflow-hidden rounded-[var(--rb-radius-lg)] border border-[var(--rb-border)] bg-white shadow-[var(--rb-shadow)]",f),children:[(0,b.jsx)("div",{className:"border-b border-[var(--rb-border)] px-5 py-4",children:(0,b.jsx)("div",{className:"grid gap-3",style:{gridTemplateColumns:`repeat(${h}, minmax(0, 1fr))`},children:Array.from({length:h}).map((a,c)=>(0,b.jsx)(e,{className:"h-3 w-full rounded-[var(--rb-radius-sm)]"},c))})}),(0,b.jsx)("div",{className:"px-5 pb-5 pt-4",children:(0,b.jsx)("div",{className:"space-y-3",children:Array.from({length:g}).map((a,d)=>(0,b.jsx)("div",{className:"grid gap-3",style:{gridTemplateColumns:`repeat(${h}, minmax(0, 1fr))`},children:Array.from({length:h}).map((a,d)=>(0,b.jsx)(e,{className:(0,c.cn)("h-3 rounded-[var(--rb-radius-sm)]",0===d?"w-3/4":"w-full")},d))},d))})})]})}a.s(["CardSkeleton",()=>f,"Skeleton",()=>e,"TableSkeleton",()=>g])},54177,a=>{"use strict";var b=a.i(57850),c=a.i(45056),d=a.i(7160),e=a.i(97867),f=a.i(46036),g=a.i(26606),h=a.i(34075);function i({title:a,data:i,columns:j,getRowId:k,loading:l=!1,emptyMessage:m="No data.",search:n,filters:o=[],pageSizeOptions:p=[10,25,50],initialPageSize:q=10,server:r,exportConfig:s,columnVisibilityKey:t,onRowClick:u,className:v}){let[w,x]=(0,c.useState)(""),[y,z]=(0,c.useState)(0),[A,B]=(0,c.useState)(q),[C,D]=(0,c.useState)(null),[E,F]=(0,c.useState)(null),[G,H]=(0,c.useState)(0),I=(0,c.useId)(),J=!!r,K=J?r.query:w,L=J?r.onQueryChange:x,M=J?r.pageIndex:y,N=J?r.onPageIndexChange:z,O=J?r.pageSize:A,P=J?r.onPageSizeChange:B,Q=J?r.sort??null:null,R=J?r.onSortChange:void 0,S=(0,c.useMemo)(()=>{let a=Array.isArray(j)?j:[];{let b=a.filter(a=>!a.hiddenByDefault);return b.length>0?b:a.slice(0,1)}},[t,j,G]),T=(0,c.useMemo)(()=>{if(J)return Array.isArray(i)?i:[];let a=K.trim().toLowerCase();return(Array.isArray(i)?i:[]).filter(b=>{if(n&&n.getSearchText&&a.length>0&&!n.getSearchText(b).toLowerCase().includes(a))return!1;for(let a of o)if(a.predicate&&!a.predicate(b,a.value))return!1;return!0})},[i,o,J,K,n]),U=J?r.totalRows:T.length,V=Math.max(1,Math.ceil(U/O)),W=Math.min(M,V-1),X=Math.max(1,Math.min(8,O||10)),Y=(0,c.useMemo)(()=>{if(J)return T;let a=W*O,b=a+O;return T.slice(a,b)},[W,T,J,O]),Z=W>0,$=W<V-1,_=!!n||o.length>0||!!s||!!t;function aa(a,b){}async function ab(a){if(s&&!C){F(null),D(a);try{let b=new URLSearchParams;for(let a of(K.trim().length>0&&b.set("q",K.trim()),o)){let c=a.value;null!=c&&0!==String(c).length&&b.set(a.id,String(c))}if(J&&Q?.id&&Q?.dir&&(b.set("sort",Q.id),b.set("dir",Q.dir)),b.set("format",a),s.extraQuery)for(let[a,c]of Object.entries(s.extraQuery))null!=c&&b.set(a,String(c));let c=`${s.url}${s.url.includes("?")?"&":"?"}${b.toString()}`,d=s.filename?.({format:a});await (0,h.apiDownload)(c,{filename:d})}catch(a){F(a instanceof Error?a.message:"Export failed.")}finally{D(null)}}}return(0,b.jsxs)("div",{className:(0,d.cn)("space-y-3",v),children:[a?(0,b.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:a}):null,_?(0,b.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-end md:justify-between",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-end",children:[n?(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-sm font-medium",htmlFor:`${I}_datatable_search`,children:"Search"}),(0,b.jsx)("input",{id:`${I}_datatable_search`,className:"w-full min-w-[220px] rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:K,onChange:a=>{L(a.target.value),N(0)},placeholder:n.placeholder??"Search..."})]}):null,o.map(a=>(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-sm font-medium",htmlFor:`${I}_datatable_filter_${a.id}`,children:a.label}),(0,b.jsx)("select",{id:`${I}_datatable_filter_${a.id}`,className:"w-full min-w-[180px] rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:String(a.value),onChange:b=>{let c=a.options.find(a=>String(a.value)===b.target.value),d=c?c.value:b.target.value;a.onChange(d),N(0)},children:a.options.map(a=>(0,b.jsx)("option",{value:String(a.value),children:a.label},String(a.value)))})]},a.id))]}),(0,b.jsxs)("div",{className:"flex flex-col items-start gap-2 md:items-end",children:[(0,b.jsxs)("div",{className:"text-sm text-zinc-600",children:[U," result(s)"]}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[s?(0,b.jsx)(f.DropdownMenu,{align:"right",trigger:({toggle:a})=>(0,b.jsx)(e.Button,{variant:"outline",size:"sm",onClick:a,disabled:!!C,children:C?"Exporting...":"Export"}),children:({close:a})=>{let c=s.formats??["csv","xlsx","pdf"];return(0,b.jsx)(b.Fragment,{children:c.map(c=>(0,b.jsxs)(f.DropdownMenuItem,{onSelect:()=>{a(),ab(c)},disabled:!!C,children:["Export ",c.toUpperCase()]},c))})}}):null,t?(0,b.jsx)(f.DropdownMenu,{align:"right",trigger:({toggle:a})=>(0,b.jsx)(e.Button,{variant:"outline",size:"sm",onClick:a,children:"Columns"}),children:({close:a})=>(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(f.DropdownMenuItem,{onSelect:()=>{for(let b of(a(),j))aa(b.id,!0)},children:"Show all"}),(0,b.jsx)(f.DropdownMenuItem,{onSelect:()=>{for(let b of(a(),j))aa(b.id,!b.hiddenByDefault)},children:"Reset defaults"}),(0,b.jsx)(f.DropdownMenuSeparator,{}),j.map(a=>{let c=S.some(b=>b.id===a.id);return(0,b.jsxs)(f.DropdownMenuItem,{onSelect:()=>{aa(a.id,!c)},children:[(0,b.jsx)("span",{className:"mr-2 inline-block w-4",children:c?"✓":""}),"string"==typeof a.header?a.header:a.id]},a.id)})]})}):null]})]})]}):null,E?(0,b.jsx)("div",{className:"text-sm text-red-600",children:E}):null,(0,b.jsx)("div",{className:"overflow-x-auto rounded-[var(--rb-radius-md)] border border-[var(--rb-border)] bg-white",children:(0,b.jsxs)("table",{className:"min-w-full border-collapse text-left text-sm",children:[(0,b.jsx)("thead",{className:"bg-[var(--rb-surface-muted)]",children:(0,b.jsx)("tr",{children:S.map(a=>(0,b.jsx)("th",{className:(0,d.cn)("whitespace-nowrap border-b border-[var(--rb-border)] px-3 py-2 text-xs font-semibold uppercase tracking-wide text-zinc-600",a.headerClassName),children:J&&a.sortId&&R?(0,b.jsxs)("button",{type:"button",onClick:()=>(function(a){if(J&&a.sortId&&R){if(!Q||Q.id!==a.sortId){R({id:a.sortId,dir:"asc"}),N(0);return}if("asc"===Q.dir){R({id:a.sortId,dir:"desc"}),N(0);return}R(null),N(0)}})(a),className:"inline-flex items-center gap-1 hover:text-zinc-900",children:[(0,b.jsx)("span",{children:a.header}),J&&a.sortId?Q&&Q.id===a.sortId?"asc"===Q.dir?(0,b.jsx)("span",{className:"ml-1 text-zinc-700",children:"↑"}):(0,b.jsx)("span",{className:"ml-1 text-zinc-700",children:"↓"}):(0,b.jsx)("span",{className:"ml-1 text-zinc-400",children:"↕"}):null]}):a.header},a.id))})}),(0,b.jsx)("tbody",{children:l?Array.from({length:X}).map((a,c)=>(0,b.jsx)("tr",{className:"border-t border-[var(--rb-border)]",children:S.map((a,c)=>(0,b.jsx)("td",{className:(0,d.cn)("px-3 py-2 align-middle",a.className),children:(0,b.jsx)(g.Skeleton,{className:(0,d.cn)("h-3 rounded-[var(--rb-radius-sm)]",0===c?"w-3/4":c===S.length-1?"w-16":"w-full")})},a.id))},`loading_${c}`)):0===Y.length?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{className:"px-3 py-3 text-sm text-zinc-600",colSpan:Math.max(1,S.length),children:m})}):Y.map(a=>(0,b.jsx)("tr",{className:(0,d.cn)("border-t border-[var(--rb-border)]",u?"cursor-pointer hover:bg-[var(--rb-surface-muted)]":null),tabIndex:u?0:void 0,role:u?"button":void 0,onClick:u?()=>{u(a)}:void 0,onKeyDown:u?b=>{("Enter"===b.key||" "===b.key)&&(b.preventDefault(),u(a))}:void 0,children:S.map(c=>(0,b.jsx)("td",{className:(0,d.cn)("px-3 py-2 align-middle",c.className),children:c.cell(a)},c.id))},String(k(a))))})]})}),(0,b.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(e.Button,{variant:"outline",size:"sm",onClick:function(){N(Math.max(0,W-1))},disabled:!Z,children:"Prev"}),(0,b.jsx)(e.Button,{variant:"outline",size:"sm",onClick:function(){N(Math.min(V-1,W+1))},disabled:!$,children:"Next"}),(0,b.jsxs)("div",{className:"text-sm text-zinc-600",children:["Page ",W+1," / ",V]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"text-sm text-zinc-600",children:"Rows per page"}),(0,b.jsx)("select",{className:"rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:String(O),onChange:a=>{P(Number(a.target.value)),N(0)},children:p.map(a=>(0,b.jsx)("option",{value:a,children:a},a))})]})]})]})}a.s(["DataTable",()=>i])},94703,a=>{"use strict";var b=a.i(57850),c=a.i(45056),d=a.i(7160);function e({open:a,onClose:e,title:f,children:g,footer:h,position:i="center",variant:j="glass",className:k}){if((0,c.useEffect)(()=>{function b(b){a&&"Escape"===b.key&&e()}return document.addEventListener("keydown",b),()=>document.removeEventListener("keydown",b)},[e,a]),!a)return null;let l="solid"===j?(0,d.cn)("relative w-full max-w-lg overflow-hidden rounded-[var(--rb-radius-lg)]","border border-[var(--rb-border)]","bg-white","shadow-[var(--rb-shadow)]"):(0,d.cn)("relative w-full max-w-lg overflow-hidden rounded-[var(--rb-radius-lg)]","border border-[color:color-mix(in_srgb,var(--rb-border),white_55%)]","bg-white/75 backdrop-blur-xl","shadow-[0_18px_55px_-18px_rgba(0,0,0,0.55)]","ring-1 ring-white/25");return(0,b.jsxs)("div",{className:"top-center"===i?"fixed inset-0 z-50 flex items-start justify-center px-4 pt-8":"fixed inset-0 z-50 flex items-center justify-center px-4",children:[(0,b.jsx)("button",{type:"button",className:(0,d.cn)("absolute inset-0","bg-black/35 backdrop-blur-md","bg-[radial-gradient(900px_600px_at_20%_20%,color-mix(in_srgb,#16a34a,transparent_82%)_0%,transparent_60%),radial-gradient(900px_600px_at_80%_30%,color-mix(in_srgb,var(--rb-blue),transparent_82%)_0%,transparent_60%),radial-gradient(900px_600px_at_50%_85%,color-mix(in_srgb,var(--rb-orange),transparent_85%)_0%,transparent_65%)]"),"aria-label":"Close",onClick:e}),(0,b.jsxs)("div",{role:"dialog","aria-modal":"true",className:(0,d.cn)(l,k),children:["glass"===j?(0,b.jsx)("div",{className:"pointer-events-none absolute inset-0 bg-[radial-gradient(650px_420px_at_20%_15%,color-mix(in_srgb,#16a34a,transparent_88%)_0%,transparent_60%),radial-gradient(650px_420px_at_80%_5%,color-mix(in_srgb,var(--rb-blue),transparent_90%)_0%,transparent_60%)]"}):null,f?(0,b.jsx)("div",{className:(0,d.cn)("relative px-5 py-4","solid"===j?"border-b border-[var(--rb-border)]":"border-b border-[color:color-mix(in_srgb,var(--rb-border),white_60%)]"),children:(0,b.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:f})}):null,(0,b.jsx)("div",{className:"relative px-5 py-4",children:g}),h?(0,b.jsx)("div",{className:(0,d.cn)("relative px-5 py-4","solid"===j?"border-t border-[var(--rb-border)]":"border-t border-[color:color-mix(in_srgb,var(--rb-border),white_60%)]"),children:h}):null]})]})}a.s(["Modal",()=>e])},21282,a=>{"use strict";var b=a.i(57850),c=a.i(94703),d=a.i(97867);function e({open:a,title:e,message:f,confirmText:g="Confirm",confirmVariant:h="primary",cancelText:i="Cancel",busy:j=!1,onCancel:k,onConfirm:l}){return(0,b.jsx)(c.Modal,{open:a,onClose:()=>{j||k()},title:e,footer:(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,b.jsx)(d.Button,{variant:"outline",onClick:k,disabled:j,children:i}),(0,b.jsx)(d.Button,{variant:h,onClick:l,disabled:j,children:j?"Working...":g})]}),children:(0,b.jsx)("div",{className:"text-sm text-zinc-700",children:f})})}a.s(["ConfirmDialog",()=>e])},46664,a=>{"use strict";let b={locale:"en-GB",dateStyle:"medium",timeStyle:"short",hour12:!1};function c(a){if(!a)return null;if(a instanceof Date)return Number.isFinite(a.getTime())?a:null;let b=new Date(a);return Number.isFinite(b.getTime())?b:null}function d(a,d){let e=c(a);if(!e)return"—";let f={...b,...d??{}};return new Intl.DateTimeFormat(f.locale,{dateStyle:f.dateStyle}).format(e)}function e(a,d){let e=c(a);if(!e)return"—";let f={...b,...d??{}};return new Intl.DateTimeFormat(f.locale,{dateStyle:f.dateStyle,timeStyle:f.timeStyle,hour12:f.hour12}).format(e)}a.s(["formatDate",()=>d,"formatDateTime",()=>e])},56264,a=>{"use strict";var b=a.i(34075);async function c(a){let c=new URLSearchParams;return"boolean"==typeof a?.includeInactive&&c.set("include_inactive",a.includeInactive?"1":"0"),(0,b.apiFetch)(`/api/admin/billing/catalog${c.toString()?`?${c.toString()}`:""}`)}async function d(a){let c=new URLSearchParams;return"boolean"==typeof a?.includeInactive&&c.set("include_inactive",a.includeInactive?"1":"0"),(0,b.apiFetch)(`/api/admin/billing/intervals${c.toString()?`?${c.toString()}`:""}`)}async function e(a){return(0,b.apiFetch)("/api/admin/billing/intervals",{method:"POST",body:{code:a.code?.trim()||void 0,name:a.name,months:a.months,is_active:"boolean"==typeof a.isActive?a.isActive:void 0}})}async function f(a){return(0,b.apiFetch)(`/api/admin/billing/intervals/${a.intervalId}`,{method:"PUT",body:{code:a.code,name:a.name,months:a.months,is_active:"boolean"==typeof a.isActive?a.isActive:void 0,reason:a.reason}})}async function g(a){return(0,b.apiFetch)(`/api/admin/billing/intervals/${a.intervalId}/active`,{method:"PATCH",body:{is_active:a.isActive,reason:a.reason}})}async function h(a){return(0,b.apiFetch)("/api/admin/billing/plans",{method:"POST",body:{name:a.name,code:a.code?.trim()||void 0,description:a.description?.trim()||void 0,is_active:"boolean"==typeof a.isActive?a.isActive:void 0}})}async function i(a){return(0,b.apiFetch)(`/api/admin/billing/plans/${a.planId}`,{method:"PUT",body:{name:a.name,code:a.code,description:a.description?.trim()||void 0,is_active:"boolean"==typeof a.isActive?a.isActive:void 0,reason:a.reason}})}async function j(a){return(0,b.apiFetch)(`/api/admin/billing/plans/${a.planId}/versions/draft-from-active`,{method:"POST",body:{reason:a.reason}})}async function k(a){try{return await (0,b.apiFetch)(`/api/admin/billing/versions/${a.versionId}/validate`,{method:"POST",body:{reason:a.reason}})}catch(a){if(a instanceof b.ApiError){let b=a.data;if(b&&"object"==typeof b){if("ok"===b.status)return{status:"ok"};if("string"==typeof b.message)return{message:b.message,errors:Array.isArray(b.errors)?b.errors.map(String):void 0}}}throw a}}async function l(a){return(0,b.apiFetch)(`/api/admin/billing/versions/${a.versionId}/entitlements/sync`,{method:"POST",body:{entitlements:a.entitlements,reason:a.reason}})}async function m(a){return(0,b.apiFetch)(`/api/admin/billing/versions/${a.versionId}/prices`,{method:"POST",body:{currency:a.currency,billing_interval_id:"number"==typeof a.billingIntervalId?a.billingIntervalId:void 0,interval:a.interval,amount_cents:a.amountCents,trial_days:"number"==typeof a.trialDays?a.trialDays:void 0,is_default:"boolean"==typeof a.isDefault?a.isDefault:void 0,reason:a.reason}})}async function n(a){return(0,b.apiFetch)(`/api/admin/billing/prices/${a.priceId}`,{method:"PATCH",body:{amount_cents:a.amountCents,trial_days:"number"==typeof a.trialDays?a.trialDays:void 0,is_default:"boolean"==typeof a.isDefault?a.isDefault:void 0,reason:a.reason}})}async function o(a){return(0,b.apiFetch)(`/api/admin/billing/prices/${a.priceId}`,{method:"DELETE",body:{reason:a.reason}})}async function p(a){return(0,b.apiFetch)(`/api/admin/billing/versions/${a.versionId}/activate`,{method:"POST",body:{confirm:a.confirm,reason:a.reason}})}async function q(a){return(0,b.apiFetch)("/api/admin/billing/entitlement-definitions",{method:"POST",body:{code:a.code?.trim()||void 0,name:a.name,value_type:a.valueType,description:a.description?.trim()||void 0,is_premium:"boolean"==typeof a.isPremium?a.isPremium:void 0}})}async function r(a){return(0,b.apiFetch)(`/api/admin/billing/entitlement-definitions/${a.id}`,{method:"PUT",body:{code:a.code,name:a.name,value_type:a.valueType,description:a.description?.trim()||void 0,is_premium:"boolean"==typeof a.isPremium?a.isPremium:void 0,reason:a.reason}})}async function s(a){return(0,b.apiFetch)(`/api/admin/billing/entitlement-definitions/${a.id}`,{method:"DELETE",body:{reason:a.reason}})}async function t(a){return(0,b.apiFetch)(`/api/admin/businesses/${a}/subscriptions`)}async function u(a){return(0,b.apiFetch)(`/api/admin/businesses/${a.tenantId}/subscriptions`,{method:"POST",body:{billing_plan_version_id:a.billingPlanVersionId,billing_price_id:a.billingPriceId,reason:a.reason}})}async function v(a){return(0,b.apiFetch)(`/api/admin/businesses/${a.tenantId}/subscriptions/${a.subscriptionId}/cancel`,{method:"POST",body:{at_period_end:"boolean"==typeof a.atPeriodEnd?a.atPeriodEnd:void 0,reason:a.reason}})}async function w(a){let c=new URLSearchParams;return a.status&&a.status.trim().length>0&&c.set("status",a.status.trim()),"number"==typeof a.limit&&Number.isFinite(a.limit)&&c.set("limit",String(a.limit)),(0,b.apiFetch)(`/api/admin/businesses/${a.tenantId}/invoices${c.toString()?`?${c.toString()}`:""}`)}async function x(a){return(0,b.apiFetch)(`/api/admin/businesses/${a.tenantId}/invoices/${a.invoiceId}`)}async function y(a){return(0,b.apiFetch)(`/api/admin/businesses/${a.tenantId}/invoices`,{method:"POST",body:{tenant_subscription_id:a.tenantSubscriptionId,reason:a.reason}})}async function z(a){return(0,b.apiFetch)(`/api/admin/businesses/${a.tenantId}/invoices/${a.invoiceId}/issue`,{method:"POST",body:{reason:a.reason}})}async function A(a){return(0,b.apiFetch)(`/api/admin/businesses/${a.tenantId}/invoices/${a.invoiceId}/paid`,{method:"POST",body:{paid_at:a.paidAt,paid_method:a.paidMethod,paid_note:a.paidNote,reason:a.reason}})}async function B(a){let c=a.invoiceNumber?`invoice_${a.invoiceNumber}.pdf`:"invoice.pdf";await (0,b.apiDownload)(`/api/admin/businesses/${a.tenantId}/invoices/${a.invoiceId}/pdf`,{filename:c})}a.s(["activateBillingPlanVersion",()=>p,"assignTenantSubscription",()=>u,"cancelTenantSubscription",()=>v,"createBillingInterval",()=>e,"createBillingPlan",()=>h,"createBillingPrice",()=>m,"createDraftBillingPlanVersionFromActive",()=>j,"createEntitlementDefinition",()=>q,"createInvoiceFromSubscription",()=>y,"deleteBillingPrice",()=>o,"deleteEntitlementDefinition",()=>s,"downloadInvoicePdf",()=>B,"getBillingCatalog",()=>c,"getTenantInvoice",()=>x,"getTenantInvoices",()=>w,"getTenantSubscriptions",()=>t,"issueInvoice",()=>z,"listBillingIntervals",()=>d,"markInvoicePaid",()=>A,"setBillingIntervalActive",()=>g,"syncBillingPlanVersionEntitlements",()=>l,"updateBillingInterval",()=>f,"updateBillingPlan",()=>i,"updateBillingPrice",()=>n,"updateEntitlementDefinition",()=>r,"validateBillingPlanVersionDraft",()=>k])},79122,a=>{"use strict";var b=a.i(57850),c=a.i(45056),d=a.i(59843),e=a.i(93609),f=a.i(91601),g=a.i(25533),h=a.i(75385),i=a.i(17933),j=a.i(97867),k=a.i(4600),l=a.i(21282),m=a.i(54177),n=a.i(29054),o=a.i(94703),p=a.i(56264),q=a.i(46664),r=a.i(4148);function s(){let a=Number((0,e.useParams)().business),s=(0,g.useDashboardHeader)(),[t,u]=(0,c.useState)(!0),[v,w]=(0,c.useState)(null),[x,y]=(0,c.useState)(null),[z,A]=(0,c.useState)([]),[B,C]=(0,c.useState)(!0),[D,E]=(0,c.useState)(null),[F,G]=(0,c.useState)([]),[H,I]=(0,c.useState)(0),[J,K]=(0,c.useState)({}),[L,M]=(0,c.useState)(!1),[N,O]=(0,c.useState)(null),[P,Q]=(0,c.useState)({open:!1,invoiceId:null}),[R,S]=(0,c.useState)(""),[T,U]=(0,c.useState)(!1),[V,W]=(0,c.useState)(null),[X,Y]=(0,c.useState)(""),[Z,$]=(0,c.useState)(""),[_,aa]=(0,c.useState)("");(0,c.useEffect)(()=>(s.setHeader({breadcrumb:"Admin / Businesses",title:x?`${x.name} — Invoices`:`Business ${a} — Invoices`,subtitle:x?`Business ID ${x.id} • ${x.slug}`:void 0,actions:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(d.default,{href:`/admin/businesses/${a}/billing`,children:(0,b.jsx)(j.Button,{variant:"outline",size:"sm",children:"Back"})}),(0,b.jsx)(j.Button,{variant:"outline",size:"sm",onClick:()=>I(a=>a+1),disabled:t||B,children:"Refresh"})]})}),()=>s.setHeader(null)),[s,t,B,x,a]);let ab=(0,c.useMemo)(()=>(Array.isArray(F)?F:[]).slice().sort((a,b)=>(b.id??0)-(a.id??0))[0]??null,[F]);async function ac(){if(!ab)return void O("No active subscription found. Assign a subscription first.");if(!L){M(!0),O(null);try{await (0,p.createInvoiceFromSubscription)({tenantId:a,tenantSubscriptionId:ab.id}),I(a=>a+1)}catch(a){O(a instanceof Error?a.message:"Failed to create invoice draft.")}finally{M(!1)}}}async function ad(b){let c=b.id;K(a=>({...a,[c]:"download"}));try{await (0,p.downloadInvoicePdf)({tenantId:a,invoiceId:b.id,invoiceNumber:b.invoice_number})}finally{K(a=>({...a,[c]:null}))}}async function ae(b){K(a=>({...a,[b]:"issue"}));try{await (0,p.issueInvoice)({tenantId:a,invoiceId:b}),I(a=>a+1)}catch(a){w(a instanceof Error?a.message:"Failed to issue invoice.")}finally{K(a=>({...a,[b]:null}))}}async function af(b){K(a=>({...a,[b]:"paid"}));try{await (0,p.markInvoicePaid)({tenantId:a,invoiceId:b,paidAt:X.trim()||void 0,paidMethod:Z.trim()||void 0,paidNote:_.trim()||void 0}),I(a=>a+1)}catch(a){w(a instanceof Error?a.message:"Failed to mark invoice as paid.")}finally{K(a=>({...a,[b]:null}))}}(0,c.useEffect)(()=>{let b=!0;return async function(){if(!Number.isFinite(a)||a<=0){w("Invalid business id."),u(!1);return}try{u(!0),w(null);let c=await (0,p.getTenantInvoices)({tenantId:a,limit:100,status:R.trim()||void 0});if(!b)return;y(c.tenant),A(Array.isArray(c.invoices)?c.invoices:[])}catch(a){if(!b)return;w(a instanceof Error?a.message:"Failed to load invoices."),A([])}finally{if(!b)return;u(!1)}}(),()=>{b=!1}},[R,a,H]),(0,c.useEffect)(()=>{let b=!0;return async function(){if(Number.isFinite(a)&&!(a<=0))try{C(!0),E(null);let c=await (0,p.getTenantSubscriptions)(a);if(!b)return;G(Array.isArray(c.subscriptions)?c.subscriptions:[])}catch(a){if(!b)return;E(a instanceof Error?a.message:"Failed to load subscriptions."),G([])}finally{if(!b)return;C(!1)}}(),()=>{b=!1}},[a,H]);let ag=(0,c.useMemo)(()=>z,[z]);return(0,b.jsx)(f.RequireAuth,{requiredPermission:"admin.billing.read",children:(0,b.jsxs)("div",{className:"space-y-6",children:[v?(0,b.jsx)(h.Alert,{variant:"danger",title:"Could not load invoices",children:v}):null,D?(0,b.jsx)(h.Alert,{variant:"danger",title:"Could not load subscriptions",children:D}):null,(0,b.jsxs)(k.Card,{children:[(0,b.jsxs)(k.CardHeader,{className:"flex flex-row items-start justify-between gap-4",children:[(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)(k.CardTitle,{className:"truncate",children:"Invoice actions"}),(0,b.jsx)("div",{className:"mt-1 text-sm text-zinc-600",children:"Create drafts from the current subscription, then issue/mark paid."})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("select",{className:"rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:R,onChange:a=>S(a.target.value),disabled:t,children:[(0,b.jsx)("option",{value:"",children:"All statuses"}),(0,b.jsx)("option",{value:"draft",children:"draft"}),(0,b.jsx)("option",{value:"issued",children:"issued"}),(0,b.jsx)("option",{value:"paid",children:"paid"})]}),(0,b.jsx)(j.Button,{variant:"secondary",size:"sm",onClick:()=>void ac(),disabled:L||B,children:L?"Creating…":"Create invoice draft"})]})]}),(0,b.jsxs)(k.CardContent,{children:[N?(0,b.jsx)("div",{className:"text-sm text-red-600",children:N}):null,(0,b.jsxs)("div",{className:"mt-2 text-sm text-zinc-600",children:["Current subscription: ",ab?`#${ab.id} (${ab.status})`:"—"]})]})]}),(0,b.jsx)(m.DataTable,{title:"Invoices",data:ag,loading:t,emptyMessage:"No invoices yet.",getRowId:a=>a.id,columns:[{id:"number",header:"Invoice",cell:a=>(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("div",{className:"truncate text-sm font-medium text-zinc-800",children:a.invoice_number}),(0,b.jsxs)("div",{className:"truncate text-xs text-zinc-500",children:["ID: ",a.id]})]}),className:"min-w-[240px]"},{id:"status",header:"Status",cell:a=>{var c;return(0,b.jsx)(i.Badge,{variant:"paid"===(c=a.status)?"success":"issued"===c?"info":"default",children:a.status})},className:"whitespace-nowrap"},{id:"issued",header:"Issued",cell:a=>(0,b.jsx)("div",{className:"text-sm text-zinc-700",children:(0,q.formatDateTime)(a.issued_at??null)}),className:"whitespace-nowrap"},{id:"total",header:"Total",cell:a=>(0,b.jsx)("div",{className:"text-sm text-zinc-700",children:(0,r.formatMoney)({amountCents:a.total_cents,currency:a.currency})}),className:"whitespace-nowrap"},{id:"actions",header:"",cell:c=>{let e=J[c.id]??null,f="draft"===c.status,g="issued"===c.status;return(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,b.jsx)(d.default,{href:`/admin/businesses/${a}/billing/invoices/${c.id}`,children:(0,b.jsx)(j.Button,{variant:"outline",size:"sm",children:"View"})}),(0,b.jsx)(j.Button,{variant:"outline",size:"sm",onClick:()=>void ad(c),disabled:"download"===e,children:"download"===e?"Downloading…":"PDF"}),(0,b.jsx)(j.Button,{variant:"outline",size:"sm",disabled:!f||"issue"===e,onClick:()=>Q({open:!0,invoiceId:c.id}),children:"issue"===e?"Issuing…":"Issue"}),(0,b.jsx)(j.Button,{variant:"primary",size:"sm",disabled:!g||"paid"===e,onClick:()=>{W(c.id),Y(new Date().toISOString().slice(0,10)),$(""),aa(""),U(!0)},children:"paid"===e?"Marking…":"Paid"})]})},className:"whitespace-nowrap"}]}),(0,b.jsx)(l.ConfirmDialog,{open:P.open,title:"Issue invoice",message:"This will transition the invoice from draft to issued.",confirmText:"Issue",confirmVariant:"secondary",busy:!!P.invoiceId&&"issue"===J[P.invoiceId],onCancel:()=>Q({open:!1,invoiceId:null}),onConfirm:()=>{let a=P.invoiceId;Q({open:!1,invoiceId:null}),a&&ae(a)}}),(0,b.jsx)(o.Modal,{open:T,onClose:()=>{V&&"paid"===J[V]||U(!1)},title:"Mark invoice as paid",footer:(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,b.jsx)(j.Button,{variant:"outline",onClick:()=>{V&&"paid"===J[V]||U(!1)},disabled:!!V&&"paid"===J[V],children:"Cancel"}),(0,b.jsx)(j.Button,{variant:"primary",onClick:()=>{V&&(af(V),U(!1))},disabled:!V||!!V&&"paid"===J[V],children:V&&"paid"===J[V]?"Marking…":"Mark paid"})]}),children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("div",{className:"text-sm text-zinc-700",children:"This will mark the invoice as paid and record payment details."}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"Payment date"}),(0,b.jsx)(n.Input,{type:"date",value:X,onChange:a=>Y(a.target.value)})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"Method (optional)"}),(0,b.jsx)(n.Input,{value:Z,onChange:a=>$(a.target.value),placeholder:"e.g. bank transfer"})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"Note (optional)"}),(0,b.jsx)(n.Input,{value:_,onChange:a=>aa(a.target.value),placeholder:"Internal note…"})]})]})})]})})}a.s(["default",()=>s])}];

//# sourceMappingURL=frontend_src_ba1b9054._.js.map