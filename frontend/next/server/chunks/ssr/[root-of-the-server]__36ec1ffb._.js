module.exports=[56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},2057,(a,b,c)=>{"use strict";b.exports=a.r(31699).vendored.contexts.AppRouterContext},3420,(a,b,c)=>{"use strict";b.exports=a.r(31699).vendored.contexts.HooksClientContext},98823,(a,b,c)=>{"use strict";b.exports=a.r(31699).vendored.contexts.ServerInsertedHtml},1395,(a,b,c)=>{"use strict";b.exports=a.r(31699).vendored["react-ssr"].ReactServerDOMTurbopackClient},4600,a=>{"use strict";var b=a.i(57850),c=a.i(7160);function d({className:a,...d}){return(0,b.jsx)("div",{className:(0,c.cn)("rounded-[var(--rb-radius-lg)] border border-[var(--rb-border)] bg-white shadow-[var(--rb-shadow)]",a),...d})}function e({className:a,...d}){return(0,b.jsx)("div",{className:(0,c.cn)("px-5 py-4",a),...d})}function f({className:a,...d}){return(0,b.jsx)("h3",{className:(0,c.cn)("text-sm font-semibold text-[var(--rb-text)]",a),...d})}function g({className:a,...d}){return(0,b.jsx)("p",{className:(0,c.cn)("mt-1 text-sm text-zinc-600",a),...d})}function h({className:a,...d}){return(0,b.jsx)("div",{className:(0,c.cn)("px-5 pb-5",a),...d})}a.s(["Card",()=>d,"CardContent",()=>h,"CardDescription",()=>g,"CardHeader",()=>e,"CardTitle",()=>f])},7160,a=>{"use strict";function b(...a){return a.filter(Boolean).join(" ")}a.s(["cn",()=>b])},87973,(a,b,c)=>{"use strict";function d(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(d=function(a){return a?c:b})(a)}c._=function(a,b){if(!b&&a&&a.__esModule)return a;if(null===a||"object"!=typeof a&&"function"!=typeof a)return{default:a};var c=d(b);if(c&&c.has(a))return c.get(a);var e={__proto__:null},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in a)if("default"!==g&&Object.prototype.hasOwnProperty.call(a,g)){var h=f?Object.getOwnPropertyDescriptor(a,g):null;h&&(h.get||h.set)?Object.defineProperty(e,g,h):e[g]=a[g]}return e.default=a,c&&c.set(a,e),e}},97867,a=>{"use strict";var b=a.i(57850),c=a.i(45056),d=a.i(7160);function e({className:a,variant:e="primary",size:f="md",asChild:g=!1,type:h="button",disabled:i,onClick:j,children:k,...l}){let m=(0,d.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-[var(--rb-radius-sm)] text-sm font-medium transition-colors disabled:pointer-events-none disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[var(--rb-orange)] focus-visible:ring-offset-2 focus-visible:ring-offset-white",{sm:"h-8 px-3",md:"h-10 px-4",lg:"h-11 px-5"}[f],{primary:"bg-[var(--rb-blue)] text-white hover:opacity-90",secondary:"bg-[var(--rb-orange)] text-white hover:opacity-90",outline:"border border-[var(--rb-border)] bg-white text-[var(--rb-text)] hover:bg-[var(--rb-surface-muted)]",ghost:"bg-transparent text-[var(--rb-text)] hover:bg-[var(--rb-surface-muted)]"}[e],i?"pointer-events-none opacity-50":"",a);if(g){let a=c.default.Children.only(k);return c.default.isValidElement(a)?c.default.cloneElement(a,{className:(0,d.cn)(m,a.props?.className),"aria-disabled":!!i||void 0,tabIndex:i?-1:a.props?.tabIndex,onClick:b=>{if(i){b.preventDefault(),b.stopPropagation();return}j?.(b),a.props?.onClick?.(b)}}):null}return(0,b.jsx)("button",{className:m,type:h,disabled:i,onClick:j,...l,children:k})}a.s(["Button",()=>e])},39693,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"useMergedRef",{enumerable:!0,get:function(){return e}});let d=a.r(45056);function e(a,b){let c=(0,d.useRef)(null),e=(0,d.useRef)(null);return(0,d.useCallback)(d=>{if(null===d){let a=c.current;a&&(c.current=null,a());let b=e.current;b&&(e.current=null,b())}else a&&(c.current=f(a,d)),b&&(e.current=f(b,d))},[a,b])}function f(a,b){if("function"!=typeof a)return a.current=b,()=>{a.current=null};{let c=a(b);return"function"==typeof c?c:()=>a(null)}}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},77038,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"warnOnce",{enumerable:!0,get:function(){return d}});let d=a=>{}},74601,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={getDeploymentId:function(){return f},getDeploymentIdQueryOrEmptyString:function(){return g}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});function f(){return!1}function g(){return""}},75385,a=>{"use strict";var b=a.i(57850),c=a.i(7160);function d({variant:a,className:d}){let e="h-4 w-4 shrink-0";return"success"===a?(0,b.jsx)("svg",{viewBox:"0 0 24 24",className:(0,c.cn)(e,d),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:(0,b.jsx)("path",{d:"M20 6L9 17l-5-5"})}):"warning"===a?(0,b.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,c.cn)(e,d),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,b.jsx)("path",{d:"M12 9v4"}),(0,b.jsx)("path",{d:"M12 17h.01"}),(0,b.jsx)("path",{d:"M10.3 3.6l-8.3 14.3A2 2 0 0 0 3.7 21h16.6a2 2 0 0 0 1.7-3.1L13.7 3.6a2 2 0 0 0-3.4 0z"})]}):"danger"===a?(0,b.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,c.cn)(e,d),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,b.jsx)("path",{d:"M18 6L6 18"}),(0,b.jsx)("path",{d:"M6 6l12 12"})]}):(0,b.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,c.cn)(e,d),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,b.jsx)("path",{d:"M12 16v-4"}),(0,b.jsx)("path",{d:"M12 8h.01"}),(0,b.jsx)("path",{d:"M12 22a10 10 0 1 0-10-10 10 10 0 0 0 10 10z"})]})}function e({className:a,variant:e="info",title:f,children:g,...h}){let i={info:{wrapper:"border-[color:color-mix(in_srgb,var(--rb-blue),white_75%)] bg-[color:color-mix(in_srgb,var(--rb-blue),white_92%)] text-[var(--rb-text)]",icon:"text-[var(--rb-blue)]",title:"text-[var(--rb-blue)]"},success:{wrapper:"border-[color:color-mix(in_srgb,#16a34a,white_75%)] bg-[color:color-mix(in_srgb,#16a34a,white_92%)] text-[var(--rb-text)]",icon:"text-[#166534]",title:"text-[#166534]"},warning:{wrapper:"border-[color:color-mix(in_srgb,var(--rb-orange),white_70%)] bg-[color:color-mix(in_srgb,var(--rb-orange),white_92%)] text-[var(--rb-text)]",icon:"text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)]",title:"text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)]"},danger:{wrapper:"border-[color:color-mix(in_srgb,#dc2626,white_75%)] bg-[color:color-mix(in_srgb,#dc2626,white_92%)] text-[var(--rb-text)]",icon:"text-[#991b1b]",title:"text-[#991b1b]"}}[e];return(0,b.jsx)("div",{role:"alert",className:(0,c.cn)("rounded-[var(--rb-radius-md)] border px-4 py-3",i.wrapper,a),...h,children:(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)(d,{variant:e,className:(0,c.cn)("mt-0.5",i.icon)}),(0,b.jsxs)("div",{className:"min-w-0",children:[f?(0,b.jsx)("div",{className:(0,c.cn)("text-sm font-semibold",i.title),children:f}):null,g?(0,b.jsx)("div",{className:(0,c.cn)("text-sm text-zinc-700",f?"mt-1":""),children:g}):null]})]})})}a.s(["Alert",()=>e])},17933,a=>{"use strict";var b=a.i(57850),c=a.i(7160);function d({className:a,variant:d="default",...e}){return(0,b.jsx)("span",{className:(0,c.cn)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-medium",{default:"bg-[var(--rb-surface-muted)] text-[var(--rb-text)] border-[var(--rb-border)]",info:"bg-[color:color-mix(in_srgb,var(--rb-blue),white_85%)] text-[var(--rb-blue)] border-[color:color-mix(in_srgb,var(--rb-blue),white_70%)]",success:"bg-[color:color-mix(in_srgb,#16a34a,white_85%)] text-[#166534] border-[color:color-mix(in_srgb,#16a34a,white_70%)]",warning:"bg-[color:color-mix(in_srgb,var(--rb-orange),white_85%)] text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)] border-[color:color-mix(in_srgb,var(--rb-orange),white_70%)]",danger:"bg-[color:color-mix(in_srgb,#dc2626,white_85%)] text-[#991b1b] border-[color:color-mix(in_srgb,#dc2626,white_70%)]"}[d],a),...e})}a.s(["Badge",()=>d])},29054,a=>{"use strict";var b=a.i(57850),c=a.i(7160);function d({className:a,type:d,...e}){return(0,b.jsx)("input",{type:d,className:(0,c.cn)("w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)] outline-none transition","placeholder:text-zinc-400","focus-visible:ring-2 focus-visible:ring-[color:color-mix(in_srgb,var(--rb-orange),white_65%)] focus-visible:ring-offset-2 focus-visible:ring-offset-white","disabled:cursor-not-allowed disabled:bg-[var(--rb-surface-muted)] disabled:opacity-70",a),...e})}a.s(["Input",()=>d])},90301,a=>{"use strict";var b=a.i(57850),c=a.i(45056),d=a.i(59843),e=a.i(93609),f=a.i(7160),g=a.i(97867),h=a.i(29054),i=a.i(4600),j=a.i(75385),k=a.i(34075);let l=[{label:"Dashboard",href:a=>`/t/${a}/portal`},{label:"Tickets/Jobs",href:a=>`/t/${a}/portal/tickets`},{label:"Estimates",href:a=>`/t/${a}/portal/estimates`},{label:"Reviews",href:a=>`/t/${a}/portal/reviews`},{label:"My Devices",href:a=>`/t/${a}/portal/devices`},{label:"Booking",href:a=>`/t/${a}/portal/booking`},{label:"Profile",href:a=>`/t/${a}/portal/profile`}];function m(a){}function n({tenantSlug:a,title:n,subtitle:o,actions:p,children:q}){let r=(0,e.usePathname)(),[s,t]=c.default.useState(!0),[u,v]=c.default.useState(null),[w,x]=c.default.useState(""),[y,z]=c.default.useState(!1),[A,B]=c.default.useState(null);c.default.useEffect(()=>{let b=!0;return async function(){try{if(t(!0),B(null),!a||0===a.trim().length)return void v(null);let c=null;if(!c)return void v(null);let d=await (0,k.apiFetch)(`/api/t/${a}/status/lookup`,{method:"POST",body:{caseNumber:c.case_number},token:null,impersonationSessionId:null}),e=d?.job??null;if(!b)return;if(!e){m(a),v(null);return}v({tenant:a,case_number:e.case_number,job_id:String(e.id),unlocked_at:c.unlocked_at})}catch(a){if(!b)return;v(null)}finally{if(!b)return;t(!1)}}(),()=>{b=!1}},[a]);let C=!!u&&!!u.job_id;async function D(){if(!a||0===a.trim().length)return;let b=w.trim();if(!b)return void B("Case number is required.");z(!0),B(null);try{let c=await (0,k.apiFetch)(`/api/t/${a}/status/lookup`,{method:"POST",body:{caseNumber:b},token:null,impersonationSessionId:null}),d=c?.job??null;if(!d)return void B("Case number not found.");let e={tenant:a,case_number:d.case_number,job_id:String(d.id),unlocked_at:new Date().toISOString()};v(e),x("")}catch(a){a instanceof k.ApiError&&404===a.status?B("Case number not found."):B(a instanceof Error?a.message:"Could not unlock portal.")}finally{z(!1),t(!1)}}let E=c.default.useMemo(()=>{let b=l.map(b=>b.href(a)).map(a=>r===a||r.startsWith(`${a}/`)?{href:a,score:a.length}:{href:a,score:-1}).filter(a=>a.score>=0).sort((a,b)=>b.score-a.score);return b[0]?.href??null},[r,a]);return(0,b.jsxs)("div",{className:"min-h-screen bg-[var(--rb-surface-muted)] text-[var(--rb-text)]",children:[(0,b.jsx)("header",{className:"border-b border-[var(--rb-border)] bg-white",children:(0,b.jsxs)("div",{className:"mx-auto flex max-w-6xl flex-wrap items-center justify-between gap-3 px-4 py-4",children:[(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(d.default,{href:`/t/${a}/status`,className:"text-sm font-semibold text-[var(--rb-text)]",children:"RepairBuddy"}),(0,b.jsxs)("div",{className:"text-xs text-zinc-500",children:["Business: ",a]}),C?(0,b.jsxs)("div",{className:"text-xs text-zinc-500",children:["Case: ",u.case_number]}):null]}),n?(0,b.jsx)("div",{className:"mt-1 truncate text-lg font-semibold text-[var(--rb-text)]",children:n}):null,o?(0,b.jsx)("div",{className:"mt-1 text-sm text-zinc-600",children:o}):null]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[p||null,C?(0,b.jsx)(g.Button,{variant:"outline",size:"sm",onClick:()=>{m(a),v(null)},children:"Switch case"}):null]})]})}),(0,b.jsx)("div",{className:"mx-auto w-full max-w-6xl px-4 py-6",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-[260px_1fr]",children:[(0,b.jsxs)("aside",{className:"rounded-[var(--rb-radius-lg)] border border-[var(--rb-border)] bg-white shadow-[var(--rb-shadow)]",children:[(0,b.jsx)("div",{className:"border-b border-[var(--rb-border)] px-5 py-4",children:(0,b.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:"My Account"})}),(0,b.jsx)("nav",{className:"space-y-1 p-2",children:C?l.map(c=>{let e=c.href(a),g=!!E&&e===E;return(0,b.jsx)(d.default,{href:e,className:(0,f.cn)("block rounded-[var(--rb-radius-sm)] px-3 py-2 text-sm transition-colors",g?"bg-[var(--rb-surface-muted)] font-medium text-[var(--rb-text)]":"text-zinc-700 hover:bg-[var(--rb-surface-muted)]"),children:c.label},e)}):null})]}),(0,b.jsx)("main",{className:"min-w-0",children:s?(0,b.jsx)("div",{className:"text-sm text-zinc-500",children:"Loading portal..."}):C?q:(0,b.jsx)(i.Card,{className:"shadow-none",children:(0,b.jsx)(i.CardContent,{className:"pt-5",children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-lg font-semibold text-[var(--rb-text)]",children:"Enter your case number"}),(0,b.jsx)("div",{className:"mt-1 text-sm text-zinc-600",children:"This portal is protected. Enter a case number to view your tickets and estimates."})]}),A?(0,b.jsx)(j.Alert,{variant:"danger",title:"Could not unlock portal",children:A}):null,(0,b.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center",children:[(0,b.jsx)(h.Input,{value:w,onChange:a=>x(a.target.value),placeholder:"e.g. RB-1001",disabled:y,onKeyDown:a=>{"Enter"===a.key&&(a.preventDefault(),D())}}),(0,b.jsx)(g.Button,{onClick:()=>void D(),disabled:y||!a||0===a.trim().length,children:y?"Unlocking...":"Unlock"})]}),(0,b.jsxs)("div",{className:"text-xs text-zinc-500",children:["Tip: You can also use the public status page at"," ",(0,b.jsxs)(d.default,{href:`/t/${a}/status`,className:"text-[var(--rb-blue)] hover:underline",children:["/t/",a,"/status"]}),"."]})]})})})})]})})]})}a.s(["PortalShell",()=>n])},57940,a=>{"use strict";var b=a.i(57850),c=a.i(45056),d=a.i(93609),e=a.i(90301),f=a.i(75385),g=a.i(17933),h=a.i(4600),i=a.i(34075);function j(){let a=(0,d.useParams)(),j="string"==typeof a.tenant?a.tenant:"",[k,l]=c.default.useState(!0),[m,n]=c.default.useState(null),[o,p]=c.default.useState(null),[q,r]=c.default.useState(!1),[s,t]=c.default.useState([]);c.default.useEffect(()=>{let a=!0;return async function(){try{if(l(!0),n(null),!j){p(null),r(!1),t([]);return}let b=null;if(p(b),!b)return void r(!1);let c=await (0,i.apiFetch)(`/api/t/${j}/portal/job-devices?caseNumber=${encodeURIComponent(b.caseNumber)}`);if(!a)return;r(!0),t(Array.isArray(c?.devices)?c.devices:[])}catch(b){if(!a)return;b instanceof i.ApiError&&404===b.status?n("We couldn’t load your ticket."):n(b instanceof Error?b.message:"Failed to load devices.")}finally{if(!a)return;l(!1)}}(),()=>{a=!1}},[j]);let u=c.default.useMemo(()=>s.map(a=>({id:a.id,label:a.label,serial:a.serial??"—",notes:a.notes??"",extraFields:Array.isArray(a.extra_fields)?a.extra_fields:[]})),[s]);return(0,b.jsx)(e.PortalShell,{tenantSlug:j,title:"My Devices",subtitle:"Devices linked to your tickets.",children:(0,b.jsxs)("div",{className:"space-y-4",children:[k?(0,b.jsx)("div",{className:"text-sm text-zinc-500",children:"Loading devices..."}):null,m?(0,b.jsx)(f.Alert,{variant:"danger",title:"Could not load devices",children:m}):null,k||m||o?null:(0,b.jsx)(f.Alert,{variant:"warning",title:"Portal locked",children:"Enter your case number to view devices."}),k||m||!o||q?null:(0,b.jsx)(f.Alert,{variant:"warning",title:"Ticket not found",children:"We couldn’t load your ticket."}),!k&&!m&&o&&q&&0===u.length?(0,b.jsx)(f.Alert,{variant:"info",title:"No devices linked",children:"This ticket doesn’t have any devices linked yet."}):null,u.length>0?(0,b.jsx)("div",{className:"space-y-3",children:u.map(a=>(0,b.jsx)(h.Card,{className:"shadow-none",children:(0,b.jsxs)(h.CardContent,{className:"pt-5",children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("div",{className:"truncate text-sm font-semibold text-[var(--rb-text)]",children:a.label}),(0,b.jsxs)("div",{className:"mt-1 text-xs text-zinc-500",children:["Serial: ",a.serial]})]}),(0,b.jsx)(g.Badge,{variant:"default",children:a.id})]}),a.notes?(0,b.jsx)("div",{className:"mt-2 text-sm text-zinc-700",children:a.notes}):null,a.extraFields.length>0?(0,b.jsxs)("div",{className:"mt-3",children:[(0,b.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wider text-zinc-500",children:"Extra details"}),(0,b.jsx)("div",{className:"mt-2 grid gap-2 sm:grid-cols-2",children:a.extraFields.map(a=>(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("div",{className:"truncate text-xs text-zinc-500",children:a.label}),(0,b.jsx)("div",{className:"truncate text-sm text-zinc-700",children:a.value_text})]},a.key))})]}):null]})},a.id))}):null]})})}a.s(["default",()=>j])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__36ec1ffb._.js.map