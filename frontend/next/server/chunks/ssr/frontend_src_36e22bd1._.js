module.exports=[75385,a=>{"use strict";var b=a.i(57850),c=a.i(7160);function d({variant:a,className:d}){let e="h-4 w-4 shrink-0";return"success"===a?(0,b.jsx)("svg",{viewBox:"0 0 24 24",className:(0,c.cn)(e,d),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:(0,b.jsx)("path",{d:"M20 6L9 17l-5-5"})}):"warning"===a?(0,b.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,c.cn)(e,d),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,b.jsx)("path",{d:"M12 9v4"}),(0,b.jsx)("path",{d:"M12 17h.01"}),(0,b.jsx)("path",{d:"M10.3 3.6l-8.3 14.3A2 2 0 0 0 3.7 21h16.6a2 2 0 0 0 1.7-3.1L13.7 3.6a2 2 0 0 0-3.4 0z"})]}):"danger"===a?(0,b.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,c.cn)(e,d),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,b.jsx)("path",{d:"M18 6L6 18"}),(0,b.jsx)("path",{d:"M6 6l12 12"})]}):(0,b.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,c.cn)(e,d),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,b.jsx)("path",{d:"M12 16v-4"}),(0,b.jsx)("path",{d:"M12 8h.01"}),(0,b.jsx)("path",{d:"M12 22a10 10 0 1 0-10-10 10 10 0 0 0 10 10z"})]})}function e({className:a,variant:e="info",title:f,children:g,...h}){let i={info:{wrapper:"border-[color:color-mix(in_srgb,var(--rb-blue),white_75%)] bg-[color:color-mix(in_srgb,var(--rb-blue),white_92%)] text-[var(--rb-text)]",icon:"text-[var(--rb-blue)]",title:"text-[var(--rb-blue)]"},success:{wrapper:"border-[color:color-mix(in_srgb,#16a34a,white_75%)] bg-[color:color-mix(in_srgb,#16a34a,white_92%)] text-[var(--rb-text)]",icon:"text-[#166534]",title:"text-[#166534]"},warning:{wrapper:"border-[color:color-mix(in_srgb,var(--rb-orange),white_70%)] bg-[color:color-mix(in_srgb,var(--rb-orange),white_92%)] text-[var(--rb-text)]",icon:"text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)]",title:"text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)]"},danger:{wrapper:"border-[color:color-mix(in_srgb,#dc2626,white_75%)] bg-[color:color-mix(in_srgb,#dc2626,white_92%)] text-[var(--rb-text)]",icon:"text-[#991b1b]",title:"text-[#991b1b]"}}[e];return(0,b.jsx)("div",{role:"alert",className:(0,c.cn)("rounded-[var(--rb-radius-md)] border px-4 py-3",i.wrapper,a),...h,children:(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)(d,{variant:e,className:(0,c.cn)("mt-0.5",i.icon)}),(0,b.jsxs)("div",{className:"min-w-0",children:[f?(0,b.jsx)("div",{className:(0,c.cn)("text-sm font-semibold",i.title),children:f}):null,g?(0,b.jsx)("div",{className:(0,c.cn)("text-sm text-zinc-700",f?"mt-1":""),children:g}):null]})]})})}a.s(["Alert",()=>e])},17933,a=>{"use strict";var b=a.i(57850),c=a.i(7160);function d({className:a,variant:d="default",...e}){return(0,b.jsx)("span",{className:(0,c.cn)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-medium",{default:"bg-[var(--rb-surface-muted)] text-[var(--rb-text)] border-[var(--rb-border)]",info:"bg-[color:color-mix(in_srgb,var(--rb-blue),white_85%)] text-[var(--rb-blue)] border-[color:color-mix(in_srgb,var(--rb-blue),white_70%)]",success:"bg-[color:color-mix(in_srgb,#16a34a,white_85%)] text-[#166534] border-[color:color-mix(in_srgb,#16a34a,white_70%)]",warning:"bg-[color:color-mix(in_srgb,var(--rb-orange),white_85%)] text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)] border-[color:color-mix(in_srgb,var(--rb-orange),white_70%)]",danger:"bg-[color:color-mix(in_srgb,#dc2626,white_85%)] text-[#991b1b] border-[color:color-mix(in_srgb,#dc2626,white_70%)]"}[d],a),...e})}a.s(["Badge",()=>d])},29054,a=>{"use strict";var b=a.i(57850),c=a.i(7160);function d({className:a,type:d,...e}){return(0,b.jsx)("input",{type:d,className:(0,c.cn)("w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)] outline-none transition","placeholder:text-zinc-400","focus-visible:ring-2 focus-visible:ring-[color:color-mix(in_srgb,var(--rb-orange),white_65%)] focus-visible:ring-offset-2 focus-visible:ring-offset-white","disabled:cursor-not-allowed disabled:bg-[var(--rb-surface-muted)] disabled:opacity-70",a),...e})}a.s(["Input",()=>d])},94703,a=>{"use strict";var b=a.i(57850),c=a.i(45056),d=a.i(7160);function e({open:a,onClose:e,title:f,children:g,footer:h,position:i="center",variant:j="glass",className:k}){if((0,c.useEffect)(()=>{function b(b){a&&"Escape"===b.key&&e()}return document.addEventListener("keydown",b),()=>document.removeEventListener("keydown",b)},[e,a]),!a)return null;let l="solid"===j?(0,d.cn)("relative w-full max-w-lg overflow-hidden rounded-[var(--rb-radius-lg)]","border border-[var(--rb-border)]","bg-white","shadow-[var(--rb-shadow)]"):(0,d.cn)("relative w-full max-w-lg overflow-hidden rounded-[var(--rb-radius-lg)]","border border-[color:color-mix(in_srgb,var(--rb-border),white_55%)]","bg-white/75 backdrop-blur-xl","shadow-[0_18px_55px_-18px_rgba(0,0,0,0.55)]","ring-1 ring-white/25");return(0,b.jsxs)("div",{className:"top-center"===i?"fixed inset-0 z-50 flex items-start justify-center px-4 pt-8":"fixed inset-0 z-50 flex items-center justify-center px-4",children:[(0,b.jsx)("button",{type:"button",className:(0,d.cn)("absolute inset-0","bg-black/35 backdrop-blur-md","bg-[radial-gradient(900px_600px_at_20%_20%,color-mix(in_srgb,#16a34a,transparent_82%)_0%,transparent_60%),radial-gradient(900px_600px_at_80%_30%,color-mix(in_srgb,var(--rb-blue),transparent_82%)_0%,transparent_60%),radial-gradient(900px_600px_at_50%_85%,color-mix(in_srgb,var(--rb-orange),transparent_85%)_0%,transparent_65%)]"),"aria-label":"Close",onClick:e}),(0,b.jsxs)("div",{role:"dialog","aria-modal":"true",className:(0,d.cn)(l,k),children:["glass"===j?(0,b.jsx)("div",{className:"pointer-events-none absolute inset-0 bg-[radial-gradient(650px_420px_at_20%_15%,color-mix(in_srgb,#16a34a,transparent_88%)_0%,transparent_60%),radial-gradient(650px_420px_at_80%_5%,color-mix(in_srgb,var(--rb-blue),transparent_90%)_0%,transparent_60%)]"}):null,f?(0,b.jsx)("div",{className:(0,d.cn)("relative px-5 py-4","solid"===j?"border-b border-[var(--rb-border)]":"border-b border-[color:color-mix(in_srgb,var(--rb-border),white_60%)]"),children:(0,b.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:f})}):null,(0,b.jsx)("div",{className:"relative px-5 py-4",children:g}),h?(0,b.jsx)("div",{className:(0,d.cn)("relative px-5 py-4","solid"===j?"border-t border-[var(--rb-border)]":"border-t border-[color:color-mix(in_srgb,var(--rb-border),white_60%)]"),children:h}):null]})]})}a.s(["Modal",()=>e])},21282,a=>{"use strict";var b=a.i(57850),c=a.i(94703),d=a.i(97867);function e({open:a,title:e,message:f,confirmText:g="Confirm",confirmVariant:h="primary",cancelText:i="Cancel",busy:j=!1,onCancel:k,onConfirm:l}){return(0,b.jsx)(c.Modal,{open:a,onClose:()=>{j||k()},title:e,footer:(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,b.jsx)(d.Button,{variant:"outline",onClick:k,disabled:j,children:i}),(0,b.jsx)(d.Button,{variant:h,onClick:l,disabled:j,children:j?"Working...":g})]}),children:(0,b.jsx)("div",{className:"text-sm text-zinc-700",children:f})})}a.s(["ConfirmDialog",()=>e])},4148,a=>{"use strict";function b(a){let b=a.amountCents,c=a.currency?.toUpperCase()??null;if("number"!=typeof b||!Number.isFinite(b))return a.fallback??"—";let d=b/100;if(!c||3!==c.length)return`${d.toFixed(2)}`;try{return new Intl.NumberFormat(void 0,{style:"currency",currency:c,minimumFractionDigits:2,maximumFractionDigits:2}).format(d)}catch{return`${c} ${d.toFixed(2)}`}}a.s(["formatMoney",()=>b])},46664,a=>{"use strict";let b={locale:"en-GB",dateStyle:"medium",timeStyle:"short",hour12:!1};function c(a){if(!a)return null;if(a instanceof Date)return Number.isFinite(a.getTime())?a:null;let b=new Date(a);return Number.isFinite(b.getTime())?b:null}function d(a,d){let e=c(a);if(!e)return"—";let f={...b,...d??{}};return new Intl.DateTimeFormat(f.locale,{dateStyle:f.dateStyle}).format(e)}function e(a,d){let e=c(a);if(!e)return"—";let f={...b,...d??{}};return new Intl.DateTimeFormat(f.locale,{dateStyle:f.dateStyle,timeStyle:f.timeStyle,hour12:f.hour12}).format(e)}a.s(["formatDate",()=>d,"formatDateTime",()=>e])},56264,a=>{"use strict";var b=a.i(34075);async function c(a){let c=new URLSearchParams;return"boolean"==typeof a?.includeInactive&&c.set("include_inactive",a.includeInactive?"1":"0"),(0,b.apiFetch)(`/api/admin/billing/catalog${c.toString()?`?${c.toString()}`:""}`)}async function d(a){let c=new URLSearchParams;return"boolean"==typeof a?.includeInactive&&c.set("include_inactive",a.includeInactive?"1":"0"),(0,b.apiFetch)(`/api/admin/billing/intervals${c.toString()?`?${c.toString()}`:""}`)}async function e(a){return(0,b.apiFetch)("/api/admin/billing/intervals",{method:"POST",body:{code:a.code?.trim()||void 0,name:a.name,months:a.months,is_active:"boolean"==typeof a.isActive?a.isActive:void 0}})}async function f(a){return(0,b.apiFetch)(`/api/admin/billing/intervals/${a.intervalId}`,{method:"PUT",body:{code:a.code,name:a.name,months:a.months,is_active:"boolean"==typeof a.isActive?a.isActive:void 0,reason:a.reason}})}async function g(a){return(0,b.apiFetch)(`/api/admin/billing/intervals/${a.intervalId}/active`,{method:"PATCH",body:{is_active:a.isActive,reason:a.reason}})}async function h(a){return(0,b.apiFetch)("/api/admin/billing/plans",{method:"POST",body:{name:a.name,code:a.code?.trim()||void 0,description:a.description?.trim()||void 0,is_active:"boolean"==typeof a.isActive?a.isActive:void 0}})}async function i(a){return(0,b.apiFetch)(`/api/admin/billing/plans/${a.planId}`,{method:"PUT",body:{name:a.name,code:a.code,description:a.description?.trim()||void 0,is_active:"boolean"==typeof a.isActive?a.isActive:void 0,reason:a.reason}})}async function j(a){return(0,b.apiFetch)(`/api/admin/billing/plans/${a.planId}/versions/draft-from-active`,{method:"POST",body:{reason:a.reason}})}async function k(a){try{return await (0,b.apiFetch)(`/api/admin/billing/versions/${a.versionId}/validate`,{method:"POST",body:{reason:a.reason}})}catch(a){if(a instanceof b.ApiError){let b=a.data;if(b&&"object"==typeof b){if("ok"===b.status)return{status:"ok"};if("string"==typeof b.message)return{message:b.message,errors:Array.isArray(b.errors)?b.errors.map(String):void 0}}}throw a}}async function l(a){return(0,b.apiFetch)(`/api/admin/billing/versions/${a.versionId}/entitlements/sync`,{method:"POST",body:{entitlements:a.entitlements,reason:a.reason}})}async function m(a){return(0,b.apiFetch)(`/api/admin/billing/versions/${a.versionId}/prices`,{method:"POST",body:{currency:a.currency,billing_interval_id:"number"==typeof a.billingIntervalId?a.billingIntervalId:void 0,interval:a.interval,amount_cents:a.amountCents,trial_days:"number"==typeof a.trialDays?a.trialDays:void 0,is_default:"boolean"==typeof a.isDefault?a.isDefault:void 0,reason:a.reason}})}async function n(a){return(0,b.apiFetch)(`/api/admin/billing/prices/${a.priceId}`,{method:"PATCH",body:{amount_cents:a.amountCents,trial_days:"number"==typeof a.trialDays?a.trialDays:void 0,is_default:"boolean"==typeof a.isDefault?a.isDefault:void 0,reason:a.reason}})}async function o(a){return(0,b.apiFetch)(`/api/admin/billing/prices/${a.priceId}`,{method:"DELETE",body:{reason:a.reason}})}async function p(a){return(0,b.apiFetch)(`/api/admin/billing/versions/${a.versionId}/activate`,{method:"POST",body:{confirm:a.confirm,reason:a.reason}})}async function q(a){return(0,b.apiFetch)("/api/admin/billing/entitlement-definitions",{method:"POST",body:{code:a.code?.trim()||void 0,name:a.name,value_type:a.valueType,description:a.description?.trim()||void 0,is_premium:"boolean"==typeof a.isPremium?a.isPremium:void 0}})}async function r(a){return(0,b.apiFetch)(`/api/admin/billing/entitlement-definitions/${a.id}`,{method:"PUT",body:{code:a.code,name:a.name,value_type:a.valueType,description:a.description?.trim()||void 0,is_premium:"boolean"==typeof a.isPremium?a.isPremium:void 0,reason:a.reason}})}async function s(a){return(0,b.apiFetch)(`/api/admin/billing/entitlement-definitions/${a.id}`,{method:"DELETE",body:{reason:a.reason}})}async function t(a){return(0,b.apiFetch)(`/api/admin/businesses/${a}/subscriptions`)}async function u(a){return(0,b.apiFetch)(`/api/admin/businesses/${a.tenantId}/subscriptions`,{method:"POST",body:{billing_plan_version_id:a.billingPlanVersionId,billing_price_id:a.billingPriceId,reason:a.reason}})}async function v(a){return(0,b.apiFetch)(`/api/admin/businesses/${a.tenantId}/subscriptions/${a.subscriptionId}/cancel`,{method:"POST",body:{at_period_end:"boolean"==typeof a.atPeriodEnd?a.atPeriodEnd:void 0,reason:a.reason}})}async function w(a){let c=new URLSearchParams;return a.status&&a.status.trim().length>0&&c.set("status",a.status.trim()),"number"==typeof a.limit&&Number.isFinite(a.limit)&&c.set("limit",String(a.limit)),(0,b.apiFetch)(`/api/admin/businesses/${a.tenantId}/invoices${c.toString()?`?${c.toString()}`:""}`)}async function x(a){return(0,b.apiFetch)(`/api/admin/businesses/${a.tenantId}/invoices/${a.invoiceId}`)}async function y(a){return(0,b.apiFetch)(`/api/admin/businesses/${a.tenantId}/invoices`,{method:"POST",body:{tenant_subscription_id:a.tenantSubscriptionId,reason:a.reason}})}async function z(a){return(0,b.apiFetch)(`/api/admin/businesses/${a.tenantId}/invoices/${a.invoiceId}/issue`,{method:"POST",body:{reason:a.reason}})}async function A(a){return(0,b.apiFetch)(`/api/admin/businesses/${a.tenantId}/invoices/${a.invoiceId}/paid`,{method:"POST",body:{paid_at:a.paidAt,paid_method:a.paidMethod,paid_note:a.paidNote,reason:a.reason}})}async function B(a){let c=a.invoiceNumber?`invoice_${a.invoiceNumber}.pdf`:"invoice.pdf";await (0,b.apiDownload)(`/api/admin/businesses/${a.tenantId}/invoices/${a.invoiceId}/pdf`,{filename:c})}a.s(["activateBillingPlanVersion",()=>p,"assignTenantSubscription",()=>u,"cancelTenantSubscription",()=>v,"createBillingInterval",()=>e,"createBillingPlan",()=>h,"createBillingPrice",()=>m,"createDraftBillingPlanVersionFromActive",()=>j,"createEntitlementDefinition",()=>q,"createInvoiceFromSubscription",()=>y,"deleteBillingPrice",()=>o,"deleteEntitlementDefinition",()=>s,"downloadInvoicePdf",()=>B,"getBillingCatalog",()=>c,"getTenantInvoice",()=>x,"getTenantInvoices",()=>w,"getTenantSubscriptions",()=>t,"issueInvoice",()=>z,"listBillingIntervals",()=>d,"markInvoicePaid",()=>A,"setBillingIntervalActive",()=>g,"syncBillingPlanVersionEntitlements",()=>l,"updateBillingInterval",()=>f,"updateBillingPlan",()=>i,"updateBillingPrice",()=>n,"updateEntitlementDefinition",()=>r,"validateBillingPlanVersionDraft",()=>k])},41345,a=>{"use strict";var b=a.i(57850),c=a.i(45056),d=a.i(59843),e=a.i(93609),f=a.i(91601),g=a.i(25533),h=a.i(75385),i=a.i(17933),j=a.i(97867),k=a.i(4600),l=a.i(21282),m=a.i(94703),n=a.i(29054),o=a.i(46664),p=a.i(56264),q=a.i(4148);function r(){let a=Number((0,e.useParams)().business),r=(0,g.useDashboardHeader)(),[s,t]=(0,c.useState)(!0),[u,v]=(0,c.useState)(null),[w,x]=(0,c.useState)(null),[y,z]=(0,c.useState)([]),[A,B]=(0,c.useState)(!0),[C,D]=(0,c.useState)(null),[E,F]=(0,c.useState)([]),[G,H]=(0,c.useState)(0),[I,J]=(0,c.useState)(!1),[K,L]=(0,c.useState)(!1),[M,N]=(0,c.useState)(null),[O,P]=(0,c.useState)(""),[Q,R]=(0,c.useState)(""),[S,T]=(0,c.useState)(""),[U,V]=(0,c.useState)(""),[W,X]=(0,c.useState)(!1),[Y,Z]=(0,c.useState)(!1),[$,_]=(0,c.useState)(!0);(0,c.useEffect)(()=>(r.setHeader({breadcrumb:"Admin / Businesses",title:w?`${w.name} — Billing`:`Business ${a} — Billing`,subtitle:w?`Business ID ${w.id} • ${w.slug}`:void 0,actions:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(d.default,{href:`/admin/businesses/${a}`,children:(0,b.jsx)(j.Button,{variant:"outline",size:"sm",children:"Back"})}),(0,b.jsx)(j.Button,{variant:"outline",size:"sm",onClick:()=>H(a=>a+1),disabled:s||A,children:"Refresh"})]})}),()=>r.setHeader(null)),[A,r,s,w,a]),(0,c.useEffect)(()=>{let b=!0;return async function(){if(!Number.isFinite(a)||a<=0){v("Invalid business id."),t(!1);return}try{t(!0),v(null);let c=await (0,p.getTenantSubscriptions)(a);if(!b)return;x(c.tenant),z(Array.isArray(c.subscriptions)?c.subscriptions:[])}catch(a){if(!b)return;v(a instanceof Error?a.message:"Failed to load subscriptions."),x(null),z([])}finally{if(!b)return;t(!1)}}(),()=>{b=!1}},[a,G]),(0,c.useEffect)(()=>{let a=!0;return async function(){try{B(!0),D(null);let b=await (0,p.getBillingCatalog)({includeInactive:!0});if(!a)return;F(Array.isArray(b.billing_plans)?b.billing_plans:[])}catch(b){if(!a)return;D(b instanceof Error?b.message:"Failed to load billing catalog."),F([])}finally{if(!a)return;B(!1)}}(),()=>{a=!1}},[G]);let aa=(0,c.useMemo)(()=>(Array.isArray(y)?y:[]).slice().sort((a,b)=>(b.id??0)-(a.id??0))[0]??null,[y]),ab=(w?.currency??"").toUpperCase(),ac=(0,c.useMemo)(()=>{let a=Number(O);return E.find(b=>b.id===a)??null},[E,O]),ad=(0,c.useMemo)(()=>Array.isArray(ac?.versions)?ac?.versions??[]:[],[ac]),ae=(0,c.useMemo)(()=>{let a=Number(Q);return ad.find(b=>b.id===a)??null},[Q,ad]),af=(0,c.useMemo)(()=>{let a=Array.isArray(ae?.prices)?ae?.prices??[]:[];return 3===ab.length?a.filter(a=>String(a.currency).toUpperCase()===ab):a},[ae,ab]),ag=(0,c.useMemo)(()=>{let a=Number(S);return af.find(b=>b.id===a)??null},[af,S]);async function ah(){J(!0),N(null),P(""),R(""),T("")}async function ai(){if(Number.isFinite(a)&&!(a<=0)){if(!ae||!ag)return void N("Please select a plan version and a price.");L(!0),N(null);try{await (0,p.assignTenantSubscription)({tenantId:a,billingPlanVersionId:ae.id,billingPriceId:ag.id,reason:U.trim()||void 0}),J(!1),H(a=>a+1)}catch(a){N(a instanceof Error?a.message:"Failed to assign subscription.")}finally{L(!1)}}}async function aj(){if(aa&&Number.isFinite(a)&&!(a<=0)){Z(!0);try{await (0,p.cancelTenantSubscription)({tenantId:a,subscriptionId:aa.id,atPeriodEnd:$,reason:U.trim()||void 0}),X(!1),H(a=>a+1)}catch(a){v(a instanceof Error?a.message:"Failed to cancel subscription.")}finally{Z(!1)}}}return(0,b.jsx)(f.RequireAuth,{requiredPermission:"admin.billing.read",children:(0,b.jsxs)("div",{className:"space-y-6",children:[u?(0,b.jsx)(h.Alert,{variant:"danger",title:"Billing could not be loaded",children:u}):null,C?(0,b.jsx)(h.Alert,{variant:"danger",title:"Billing catalog could not be loaded",children:C}):null,(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-3",children:[(0,b.jsxs)(k.Card,{className:"lg:col-span-2",children:[(0,b.jsxs)(k.CardHeader,{className:"flex flex-row items-start justify-between gap-4",children:[(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)(k.CardTitle,{className:"truncate",children:"Subscription"}),(0,b.jsx)("div",{className:"mt-1 text-sm text-zinc-600",children:"Current subscription and assignment actions"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(d.default,{href:`/admin/businesses/${a}/billing/invoices`,children:(0,b.jsx)(j.Button,{variant:"outline",size:"sm",children:"Invoices"})}),(0,b.jsx)(j.Button,{variant:"secondary",size:"sm",onClick:ah,disabled:A||s,children:"Assign / Change"})]})]}),(0,b.jsxs)(k.CardContent,{className:"space-y-4",children:[s?(0,b.jsx)("div",{className:"text-sm text-zinc-500",children:"Loading subscription…"}):null,s||aa?null:(0,b.jsx)("div",{className:"text-sm text-zinc-600",children:"No subscription assigned yet."}),aa?(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-zinc-500",children:"Plan"}),(0,b.jsx)("div",{className:"mt-1 text-sm text-zinc-800",children:aa.plan_version?.plan?.name??"—"}),(0,b.jsxs)("div",{className:"mt-1 text-xs text-zinc-500",children:["Version ID: ",aa.billing_plan_version_id]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-zinc-500",children:"Status"}),(0,b.jsx)("div",{className:"mt-1",children:(0,b.jsx)(i.Badge,{variant:"active"===aa.status?"success":"default",children:aa.status})}),aa.cancel_at_period_end?(0,b.jsx)("div",{className:"mt-1 text-xs text-amber-700",children:"Cancel at period end"}):null]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-zinc-500",children:"Price"}),(0,b.jsx)("div",{className:"mt-1 text-sm text-zinc-800",children:aa.price?`${(0,q.formatMoney)({amountCents:aa.price.amount_cents,currency:aa.price.currency})} / ${aa.price.interval}`:"—"}),(0,b.jsxs)("div",{className:"mt-1 text-xs text-zinc-500",children:["Currency: ",aa.currency??"—"]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-zinc-500",children:"Period"}),(0,b.jsxs)("div",{className:"mt-1 text-sm text-zinc-800",children:[(0,o.formatDateTime)(aa.current_period_start??null)," → ",(0,o.formatDateTime)(aa.current_period_end??null)]})]}),(0,b.jsx)("div",{className:"sm:col-span-2",children:(0,b.jsx)("div",{className:"flex flex-wrap items-center gap-2",children:(0,b.jsx)(j.Button,{variant:"outline",size:"sm",onClick:()=>X(!0),disabled:Y,children:"Cancel subscription"})})})]}):null]})]}),(0,b.jsxs)(k.Card,{children:[(0,b.jsx)(k.CardHeader,{children:(0,b.jsx)(k.CardTitle,{children:"Tenant billing profile"})}),(0,b.jsxs)(k.CardContent,{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-zinc-500",children:"Currency"}),(0,b.jsx)("div",{className:"mt-1 text-sm text-zinc-800",children:ab||"—"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-zinc-500",children:"Billing country"}),(0,b.jsx)("div",{className:"mt-1 text-sm text-zinc-800",children:w?.billing_country??"—"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs text-zinc-500",children:"VAT number"}),(0,b.jsx)("div",{className:"mt-1 text-sm text-zinc-800",children:w?.billing_vat_number??"—"})]})]})]})]}),(0,b.jsx)(m.Modal,{open:I,onClose:()=>{K||J(!1)},title:"Assign / Change subscription",footer:(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,b.jsx)(j.Button,{variant:"outline",onClick:()=>{K||J(!1)},disabled:K,children:"Cancel"}),(0,b.jsx)(j.Button,{variant:"primary",onClick:ai,disabled:K,children:K?"Saving…":"Save"})]}),children:(0,b.jsxs)("div",{className:"space-y-4",children:[M?(0,b.jsx)(h.Alert,{variant:"danger",title:"Cannot assign subscription",children:M}):null,(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-[var(--rb-text)]",children:"Tenant currency"}),(0,b.jsxs)("div",{className:"mt-1 text-sm text-zinc-700",children:[ab||"—"," (prices are filtered to match)"]})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"Plan"}),(0,b.jsxs)("select",{className:"w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:O,onChange:a=>{P(a.target.value),R(""),T("")},disabled:A||K,children:[(0,b.jsx)("option",{value:"",children:"— Select plan —"}),E.map(a=>(0,b.jsxs)("option",{value:String(a.id),children:[a.name," (",a.code,")"]},a.id))]})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"Plan version"}),(0,b.jsxs)("select",{className:"w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:Q,onChange:a=>{R(a.target.value),T("")},disabled:!ac||K,children:[(0,b.jsx)("option",{value:"",children:"— Select version —"}),ad.map(a=>(0,b.jsxs)("option",{value:String(a.id),children:["v",a.version," (",a.status,")"]},a.id))]}),ac&&0===ad.length?(0,b.jsx)("div",{className:"text-xs text-zinc-500",children:"No versions available for this plan."}):null]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"Price"}),(0,b.jsxs)("select",{className:"w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:S,onChange:a=>T(a.target.value),disabled:!ae||K,children:[(0,b.jsx)("option",{value:"",children:"— Select price —"}),af.map(a=>(0,b.jsxs)("option",{value:String(a.id),children:[(0,q.formatMoney)({amountCents:a.amount_cents,currency:a.currency})," / ",a.interval,a.is_default?" (default)":""]},a.id))]}),ae&&0===af.length?(0,b.jsxs)("div",{className:"text-xs text-amber-700",children:["No prices found for this version",ab?` in ${ab}`:"","."]}):null]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"Reason (optional)"}),(0,b.jsx)(n.Input,{value:U,onChange:a=>V(a.target.value),placeholder:"Support / plan change reason…"})]})]})}),(0,b.jsx)(l.ConfirmDialog,{open:W,title:"Cancel subscription",message:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("div",{children:"This will cancel the current subscription for this tenant."}),(0,b.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,b.jsx)("input",{type:"checkbox",checked:$,onChange:a=>_(a.target.checked),disabled:Y}),"Cancel at period end"]})]}),confirmText:"Cancel subscription",confirmVariant:"secondary",busy:Y,onCancel:()=>{Y||X(!1)},onConfirm:()=>void aj()})]})})}a.s(["default",()=>r])}];

//# sourceMappingURL=frontend_src_36e22bd1._.js.map