module.exports=[94703,a=>{"use strict";var b=a.i(57850),c=a.i(45056),d=a.i(7160);function e({open:a,onClose:e,title:f,children:g,footer:h,position:i="center",variant:j="glass",className:k}){if((0,c.useEffect)(()=>{function b(b){a&&"Escape"===b.key&&e()}return document.addEventListener("keydown",b),()=>document.removeEventListener("keydown",b)},[e,a]),!a)return null;let l="solid"===j?(0,d.cn)("relative w-full max-w-lg overflow-hidden rounded-[var(--rb-radius-lg)]","border border-[var(--rb-border)]","bg-white","shadow-[var(--rb-shadow)]"):(0,d.cn)("relative w-full max-w-lg overflow-hidden rounded-[var(--rb-radius-lg)]","border border-[color:color-mix(in_srgb,var(--rb-border),white_55%)]","bg-white/75 backdrop-blur-xl","shadow-[0_18px_55px_-18px_rgba(0,0,0,0.55)]","ring-1 ring-white/25");return(0,b.jsxs)("div",{className:"top-center"===i?"fixed inset-0 z-50 flex items-start justify-center px-4 pt-8":"fixed inset-0 z-50 flex items-center justify-center px-4",children:[(0,b.jsx)("button",{type:"button",className:(0,d.cn)("absolute inset-0","bg-black/35 backdrop-blur-md","bg-[radial-gradient(900px_600px_at_20%_20%,color-mix(in_srgb,#16a34a,transparent_82%)_0%,transparent_60%),radial-gradient(900px_600px_at_80%_30%,color-mix(in_srgb,var(--rb-blue),transparent_82%)_0%,transparent_60%),radial-gradient(900px_600px_at_50%_85%,color-mix(in_srgb,var(--rb-orange),transparent_85%)_0%,transparent_65%)]"),"aria-label":"Close",onClick:e}),(0,b.jsxs)("div",{role:"dialog","aria-modal":"true",className:(0,d.cn)(l,k),children:["glass"===j?(0,b.jsx)("div",{className:"pointer-events-none absolute inset-0 bg-[radial-gradient(650px_420px_at_20%_15%,color-mix(in_srgb,#16a34a,transparent_88%)_0%,transparent_60%),radial-gradient(650px_420px_at_80%_5%,color-mix(in_srgb,var(--rb-blue),transparent_90%)_0%,transparent_60%)]"}):null,f?(0,b.jsx)("div",{className:(0,d.cn)("relative px-5 py-4","solid"===j?"border-b border-[var(--rb-border)]":"border-b border-[color:color-mix(in_srgb,var(--rb-border),white_60%)]"),children:(0,b.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:f})}):null,(0,b.jsx)("div",{className:"relative px-5 py-4",children:g}),h?(0,b.jsx)("div",{className:(0,d.cn)("relative px-5 py-4","solid"===j?"border-t border-[var(--rb-border)]":"border-t border-[color:color-mix(in_srgb,var(--rb-border),white_60%)]"),children:h}):null]})]})}a.s(["Modal",()=>e])},21282,a=>{"use strict";var b=a.i(57850),c=a.i(94703),d=a.i(97867);function e({open:a,title:e,message:f,confirmText:g="Confirm",confirmVariant:h="primary",cancelText:i="Cancel",busy:j=!1,onCancel:k,onConfirm:l}){return(0,b.jsx)(c.Modal,{open:a,onClose:()=>{j||k()},title:e,footer:(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,b.jsx)(d.Button,{variant:"outline",onClick:k,disabled:j,children:i}),(0,b.jsx)(d.Button,{variant:h,onClick:l,disabled:j,children:j?"Working...":g})]}),children:(0,b.jsx)("div",{className:"text-sm text-zinc-700",children:f})})}a.s(["ConfirmDialog",()=>e])},4148,a=>{"use strict";function b(a){let b=a.amountCents,c=a.currency?.toUpperCase()??null;if("number"!=typeof b||!Number.isFinite(b))return a.fallback??"—";let d=b/100;if(!c||3!==c.length)return`${d.toFixed(2)}`;try{return new Intl.NumberFormat(void 0,{style:"currency",currency:c,minimumFractionDigits:2,maximumFractionDigits:2}).format(d)}catch{return`${c} ${d.toFixed(2)}`}}a.s(["formatMoney",()=>b])},54804,a=>{"use strict";var b=a.i(57850),c=a.i(648),d=a.i(75385),e=a.i(4600);function f({title:a,description:f,actions:g,filters:h,loading:i,loadingFallback:j,error:k,empty:l,emptyTitle:m="Nothing here yet",emptyDescription:n="No items to display.",children:o}){return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(c.PageHeader,{title:a,description:f,actions:g}),h?(0,b.jsx)(e.Card,{className:"shadow-none",children:(0,b.jsx)(e.CardContent,{className:"pt-5",children:h})}):null,k?(0,b.jsx)(d.Alert,{variant:"danger",title:"Something went wrong",children:k}):null,i?j??(0,b.jsx)("div",{className:"text-sm text-zinc-500",children:"Loading..."}):null,i||k||!l?null:(0,b.jsx)(e.Card,{className:"shadow-none",children:(0,b.jsxs)(e.CardContent,{className:"pt-5",children:[(0,b.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:m}),(0,b.jsx)("div",{className:"mt-1 text-sm text-zinc-600",children:n})]})}),i||k||l?null:o]})}a.s(["ListPageShell",()=>f])},41184,a=>{"use strict";var b=a.i(57850),c=a.i(45056),d=a.i(93609),e=a.i(91601),f=a.i(75458),g=a.i(97867),h=a.i(4600),i=a.i(21282),j=a.i(54177),k=a.i(46036),l=a.i(26606),m=a.i(54804),n=a.i(34075),o=a.i(4148);function p(){let a=(0,f.useAuth)(),p=(0,d.useRouter)(),q=(0,d.useParams)(),r=q.business??q.tenant,[s,t]=c.default.useState(!0),[u,v]=c.default.useState(null),[w,x]=c.default.useState(null),[y,z]=c.default.useState(!1),[A,B]=c.default.useState([]),[C,D]=c.default.useState([]),[E,F]=c.default.useState([]),[G,H]=c.default.useState(!1),[I,J]=c.default.useState(""),[K,L]=c.default.useState(""),[M,N]=c.default.useState(null),[O,P]=c.default.useState(""),[Q,R]=c.default.useState(0),[S,T]=c.default.useState(10),[U,V]=c.default.useState(0),[W,X]=c.default.useState(null),Y=a.can("parts.manage"),Z=c.default.useCallback(async()=>{if("string"==typeof r&&0!==r.length)try{let[a,b]=await Promise.all([(0,n.apiFetch)(`/api/${r}/app/repairbuddy/part-types?limit=200`),(0,n.apiFetch)(`/api/${r}/app/repairbuddy/part-brands?limit=200`)]);D(Array.isArray(a.part_types)?a.part_types:[]),F(Array.isArray(b.part_brands)?b.part_brands:[])}catch{D([]),F([])}},[r]),$=c.default.useCallback(async()=>{try{if(t(!0),v(null),"string"!=typeof r||0===r.length)throw Error("Business is missing.");let a=new URLSearchParams;O.trim().length>0&&a.set("q",O.trim()),a.set("page",String(Q+1)),a.set("per_page",String(S)),W?.id&&W?.dir&&(a.set("sort",W.id),a.set("dir",W.dir));let b=await (0,n.apiFetch)(`/api/${r}/app/repairbuddy/parts?${a.toString()}`);B(Array.isArray(b.parts)?b.parts:[]),V("number"==typeof b.meta?.total?b.meta.total:0),T("number"==typeof b.meta?.per_page?b.meta.per_page:S)}catch(a){if(a instanceof n.ApiError&&428===a.status&&"string"==typeof r&&r.length>0){let a=`/app/${r}/parts`;p.replace(`/app/${r}/branches/select?next=${encodeURIComponent(a)}`);return}v(a instanceof Error?a.message:"Failed to load parts.")}finally{t(!1)}},[Q,S,O,p,W?.dir,W?.id,r]);async function _(a){if(!y&&"string"==typeof r&&0!==r.length){var c;if(!Y)return void v("Forbidden.");c={title:"Delete part",message:(0,b.jsxs)("div",{children:["Delete ",(0,b.jsx)("span",{className:"font-semibold",children:a.name}),"?"]}),action:async()=>{z(!0),v(null),x(null);try{await (0,n.apiFetch)(`/api/${r}/app/repairbuddy/parts/${a.id}`,{method:"DELETE"}),x("Part deleted."),R(0),await $()}catch(a){a instanceof n.ApiError?v(a.message):v("Failed to delete part.")}finally{z(!1)}}},J(c.title),L(c.message),N(()=>c.action),H(!0)}}c.default.useEffect(()=>{$()},[$]),c.default.useEffect(()=>{Z()},[Z]);let aa=c.default.useMemo(()=>{let a=new Map;for(let b of C)"number"==typeof b.id&&a.set(b.id,b.name);return a},[C]),ab=c.default.useMemo(()=>{let a=new Map;for(let b of E)"number"==typeof b.id&&a.set(b.id,b.name);return a},[E]),ac=c.default.useMemo(()=>[{id:"name",header:"Part",sortId:"name",cell:a=>(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("div",{className:"truncate font-semibold text-[var(--rb-text)]",children:a.name}),(0,b.jsx)("div",{className:"truncate text-xs text-zinc-600",children:a.id})]}),className:"min-w-[280px]"},{id:"sku",header:"SKU",sortId:"sku",cell:a=>(0,b.jsx)("div",{className:"text-sm text-zinc-700",children:a.sku??"—"}),className:"min-w-[200px]"},{id:"type",header:"Type",cell:a=>{let c="number"==typeof a.part_type_id?aa.get(a.part_type_id):null;return(0,b.jsx)("div",{className:"text-sm text-zinc-700",children:c??"—"})},className:"min-w-[160px]"},{id:"brand",header:"Brand",cell:a=>{let c="number"==typeof a.part_brand_id?ab.get(a.part_brand_id):null;return(0,b.jsx)("div",{className:"text-sm text-zinc-700",children:c??"—"})},className:"min-w-[160px]"},{id:"price",header:"Price",cell:a=>a.price?(0,b.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)] whitespace-nowrap",children:(0,o.formatMoney)({amountCents:a.price.amount_cents,currency:a.price.currency})}):(0,b.jsx)("div",{className:"text-sm text-zinc-600",children:"—"}),className:"whitespace-nowrap"},{id:"stock",header:"Stock",sortId:"stock",cell:a=>(0,b.jsx)("div",{className:"text-sm text-zinc-700",children:a.stock??"—"}),className:"whitespace-nowrap"},{id:"active",header:"Active",sortId:"is_active",className:"whitespace-nowrap",cell:a=>(0,b.jsx)("div",{className:"text-sm text-zinc-700",children:a.is_active?"Yes":"No"})},{id:"actions",header:"",headerClassName:"text-right",className:"whitespace-nowrap text-right",cell:a=>Y?(0,b.jsx)(k.DropdownMenu,{align:"right",trigger:({toggle:a})=>(0,b.jsx)(g.Button,{variant:"ghost",size:"sm",onClick:a,disabled:y,className:"px-2",children:"Actions"}),children:({close:c})=>(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(k.DropdownMenuItem,{onSelect:()=>{c(),"string"==typeof r&&0!==r.length&&p.push(`/app/${r}/parts/${a.id}/edit`)},disabled:y,children:"Edit"}),(0,b.jsx)(k.DropdownMenuSeparator,{}),(0,b.jsx)(k.DropdownMenuItem,{destructive:!0,onSelect:()=>{c(),_(a)},disabled:y,children:"Delete"})]})}):null}],[ab,y,Y,p,r,aa]);return(0,b.jsx)(e.RequireAuth,{requiredPermission:"parts.view",children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(i.ConfirmDialog,{open:G,title:I,message:K,busy:y,confirmText:"Delete",confirmVariant:"secondary",onCancel:()=>{y||(H(!1),N(null))},onConfirm:()=>{M&&(async()=>{await M(),H(!1),N(null)})()}}),w?(0,b.jsx)("div",{className:"text-sm text-green-700",children:w}):null,u?(0,b.jsx)("div",{className:"text-sm text-red-600",children:u}):null,(0,b.jsx)(m.ListPageShell,{title:"Parts",description:"Inventory catalog and pricing for parts.",actions:(0,b.jsx)(g.Button,{variant:"primary",size:"sm",onClick:()=>{"string"==typeof r&&0!==r.length&&p.push(`/app/${r}/parts/new`)},disabled:!Y||s||y,children:"New part"}),loading:s,loadingFallback:(0,b.jsx)(h.Card,{className:"shadow-none",children:(0,b.jsx)(h.CardContent,{className:"pt-5",children:(0,b.jsx)(l.TableSkeleton,{rows:8,columns:7,className:"shadow-none"})})}),error:null,empty:!s&&!u&&0===A.length,emptyTitle:"No parts",emptyDescription:"Add parts to track costs and availability.",children:(0,b.jsx)(h.Card,{className:"shadow-none",children:(0,b.jsx)(h.CardContent,{className:"pt-5",children:(0,b.jsx)(j.DataTable,{title:"string"==typeof r?`Parts \xb7 ${r}`:"Parts",data:A,loading:s,emptyMessage:"No parts.",columns:ac,getRowId:a=>a.id,search:{placeholder:"Search parts..."},server:{query:O,onQueryChange:a=>{P(a),R(0)},pageIndex:Q,onPageIndexChange:R,pageSize:S,onPageSizeChange:a=>{T(a),R(0)},totalRows:U,sort:W,onSortChange:a=>{X(a),R(0)}}})})})})]})})}a.s(["default",()=>p])}];

//# sourceMappingURL=frontend_src_727109f6._.js.map