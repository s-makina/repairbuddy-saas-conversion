{"version":3,"sources":["../../../../../frontend/src/app/app/%5Btenant%5D/business-settings/page.tsx","../../../../../frontend/src/app/app/%5Btenant%5D/settings/_components/repairbuddy/RepairBuddySettingsTab.tsx","../../../../../frontend/src/app/app/%5Btenant%5D/settings/_components/repairbuddy/repairBuddyNav.ts","../../../../../frontend/src/app/app/%5Btenant%5D/settings/_components/repairbuddy/defaults.ts","../../../../../frontend/src/app/app/%5Btenant%5D/settings/_components/repairbuddy/useRepairBuddyDraft.ts","../../../../../frontend/src/app/app/%5Btenant%5D/settings/_components/repairbuddy/sections/CompanyProfileSection.tsx","../../../../../frontend/src/app/app/%5Btenant%5D/settings/_components/repairbuddy/sections/BookingSection.tsx","../../../../../frontend/src/app/app/%5Btenant%5D/settings/_components/repairbuddy/sections/SectionShell.tsx","../../../../../frontend/src/app/app/%5Btenant%5D/settings/_components/repairbuddy/sections/CurrencySection.tsx","../../../../../frontend/src/app/app/%5Btenant%5D/settings/_components/repairbuddy/sections/DevicesBrandsSection.tsx","../../../../../frontend/src/app/app/%5Btenant%5D/settings/_components/repairbuddy/sections/EstimatesSection.tsx","../../../../../frontend/src/app/app/%5Btenant%5D/settings/_components/repairbuddy/sections/GeneralSection.tsx","../../../../../frontend/src/app/app/%5Btenant%5D/settings/_components/repairbuddy/sections/InvoicesReportsSection.tsx","../../../../../frontend/src/app/app/%5Btenant%5D/settings/_components/repairbuddy/sections/JobStatusesSection.tsx","../../../../../frontend/src/lib/repairbuddy-maintenance-reminders.ts","../../../../../frontend/src/app/app/%5Btenant%5D/settings/_components/repairbuddy/sections/MaintenanceRemindersSection.tsx","../../../../../frontend/src/app/app/%5Btenant%5D/settings/_components/repairbuddy/sections/MyAccountSection.tsx","../../../../../frontend/src/app/app/%5Btenant%5D/settings/_components/repairbuddy/sections/PaymentsSection.tsx","../../../../../frontend/src/app/app/%5Btenant%5D/settings/_components/repairbuddy/sections/ReviewsSection.tsx","../../../../../frontend/src/app/app/%5Btenant%5D/settings/_components/repairbuddy/sections/ServiceSettingsSection.tsx","../../../../../frontend/src/app/app/%5Btenant%5D/settings/_components/repairbuddy/sections/SignatureWorkflowSection.tsx","../../../../../frontend/src/app/app/%5Btenant%5D/settings/_components/repairbuddy/sections/SmsSection.tsx","../../../../../frontend/src/app/app/%5Btenant%5D/settings/_components/repairbuddy/sections/StylingLabelsSection.tsx","../../../../../frontend/src/app/app/%5Btenant%5D/settings/_components/repairbuddy/sections/TaxesSection.tsx","../../../../../frontend/src/app/app/%5Btenant%5D/settings/_components/repairbuddy/sections/TimeLogsSection.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React from \"react\";\r\nimport { useParams } from \"next/navigation\";\r\nimport { RequireAuth } from \"@/components/RequireAuth\";\r\nimport { PageHeader } from \"@/components/ui/PageHeader\";\r\nimport { RepairBuddySettingsTab } from \"@/app/app/[tenant]/settings/_components/repairbuddy/RepairBuddySettingsTab\";\r\n\r\nexport default function TenantBusinessSettingsPage() {\r\n  const params = useParams() as { tenant?: string; business?: string };\r\n  const tenantSlug = params.business ?? params.tenant;\r\n\r\n  if (!tenantSlug) {\r\n    return (\r\n      <RequireAuth requiredPermission=\"settings.manage\">\r\n        <div className=\"space-y-6\">\r\n          <PageHeader title=\"Business Settings\" description=\"Operational settings for this business.\" />\r\n          <div className=\"rounded-[var(--rb-radius-md)] border border-[var(--rb-border)] bg-white px-4 py-3 text-sm text-zinc-700\">\r\n            Missing tenant in route.\r\n          </div>\r\n        </div>\r\n      </RequireAuth>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <RequireAuth requiredPermission=\"settings.manage\">\r\n      <div className=\"space-y-6\">\r\n        <PageHeader title=\"Business Settings\" description=\"Operational settings for this business.\" />\r\n\r\n        <RepairBuddySettingsTab tenantSlug={tenantSlug} />\r\n      </div>\r\n    </RequireAuth>\r\n  );\r\n}\r\n","\"use client\";\r\n\r\nimport React, { useCallback, useMemo, useState } from \"react\";\r\nimport Link from \"next/link\";\r\nimport { useSearchParams } from \"next/navigation\";\r\nimport {\r\n  Building2,\r\n  Calculator,\r\n  Calendar,\r\n  CircleHelp,\r\n  Clock,\r\n  CreditCard,\r\n  FileText,\r\n  Laptop,\r\n  Settings,\r\n  Sparkles,\r\n  Star,\r\n  Tag,\r\n  User,\r\n  Wrench,\r\n} from \"lucide-react\";\r\nimport { Alert } from \"@/components/ui/Alert\";\r\nimport { Button } from \"@/components/ui/Button\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/Card\";\r\nimport { Skeleton } from \"@/components/ui/Skeleton\";\r\nimport { repairBuddyNav } from \"@/app/app/[tenant]/settings/_components/repairbuddy/repairBuddyNav\";\r\nimport { useRepairBuddyDraft } from \"@/app/app/[tenant]/settings/_components/repairbuddy/useRepairBuddyDraft\";\r\nimport { CompanyProfileSection } from \"@/app/app/[tenant]/settings/_components/repairbuddy/sections/CompanyProfileSection\";\r\nimport { BookingSection } from \"@/app/app/[tenant]/settings/_components/repairbuddy/sections/BookingSection\";\r\nimport { CurrencySection } from \"@/app/app/[tenant]/settings/_components/repairbuddy/sections/CurrencySection\";\r\nimport { DevicesBrandsSection } from \"@/app/app/[tenant]/settings/_components/repairbuddy/sections/DevicesBrandsSection\";\r\nimport { EstimatesSection } from \"@/app/app/[tenant]/settings/_components/repairbuddy/sections/EstimatesSection\";\r\nimport { GeneralSection } from \"@/app/app/[tenant]/settings/_components/repairbuddy/sections/GeneralSection\";\r\nimport { InvoicesReportsSection } from \"@/app/app/[tenant]/settings/_components/repairbuddy/sections/InvoicesReportsSection\";\r\nimport { JobStatusesSection } from \"@/app/app/[tenant]/settings/_components/repairbuddy/sections/JobStatusesSection\";\r\nimport { MaintenanceRemindersSection } from \"@/app/app/[tenant]/settings/_components/repairbuddy/sections/MaintenanceRemindersSection\";\r\nimport { MyAccountSection } from \"@/app/app/[tenant]/settings/_components/repairbuddy/sections/MyAccountSection\";\r\nimport { PaymentsSection } from \"@/app/app/[tenant]/settings/_components/repairbuddy/sections/PaymentsSection\";\r\nimport { ReviewsSection } from \"@/app/app/[tenant]/settings/_components/repairbuddy/sections/ReviewsSection\";\r\nimport { ServiceSettingsSection } from \"@/app/app/[tenant]/settings/_components/repairbuddy/sections/ServiceSettingsSection\";\r\nimport { SignatureWorkflowSection } from \"@/app/app/[tenant]/settings/_components/repairbuddy/sections/SignatureWorkflowSection\";\r\nimport { SmsSection } from \"@/app/app/[tenant]/settings/_components/repairbuddy/sections/SmsSection\";\r\nimport { StylingLabelsSection } from \"@/app/app/[tenant]/settings/_components/repairbuddy/sections/StylingLabelsSection\";\r\nimport { TaxesSection } from \"@/app/app/[tenant]/settings/_components/repairbuddy/sections/TaxesSection\";\r\nimport { TimeLogsSection } from \"@/app/app/[tenant]/settings/_components/repairbuddy/sections/TimeLogsSection\";\r\n\r\nfunction SettingsSkeleton() {\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <div className=\"rounded-[var(--rb-radius-lg)] border border-[var(--rb-border)] bg-white px-5 py-4\">\r\n        <div className=\"flex flex-wrap items-start justify-between gap-3\">\r\n          <div>\r\n            <Skeleton className=\"h-4 w-40 rounded-[var(--rb-radius-sm)]\" />\r\n            <Skeleton className=\"mt-2 h-3 w-36 rounded-[var(--rb-radius-sm)]\" />\r\n            <Skeleton className=\"mt-3 h-9 w-[520px] max-w-full rounded-[var(--rb-radius-sm)]\" />\r\n          </div>\r\n          <Skeleton className=\"h-9 w-20 rounded-[var(--rb-radius-sm)]\" />\r\n        </div>\r\n      </div>\r\n\r\n      <Card className=\"shadow-none\">\r\n        <CardContent className=\"pt-5\">\r\n          <Skeleton className=\"h-5 w-48 rounded-[var(--rb-radius-sm)]\" />\r\n          <Skeleton className=\"mt-3 h-4 w-full rounded-[var(--rb-radius-sm)]\" />\r\n          <Skeleton className=\"mt-2 h-4 w-4/5 rounded-[var(--rb-radius-sm)]\" />\r\n          <Skeleton className=\"mt-2 h-4 w-3/5 rounded-[var(--rb-radius-sm)]\" />\r\n          <div className=\"mt-5 grid gap-3 sm:grid-cols-2\">\r\n            {Array.from({ length: 6 }).map((_, idx) => (\r\n              <div key={idx} className=\"rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2\">\r\n                <Skeleton className=\"h-4 w-40 rounded-[var(--rb-radius-sm)]\" />\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n\r\nconst navIcons: Record<string, React.ComponentType<{ className?: string; \"aria-hidden\"?: boolean }>> = {\r\n  \"company-profile\": Building2,\r\n  general: Settings,\r\n  currency: Calculator,\r\n  \"invoices-reports\": FileText,\r\n  \"job-statuses\": Tag,\r\n  payments: CreditCard,\r\n  reviews: Star,\r\n  estimates: FileText,\r\n  \"my-account\": User,\r\n  \"devices-brands\": Laptop,\r\n  sms: CircleHelp,\r\n  taxes: Calculator,\r\n  \"service-settings\": Wrench,\r\n  \"time-logs\": Clock,\r\n  \"maintenance-reminders\": Clock,\r\n  \"styling-labels\": Sparkles,\r\n  \"signature-workflow\": FileText,\r\n  booking: Calendar,\r\n};\r\n\r\nexport function RepairBuddySettingsTab({ tenantSlug }: { tenantSlug: string }) {\r\n  const searchParams = useSearchParams();\r\n  const { draft, updateSection, setDraft, isMock, savingDisabledReason, loading, saving, error, save } = useRepairBuddyDraft(tenantSlug);\r\n  const [status, setStatus] = useState<string | null>(null);\r\n\r\n  const updateCurrency = useCallback((patch: Partial<typeof draft.currency>) => updateSection(\"currency\", patch), [updateSection]);\r\n\r\n  const selectedKey = useMemo(() => {\r\n    const sectionParam = searchParams.get(\"section\");\r\n    const keys = new Set(repairBuddyNav.map((item) => item.key));\r\n    if (sectionParam && keys.has(sectionParam)) return sectionParam;\r\n    return \"company-profile\";\r\n  }, [searchParams]);\r\n\r\n  const selectedItem = useMemo(() => repairBuddyNav.find((item) => item.key === selectedKey) ?? null, [selectedKey]);\r\n\r\n  const sectionNode = useMemo(() => {\r\n    switch (selectedKey) {\r\n      case \"company-profile\":\r\n        return <CompanyProfileSection tenantSlug={tenantSlug} />;\r\n      case \"general\":\r\n        return <GeneralSection draft={draft} updateGeneral={(patch) => updateSection(\"general\", patch)} />;\r\n      case \"currency\":\r\n        return <CurrencySection draft={draft} updateCurrency={updateCurrency} />;\r\n      case \"invoices-reports\":\r\n        return <InvoicesReportsSection draft={draft} updateInvoicesReports={(patch) => updateSection(\"invoicesReports\", patch)} />;\r\n      case \"job-statuses\":\r\n        return <JobStatusesSection tenantSlug={tenantSlug} />;\r\n      case \"payments\":\r\n        return <PaymentsSection draft={draft} updatePayments={(patch) => updateSection(\"payments\", patch)} isMock={isMock} />;\r\n      case \"reviews\":\r\n        return <ReviewsSection draft={draft} updateReviews={(patch) => updateSection(\"reviews\", patch)} />;\r\n      case \"estimates\":\r\n        return <EstimatesSection draft={draft} updateEstimates={(patch) => updateSection(\"estimates\", patch)} />;\r\n      case \"my-account\":\r\n        return <MyAccountSection draft={draft} updateMyAccount={(patch) => updateSection(\"myAccount\", patch)} />;\r\n      case \"devices-brands\":\r\n        return <DevicesBrandsSection draft={draft} updateDevicesBrands={(patch) => updateSection(\"devicesBrands\", patch)} isMock={isMock} />;\r\n      case \"sms\":\r\n        return <SmsSection draft={draft} updateSms={(patch) => updateSection(\"sms\", patch)} />;\r\n      case \"taxes\":\r\n        return <TaxesSection tenantSlug={tenantSlug} draft={draft} updateTaxes={(patch) => updateSection(\"taxes\", patch)} isMock={isMock} />;\r\n      case \"service-settings\":\r\n        return <ServiceSettingsSection draft={draft} updateServiceSettings={(patch) => updateSection(\"serviceSettings\", patch)} />;\r\n      case \"time-logs\":\r\n        return <TimeLogsSection tenantSlug={tenantSlug} draft={draft} updateTimeLogs={(patch) => updateSection(\"timeLogs\", patch)} isMock={isMock} />;\r\n      case \"maintenance-reminders\":\r\n        return <MaintenanceRemindersSection tenantSlug={tenantSlug} draft={draft} isMock={isMock} />;\r\n      case \"styling-labels\":\r\n        return <StylingLabelsSection draft={draft} updateStylingLabels={(patch) => updateSection(\"stylingLabels\", patch)} />;\r\n      case \"signature-workflow\":\r\n        return <SignatureWorkflowSection draft={draft} updateSignatureWorkflow={(patch) => updateSection(\"signatureWorkflow\", patch)} />;\r\n      case \"booking\":\r\n        return <BookingSection draft={draft} updateBooking={(patch) => updateSection(\"booking\", patch)} />;\r\n      default:\r\n        return null;\r\n    }\r\n  }, [draft, isMock, selectedKey, tenantSlug, updateCurrency, updateSection]);\r\n\r\n  async function onSave() {\r\n    setStatus(null);\r\n    try {\r\n      await save();\r\n      setStatus(\"Saved.\");\r\n    } catch {\r\n      return;\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* <Alert variant=\"warning\" title=\"Mock screens\">\r\n        Saving is not available yet.\r\n      </Alert> */}\r\n\r\n      {error ? (\r\n        <Alert variant=\"danger\" title=\"Could not load or save business settings\">\r\n          {error}\r\n        </Alert>\r\n      ) : null}\r\n\r\n      {status ? (\r\n        <Alert variant=\"success\" title=\"Success\">\r\n          {status}\r\n        </Alert>\r\n      ) : null}\r\n\r\n      <div className=\"grid grid-cols-1 gap-6 lg:grid-cols-[260px_1fr]\">\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle>Business Settings</CardTitle>\r\n            <CardDescription>Operational settings for this business.</CardDescription>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-1\">\r\n            {repairBuddyNav.map((item) => {\r\n              const isActive = item.key === selectedKey;\r\n              const Icon = navIcons[item.key] ?? CircleHelp;\r\n\r\n              return (\r\n                <Link\r\n                  key={item.key}\r\n                  href={`/app/${tenantSlug}/business-settings?section=${item.key}`}\r\n                  scroll={false}\r\n                  className={\r\n                    \"block rounded-[var(--rb-radius-sm)] px-3 py-2 text-sm transition-colors \" +\r\n                    (isActive\r\n                      ? \"bg-[var(--rb-surface-muted)] font-medium text-[var(--rb-text)]\"\r\n                      : \"text-zinc-700 hover:bg-[var(--rb-surface-muted)]\")\r\n                  }\r\n                >\r\n                  <span className=\"flex items-center gap-2\">\r\n                    <Icon\r\n                      className={\r\n                        \"h-4 w-4 shrink-0 \" +\r\n                        (isActive ? \"text-[var(--rb-text)]\" : \"text-zinc-500\")\r\n                      }\r\n                      aria-hidden\r\n                    />\r\n                    <span>{item.label}</span>\r\n                  </span>\r\n                </Link>\r\n              );\r\n            })}\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <div className=\"space-y-4\">\r\n          <div className=\"rounded-[var(--rb-radius-lg)] border border-[var(--rb-border)] bg-white px-5 py-4\">\r\n            <div className=\"flex flex-wrap items-start justify-between gap-3\">\r\n              <div>\r\n                <div className=\"text-sm font-semibold text-[var(--rb-text)]\">{selectedItem?.label ?? \"Business Settings\"}</div>\r\n                <div className=\"mt-1 text-xs text-zinc-500\">Business: {tenantSlug}</div>\r\n                {savingDisabledReason ? (\r\n                  <div className=\"mt-2 text-xs text-zinc-500\">{savingDisabledReason}</div>\r\n                ) : null}\r\n                <div className=\"mt-3 flex flex-wrap items-center gap-2\">\r\n                  <Button asChild variant=\"outline\" size=\"sm\">\r\n                    <Link href={`/t/${tenantSlug}/portal`}>Preview portal</Link>\r\n                  </Button>\r\n                  <Button asChild variant=\"outline\" size=\"sm\">\r\n                    <Link href={`/t/${tenantSlug}/status`}>Preview status</Link>\r\n                  </Button>\r\n                  <Button asChild variant=\"outline\" size=\"sm\">\r\n                    <Link href={`/t/${tenantSlug}/book`}>Preview booking</Link>\r\n                  </Button>\r\n                  <Button asChild variant=\"outline\" size=\"sm\">\r\n                    <Link href={`/t/${tenantSlug}/services`}>Preview services</Link>\r\n                  </Button>\r\n                  <Button asChild variant=\"outline\" size=\"sm\">\r\n                    <Link href={`/t/${tenantSlug}/parts`}>Preview parts</Link>\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n              <Button variant=\"outline\" onClick={() => void onSave()} disabled={Boolean(savingDisabledReason) || loading || saving}>\r\n                {saving ? \"Saving...\" : \"Save\"}\r\n              </Button>\r\n            </div>\r\n          </div>\r\n\r\n          {loading ? <SettingsSkeleton /> : sectionNode}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","export type RepairBuddyNavItem = {\r\n  key: string;\r\n  label: string;\r\n  description?: string;\r\n};\r\n\r\nexport const repairBuddyNav: RepairBuddyNavItem[] = [\r\n  { key: \"company-profile\", label: \"Operations\" },\r\n  { key: \"general\", label: \"General\" },\r\n  { key: \"currency\", label: \"Currency\" },\r\n  { key: \"invoices-reports\", label: \"Invoices & Reports\" },\r\n  { key: \"job-statuses\", label: \"Statuses\" },\r\n  { key: \"payments\", label: \"Payments\" },\r\n  { key: \"reviews\", label: \"Reviews\" },\r\n  { key: \"estimates\", label: \"Estimates\" },\r\n  { key: \"my-account\", label: \"My Account\" },\r\n  { key: \"devices-brands\", label: \"Devices & Brands\" },\r\n  { key: \"sms\", label: \"SMS\" },\r\n  { key: \"taxes\", label: \"Taxes\" },\r\n  { key: \"service-settings\", label: \"Service Settings\" },\r\n  { key: \"time-logs\", label: \"Time Logs\" },\r\n  { key: \"maintenance-reminders\", label: \"Maintenance Reminders\" },\r\n  { key: \"styling-labels\", label: \"Styling & Labels\" },\r\n  { key: \"signature-workflow\", label: \"Signature Workflow\" },\r\n  { key: \"booking\", label: \"Booking\" },\r\n];\r\n","import type { RepairBuddySettingsDraft } from \"@/app/app/[tenant]/settings/_components/repairbuddy/types\";\r\n\r\nexport const defaultRepairBuddyDraft: RepairBuddySettingsDraft = {\r\n  general: {\r\n    businessName: \"\",\r\n    businessPhone: \"\",\r\n    businessAddress: \"\",\r\n    logoUrl: \"\",\r\n    email: \"\",\r\n    displayName: \"\",\r\n    primaryContactName: \"\",\r\n    registrationNumber: \"\",\r\n    caseNumberPrefix: \"RB\",\r\n    caseNumberLength: 6,\r\n    emailCustomer: true,\r\n    attachPdf: true,\r\n    nextServiceDateEnabled: false,\r\n    gdprAcceptanceText: \"I agree to the privacy policy.\",\r\n    gdprLinkLabel: \"Privacy policy\",\r\n    gdprLinkUrl: \"\",\r\n    defaultCountry: \"US\",\r\n    disableStatusCheckBySerial: false,\r\n  },\r\n  currency: {\r\n    currency: \"USD\",\r\n    currencyPosition: \"left\",\r\n    thousandSeparator: \",\",\r\n    decimalSeparator: \".\",\r\n    numberOfDecimals: 2,\r\n  },\r\n  invoicesReports: {\r\n    addQrCodeToInvoice: true,\r\n    invoiceFooterMessage: \"Thank you for your business.\",\r\n    invoicePrintType: \"standard\",\r\n    displayPickupDate: true,\r\n    displayDeliveryDate: true,\r\n    displayNextServiceDate: false,\r\n    invoiceDisclaimerTerms: \"\",\r\n    repairOrderType: \"standard\",\r\n    termsUrl: \"\",\r\n    repairOrderPrintSize: \"a4\",\r\n    displayBusinessAddressDetails: true,\r\n    displayCustomerEmailAddressDetails: true,\r\n    repairOrderFooterMessage: \"\",\r\n  },\r\n  jobStatuses: {\r\n    statuses: [\r\n      {\r\n        id: \"status_received\",\r\n        name: \"Received\",\r\n        slug: \"received\",\r\n        description: \"Job received\",\r\n        invoiceLabel: \"Received\",\r\n        manageWooStock: false,\r\n        status: \"active\",\r\n      },\r\n      {\r\n        id: \"status_completed\",\r\n        name: \"Completed\",\r\n        slug: \"completed\",\r\n        description: \"Job completed\",\r\n        invoiceLabel: \"Completed\",\r\n        manageWooStock: false,\r\n        status: \"active\",\r\n      },\r\n      {\r\n        id: \"status_cancelled\",\r\n        name: \"Cancelled\",\r\n        slug: \"cancelled\",\r\n        description: \"Job cancelled\",\r\n        invoiceLabel: \"Cancelled\",\r\n        manageWooStock: false,\r\n        status: \"active\",\r\n      },\r\n    ],\r\n    completedStatusId: \"status_completed\",\r\n    cancelledStatusId: \"status_cancelled\",\r\n  },\r\n  payments: {\r\n    statuses: [\r\n      { id: \"pay_unpaid\", name: \"Unpaid\", slug: \"unpaid\", description: \"\", status: \"active\" },\r\n      { id: \"pay_paid\", name: \"Paid\", slug: \"paid\", description: \"\", status: \"active\" },\r\n      { id: \"pay_refunded\", name: \"Refunded\", slug: \"refunded\", description: \"\", status: \"active\" },\r\n    ],\r\n    paymentMethods: {\r\n      cash: true,\r\n      card: true,\r\n      bankTransfer: false,\r\n      paypal: false,\r\n      other: false,\r\n    },\r\n  },\r\n  reviews: {\r\n    requestFeedbackBySms: false,\r\n    requestFeedbackByEmail: true,\r\n    feedbackPage: \"\",\r\n    sendReviewRequestIfJobStatusId: \"status_completed\",\r\n    autoFeedbackRequestIntervalDays: 2,\r\n    emailSubject: \"How did we do?\",\r\n    emailMessageTemplate: \"Thanks for choosing us. Please leave feedback.\",\r\n    smsMessageTemplate: \"Thanks for your visit. Please leave feedback.\",\r\n  },\r\n  estimates: {\r\n    customerEmailSubject: \"Your estimate\",\r\n    customerEmailBody: \"Please review your estimate.\",\r\n    disableEstimates: false,\r\n    bookingQuoteSendToJobs: true,\r\n    adminApproveRejectEmailSubject: \"Estimate decision\",\r\n    adminApproveRejectEmailBody: \"An estimate was approved or rejected.\",\r\n  },\r\n  myAccount: {\r\n    disableBooking: false,\r\n    disableEstimates: false,\r\n    disableReviews: false,\r\n    bookingFormType: \"simple\",\r\n  },\r\n  devicesBrands: {\r\n    enablePinCodeField: false,\r\n    showPinCodeInDocuments: false,\r\n    useWooProductsAsDevices: false,\r\n    labels: {\r\n      note: \"Note\",\r\n      pin: \"PIN\",\r\n      device: \"Device\",\r\n      deviceBrand: \"Brand\",\r\n      deviceType: \"Type\",\r\n      imei: \"IMEI\",\r\n    },\r\n    additionalDeviceFields: [],\r\n    pickupDeliveryEnabled: false,\r\n    pickupCharge: \"0\",\r\n    deliveryCharge: \"0\",\r\n    rentalEnabled: false,\r\n    rentalPerDay: \"0\",\r\n    rentalPerWeek: \"0\",\r\n  },\r\n  pagesSetup: {\r\n    dashboardPage: \"\",\r\n    statusCheckPage: \"\",\r\n    feedbackPage: \"\",\r\n    bookingPage: \"\",\r\n    servicesPage: \"\",\r\n    partsPage: \"\",\r\n    redirectAfterLogin: \"\",\r\n    enableRegistration: true,\r\n  },\r\n  sms: {\r\n    activateSmsForSelectiveStatuses: false,\r\n    gateway: \"twilio\",\r\n    gatewayAccountSid: \"\",\r\n    gatewayAuthToken: \"\",\r\n    gatewayFromNumber: \"\",\r\n    sendWhenStatusChangedToIds: [\"status_received\", \"status_completed\"],\r\n    testNumber: \"\",\r\n    testMessage: \"Test message\",\r\n  },\r\n  taxes: {\r\n    enableTaxes: false,\r\n    taxes: [\r\n      { id: \"tax_none\", name: \"No tax\", ratePercent: 0, status: \"active\" },\r\n      { id: \"tax_standard\", name: \"Standard\", ratePercent: 20, status: \"active\" },\r\n    ],\r\n    defaultTaxId: \"tax_none\",\r\n    invoiceAmounts: \"exclusive\",\r\n  },\r\n  serviceSettings: {\r\n    sidebarDescription: \"\",\r\n    disableBookingOnServicePage: false,\r\n    bookingFormType: \"simple\",\r\n  },\r\n  timeLogs: {\r\n    disableTimeLog: false,\r\n    defaultTaxIdForHours: \"tax_none\",\r\n    enableTimeLogForStatusIds: [],\r\n    activities: \"Repair\\nDiagnostic\\nTesting\\nCleaning\\nConsultation\\nOther\",\r\n  },\r\n  maintenanceReminders: {\r\n    reminders: [\r\n      { id: \"reminder_1\", name: \"Maintenance reminder\", intervalDays: 180, status: \"active\" },\r\n    ],\r\n  },\r\n  stylingLabels: {\r\n    labels: {\r\n      delivery: \"Delivery\",\r\n      pickup: \"Pickup\",\r\n      nextService: \"Next service\",\r\n      caseNumber: \"Case number\",\r\n    },\r\n    colors: {\r\n      primary: \"#2563eb\",\r\n      secondary: \"#f97316\",\r\n    },\r\n  },\r\n  signatureWorkflow: {\r\n    pickup: {\r\n      enabled: false,\r\n      triggerStatusId: \"status_completed\",\r\n      templates: {\r\n        emailSubject: \"Pickup signature requested\",\r\n        emailTemplate: \"Please sign the pickup form.\",\r\n        smsText: \"Please sign the pickup form.\",\r\n      },\r\n      statusAfterSubmissionId: \"status_completed\",\r\n    },\r\n    delivery: {\r\n      enabled: false,\r\n      triggerStatusId: \"status_completed\",\r\n      templates: {\r\n        emailSubject: \"Delivery signature requested\",\r\n        emailTemplate: \"Please sign the delivery form.\",\r\n        smsText: \"Please sign the delivery form.\",\r\n      },\r\n      statusAfterSubmissionId: \"status_completed\",\r\n    },\r\n  },\r\n  booking: {\r\n    customerEmailSubject: \"Booking confirmation\",\r\n    customerEmailBody: \"Thanks for your booking.\",\r\n    adminEmailSubject: \"New booking\",\r\n    adminEmailBody: \"A new booking has been received.\",\r\n    publicBookingMode: \"ungrouped\",\r\n    publicBookingUiStyle: \"wizard\",\r\n    sendBookingQuoteToJobs: true,\r\n    customerCreationEmailBehavior: \"send_login_credentials\",\r\n    turnOffOtherDeviceBrand: false,\r\n    turnOffOtherService: false,\r\n    turnOffServicePrice: false,\r\n    turnOffIdImeiInBooking: false,\r\n    defaultType: \"\",\r\n    defaultBrand: \"\",\r\n    defaultDevice: \"\",\r\n  },\r\n};\r\n","\"use client\";\r\n\r\nimport React, { useCallback, useEffect, useMemo, useState } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { defaultRepairBuddyDraft } from \"@/app/app/[tenant]/settings/_components/repairbuddy/defaults\";\r\nimport type { RepairBuddySettingsDraft } from \"@/app/app/[tenant]/settings/_components/repairbuddy/types\";\r\nimport { ApiError, apiFetch } from \"@/lib/api\";\r\nimport { getRepairBuddySettings, updateRepairBuddySettings } from \"@/lib/repairbuddy-settings\";\r\nimport { getSetup, updateSetup } from \"@/lib/setup\";\r\nimport type { Tenant } from \"@/lib/types\";\r\n\r\nexport const savingDisabledReason = \"\";\r\n\r\nfunction normalizeAdditionalDeviceFields(draft: RepairBuddySettingsDraft): RepairBuddySettingsDraft {\r\n  const db = draft.devicesBrands;\r\n  if (!db || !Array.isArray(db.additionalDeviceFields)) return draft;\r\n\r\n  const nextFields = db.additionalDeviceFields\r\n    .map((raw) => {\r\n      if (!raw || typeof raw !== \"object\") return null;\r\n      const r = raw as Record<string, unknown>;\r\n      const id = typeof r.id === \"string\" && r.id.trim() ? r.id.trim() : `device_field_${Date.now()}_${Math.random().toString(16).slice(2)}`;\r\n      const label = typeof r.label === \"string\" ? r.label : \"\";\r\n      if (!label.trim()) return null;\r\n\r\n      const type = \"text\" as const;\r\n      const displayInBookingForm = typeof r.displayInBookingForm === \"boolean\" ? r.displayInBookingForm : true;\r\n      const displayInInvoice = typeof r.displayInInvoice === \"boolean\" ? r.displayInInvoice : true;\r\n      const displayForCustomer = typeof r.displayForCustomer === \"boolean\" ? r.displayForCustomer : true;\r\n\r\n      return {\r\n        id,\r\n        label: label.trim(),\r\n        type,\r\n        displayInBookingForm,\r\n        displayInInvoice,\r\n        displayForCustomer,\r\n      };\r\n    })\r\n    .filter((x): x is NonNullable<typeof x> => Boolean(x));\r\n\r\n  return {\r\n    ...draft,\r\n    devicesBrands: {\r\n      ...db,\r\n      additionalDeviceFields: nextFields,\r\n    },\r\n  };\r\n}\r\n\r\nfunction formatTenantAddress(tenant: Tenant): string {\r\n  const addr = (tenant.billing_address_json ?? {}) as Record<string, unknown>;\r\n  const parts: string[] = [];\r\n  if (typeof addr.line1 === \"string\" && addr.line1.trim()) parts.push(addr.line1.trim());\r\n  if (typeof addr.line2 === \"string\" && addr.line2.trim()) parts.push(addr.line2.trim());\r\n  if (typeof addr.city === \"string\" && addr.city.trim()) parts.push(addr.city.trim());\r\n  if (typeof addr.state === \"string\" && addr.state.trim()) parts.push(addr.state.trim());\r\n  if (typeof addr.postal_code === \"string\" && addr.postal_code.trim()) parts.push(addr.postal_code.trim());\r\n  const country = typeof tenant.billing_country === \"string\" ? tenant.billing_country.trim().toUpperCase() : \"\";\r\n  if (country) parts.push(country);\r\n  return parts.join(\", \");\r\n}\r\n\r\nfunction applyTenantIdentityToDraft(draft: RepairBuddySettingsDraft, tenant: Tenant): RepairBuddySettingsDraft {\r\n  const setupState = (tenant.setup_state ?? {}) as Record<string, unknown>;\r\n  const logoUrlFromState = (setupState.identity as Record<string, unknown> | undefined)?.logo_url;\r\n  const identityFromState = (setupState.identity ?? {}) as Record<string, unknown>;\r\n  const logoUrl =\r\n    typeof tenant.logo_url === \"string\"\r\n      ? tenant.logo_url\r\n      : typeof logoUrlFromState === \"string\"\r\n        ? logoUrlFromState\r\n        : \"\";\r\n  const billingCountry = typeof tenant.billing_country === \"string\" ? tenant.billing_country.trim().toUpperCase() : \"\";\r\n\r\n  return {\r\n    ...draft,\r\n    general: {\r\n      ...draft.general,\r\n      businessName: tenant.name ?? \"\",\r\n      businessPhone: tenant.contact_phone ?? \"\",\r\n      email: tenant.contact_email ?? \"\",\r\n      displayName: typeof identityFromState.display_name === \"string\" ? identityFromState.display_name : draft.general.displayName,\r\n      primaryContactName:\r\n        typeof identityFromState.primary_contact_name === \"string\" ? identityFromState.primary_contact_name : draft.general.primaryContactName,\r\n      registrationNumber:\r\n        typeof identityFromState.registration_number === \"string\" ? identityFromState.registration_number : draft.general.registrationNumber,\r\n      businessAddress: formatTenantAddress(tenant),\r\n      logoUrl,\r\n      defaultCountry: billingCountry || draft.general.defaultCountry,\r\n    },\r\n  };\r\n}\r\n\r\nexport function useRepairBuddyDraft(tenantSlug?: string) {\r\n  const router = useRouter();\r\n  const [draft, setDraft] = useState<RepairBuddySettingsDraft>(defaultRepairBuddyDraft);\r\n  const [loading, setLoading] = useState(false);\r\n  const [saving, setSaving] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [tenant, setTenant] = useState<Tenant | null>(null);\r\n\r\n  const updateSection = useCallback(<K extends keyof RepairBuddySettingsDraft>(key: K, patch: Partial<RepairBuddySettingsDraft[K]>) => {\r\n    setDraft((prev) => ({\r\n      ...prev,\r\n      [key]: {\r\n        ...prev[key],\r\n        ...patch,\r\n      },\r\n    }));\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    let alive = true;\r\n\r\n    async function load() {\r\n      if (!tenantSlug) return;\r\n      setLoading(true);\r\n      setError(null);\r\n      try {\r\n        const [settingsRes, setupRes, jobStatusesRes] = await Promise.all([\r\n          getRepairBuddySettings(String(tenantSlug)),\r\n          getSetup(String(tenantSlug)),\r\n          apiFetch<{ job_statuses: Array<{ id: number; slug: string; label: string; invoice_label?: string | null; is_active?: boolean }> }>(\r\n            `/api/${String(tenantSlug)}/app/repairbuddy/job-statuses`\r\n          ),\r\n        ]);\r\n        if (!alive) return;\r\n\r\n        setTenant(setupRes.tenant);\r\n\r\n        const settingsFromApi = settingsRes.settings && typeof settingsRes.settings === \"object\" ? settingsRes.settings : null;\r\n        const merged: RepairBuddySettingsDraft = {\r\n          ...defaultRepairBuddyDraft,\r\n          ...(settingsFromApi ?? {}),\r\n          general: {\r\n            ...defaultRepairBuddyDraft.general,\r\n            ...((settingsFromApi?.general ?? {}) as RepairBuddySettingsDraft[\"general\"]),\r\n          },\r\n        };\r\n\r\n        const apiJobStatuses = Array.isArray(jobStatusesRes?.job_statuses) ? jobStatusesRes.job_statuses : [];\r\n        if (apiJobStatuses.length > 0) {\r\n          merged.jobStatuses = {\r\n            ...(merged.jobStatuses ?? defaultRepairBuddyDraft.jobStatuses),\r\n            statuses: apiJobStatuses.map((s) => {\r\n              const slug = typeof s.slug === \"string\" ? s.slug : \"\";\r\n              const label = typeof s.label === \"string\" ? s.label : slug;\r\n              const invoiceLabel = typeof s.invoice_label === \"string\" ? s.invoice_label : label;\r\n\r\n              return {\r\n                id: `status_${slug}`,\r\n                name: label,\r\n                slug,\r\n                description: \"\",\r\n                invoiceLabel,\r\n                manageWooStock: false,\r\n                status: s.is_active === false ? \"inactive\" : \"active\",\r\n              };\r\n            }),\r\n            completedStatusId: merged.jobStatuses?.completedStatusId ?? defaultRepairBuddyDraft.jobStatuses.completedStatusId,\r\n            cancelledStatusId: merged.jobStatuses?.cancelledStatusId ?? defaultRepairBuddyDraft.jobStatuses.cancelledStatusId,\r\n          };\r\n        }\r\n\r\n        const shouldHydrateTimeLogStatuses =\r\n          !merged.timeLogs ||\r\n          !Array.isArray(merged.timeLogs.enableTimeLogForStatusIds) ||\r\n          merged.timeLogs.enableTimeLogForStatusIds.length === 0;\r\n\r\n        const cancelledStatusId = merged.jobStatuses?.cancelledStatusId;\r\n        if (shouldHydrateTimeLogStatuses && merged.jobStatuses && Array.isArray(merged.jobStatuses.statuses)) {\r\n          const enabled = merged.jobStatuses.statuses\r\n            .filter((s) => s.status === \"active\")\r\n            .map((s) => s.id)\r\n            .filter((id) => (typeof cancelledStatusId === \"string\" && cancelledStatusId ? id !== cancelledStatusId : true));\r\n\r\n          merged.timeLogs = {\r\n            ...merged.timeLogs,\r\n            enableTimeLogForStatusIds: enabled,\r\n          };\r\n        }\r\n\r\n        setDraft(applyTenantIdentityToDraft(normalizeAdditionalDeviceFields(merged), setupRes.tenant));\r\n      } catch (e) {\r\n        if (!alive) return;\r\n\r\n        if (e instanceof ApiError && e.status === 428 && tenantSlug) {\r\n          const next = `/app/${String(tenantSlug)}/business-settings`;\r\n          router.replace(`/app/${String(tenantSlug)}/branches/select?next=${encodeURIComponent(next)}`);\r\n          return;\r\n        }\r\n\r\n        setError(e instanceof Error ? e.message : \"Failed to load business settings.\");\r\n      } finally {\r\n        if (!alive) return;\r\n        setLoading(false);\r\n      }\r\n    }\r\n\r\n    void load();\r\n\r\n    return () => {\r\n      alive = false;\r\n    };\r\n  }, [router, tenantSlug]);\r\n\r\n  const reset = useCallback(() => {\r\n    setDraft(defaultRepairBuddyDraft);\r\n  }, []);\r\n\r\n  const save = useCallback(async () => {\r\n    if (!tenantSlug) return;\r\n    setSaving(true);\r\n    setError(null);\r\n    try {\r\n      const setupRes = await getSetup(String(tenantSlug));\r\n\r\n      const nextTenantCurrency = draft.currency.currency.trim().toUpperCase();\r\n\r\n      const nextCountry = draft.general.defaultCountry.trim().toUpperCase();\r\n      const addressInput = draft.general.businessAddress.trim();\r\n      const trailingCountry = nextCountry ? new RegExp(`,\\\\s*${nextCountry}$`, \"i\") : null;\r\n      const addressLine1 = trailingCountry ? addressInput.replace(trailingCountry, \"\").trim() : addressInput;\r\n\r\n      const existingAddr = (setupRes.tenant.billing_address_json ?? {}) as Record<string, unknown>;\r\n      const nextAddr = addressLine1 ? { ...existingAddr, line1: addressLine1 } : null;\r\n\r\n      const state = (setupRes.tenant.setup_state ?? {}) as Record<string, unknown>;\r\n      const identity = (state.identity ?? {}) as Record<string, unknown>;\r\n      const nextState: Record<string, unknown> = {\r\n        ...state,\r\n        identity: {\r\n          ...identity,\r\n          display_name: draft.general.displayName || null,\r\n          primary_contact_name: draft.general.primaryContactName || null,\r\n          registration_number: draft.general.registrationNumber || null,\r\n          logo_url: draft.general.logoUrl,\r\n        },\r\n      };\r\n\r\n      const setupUpdateRes = await updateSetup(String(tenantSlug), {\r\n        name: draft.general.businessName,\r\n        contact_email: draft.general.email || null,\r\n        contact_phone: draft.general.businessPhone || null,\r\n        billing_country: nextCountry || null,\r\n        billing_address_json: nextAddr,\r\n        currency: nextTenantCurrency.length === 3 ? nextTenantCurrency : null,\r\n        setup_state: nextState,\r\n      });\r\n\r\n      setTenant(setupUpdateRes.tenant);\r\n\r\n      const res = await updateRepairBuddySettings(String(tenantSlug), draft);\r\n      if (res.settings) {\r\n        setDraft(applyTenantIdentityToDraft(res.settings, setupUpdateRes.tenant));\r\n      }\r\n    } catch (e) {\r\n      if (e instanceof ApiError) {\r\n        setError(e.message);\r\n      } else {\r\n        setError(e instanceof Error ? e.message : \"Failed to save business settings.\");\r\n      }\r\n      throw e;\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  }, [draft, tenantSlug]);\r\n\r\n  const isMock = false;\r\n\r\n  return useMemo(\r\n    () => ({\r\n      draft,\r\n      setDraft,\r\n      updateSection,\r\n      reset,\r\n      save,\r\n      isMock,\r\n      loading,\r\n      saving,\r\n      error,\r\n      tenant,\r\n      savingDisabledReason,\r\n    }),\r\n    [draft, error, loading, reset, save, saving, tenant, updateSection],\r\n  );\r\n}\r\n","\"use client\";\r\n\r\nimport React, { useEffect, useMemo, useState } from \"react\";\r\nimport { ApiError } from \"@/lib/api\";\r\nimport type { Tenant } from \"@/lib/types\";\r\nimport { Alert } from \"@/components/ui/Alert\";\r\nimport { Button } from \"@/components/ui/Button\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/Card\";\r\nimport { Input } from \"@/components/ui/Input\";\r\nimport { getSetup, updateSetup } from \"@/lib/setup\";\r\n\r\ntype SettingsPayload = {\r\n  tenant: Tenant;\r\n  setup: {\r\n    completed_at?: string | null;\r\n    step?: string | null;\r\n    state?: Record<string, unknown> | null;\r\n  };\r\n};\r\n\r\nconst fallbackTimezones = [\r\n  \"UTC\",\r\n  \"Europe/London\",\r\n  \"Europe/Berlin\",\r\n  \"Europe/Paris\",\r\n  \"Africa/Cairo\",\r\n  \"Asia/Dubai\",\r\n  \"Asia/Riyadh\",\r\n  \"Asia/Kolkata\",\r\n  \"Asia/Singapore\",\r\n  \"Asia/Tokyo\",\r\n  \"Australia/Sydney\",\r\n  \"America/New_York\",\r\n  \"America/Chicago\",\r\n  \"America/Denver\",\r\n  \"America/Los_Angeles\",\r\n];\r\n\r\nexport function CompanyProfileSection({ tenantSlug }: { tenantSlug: string }) {\r\n  const [loading, setLoading] = useState(true);\r\n  const [saving, setSaving] = useState(false);\r\n  const [uploadingLogo, setUploadingLogo] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [status, setStatus] = useState<string | null>(null);\r\n\r\n  const [data, setData] = useState<SettingsPayload | null>(null);\r\n\r\n  const [supportEmail, setSupportEmail] = useState(\"\");\r\n  const [supportPhone, setSupportPhone] = useState(\"\");\r\n  const [website, setWebsite] = useState(\"\");\r\n  const [documentFooter, setDocumentFooter] = useState(\"\");\r\n\r\n  const [timezone, setTimezone] = useState(\"UTC\");\r\n  const [workingHours, setWorkingHours] = useState(\"Mon–Fri 09:00–17:00\");\r\n  const [defaultLaborRate, setDefaultLaborRate] = useState(\"\");\r\n  const [warrantyTerms, setWarrantyTerms] = useState(\"\");\r\n  const [notifyStatusChange, setNotifyStatusChange] = useState(true);\r\n  const [notifyInvoiceCreated, setNotifyInvoiceCreated] = useState(false);\r\n\r\n  const timezoneOptions = useMemo(() => {\r\n    try {\r\n      const anyIntl = Intl as unknown as { supportedValuesOf?: (key: string) => string[] };\r\n      const values = typeof anyIntl.supportedValuesOf === \"function\" ? anyIntl.supportedValuesOf(\"timeZone\") : null;\r\n      return Array.isArray(values) && values.length > 0 ? values : fallbackTimezones;\r\n    } catch {\r\n      return fallbackTimezones;\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    let alive = true;\r\n\r\n    async function load() {\r\n      try {\r\n        setError(null);\r\n        setStatus(null);\r\n        setLoading(true);\r\n\r\n        const res = (await getSetup(String(tenantSlug))) as SettingsPayload;\r\n        if (!alive) return;\r\n\r\n        setData(res);\r\n\r\n        const t = res.tenant;\r\n        setTimezone(t.timezone ?? \"UTC\");\r\n\r\n        const state = (res.setup?.state ?? {}) as Record<string, unknown>;\r\n        const branding = (state.branding ?? {}) as Record<string, unknown>;\r\n        const operations = (state.operations ?? {}) as Record<string, unknown>;\r\n\r\n        setSupportEmail(typeof branding.support_email === \"string\" ? branding.support_email : \"\");\r\n        setSupportPhone(typeof branding.support_phone === \"string\" ? branding.support_phone : \"\");\r\n        setWebsite(typeof branding.website === \"string\" ? branding.website : \"\");\r\n        setDocumentFooter(typeof branding.document_footer === \"string\" ? branding.document_footer : \"\");\r\n\r\n        setWorkingHours(typeof operations.working_hours === \"string\" ? operations.working_hours : \"Mon–Fri 09:00–17:00\");\r\n        setDefaultLaborRate(typeof operations.default_labor_rate === \"string\" ? operations.default_labor_rate : \"\");\r\n        setWarrantyTerms(typeof operations.warranty_terms === \"string\" ? operations.warranty_terms : \"\");\r\n        setNotifyStatusChange(typeof operations.notify_status_change === \"boolean\" ? operations.notify_status_change : true);\r\n        setNotifyInvoiceCreated(typeof operations.notify_invoice_created === \"boolean\" ? operations.notify_invoice_created : false);\r\n      } catch (e) {\r\n        if (!alive) return;\r\n        setError(e instanceof Error ? e.message : \"Failed to load settings.\");\r\n        setData(null);\r\n      } finally {\r\n        if (!alive) return;\r\n        setLoading(false);\r\n      }\r\n    }\r\n\r\n    void load();\r\n\r\n    return () => {\r\n      alive = false;\r\n    };\r\n  }, [tenantSlug]);\r\n\r\n  const initial = data?.tenant;\r\n  const initialSetupState = useMemo(() => (data?.setup?.state ?? null) as Record<string, unknown> | null, [data?.setup?.state]);\r\n\r\n  const hasChanges = useMemo(() => {\r\n    if (!initial) return false;\r\n\r\n    const s = (initialSetupState ?? {}) as Record<string, unknown>;\r\n    const branding = (s.branding ?? {}) as Record<string, unknown>;\r\n    const operations = (s.operations ?? {}) as Record<string, unknown>;\r\n\r\n    return (\r\n      (timezone.trim() || \"\") !== ((initial.timezone ?? \"\").trim() || \"\") ||\r\n      (supportEmail.trim() || \"\") !== (typeof branding.support_email === \"string\" ? branding.support_email.trim() : \"\") ||\r\n      (supportPhone.trim() || \"\") !== (typeof branding.support_phone === \"string\" ? branding.support_phone.trim() : \"\") ||\r\n      (website.trim() || \"\") !== (typeof branding.website === \"string\" ? branding.website.trim() : \"\") ||\r\n      (documentFooter.trim() || \"\") !== (typeof branding.document_footer === \"string\" ? branding.document_footer.trim() : \"\") ||\r\n      (workingHours.trim() || \"\") !== (typeof operations.working_hours === \"string\" ? operations.working_hours.trim() : \"\") ||\r\n      (defaultLaborRate.trim() || \"\") !== (typeof operations.default_labor_rate === \"string\" ? operations.default_labor_rate.trim() : \"\") ||\r\n      (warrantyTerms.trim() || \"\") !== (typeof operations.warranty_terms === \"string\" ? operations.warranty_terms.trim() : \"\") ||\r\n      notifyStatusChange !== (typeof operations.notify_status_change === \"boolean\" ? operations.notify_status_change : true) ||\r\n      notifyInvoiceCreated !== (typeof operations.notify_invoice_created === \"boolean\" ? operations.notify_invoice_created : false)\r\n    );\r\n  }, [\r\n    defaultLaborRate,\r\n    documentFooter,\r\n    initial,\r\n    initialSetupState,\r\n    notifyInvoiceCreated,\r\n    notifyStatusChange,\r\n    supportEmail,\r\n    supportPhone,\r\n    timezone,\r\n    warrantyTerms,\r\n    website,\r\n    workingHours,\r\n  ]);\r\n\r\n  const onUploadLogo = React.useCallback(\r\n    async (file: File) => {\r\n      setUploadingLogo(true);\r\n      setError(null);\r\n      try {\r\n        const payload = await updateSetup(String(tenantSlug), { logo: file });\r\n        setData((prev) =>\r\n          prev\r\n            ? {\r\n                ...prev,\r\n                tenant: payload.tenant,\r\n              }\r\n            : prev,\r\n        );\r\n      } catch (e) {\r\n        setError(e instanceof Error ? e.message : \"Failed to upload logo.\");\r\n      } finally {\r\n        setUploadingLogo(false);\r\n      }\r\n    },\r\n    [tenantSlug],\r\n  );\r\n\r\n  async function onSave(e: React.FormEvent) {\r\n    e.preventDefault();\r\n    setError(null);\r\n    setStatus(null);\r\n\r\n    if (!timezone.trim()) {\r\n      setError(\"Timezone is required.\");\r\n      return;\r\n    }\r\n\r\n    setSaving(true);\r\n\r\n    try {\r\n      const prevSetupState = (data?.setup?.state ?? {}) as Record<string, unknown>;\r\n      const nextSetupState: Record<string, unknown> = {\r\n        ...prevSetupState,\r\n        branding: {\r\n          support_email: supportEmail.trim() || null,\r\n          support_phone: supportPhone.trim() || null,\r\n          website: website.trim() || null,\r\n          document_footer: documentFooter.trim() || null,\r\n        },\r\n        operations: {\r\n          working_hours: workingHours.trim() || null,\r\n          default_labor_rate: defaultLaborRate.trim() || null,\r\n          warranty_terms: warrantyTerms.trim() || null,\r\n          notify_status_change: Boolean(notifyStatusChange),\r\n          notify_invoice_created: Boolean(notifyInvoiceCreated),\r\n        },\r\n      };\r\n\r\n      const payload = await updateSetup(String(tenantSlug), {\r\n        timezone: timezone.trim() || null,\r\n        language: \"en\",\r\n        setup_state: nextSetupState,\r\n      });\r\n\r\n      setData((prev) =>\r\n        prev\r\n          ? {\r\n              ...prev,\r\n              tenant: payload.tenant,\r\n              setup: {\r\n                ...prev.setup,\r\n                state: nextSetupState,\r\n              },\r\n            }\r\n          : prev,\r\n      );\r\n\r\n      setStatus(\"Settings saved.\");\r\n    } catch (err) {\r\n      if (err instanceof ApiError) {\r\n        setError(err.message);\r\n      } else {\r\n        setError(\"Failed to save settings.\");\r\n      }\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      {error ? (\r\n        <Alert variant=\"danger\" title=\"Could not load or save settings\">\r\n          {error}\r\n        </Alert>\r\n      ) : null}\r\n\r\n      {status ? (\r\n        <Alert variant=\"success\" title=\"Success\">\r\n          {status}\r\n        </Alert>\r\n      ) : null}\r\n\r\n      {loading ? <div className=\"text-sm text-zinc-500\">Loading settings...</div> : null}\r\n\r\n      {!loading && data ? (\r\n        <form className=\"space-y-6\" onSubmit={onSave}>\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Branding</CardTitle>\r\n              <CardDescription>Customer-facing visuals and contact information.</CardDescription>\r\n            </CardHeader>\r\n            <CardContent className=\"space-y-4\">\r\n              <div className=\"grid gap-4 sm:grid-cols-2\">\r\n                <div>\r\n                  <label className=\"text-sm font-medium text-[var(--rb-text)]\">Logo</label>\r\n                  <div className=\"mt-2 flex items-center gap-3\">\r\n                    {data?.tenant?.logo_url ? (\r\n                      // eslint-disable-next-line @next/next/no-img-element\r\n                      <img\r\n                        src={data.tenant.logo_url}\r\n                        alt=\"Logo\"\r\n                        className=\"h-10 w-10 rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white object-contain\"\r\n                      />\r\n                    ) : (\r\n                      <div className=\"h-10 w-10 rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white\" />\r\n                    )}\r\n\r\n                    <div className=\"flex-1\">\r\n                      <input\r\n                        type=\"file\"\r\n                        accept=\"image/png,image/jpeg,image/webp\"\r\n                        disabled={uploadingLogo}\r\n                        onChange={(e) => {\r\n                          const file = e.target.files && e.target.files[0] ? e.target.files[0] : null;\r\n                          if (file) {\r\n                            void onUploadLogo(file);\r\n                          }\r\n                        }}\r\n                        className=\"block w-full text-sm text-zinc-700 file:mr-3 file:rounded-[var(--rb-radius-sm)] file:border-0 file:bg-[var(--rb-surface-muted)] file:px-3 file:py-2 file:text-sm file:font-medium file:text-[var(--rb-text)] hover:file:bg-[color:color-mix(in_srgb,var(--rb-surface-muted),black_4%)]\"\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"mt-2 text-xs text-zinc-500\">{uploadingLogo ? \"Uploading...\" : \"PNG/JPG/WEBP up to 5MB\"}</div>\r\n                </div>\r\n\r\n                <div className=\"sm:col-span-2\">\r\n                  <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Customer-facing contact (optional)</div>\r\n                  <div className=\"mt-2 grid gap-3 sm:grid-cols-2\">\r\n                    <Input value={supportEmail} onChange={(e) => setSupportEmail(e.target.value)} placeholder=\"Public support email\" disabled={saving} />\r\n                    <Input value={supportPhone} onChange={(e) => setSupportPhone(e.target.value)} placeholder=\"Public support phone\" disabled={saving} />\r\n                    <div className=\"sm:col-span-2\">\r\n                      <Input value={website} onChange={(e) => setWebsite(e.target.value)} placeholder=\"Website (optional)\" disabled={saving} />\r\n                    </div>\r\n                    <div className=\"sm:col-span-2\">\r\n                      <Input\r\n                        value={documentFooter}\r\n                        onChange={(e) => setDocumentFooter(e.target.value)}\r\n                        placeholder=\"Document footer text (optional)\"\r\n                        disabled={saving}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Operations</CardTitle>\r\n              <CardDescription>Defaults and notifications.</CardDescription>\r\n            </CardHeader>\r\n            <CardContent className=\"space-y-4\">\r\n              <div className=\"grid gap-4 sm:grid-cols-2\">\r\n                <div>\r\n                  <label className=\"text-sm font-medium text-[var(--rb-text)]\">Timezone</label>\r\n                  <div className=\"mt-1\">\r\n                    <Input value={timezone} onChange={(e) => setTimezone(e.target.value)} placeholder=\"UTC\" list=\"rb-timezones\" disabled={saving} />\r\n                    <datalist id=\"rb-timezones\">\r\n                      {timezoneOptions.map((tz) => (\r\n                        <option key={tz} value={tz} />\r\n                      ))}\r\n                    </datalist>\r\n                  </div>\r\n                  <div className=\"mt-2 text-xs text-zinc-500\">Example: UTC, Europe/Berlin, America/New_York</div>\r\n                </div>\r\n\r\n                <div>\r\n                  <label className=\"text-sm font-medium text-[var(--rb-text)]\">Language</label>\r\n                  <div className=\"mt-1\">\r\n                    <Input value=\"English (en)\" disabled />\r\n                  </div>\r\n                  <div className=\"mt-2 text-xs text-zinc-500\">Currently supported language: English</div>\r\n                </div>\r\n\r\n                <div className=\"sm:col-span-2\">\r\n                  <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Operations defaults (optional)</div>\r\n                  <div className=\"mt-2 grid gap-3 sm:grid-cols-2\">\r\n                    <div className=\"sm:col-span-2\">\r\n                      <Input\r\n                        value={workingHours}\r\n                        onChange={(e) => setWorkingHours(e.target.value)}\r\n                        placeholder=\"Working hours (e.g. Mon–Fri 09:00–17:00)\"\r\n                        disabled={saving}\r\n                      />\r\n                    </div>\r\n                    <Input\r\n                      value={defaultLaborRate}\r\n                      onChange={(e) => setDefaultLaborRate(e.target.value)}\r\n                      placeholder=\"Default labor rate (optional)\"\r\n                      disabled={saving}\r\n                    />\r\n                    <Input\r\n                      value={warrantyTerms}\r\n                      onChange={(e) => setWarrantyTerms(e.target.value)}\r\n                      placeholder=\"Default warranty terms (optional)\"\r\n                      disabled={saving}\r\n                    />\r\n                    <label className=\"sm:col-span-2 flex items-center gap-2 text-sm text-[var(--rb-text)]\">\r\n                      <input type=\"checkbox\" checked={notifyStatusChange} onChange={(e) => setNotifyStatusChange(e.target.checked)} disabled={saving} />\r\n                      Email on status change\r\n                    </label>\r\n                    <label className=\"sm:col-span-2 flex items-center gap-2 text-sm text-[var(--rb-text)]\">\r\n                      <input\r\n                        type=\"checkbox\"\r\n                        checked={notifyInvoiceCreated}\r\n                        onChange={(e) => setNotifyInvoiceCreated(e.target.checked)}\r\n                        disabled={saving}\r\n                      />\r\n                      Email on invoice created\r\n                    </label>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          <div className=\"flex items-center justify-end gap-2\">\r\n            <Button type=\"submit\" disabled={saving || !hasChanges}>\r\n              {saving ? \"Saving...\" : \"Save changes\"}\r\n            </Button>\r\n          </div>\r\n        </form>\r\n      ) : null}\r\n    </div>\r\n  );\r\n}\r\n","\"use client\";\r\n\r\nimport React from \"react\";\r\nimport { Input } from \"@/components/ui/Input\";\r\nimport { Select } from \"@/components/ui/Select\";\r\nimport { SectionShell } from \"@/app/app/[tenant]/settings/_components/repairbuddy/sections/SectionShell\";\r\nimport type { RepairBuddySettingsDraft } from \"@/app/app/[tenant]/settings/_components/repairbuddy/types\";\r\n\r\nexport function BookingSection({\r\n  draft,\r\n  updateBooking,\r\n}: {\r\n  draft: RepairBuddySettingsDraft;\r\n  updateBooking: (patch: Partial<RepairBuddySettingsDraft[\"booking\"]>) => void;\r\n}) {\r\n  const b = draft.booking;\r\n\r\n  return (\r\n    <SectionShell title=\"Booking\" description=\"Booking/quote templates and form defaults.\">\r\n      <div className=\"space-y-6\">\r\n        <div>\r\n          <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Email templates</div>\r\n          <div className=\"mt-2 grid gap-4 sm:grid-cols-2\">\r\n            <div className=\"sm:col-span-2 space-y-1\">\r\n              <label className=\"text-sm font-medium\">Customer email subject</label>\r\n              <Input value={b.customerEmailSubject} onChange={(e) => updateBooking({ customerEmailSubject: e.target.value })} />\r\n            </div>\r\n            <div className=\"sm:col-span-2 space-y-1\">\r\n              <label className=\"text-sm font-medium\">Customer email body</label>\r\n              <textarea\r\n                className=\"min-h-[140px] w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm\"\r\n                value={b.customerEmailBody}\r\n                onChange={(e) => updateBooking({ customerEmailBody: e.target.value })}\r\n              />\r\n            </div>\r\n\r\n            <div className=\"sm:col-span-2 space-y-1\">\r\n              <label className=\"text-sm font-medium\">Admin email subject</label>\r\n              <Input value={b.adminEmailSubject} onChange={(e) => updateBooking({ adminEmailSubject: e.target.value })} />\r\n            </div>\r\n            <div className=\"sm:col-span-2 space-y-1\">\r\n              <label className=\"text-sm font-medium\">Admin email body</label>\r\n              <textarea\r\n                className=\"min-h-[140px] w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm\"\r\n                value={b.adminEmailBody}\r\n                onChange={(e) => updateBooking({ adminEmailBody: e.target.value })}\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div>\r\n          <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Booking workflow</div>\r\n          <div className=\"mt-2 grid gap-2\">\r\n            <div className=\"grid gap-1 sm:max-w-[360px]\">\r\n              <label className=\"text-sm font-medium\">Public booking mode</label>\r\n              <Select value={b.publicBookingMode} onChange={(e) => updateBooking({ publicBookingMode: e.target.value as typeof b.publicBookingMode })}>\r\n                <option value=\"ungrouped\">Ungrouped (brand → device)</option>\r\n                <option value=\"grouped\">Grouped (type → brand → device)</option>\r\n                <option value=\"warranty\">Warranty (grouped + date of purchase)</option>\r\n              </Select>\r\n            </div>\r\n\r\n            <div className=\"grid gap-1 sm:max-w-[360px]\">\r\n              <label className=\"text-sm font-medium\">Public booking UI style</label>\r\n              <Select\r\n                value={b.publicBookingUiStyle ?? \"wizard\"}\r\n                onChange={(e) => updateBooking({ publicBookingUiStyle: e.target.value as NonNullable<typeof b.publicBookingUiStyle> })}\r\n              >\r\n                <option value=\"wizard\">List / Wizard</option>\r\n                <option value=\"images\">Images / Cards</option>\r\n              </Select>\r\n              <div className=\"text-xs text-zinc-500\">Controls the design used on /t/&lt;tenant&gt;/book.</div>\r\n            </div>\r\n\r\n            <div className=\"grid gap-1 sm:max-w-[360px]\">\r\n              <label className=\"text-sm font-medium\">New customer email behavior</label>\r\n              <Select\r\n                value={b.customerCreationEmailBehavior ?? \"send_login_credentials\"}\r\n                onChange={(e) =>\r\n                  updateBooking({\r\n                    customerCreationEmailBehavior: e.target.value as NonNullable<typeof b.customerCreationEmailBehavior>,\r\n                  })\r\n                }\r\n              >\r\n                <option value=\"send_login_credentials\">Send login credentials (OTP)</option>\r\n                <option value=\"do_not_email\">Do not email</option>\r\n              </Select>\r\n              <div className=\"text-xs text-zinc-500\">Controls whether customers get an email when an account is created on booking submit.</div>\r\n            </div>\r\n\r\n            <label className=\"flex items-center gap-2 text-sm\">\r\n              <input type=\"checkbox\" checked={b.sendBookingQuoteToJobs} onChange={(e) => updateBooking({ sendBookingQuoteToJobs: e.target.checked })} />\r\n              Send booking/quote to jobs\r\n            </label>\r\n            <label className=\"flex items-center gap-2 text-sm\">\r\n              <input\r\n                type=\"checkbox\"\r\n                checked={b.turnOffOtherDeviceBrand}\r\n                onChange={(e) => updateBooking({ turnOffOtherDeviceBrand: e.target.checked })}\r\n              />\r\n              Turn off “other device brand”\r\n            </label>\r\n            <label className=\"flex items-center gap-2 text-sm\">\r\n              <input type=\"checkbox\" checked={b.turnOffOtherService} onChange={(e) => updateBooking({ turnOffOtherService: e.target.checked })} />\r\n              Turn off “other service”\r\n            </label>\r\n            <label className=\"flex items-center gap-2 text-sm\">\r\n              <input type=\"checkbox\" checked={b.turnOffServicePrice} onChange={(e) => updateBooking({ turnOffServicePrice: e.target.checked })} />\r\n              Turn off service price\r\n            </label>\r\n            <label className=\"flex items-center gap-2 text-sm\">\r\n              <input\r\n                type=\"checkbox\"\r\n                checked={b.turnOffIdImeiInBooking}\r\n                onChange={(e) => updateBooking({ turnOffIdImeiInBooking: e.target.checked })}\r\n              />\r\n              Turn off ID/IMEI in booking\r\n            </label>\r\n          </div>\r\n        </div>\r\n\r\n        <div>\r\n          <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Defaults</div>\r\n          <div className=\"mt-2 grid gap-3 sm:grid-cols-2\">\r\n            <Input value={b.defaultType} onChange={(e) => updateBooking({ defaultType: e.target.value })} placeholder=\"Default type\" />\r\n            <Input value={b.defaultBrand} onChange={(e) => updateBooking({ defaultBrand: e.target.value })} placeholder=\"Default brand\" />\r\n            <Input value={b.defaultDevice} onChange={(e) => updateBooking({ defaultDevice: e.target.value })} placeholder=\"Default device\" />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </SectionShell>\r\n  );\r\n}\r\n","\"use client\";\r\n\r\nimport React from \"react\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/Card\";\r\n\r\nexport function SectionShell({\r\n  title,\r\n  description,\r\n  children,\r\n}: {\r\n  title: string;\r\n  description?: string;\r\n  children: React.ReactNode;\r\n}) {\r\n  return (\r\n    <Card>\r\n      <CardHeader>\r\n        <CardTitle>{title}</CardTitle>\r\n        {description ? <CardDescription>{description}</CardDescription> : null}\r\n      </CardHeader>\r\n      <CardContent className=\"space-y-4\">{children}</CardContent>\r\n    </Card>\r\n  );\r\n}\r\n","\"use client\";\r\n\r\nimport React, { useEffect, useMemo, useState } from \"react\";\r\nimport { useParams } from \"next/navigation\";\r\nimport { Input } from \"@/components/ui/Input\";\r\nimport { Select } from \"@/components/ui/Select\";\r\nimport { Button } from \"@/components/ui/Button\";\r\nimport { Badge } from \"@/components/ui/Badge\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/Card\";\r\nimport { DropdownMenu, DropdownMenuItem, DropdownMenuSeparator } from \"@/components/ui/DropdownMenu\";\r\nimport { Modal } from \"@/components/ui/Modal\";\r\nimport { ConfirmDialog } from \"@/components/ui/ConfirmDialog\";\r\nimport { Alert } from \"@/components/ui/Alert\";\r\nimport type { RepairBuddySettingsDraft } from \"@/app/app/[tenant]/settings/_components/repairbuddy/types\";\r\nimport { ApiError } from \"@/lib/api\";\r\nimport { getTenantCurrencies, updateTenantCurrencies, type TenantCurrency } from \"@/lib/tenant-currencies\";\r\n\r\nexport function CurrencySection({\r\n  draft,\r\n  updateCurrency,\r\n}: {\r\n  draft: RepairBuddySettingsDraft;\r\n  updateCurrency: (patch: Partial<RepairBuddySettingsDraft[\"currency\"]>) => void;\r\n}) {\r\n  const c = draft.currency;\r\n\r\n  const params = useParams() as { tenant?: string; business?: string };\r\n  const tenantSlug = params.business ?? params.tenant;\r\n\r\n  const [loadingCurrencies, setLoadingCurrencies] = useState(true);\r\n  const [currenciesError, setCurrenciesError] = useState<string | null>(null);\r\n  const [currenciesStatus, setCurrenciesStatus] = useState<string | null>(null);\r\n  const [busyCurrencies, setBusyCurrencies] = useState(false);\r\n\r\n  const [currenciesDraft, setCurrenciesDraft] = useState<TenantCurrency[]>([]);\r\n  const [currenciesOriginal, setCurrenciesOriginal] = useState<TenantCurrency[]>([]);\r\n\r\n  const [createOpen, setCreateOpen] = useState(false);\r\n  const [newCode, setNewCode] = useState(\"\");\r\n  const [newSymbol, setNewSymbol] = useState(\"\");\r\n  const [newName, setNewName] = useState(\"\");\r\n  const [newActive, setNewActive] = useState(true);\r\n  const [newDefault, setNewDefault] = useState(false);\r\n\r\n  const [removeCode, setRemoveCode] = useState<string | null>(null);\r\n\r\n  function normalize(list: TenantCurrency[]) {\r\n    const next = (Array.isArray(list) ? list : [])\r\n      .map((r) => ({\r\n        code: (r.code ?? \"\").trim().toUpperCase(),\r\n        symbol: r.symbol ?? null,\r\n        name: (r.name ?? \"\").trim(),\r\n        is_active: Boolean(r.is_active),\r\n        is_default: Boolean(r.is_default),\r\n      }))\r\n      .filter((r) => /^[A-Z]{3}$/.test(r.code) && r.name.length > 0);\r\n\r\n    const hasDefault = next.some((r) => r.is_default && r.is_active);\r\n    if (!hasDefault) {\r\n      const firstActive = next.find((r) => r.is_active);\r\n      if (firstActive) firstActive.is_default = true;\r\n      else if (next[0]) next[0].is_default = true;\r\n    }\r\n\r\n    let defaultSeen = false;\r\n    return next\r\n      .map((r) => {\r\n        const v = { ...r };\r\n        if (!v.is_active) v.is_default = false;\r\n        if (v.is_default) {\r\n          if (defaultSeen) v.is_default = false;\r\n          defaultSeen = true;\r\n        }\r\n        return v;\r\n      })\r\n      .sort((a, b) => a.code.localeCompare(b.code));\r\n  }\r\n\r\n  const reloadCurrencies = React.useCallback(async () => {\r\n    if (typeof tenantSlug !== \"string\" || tenantSlug.length === 0) return;\r\n\r\n    setLoadingCurrencies(true);\r\n    setCurrenciesError(null);\r\n    setCurrenciesStatus(null);\r\n\r\n    try {\r\n      const res = await getTenantCurrencies(String(tenantSlug));\r\n      const normalized = normalize(Array.isArray(res.currencies) ? res.currencies : []);\r\n      setCurrenciesDraft(normalized);\r\n      setCurrenciesOriginal(normalized);\r\n\r\n      const defaultCode = normalized.find((x) => x.is_default)?.code ?? null;\r\n      if (defaultCode && /^[A-Z]{3}$/.test(defaultCode)) {\r\n        updateCurrency({ currency: defaultCode });\r\n      }\r\n    } catch (e) {\r\n      setCurrenciesError(e instanceof Error ? e.message : \"Failed to load currencies.\");\r\n      setCurrenciesDraft([]);\r\n      setCurrenciesOriginal([]);\r\n    } finally {\r\n      setLoadingCurrencies(false);\r\n    }\r\n  }, [tenantSlug, updateCurrency]);\r\n\r\n  useEffect(() => {\r\n    void reloadCurrencies();\r\n  }, [reloadCurrencies]);\r\n\r\n  const isDirtyCurrencies = useMemo(() => {\r\n    return JSON.stringify(normalize(currenciesDraft)) !== JSON.stringify(normalize(currenciesOriginal));\r\n  }, [currenciesDraft, currenciesOriginal]);\r\n\r\n  const defaultCode = useMemo(() => {\r\n    return currenciesDraft.find((x) => x.is_default)?.code ?? \"\";\r\n  }, [currenciesDraft]);\r\n\r\n  const activeCurrencies = useMemo(() => {\r\n    return currenciesDraft.filter((x) => x.is_active);\r\n  }, [currenciesDraft]);\r\n\r\n  const updateRow = React.useCallback((code: string, patch: Partial<TenantCurrency>) => {\r\n    setCurrenciesDraft((prev) => {\r\n      const next = prev.map((r) => (r.code === code ? { ...r, ...patch } : r));\r\n\r\n      if (patch.is_default) {\r\n        return next.map((r) => (r.code === code ? { ...r, is_default: true, is_active: true } : { ...r, is_default: false }));\r\n      }\r\n\r\n      if (patch.is_active === false) {\r\n        return next.map((r) => (r.code === code ? { ...r, is_active: false, is_default: false } : r));\r\n      }\r\n\r\n      return next;\r\n    });\r\n  }, []);\r\n\r\n  const codeExists = useMemo(() => {\r\n    const code = newCode.trim().toUpperCase();\r\n    if (!/^[A-Z]{3}$/.test(code)) return false;\r\n    return currenciesDraft.some((r) => r.code === code);\r\n  }, [currenciesDraft, newCode]);\r\n\r\n  function addRow() {\r\n    const code = newCode.trim().toUpperCase();\r\n    if (!/^[A-Z]{3}$/.test(code)) return;\r\n    const name = newName.trim();\r\n    if (!name) return;\r\n    if (currenciesDraft.some((r) => r.code === code)) return;\r\n\r\n    const next: TenantCurrency = {\r\n      code,\r\n      symbol: newSymbol.trim() ? newSymbol.trim() : null,\r\n      name,\r\n      is_active: Boolean(newActive),\r\n      is_default: Boolean(newDefault),\r\n    };\r\n\r\n    setCurrenciesDraft((prev) => {\r\n      const filtered = prev.filter((r) => r.code !== code);\r\n      let combined = [...filtered, next];\r\n\r\n      if (next.is_default) {\r\n        combined = combined.map((r) => (r.code === code ? { ...r, is_default: true, is_active: true } : { ...r, is_default: false }));\r\n      }\r\n\r\n      return normalize(combined);\r\n    });\r\n\r\n    setNewCode(\"\");\r\n    setNewSymbol(\"\");\r\n    setNewName(\"\");\r\n    setNewActive(true);\r\n    setNewDefault(false);\r\n  }\r\n\r\n  function removeRow(code: string) {\r\n    setCurrenciesDraft((prev) => normalize(prev.filter((r) => r.code !== code)));\r\n  }\r\n\r\n  async function onSaveCurrencies() {\r\n    if (typeof tenantSlug !== \"string\" || tenantSlug.length === 0) return;\r\n    if (!isDirtyCurrencies) return;\r\n\r\n    setCurrenciesError(null);\r\n    setCurrenciesStatus(null);\r\n    setBusyCurrencies(true);\r\n\r\n    try {\r\n      const normalized = normalize(currenciesDraft);\r\n      const res = await updateTenantCurrencies(\r\n        String(tenantSlug),\r\n        normalized.map((r) => ({\r\n          code: r.code,\r\n          symbol: r.symbol ?? null,\r\n          name: r.name,\r\n          is_active: Boolean(r.is_active),\r\n          is_default: Boolean(r.is_default),\r\n        })),\r\n      );\r\n\r\n      const next = normalize(Array.isArray(res.currencies) ? res.currencies : []);\r\n      setCurrenciesDraft(next);\r\n      setCurrenciesOriginal(next);\r\n\r\n      const defaultCode = next.find((x) => x.is_default)?.code ?? null;\r\n      if (defaultCode && /^[A-Z]{3}$/.test(defaultCode)) {\r\n        updateCurrency({ currency: defaultCode });\r\n      }\r\n\r\n      setCurrenciesStatus(\"Currencies updated.\");\r\n    } catch (e) {\r\n      if (e instanceof ApiError) setCurrenciesError(e.message);\r\n      else setCurrenciesError(e instanceof Error ? e.message : \"Failed to save currencies.\");\r\n    } finally {\r\n      setBusyCurrencies(false);\r\n    }\r\n  }\r\n\r\n  const canAdd = useMemo(() => {\r\n    return /^[A-Z]{3}$/.test(newCode.trim().toUpperCase()) && Boolean(newName.trim()) && !codeExists;\r\n  }, [codeExists, newCode, newName]);\r\n\r\n  const separatorsConflict = useMemo(() => {\r\n    const a = (c.thousandSeparator ?? \"\").trim();\r\n    const b = (c.decimalSeparator ?? \"\").trim();\r\n    return a.length > 0 && b.length > 0 && a === b;\r\n  }, [c.decimalSeparator, c.thousandSeparator]);\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Business currencies</CardTitle>\r\n          <CardDescription>Manage currencies for this business. Set the default from the Actions menu.</CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n      {currenciesError ? (\r\n        <Alert variant=\"danger\" title=\"Could not load currencies\">\r\n          {currenciesError}\r\n        </Alert>\r\n      ) : null}\r\n\r\n      {currenciesStatus ? (\r\n        <Alert variant=\"success\" title=\"Status\">\r\n          {currenciesStatus}\r\n        </Alert>\r\n      ) : null}\r\n\r\n      <div className=\"flex flex-wrap items-center justify-between gap-2\">\r\n        <div className=\"flex flex-wrap items-center gap-2\">\r\n          {isDirtyCurrencies ? <Badge variant=\"warning\">Unsaved changes</Badge> : <Badge variant=\"success\">Saved</Badge>}\r\n          {defaultCode ? <Badge variant=\"info\">Default: {defaultCode}</Badge> : null}\r\n        </div>\r\n\r\n        <div className=\"flex flex-wrap items-center gap-2\">\r\n          <Button type=\"button\" variant=\"outline\" size=\"sm\" onClick={() => void reloadCurrencies()} disabled={loadingCurrencies || busyCurrencies}>\r\n            Refresh\r\n          </Button>\r\n          <Button\r\n            type=\"button\"\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            onClick={() => {\r\n              setCurrenciesDraft(normalize(currenciesOriginal));\r\n              setCurrenciesError(null);\r\n              setCurrenciesStatus(null);\r\n            }}\r\n            disabled={loadingCurrencies || busyCurrencies || !isDirtyCurrencies}\r\n          >\r\n            Reset\r\n          </Button>\r\n          <Button type=\"button\" variant=\"secondary\" size=\"sm\" onClick={() => void onSaveCurrencies()} disabled={loadingCurrencies || busyCurrencies || !isDirtyCurrencies}>\r\n            {busyCurrencies ? \"Saving...\" : \"Save\"}\r\n          </Button>\r\n          <Button\r\n            type=\"button\"\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            onClick={() => {\r\n              setNewCode(\"\");\r\n              setNewSymbol(\"\");\r\n              setNewName(\"\");\r\n              setNewActive(true);\r\n              setNewDefault(false);\r\n              setCreateOpen(true);\r\n            }}\r\n            disabled={loadingCurrencies || busyCurrencies}\r\n          >\r\n            Add currency\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {loadingCurrencies ? <div className=\"text-sm text-zinc-500\">Loading currencies...</div> : null}\r\n\r\n      {!loadingCurrencies ? (\r\n        <div className=\"overflow-x-auto rounded-[var(--rb-radius-md)] border border-[var(--rb-border)] bg-white\">\r\n          <table className=\"min-w-full border-collapse text-left text-sm\">\r\n            <thead className=\"bg-[var(--rb-surface-muted)]\">\r\n              <tr>\r\n                <th className=\"whitespace-nowrap border-b border-[var(--rb-border)] px-3 py-2 text-xs font-semibold uppercase tracking-wide text-zinc-600\">Code</th>\r\n                <th className=\"whitespace-nowrap border-b border-[var(--rb-border)] px-3 py-2 text-xs font-semibold uppercase tracking-wide text-zinc-600\">Name</th>\r\n                <th className=\"whitespace-nowrap border-b border-[var(--rb-border)] px-3 py-2 text-xs font-semibold uppercase tracking-wide text-zinc-600\">Symbol</th>\r\n                <th className=\"whitespace-nowrap border-b border-[var(--rb-border)] px-3 py-2 text-xs font-semibold uppercase tracking-wide text-zinc-600\">Status</th>\r\n                <th className=\"whitespace-nowrap border-b border-[var(--rb-border)] px-3 py-2 text-xs font-semibold uppercase tracking-wide text-zinc-600\" />\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {currenciesDraft.length === 0 ? (\r\n                <tr>\r\n                  <td className=\"px-3 py-3 text-sm text-zinc-600\" colSpan={5}>\r\n                    No currencies configured. Add a currency to get started.\r\n                  </td>\r\n                </tr>\r\n              ) : (\r\n                currenciesDraft.map((row) => (\r\n                  <tr key={row.code} className=\"border-t border-[var(--rb-border)]\">\r\n                    <td className=\"px-3 py-2 align-middle\">\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <span className=\"font-mono text-sm\">{row.code}</span>\r\n                        {row.is_default ? <Badge variant=\"info\">Default</Badge> : null}\r\n                      </div>\r\n                    </td>\r\n                    <td className=\"px-3 py-2 align-middle\">\r\n                      <Input value={row.name} onChange={(e) => updateRow(row.code, { name: e.target.value })} disabled={busyCurrencies} placeholder=\"Currency name\" />\r\n                    </td>\r\n                    <td className=\"px-3 py-2 align-middle\">\r\n                      <Input value={row.symbol ?? \"\"} onChange={(e) => updateRow(row.code, { symbol: e.target.value })} disabled={busyCurrencies} placeholder=\"$\" />\r\n                    </td>\r\n                    <td className=\"px-3 py-2 align-middle\">\r\n                      <Badge variant={row.is_active ? \"success\" : \"default\"}>{row.is_active ? \"Active\" : \"Inactive\"}</Badge>\r\n                    </td>\r\n                    <td className=\"px-3 py-2 align-middle text-right\">\r\n                      <DropdownMenu\r\n                        align=\"right\"\r\n                        trigger={({ toggle }) => (\r\n                          <Button variant=\"outline\" size=\"sm\" onClick={toggle} disabled={busyCurrencies}>\r\n                            Actions\r\n                          </Button>\r\n                        )}\r\n                      >\r\n                        {({ close }) => (\r\n                          <>\r\n                            <DropdownMenuItem\r\n                              onSelect={() => {\r\n                                close();\r\n                                updateRow(row.code, { is_default: true });\r\n                              }}\r\n                              disabled={busyCurrencies || row.is_default || !row.is_active}\r\n                            >\r\n                              Set default\r\n                            </DropdownMenuItem>\r\n                            <DropdownMenuItem\r\n                              onSelect={() => {\r\n                                close();\r\n                                updateRow(row.code, { is_active: !row.is_active });\r\n                              }}\r\n                              disabled={busyCurrencies || row.is_default}\r\n                            >\r\n                              {row.is_active ? \"Disable\" : \"Enable\"}\r\n                            </DropdownMenuItem>\r\n                            <DropdownMenuSeparator />\r\n                            <DropdownMenuItem\r\n                              onSelect={() => {\r\n                                close();\r\n                                setRemoveCode(row.code);\r\n                              }}\r\n                              destructive\r\n                              disabled={busyCurrencies || row.is_default}\r\n                            >\r\n                              Remove\r\n                            </DropdownMenuItem>\r\n                          </>\r\n                        )}\r\n                      </DropdownMenu>\r\n                    </td>\r\n                  </tr>\r\n                ))\r\n              )}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      ) : null}\r\n\r\n      {activeCurrencies.length === 0 && !loadingCurrencies ? (\r\n        <Alert variant=\"warning\" title=\"No active currency\">\r\n          Enable at least one currency so you can set a default.\r\n        </Alert>\r\n      ) : null}\r\n\r\n      </CardContent>\r\n      </Card>\r\n\r\n      <Modal\r\n        open={createOpen}\r\n        onClose={() => {\r\n          if (!busyCurrencies) setCreateOpen(false);\r\n        }}\r\n        title=\"Add currency\"\r\n        footer={\r\n          <div className=\"flex items-center justify-end gap-2\">\r\n            <Button variant=\"outline\" onClick={() => setCreateOpen(false)} disabled={busyCurrencies}>\r\n              Cancel\r\n            </Button>\r\n            <Button\r\n              variant=\"secondary\"\r\n              onClick={() => {\r\n                addRow();\r\n                setCreateOpen(false);\r\n              }}\r\n              disabled={busyCurrencies || !canAdd}\r\n            >\r\n              Add\r\n            </Button>\r\n          </div>\r\n        }\r\n      >\r\n        <div className=\"space-y-3\">\r\n          <Alert variant=\"info\" title=\"Tip\">\r\n            Add a 3-letter ISO code (example: USD). You can set it active immediately, and optionally set it as the default.\r\n          </Alert>\r\n\r\n          <div className=\"grid grid-cols-1 gap-3 sm:grid-cols-2\">\r\n            <div className=\"space-y-1\">\r\n              <label className=\"text-sm font-medium\" htmlFor=\"currency_code_new\">\r\n                Code\r\n              </label>\r\n              <Input\r\n                id=\"currency_code_new\"\r\n                value={newCode}\r\n                onChange={(e) => setNewCode(e.target.value.toUpperCase().replace(/[^A-Z]/g, \"\").slice(0, 3))}\r\n                type=\"text\"\r\n                placeholder=\"USD\"\r\n                disabled={busyCurrencies}\r\n              />\r\n              {codeExists ? <div className=\"text-xs text-zinc-500\">This currency is already added.</div> : null}\r\n            </div>\r\n            <div className=\"space-y-1\">\r\n              <label className=\"text-sm font-medium\" htmlFor=\"currency_symbol_new\">\r\n                Symbol\r\n              </label>\r\n              <Input\r\n                id=\"currency_symbol_new\"\r\n                value={newSymbol}\r\n                onChange={(e) => setNewSymbol(e.target.value)}\r\n                type=\"text\"\r\n                placeholder=\"$\"\r\n                disabled={busyCurrencies}\r\n              />\r\n            </div>\r\n          </div>\r\n          <div className=\"space-y-1\">\r\n            <label className=\"text-sm font-medium\" htmlFor=\"currency_name_new\">\r\n              Name\r\n            </label>\r\n            <Input\r\n              id=\"currency_name_new\"\r\n              value={newName}\r\n              onChange={(e) => setNewName(e.target.value)}\r\n              type=\"text\"\r\n              placeholder=\"US Dollar\"\r\n              disabled={busyCurrencies}\r\n            />\r\n          </div>\r\n          <div className=\"grid grid-cols-1 gap-3 sm:grid-cols-2\">\r\n            <div className=\"space-y-1\">\r\n              <div className=\"text-sm font-medium\">Active</div>\r\n              <label className=\"flex h-10 items-center gap-2 rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 text-sm text-[var(--rb-text)]\">\r\n                <input type=\"checkbox\" checked={newActive} onChange={(e) => setNewActive(e.target.checked)} disabled={busyCurrencies || newDefault} />\r\n                Active\r\n              </label>\r\n            </div>\r\n            <div className=\"space-y-1\">\r\n              <div className=\"text-sm font-medium\">Default</div>\r\n              <label className=\"flex h-10 items-center gap-2 rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 text-sm text-[var(--rb-text)]\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={newDefault}\r\n                  onChange={(e) => {\r\n                    const v = e.target.checked;\r\n                    setNewDefault(v);\r\n                    if (v) setNewActive(true);\r\n                  }}\r\n                  disabled={busyCurrencies}\r\n                />\r\n                Set as default\r\n              </label>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </Modal>\r\n\r\n      <ConfirmDialog\r\n        open={removeCode !== null}\r\n        title=\"Remove currency\"\r\n        message={\r\n          <span>\r\n            Remove currency <span className=\"font-mono\">{removeCode}</span> from this business?\r\n          </span>\r\n        }\r\n        confirmText=\"Remove\"\r\n        confirmVariant=\"outline\"\r\n        busy={busyCurrencies}\r\n        onCancel={() => setRemoveCode(null)}\r\n        onConfirm={() => {\r\n          if (removeCode) removeRow(removeCode);\r\n          setRemoveCode(null);\r\n        }}\r\n      />\r\n\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Currency formatting</CardTitle>\r\n          <CardDescription>Formatting changes are saved with the main “Save” button at the top of this page.</CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          {separatorsConflict ? (\r\n            <Alert variant=\"warning\" title=\"Check your separators\">\r\n              Thousand and decimal separators are the same. This can make numbers ambiguous.\r\n            </Alert>\r\n          ) : null}\r\n\r\n          <div className=\"grid gap-4 sm:grid-cols-2\">\r\n            <div className=\"space-y-1\">\r\n              <label className=\"text-sm font-medium\">Default currency code</label>\r\n              <Input value={defaultCode || c.currency} placeholder=\"USD\" disabled />\r\n            </div>\r\n            <div className=\"space-y-1\">\r\n              <label className=\"text-sm font-medium\">Currency position</label>\r\n              <Select\r\n                value={c.currencyPosition}\r\n                onChange={(e) => updateCurrency({ currencyPosition: e.target.value as RepairBuddySettingsDraft[\"currency\"][\"currencyPosition\"] })}\r\n              >\r\n                <option value=\"left\">Left</option>\r\n                <option value=\"right\">Right</option>\r\n                <option value=\"left_space\">Left (space)</option>\r\n                <option value=\"right_space\">Right (space)</option>\r\n              </Select>\r\n            </div>\r\n            <div className=\"space-y-1\">\r\n              <label className=\"text-sm font-medium\">Thousand separator</label>\r\n              <Input\r\n                value={c.thousandSeparator}\r\n                onChange={(e) => updateCurrency({ thousandSeparator: e.target.value.slice(0, 1) })}\r\n                placeholder=\",\" \r\n                maxLength={1}\r\n              />\r\n            </div>\r\n            <div className=\"space-y-1\">\r\n              <label className=\"text-sm font-medium\">Decimal separator</label>\r\n              <Input\r\n                value={c.decimalSeparator}\r\n                onChange={(e) => updateCurrency({ decimalSeparator: e.target.value.slice(0, 1) })}\r\n                placeholder=\".\"\r\n                maxLength={1}\r\n              />\r\n            </div>\r\n            <div className=\"space-y-1\">\r\n              <label className=\"text-sm font-medium\">Number of decimals</label>\r\n              <Input\r\n                value={String(c.numberOfDecimals)}\r\n                onChange={(e) => {\r\n                  const raw = e.target.value;\r\n                  const n = Number.parseInt(raw, 10);\r\n                  const safe = Number.isFinite(n) ? Math.min(6, Math.max(0, n)) : 0;\r\n                  updateCurrency({ numberOfDecimals: safe });\r\n                }}\r\n                type=\"number\"\r\n                min={0}\r\n                max={6}\r\n              />\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n","\"use client\";\r\n\r\nimport React, { useMemo, useState } from \"react\";\r\nimport { Badge } from \"@/components/ui/Badge\";\r\nimport { Button } from \"@/components/ui/Button\";\r\nimport { Card, CardContent } from \"@/components/ui/Card\";\r\nimport { DataTable, type DataTableColumn } from \"@/components/ui/DataTable\";\r\nimport { Input } from \"@/components/ui/Input\";\r\nimport { Modal } from \"@/components/ui/Modal\";\r\nimport { Select } from \"@/components/ui/Select\";\r\nimport { SectionShell } from \"@/app/app/[tenant]/settings/_components/repairbuddy/sections/SectionShell\";\r\nimport type { RepairBuddyAdditionalDeviceField, RepairBuddySettingsDraft } from \"@/app/app/[tenant]/settings/_components/repairbuddy/types\";\r\n\r\nexport function DevicesBrandsSection({\r\n  draft,\r\n  updateDevicesBrands,\r\n  isMock,\r\n}: {\r\n  draft: RepairBuddySettingsDraft;\r\n  updateDevicesBrands: (patch: Partial<RepairBuddySettingsDraft[\"devicesBrands\"]>) => void;\r\n  isMock: boolean;\r\n}) {\r\n  const [fieldModalOpen, setFieldModalOpen] = useState(false);\r\n  const [editingFieldId, setEditingFieldId] = useState<string | null>(null);\r\n  const [fieldError, setFieldError] = useState<string | null>(null);\r\n  const d = draft.devicesBrands;\r\n\r\n  const [query, setQuery] = useState(\"\");\r\n  const [pageIndex, setPageIndex] = useState(0);\r\n  const [pageSize, setPageSize] = useState(10);\r\n\r\n  const fields = d.additionalDeviceFields;\r\n\r\n  const filtered = React.useMemo(() => {\r\n    const needle = query.trim().toLowerCase();\r\n    if (!needle) return fields;\r\n    return fields.filter((f) => `${f.id} ${f.label}`.toLowerCase().includes(needle));\r\n  }, [fields, query]);\r\n\r\n  const totalRows = filtered.length;\r\n  const pageRows = React.useMemo(() => {\r\n    const start = pageIndex * pageSize;\r\n    const end = start + pageSize;\r\n    return filtered.slice(start, end);\r\n  }, [filtered, pageIndex, pageSize]);\r\n\r\n  const editingField = useMemo(() => {\r\n    if (!editingFieldId) return null;\r\n    return fields.find((f) => f.id === editingFieldId) ?? null;\r\n  }, [editingFieldId, fields]);\r\n\r\n  const [fieldDraft, setFieldDraft] = useState<RepairBuddyAdditionalDeviceField>(() => ({\r\n    id: \"\",\r\n    label: \"\",\r\n    type: \"text\",\r\n    displayInBookingForm: true,\r\n    displayInInvoice: true,\r\n    displayForCustomer: true,\r\n  }));\r\n\r\n  function openAddField() {\r\n    setFieldError(null);\r\n    setEditingFieldId(null);\r\n    setFieldDraft({\r\n      id: \"\",\r\n      label: \"\",\r\n      type: \"text\",\r\n      displayInBookingForm: true,\r\n      displayInInvoice: true,\r\n      displayForCustomer: true,\r\n    });\r\n    setFieldModalOpen(true);\r\n  }\r\n\r\n  const openEditField = React.useCallback((field: RepairBuddyAdditionalDeviceField) => {\r\n    setFieldError(null);\r\n    setEditingFieldId(field.id);\r\n    setFieldDraft({ ...field });\r\n    setFieldModalOpen(true);\r\n  }, []);\r\n\r\n  function closeFieldModal() {\r\n    setFieldModalOpen(false);\r\n    setEditingFieldId(null);\r\n    setFieldError(null);\r\n  }\r\n\r\n  function genId() {\r\n    const c = globalThis as unknown as { crypto?: { randomUUID?: () => string } };\r\n    if (c.crypto?.randomUUID) return `device_field_${c.crypto.randomUUID()}`;\r\n    return `device_field_${Date.now()}_${Math.random().toString(16).slice(2)}`;\r\n  }\r\n\r\n  function saveField() {\r\n    const nextLabel = fieldDraft.label.trim();\r\n\r\n    if (!nextLabel) {\r\n      setFieldError(\"Label is required.\");\r\n      return;\r\n    }\r\n\r\n    const next: RepairBuddyAdditionalDeviceField = {\r\n      id: editingFieldId ?? genId(),\r\n      label: nextLabel,\r\n      type: \"text\",\r\n      displayInBookingForm: Boolean(fieldDraft.displayInBookingForm),\r\n      displayInInvoice: Boolean(fieldDraft.displayInInvoice),\r\n      displayForCustomer: Boolean(fieldDraft.displayForCustomer),\r\n    };\r\n\r\n    const nextFields = editingFieldId ? fields.map((f) => (f.id === editingFieldId ? next : f)) : [...fields, next];\r\n    updateDevicesBrands({ additionalDeviceFields: nextFields });\r\n    closeFieldModal();\r\n  }\r\n\r\n  const deleteField = React.useCallback(\r\n    (field: RepairBuddyAdditionalDeviceField) => {\r\n      if (!globalThis.confirm(`Delete field \"${field.label}\"?`)) return;\r\n      updateDevicesBrands({ additionalDeviceFields: fields.filter((f) => f.id !== field.id) });\r\n    },\r\n    [fields, updateDevicesBrands],\r\n  );\r\n\r\n  const columns = React.useMemo<Array<DataTableColumn<RepairBuddyAdditionalDeviceField>>>(\r\n    () => [\r\n      {\r\n        id: \"label\",\r\n        header: \"Label\",\r\n        cell: (f) => (\r\n          <div className=\"min-w-[200px]\">\r\n            <div className=\"text-sm font-medium text-[var(--rb-text)]\">{f.label}</div>\r\n            <div className=\"mt-0.5 text-xs text-zinc-500\">ID: {f.id}</div>\r\n          </div>\r\n        ),\r\n      },\r\n      { id: \"type\", header: \"Type\", cell: () => <div className=\"text-sm text-zinc-600\">Text</div>, className: \"whitespace-nowrap\" },\r\n      {\r\n        id: \"booking\",\r\n        header: \"In booking form?\",\r\n        cell: (f) => <Badge variant={f.displayInBookingForm ? \"success\" : \"default\"}>{f.displayInBookingForm ? \"Display\" : \"Hide\"}</Badge>,\r\n        className: \"whitespace-nowrap\",\r\n      },\r\n      {\r\n        id: \"invoice\",\r\n        header: \"In invoice?\",\r\n        cell: (f) => <Badge variant={f.displayInInvoice ? \"success\" : \"default\"}>{f.displayInInvoice ? \"Display\" : \"Hide\"}</Badge>,\r\n        className: \"whitespace-nowrap\",\r\n      },\r\n      {\r\n        id: \"customer\",\r\n        header: \"In customer output?\",\r\n        cell: (f) => <Badge variant={f.displayForCustomer ? \"success\" : \"default\"}>{f.displayForCustomer ? \"Display\" : \"Hide\"}</Badge>,\r\n        className: \"whitespace-nowrap\",\r\n      },\r\n      {\r\n        id: \"actions\",\r\n        header: \"Actions\",\r\n        cell: (f) => (\r\n          <div className=\"flex items-center gap-2\">\r\n            <Button size=\"sm\" variant=\"outline\" disabled={isMock} onClick={() => openEditField(f)}>\r\n              Edit\r\n            </Button>\r\n            <Button size=\"sm\" variant=\"outline\" disabled={isMock} onClick={() => deleteField(f)}>\r\n              Delete\r\n            </Button>\r\n          </div>\r\n        ),\r\n        className: \"whitespace-nowrap\",\r\n      },\r\n    ],\r\n    [deleteField, isMock, openEditField],\r\n  );\r\n\r\n  return (\r\n    <SectionShell title=\"Devices & Brands\" description=\"Device fields, labels and pickup/delivery/rental toggles.\">\r\n      <div className=\"grid gap-4 sm:grid-cols-2\">\r\n        <div className=\"sm:col-span-2\">\r\n          <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Device form</div>\r\n          <div className=\"mt-2 grid gap-3\">\r\n            <label className=\"flex items-start gap-2 text-sm\">\r\n              <input\r\n                type=\"checkbox\"\r\n                checked={d.enablePinCodeField}\r\n                onChange={(e) => updateDevicesBrands({ enablePinCodeField: e.target.checked })}\r\n              />\r\n              <span>\r\n                <span className=\"block font-medium text-[var(--rb-text)]\">Enable pin code field</span>\r\n                <span className=\"mt-0.5 block text-xs text-zinc-500\">Adds a PIN input on the device form.</span>\r\n              </span>\r\n            </label>\r\n            <label className=\"flex items-start gap-2 text-sm\">\r\n              <input\r\n                type=\"checkbox\"\r\n                checked={d.showPinCodeInDocuments}\r\n                onChange={(e) => updateDevicesBrands({ showPinCodeInDocuments: e.target.checked })}\r\n                disabled={!d.enablePinCodeField}\r\n              />\r\n              <span>\r\n                <span className=\"block font-medium text-[var(--rb-text)]\">Show pin code in documents</span>\r\n                <span className=\"mt-0.5 block text-xs text-zinc-500\">Visible in invoices, emails, and status check (if enabled).</span>\r\n              </span>\r\n            </label>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div>\r\n        <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Labels</div>\r\n        <div className=\"mt-1 text-xs text-zinc-500\">Customize how fields are named across the app.</div>\r\n        <div className=\"mt-2 grid gap-3 sm:grid-cols-2\">\r\n          <div className=\"space-y-1\">\r\n            <label className=\"text-sm font-medium\">Note label</label>\r\n            <Input value={d.labels.note} onChange={(e) => updateDevicesBrands({ labels: { ...d.labels, note: e.target.value } })} placeholder=\"Note\" />\r\n          </div>\r\n          <div className=\"space-y-1\">\r\n            <label className=\"text-sm font-medium\">PIN label</label>\r\n            <Input value={d.labels.pin} onChange={(e) => updateDevicesBrands({ labels: { ...d.labels, pin: e.target.value } })} placeholder=\"PIN\" />\r\n          </div>\r\n          <div className=\"space-y-1\">\r\n            <label className=\"text-sm font-medium\">Device label</label>\r\n            <Input value={d.labels.device} onChange={(e) => updateDevicesBrands({ labels: { ...d.labels, device: e.target.value } })} placeholder=\"Device\" />\r\n          </div>\r\n          <div className=\"space-y-1\">\r\n            <label className=\"text-sm font-medium\">Brand label</label>\r\n            <Input value={d.labels.deviceBrand} onChange={(e) => updateDevicesBrands({ labels: { ...d.labels, deviceBrand: e.target.value } })} placeholder=\"Brand\" />\r\n          </div>\r\n          <div className=\"space-y-1\">\r\n            <label className=\"text-sm font-medium\">Type label</label>\r\n            <Input value={d.labels.deviceType} onChange={(e) => updateDevicesBrands({ labels: { ...d.labels, deviceType: e.target.value } })} placeholder=\"Type\" />\r\n          </div>\r\n          <div className=\"space-y-1\">\r\n            <label className=\"text-sm font-medium\">IMEI label</label>\r\n            <Input value={d.labels.imei} onChange={(e) => updateDevicesBrands({ labels: { ...d.labels, imei: e.target.value } })} placeholder=\"IMEI\" />\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"flex items-center justify-between gap-3\">\r\n        <div>\r\n          <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Additional device fields</div>\r\n          <div className=\"mt-1 text-xs text-zinc-500\">Custom fields shown on the device form.</div>\r\n        </div>\r\n        <Button variant=\"outline\" disabled={isMock} onClick={openAddField}>\r\n          Add field\r\n        </Button>\r\n      </div>\r\n\r\n      <Card className=\"shadow-none\">\r\n        <CardContent className=\"pt-5\">\r\n          <DataTable\r\n            title=\"Additional device fields\"\r\n            data={pageRows}\r\n            columns={columns}\r\n            getRowId={(row) => row.id}\r\n            emptyMessage=\"No additional fields yet.\"\r\n            search={{ placeholder: \"Search fields...\" }}\r\n            onRowClick={isMock ? undefined : (row) => openEditField(row)}\r\n            server={{\r\n              query,\r\n              onQueryChange: (value) => {\r\n                setQuery(value);\r\n                setPageIndex(0);\r\n              },\r\n              pageIndex,\r\n              onPageIndexChange: setPageIndex,\r\n              pageSize,\r\n              onPageSizeChange: (value) => {\r\n                setPageSize(value);\r\n                setPageIndex(0);\r\n              },\r\n              totalRows,\r\n            }}\r\n          />\r\n\r\n          {fields.length === 0 ? (\r\n            <div className=\"mt-3 flex flex-wrap items-center justify-between gap-2 rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-[var(--rb-surface-muted)] px-3 py-2\">\r\n              <div className=\"text-sm text-zinc-700\">Add your first field to capture extra device info (e.g. Password, Pattern, Account email).</div>\r\n              <Button variant=\"outline\" size=\"sm\" disabled={isMock} onClick={openAddField}>\r\n                Add field\r\n              </Button>\r\n            </div>\r\n          ) : null}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <div>\r\n        <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Pickup / Delivery</div>\r\n        <div className=\"mt-2 grid gap-3 sm:grid-cols-2\">\r\n          <label className=\"sm:col-span-2 flex items-center gap-2 text-sm\">\r\n            <input\r\n              type=\"checkbox\"\r\n              checked={d.pickupDeliveryEnabled}\r\n              onChange={(e) => updateDevicesBrands({ pickupDeliveryEnabled: e.target.checked })}\r\n            />\r\n            Pickup/delivery enabled\r\n          </label>\r\n          <div className=\"space-y-1\">\r\n            <label className=\"text-sm font-medium\">Pickup charge</label>\r\n            <Input\r\n              value={d.pickupCharge}\r\n              onChange={(e) => updateDevicesBrands({ pickupCharge: e.target.value })}\r\n              placeholder=\"Pickup charge\"\r\n              disabled={!d.pickupDeliveryEnabled}\r\n            />\r\n          </div>\r\n          <div className=\"space-y-1\">\r\n            <label className=\"text-sm font-medium\">Delivery charge</label>\r\n            <Input\r\n              value={d.deliveryCharge}\r\n              onChange={(e) => updateDevicesBrands({ deliveryCharge: e.target.value })}\r\n              placeholder=\"Delivery charge\"\r\n              disabled={!d.pickupDeliveryEnabled}\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div>\r\n        <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Rental</div>\r\n        <div className=\"mt-2 grid gap-3 sm:grid-cols-2\">\r\n          <label className=\"sm:col-span-2 flex items-center gap-2 text-sm\">\r\n            <input type=\"checkbox\" checked={d.rentalEnabled} onChange={(e) => updateDevicesBrands({ rentalEnabled: e.target.checked })} />\r\n            Rental enabled\r\n          </label>\r\n          <div className=\"space-y-1\">\r\n            <label className=\"text-sm font-medium\">Per day</label>\r\n            <Input\r\n              value={d.rentalPerDay}\r\n              onChange={(e) => updateDevicesBrands({ rentalPerDay: e.target.value })}\r\n              placeholder=\"Per-day\"\r\n              disabled={!d.rentalEnabled}\r\n            />\r\n          </div>\r\n          <div className=\"space-y-1\">\r\n            <label className=\"text-sm font-medium\">Per week</label>\r\n            <Input\r\n              value={d.rentalPerWeek}\r\n              onChange={(e) => updateDevicesBrands({ rentalPerWeek: e.target.value })}\r\n              placeholder=\"Per-week\"\r\n              disabled={!d.rentalEnabled}\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <Modal\r\n        open={fieldModalOpen}\r\n        onClose={closeFieldModal}\r\n        title={editingField ? \"Edit additional device field\" : \"Add additional device field\"}\r\n        footer={\r\n          <div className=\"flex items-center justify-end gap-2\">\r\n            <Button variant=\"outline\" onClick={closeFieldModal}>\r\n              Close\r\n            </Button>\r\n            <Button disabled={isMock} onClick={saveField}>\r\n              Save\r\n            </Button>\r\n          </div>\r\n        }\r\n      >\r\n        <div className=\"space-y-3\">\r\n          {fieldError ? <div className=\"text-sm text-red-600\">{fieldError}</div> : null}\r\n          <div className=\"space-y-1\">\r\n            <label className=\"text-sm font-medium\">Label</label>\r\n            <Input\r\n              value={fieldDraft.label}\r\n              onChange={(e) => {\r\n                setFieldError(null);\r\n                setFieldDraft((p) => ({ ...p, label: e.target.value }));\r\n              }}\r\n              placeholder=\"e.g. Password\"\r\n              autoFocus\r\n              onKeyDown={(e) => {\r\n                if (e.key === \"Enter\") {\r\n                  e.preventDefault();\r\n                  saveField();\r\n                }\r\n              }}\r\n            />\r\n          </div>\r\n          <div className=\"space-y-1\">\r\n            <label className=\"text-sm font-medium\">Type</label>\r\n            <Select value={fieldDraft.type} onChange={() => {}} disabled>\r\n              <option value=\"text\">Text</option>\r\n            </Select>\r\n          </div>\r\n          <div className=\"grid gap-3 sm:grid-cols-3\">\r\n            <div className=\"space-y-1\">\r\n              <label className=\"text-sm font-medium\">In booking form?</label>\r\n              <Select\r\n                value={fieldDraft.displayInBookingForm ? \"yes\" : \"no\"}\r\n                onChange={(e) => setFieldDraft((p) => ({ ...p, displayInBookingForm: e.target.value === \"yes\" }))}\r\n              >\r\n                <option value=\"yes\">Display</option>\r\n                <option value=\"no\">Hide</option>\r\n              </Select>\r\n            </div>\r\n            <div className=\"space-y-1\">\r\n              <label className=\"text-sm font-medium\">In invoice?</label>\r\n              <Select value={fieldDraft.displayInInvoice ? \"yes\" : \"no\"} onChange={(e) => setFieldDraft((p) => ({ ...p, displayInInvoice: e.target.value === \"yes\" }))}>\r\n                <option value=\"yes\">Display</option>\r\n                <option value=\"no\">Hide</option>\r\n              </Select>\r\n            </div>\r\n            <div className=\"space-y-1\">\r\n              <label className=\"text-sm font-medium\">In customer output?</label>\r\n              <Select\r\n                value={fieldDraft.displayForCustomer ? \"yes\" : \"no\"}\r\n                onChange={(e) => setFieldDraft((p) => ({ ...p, displayForCustomer: e.target.value === \"yes\" }))}\r\n              >\r\n                <option value=\"yes\">Display</option>\r\n                <option value=\"no\">Hide</option>\r\n              </Select>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </Modal>\r\n    </SectionShell>\r\n  );\r\n}\r\n","\"use client\";\r\n\r\nimport React from \"react\";\r\nimport { Input } from \"@/components/ui/Input\";\r\nimport { SectionShell } from \"@/app/app/[tenant]/settings/_components/repairbuddy/sections/SectionShell\";\r\nimport type { RepairBuddySettingsDraft } from \"@/app/app/[tenant]/settings/_components/repairbuddy/types\";\r\n\r\nexport function EstimatesSection({\r\n  draft,\r\n  updateEstimates,\r\n}: {\r\n  draft: RepairBuddySettingsDraft;\r\n  updateEstimates: (patch: Partial<RepairBuddySettingsDraft[\"estimates\"]>) => void;\r\n}) {\r\n  const e = draft.estimates;\r\n\r\n  return (\r\n    <SectionShell title=\"Estimates\" description=\"Email templates and estimate workflow toggles.\">\r\n      <div className=\"grid gap-4 sm:grid-cols-2\">\r\n        <label className=\"sm:col-span-2 flex items-center gap-2 text-sm\">\r\n          <input type=\"checkbox\" checked={e.disableEstimates} onChange={(ev) => updateEstimates({ disableEstimates: ev.target.checked })} />\r\n          Disable estimates\r\n        </label>\r\n        <label className=\"sm:col-span-2 flex items-center gap-2 text-sm\">\r\n          <input\r\n            type=\"checkbox\"\r\n            checked={e.bookingQuoteSendToJobs}\r\n            onChange={(ev) => updateEstimates({ bookingQuoteSendToJobs: ev.target.checked })}\r\n          />\r\n          Booking & quote forms: send to jobs\r\n        </label>\r\n\r\n        <div className=\"sm:col-span-2 space-y-1\">\r\n          <label className=\"text-sm font-medium\">Email subject to customer</label>\r\n          <Input value={e.customerEmailSubject} onChange={(ev) => updateEstimates({ customerEmailSubject: ev.target.value })} />\r\n        </div>\r\n        <div className=\"sm:col-span-2 space-y-1\">\r\n          <label className=\"text-sm font-medium\">Email body to customer</label>\r\n          <textarea\r\n            className=\"min-h-[140px] w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm\"\r\n            value={e.customerEmailBody}\r\n            onChange={(ev) => updateEstimates({ customerEmailBody: ev.target.value })}\r\n          />\r\n        </div>\r\n\r\n        <div className=\"sm:col-span-2 space-y-1\">\r\n          <label className=\"text-sm font-medium\">Approve/reject email subject to admin</label>\r\n          <Input value={e.adminApproveRejectEmailSubject} onChange={(ev) => updateEstimates({ adminApproveRejectEmailSubject: ev.target.value })} />\r\n        </div>\r\n        <div className=\"sm:col-span-2 space-y-1\">\r\n          <label className=\"text-sm font-medium\">Approve/reject email body to admin</label>\r\n          <textarea\r\n            className=\"min-h-[140px] w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm\"\r\n            value={e.adminApproveRejectEmailBody}\r\n            onChange={(ev) => updateEstimates({ adminApproveRejectEmailBody: ev.target.value })}\r\n          />\r\n        </div>\r\n      </div>\r\n    </SectionShell>\r\n  );\r\n}\r\n","\"use client\";\r\n\r\nimport React from \"react\";\r\nimport { Input } from \"@/components/ui/Input\";\r\nimport { SectionShell } from \"@/app/app/[tenant]/settings/_components/repairbuddy/sections/SectionShell\";\r\nimport type { RepairBuddySettingsDraft } from \"@/app/app/[tenant]/settings/_components/repairbuddy/types\";\r\n\r\nexport function GeneralSection({\r\n  draft,\r\n  updateGeneral,\r\n}: {\r\n  draft: RepairBuddySettingsDraft;\r\n  updateGeneral: (patch: Partial<RepairBuddySettingsDraft[\"general\"]>) => void;\r\n}) {\r\n  const g = draft.general;\r\n\r\n  return (\r\n    <SectionShell title=\"General\" description=\"Business identity, case numbering and customer communication defaults.\">\r\n      <div className=\"grid gap-4 sm:grid-cols-2\">\r\n        <div className=\"space-y-1\">\r\n          <label className=\"text-sm font-medium\">Business name</label>\r\n          <Input value={g.businessName} onChange={(e) => updateGeneral({ businessName: e.target.value })} />\r\n        </div>\r\n        <div className=\"space-y-1\">\r\n          <label className=\"text-sm font-medium\">Display name</label>\r\n          <Input value={g.displayName} onChange={(e) => updateGeneral({ displayName: e.target.value })} placeholder=\"Defaults to business name\" />\r\n        </div>\r\n        <div className=\"space-y-1\">\r\n          <label className=\"text-sm font-medium\">Primary contact person name</label>\r\n          <Input value={g.primaryContactName} onChange={(e) => updateGeneral({ primaryContactName: e.target.value })} placeholder=\"e.g. Alex Johnson\" />\r\n        </div>\r\n        <div className=\"space-y-1\">\r\n          <label className=\"text-sm font-medium\">Business registration number</label>\r\n          <Input value={g.registrationNumber} onChange={(e) => updateGeneral({ registrationNumber: e.target.value })} placeholder=\"Optional\" />\r\n        </div>\r\n        <div className=\"space-y-1\">\r\n          <label className=\"text-sm font-medium\">Business phone</label>\r\n          <Input value={g.businessPhone} onChange={(e) => updateGeneral({ businessPhone: e.target.value })} placeholder=\"+1 555 123 4567\" />\r\n        </div>\r\n        <div className=\"space-y-1\">\r\n          <label className=\"text-sm font-medium\">Email</label>\r\n          <Input value={g.email} onChange={(e) => updateGeneral({ email: e.target.value })} type=\"email\" placeholder=\"support@company.com\" />\r\n        </div>\r\n        <div className=\"sm:col-span-2 space-y-1\">\r\n          <label className=\"text-sm font-medium\">Business address</label>\r\n          <Input value={g.businessAddress} onChange={(e) => updateGeneral({ businessAddress: e.target.value })} placeholder=\"Street, City, Region\" />\r\n        </div>\r\n        <div className=\"sm:col-span-2 space-y-1\">\r\n          <label className=\"text-sm font-medium\">Logo URL</label>\r\n          <Input value={g.logoUrl} onChange={(e) => updateGeneral({ logoUrl: e.target.value })} placeholder=\"https://...\" />\r\n        </div>\r\n\r\n        <div className=\"space-y-1\">\r\n          <label className=\"text-sm font-medium\">Case number prefix</label>\r\n          <Input value={g.caseNumberPrefix} onChange={(e) => updateGeneral({ caseNumberPrefix: e.target.value })} placeholder=\"RB\" />\r\n        </div>\r\n        <div className=\"space-y-1\">\r\n          <label className=\"text-sm font-medium\">Case number length</label>\r\n          <Input\r\n            value={String(g.caseNumberLength)}\r\n            onChange={(e) => updateGeneral({ caseNumberLength: Number(e.target.value || 0) })}\r\n            type=\"number\"\r\n            min={1}\r\n          />\r\n        </div>\r\n\r\n        <div className=\"sm:col-span-2 space-y-1\">\r\n          <label className=\"flex items-start gap-2 text-sm\">\r\n            <input\r\n              className=\"mt-0.5\"\r\n              type=\"checkbox\"\r\n              checked={g.emailCustomer}\r\n              onChange={(e) => updateGeneral({ emailCustomer: e.target.checked })}\r\n            />\r\n            <span className=\"font-medium\">Email customer</span>\r\n          </label>\r\n          <div className=\"pl-6 text-xs text-zinc-500\">Send customer updates by email by default.</div>\r\n        </div>\r\n        <div className=\"sm:col-span-2 space-y-1\">\r\n          <label className=\"flex items-start gap-2 text-sm\">\r\n            <input className=\"mt-0.5\" type=\"checkbox\" checked={g.attachPdf} onChange={(e) => updateGeneral({ attachPdf: e.target.checked })} />\r\n            <span className=\"font-medium\">Attach PDF</span>\r\n          </label>\r\n          <div className=\"pl-6 text-xs text-zinc-500\">Attach a PDF copy to outgoing customer emails.</div>\r\n        </div>\r\n        <div className=\"sm:col-span-2 space-y-1\">\r\n          <label className=\"flex items-start gap-2 text-sm\">\r\n            <input\r\n              className=\"mt-0.5\"\r\n              type=\"checkbox\"\r\n              checked={g.nextServiceDateEnabled}\r\n              onChange={(e) => updateGeneral({ nextServiceDateEnabled: e.target.checked })}\r\n            />\r\n            <span className=\"font-medium\">Next service date</span>\r\n          </label>\r\n          <div className=\"pl-6 text-xs text-zinc-500\">Enable tracking a next service date on jobs and documents.</div>\r\n        </div>\r\n\r\n        <div className=\"sm:col-span-2 space-y-1\">\r\n          <label className=\"text-sm font-medium\">GDPR acceptance text</label>\r\n          <textarea\r\n            className=\"min-h-[90px] w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm\"\r\n            value={g.gdprAcceptanceText}\r\n            onChange={(e) => updateGeneral({ gdprAcceptanceText: e.target.value })}\r\n          />\r\n        </div>\r\n        <div className=\"space-y-1\">\r\n          <label className=\"text-sm font-medium\">GDPR link label</label>\r\n          <Input value={g.gdprLinkLabel} onChange={(e) => updateGeneral({ gdprLinkLabel: e.target.value })} />\r\n        </div>\r\n        <div className=\"space-y-1\">\r\n          <label className=\"text-sm font-medium\">GDPR link URL</label>\r\n          <Input value={g.gdprLinkUrl} onChange={(e) => updateGeneral({ gdprLinkUrl: e.target.value })} placeholder=\"https://...\" />\r\n        </div>\r\n\r\n        <div className=\"space-y-1\">\r\n          <label className=\"text-sm font-medium\">Default country</label>\r\n          <Input value={g.defaultCountry} onChange={(e) => updateGeneral({ defaultCountry: e.target.value })} placeholder=\"US\" />\r\n        </div>\r\n\r\n        <div className=\"sm:col-span-2 space-y-1\">\r\n          <label className=\"flex items-start gap-2 text-sm\">\r\n            <input\r\n              className=\"mt-0.5\"\r\n              type=\"checkbox\"\r\n              checked={g.disableStatusCheckBySerial}\r\n              onChange={(e) => updateGeneral({ disableStatusCheckBySerial: e.target.checked })}\r\n            />\r\n            <span className=\"font-medium\">Disable status check by serial</span>\r\n          </label>\r\n          <div className=\"pl-6 text-xs text-zinc-500\">Hide serial-based status lookup to reduce customer self-service options.</div>\r\n        </div>\r\n      </div>\r\n    </SectionShell>\r\n  );\r\n}\r\n","\"use client\";\r\n\r\nimport React from \"react\";\r\nimport { Input } from \"@/components/ui/Input\";\r\nimport { Select } from \"@/components/ui/Select\";\r\nimport { SectionShell } from \"@/app/app/[tenant]/settings/_components/repairbuddy/sections/SectionShell\";\r\nimport type { RepairBuddySettingsDraft } from \"@/app/app/[tenant]/settings/_components/repairbuddy/types\";\r\n\r\nexport function InvoicesReportsSection({\r\n  draft,\r\n  updateInvoicesReports,\r\n}: {\r\n  draft: RepairBuddySettingsDraft;\r\n  updateInvoicesReports: (patch: Partial<RepairBuddySettingsDraft[\"invoicesReports\"]>) => void;\r\n}) {\r\n  const s = draft.invoicesReports;\r\n\r\n  return (\r\n    <SectionShell title=\"Invoices & Reports\" description=\"Document printing, footer content and invoice display preferences.\">\r\n      <div className=\"grid gap-4 sm:grid-cols-2\">\r\n        <label className=\"sm:col-span-2 flex items-center gap-2 text-sm\">\r\n          <input type=\"checkbox\" checked={s.addQrCodeToInvoice} onChange={(e) => updateInvoicesReports({ addQrCodeToInvoice: e.target.checked })} />\r\n          Add QR code to invoice\r\n        </label>\r\n\r\n        <div className=\"sm:col-span-2 space-y-1\">\r\n          <label className=\"text-sm font-medium\">Invoice footer message</label>\r\n          <Input value={s.invoiceFooterMessage} onChange={(e) => updateInvoicesReports({ invoiceFooterMessage: e.target.value })} />\r\n        </div>\r\n\r\n        <div className=\"space-y-1\">\r\n          <label className=\"text-sm font-medium\">Invoice print type</label>\r\n          <Select value={s.invoicePrintType} onChange={(e) => updateInvoicesReports({ invoicePrintType: e.target.value as RepairBuddySettingsDraft[\"invoicesReports\"][\"invoicePrintType\"] })}>\r\n            <option value=\"standard\">Standard</option>\r\n            <option value=\"thermal\">Thermal</option>\r\n          </Select>\r\n        </div>\r\n\r\n        <div className=\"space-y-1\">\r\n          <label className=\"text-sm font-medium\">Repair order type</label>\r\n          <Select value={s.repairOrderType} onChange={(e) => updateInvoicesReports({ repairOrderType: e.target.value as RepairBuddySettingsDraft[\"invoicesReports\"][\"repairOrderType\"] })}>\r\n            <option value=\"standard\">Standard</option>\r\n            <option value=\"detailed\">Detailed</option>\r\n          </Select>\r\n        </div>\r\n\r\n        <div className=\"space-y-1\">\r\n          <label className=\"text-sm font-medium\">Repair order print size</label>\r\n          <Select\r\n            value={s.repairOrderPrintSize}\r\n            onChange={(e) => updateInvoicesReports({ repairOrderPrintSize: e.target.value as RepairBuddySettingsDraft[\"invoicesReports\"][\"repairOrderPrintSize\"] })}\r\n          >\r\n            <option value=\"a4\">A4</option>\r\n            <option value=\"letter\">Letter</option>\r\n          </Select>\r\n        </div>\r\n\r\n        <div className=\"sm:col-span-2 grid gap-2\">\r\n          <label className=\"flex items-center gap-2 text-sm\">\r\n            <input type=\"checkbox\" checked={s.displayPickupDate} onChange={(e) => updateInvoicesReports({ displayPickupDate: e.target.checked })} />\r\n            Display pickup date\r\n          </label>\r\n          <label className=\"flex items-center gap-2 text-sm\">\r\n            <input type=\"checkbox\" checked={s.displayDeliveryDate} onChange={(e) => updateInvoicesReports({ displayDeliveryDate: e.target.checked })} />\r\n            Display delivery date\r\n          </label>\r\n          <label className=\"flex items-center gap-2 text-sm\">\r\n            <input\r\n              type=\"checkbox\"\r\n              checked={s.displayNextServiceDate}\r\n              onChange={(e) => updateInvoicesReports({ displayNextServiceDate: e.target.checked })}\r\n            />\r\n            Display next service date\r\n          </label>\r\n        </div>\r\n\r\n        <div className=\"sm:col-span-2 space-y-1\">\r\n          <label className=\"text-sm font-medium\">Invoice disclaimer / terms</label>\r\n          <textarea\r\n            className=\"min-h-[120px] w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm\"\r\n            value={s.invoiceDisclaimerTerms}\r\n            onChange={(e) => updateInvoicesReports({ invoiceDisclaimerTerms: e.target.value })}\r\n          />\r\n        </div>\r\n\r\n        <div className=\"sm:col-span-2 space-y-1\">\r\n          <label className=\"text-sm font-medium\">Terms URL</label>\r\n          <Input value={s.termsUrl} onChange={(e) => updateInvoicesReports({ termsUrl: e.target.value })} placeholder=\"https://...\" />\r\n        </div>\r\n\r\n        <label className=\"sm:col-span-2 flex items-center gap-2 text-sm\">\r\n          <input\r\n            type=\"checkbox\"\r\n            checked={s.displayBusinessAddressDetails}\r\n            onChange={(e) => updateInvoicesReports({ displayBusinessAddressDetails: e.target.checked })}\r\n          />\r\n          Display business address details\r\n        </label>\r\n        <label className=\"sm:col-span-2 flex items-center gap-2 text-sm\">\r\n          <input\r\n            type=\"checkbox\"\r\n            checked={s.displayCustomerEmailAddressDetails}\r\n            onChange={(e) => updateInvoicesReports({ displayCustomerEmailAddressDetails: e.target.checked })}\r\n          />\r\n          Display customer email/address details\r\n        </label>\r\n\r\n        <div className=\"sm:col-span-2 space-y-1\">\r\n          <label className=\"text-sm font-medium\">Repair order footer message</label>\r\n          <Input value={s.repairOrderFooterMessage} onChange={(e) => updateInvoicesReports({ repairOrderFooterMessage: e.target.value })} />\r\n        </div>\r\n      </div>\r\n    </SectionShell>\r\n  );\r\n}\r\n","\"use client\";\r\n\r\nimport React from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { Badge, type BadgeVariant } from \"@/components/ui/Badge\";\r\nimport { Button } from \"@/components/ui/Button\";\r\nimport { Card, CardContent } from \"@/components/ui/Card\";\r\nimport { DataTable, type DataTableColumn } from \"@/components/ui/DataTable\";\r\nimport { Input } from \"@/components/ui/Input\";\r\nimport { Modal } from \"@/components/ui/Modal\";\r\nimport { Select } from \"@/components/ui/Select\";\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/Tabs\";\r\nimport { ApiError, apiFetch } from \"@/lib/api\";\r\nimport { useAuth } from \"@/lib/auth\";\r\nimport { SectionShell } from \"@/app/app/[tenant]/settings/_components/repairbuddy/sections/SectionShell\";\r\n\r\ntype ApiJobStatus = {\r\n  id: number;\r\n  slug: string;\r\n  label: string;\r\n  invoice_label?: string | null;\r\n  email_enabled?: boolean;\r\n  sms_enabled?: boolean;\r\n  is_active?: boolean;\r\n  color?: string | null;\r\n  sort_order?: number | null;\r\n};\r\n\r\ntype ApiPaymentStatus = {\r\n  id: number;\r\n  slug: string;\r\n  label: string;\r\n  is_active?: boolean;\r\n  color?: string | null;\r\n  sort_order?: number | null;\r\n};\r\n\r\ntype Domain = \"job\" | \"payment\";\r\n\r\nconst badgeOptions: Array<{ value: \"\" | BadgeVariant; label: string }> = [\r\n  { value: \"\", label: \"Default\" },\r\n  { value: \"info\", label: \"Info\" },\r\n  { value: \"success\", label: \"Success\" },\r\n  { value: \"warning\", label: \"Warning\" },\r\n  { value: \"danger\", label: \"Danger\" },\r\n];\r\n\r\nfunction badgeVariantFromValue(value: unknown): BadgeVariant {\r\n  if (value === \"info\" || value === \"success\" || value === \"warning\" || value === \"danger\" || value === \"default\") {\r\n    return value;\r\n  }\r\n  return \"default\";\r\n}\r\n\r\nfunction normalizeNullableString(value: unknown): string | null {\r\n  if (typeof value !== \"string\") return null;\r\n  const trimmed = value.trim();\r\n  return trimmed.length > 0 ? trimmed : null;\r\n}\r\n\r\nfunction normalizeNullableInt(value: unknown): number | null {\r\n  if (typeof value !== \"string\" && typeof value !== \"number\") return null;\r\n  const raw = String(value).trim();\r\n  if (raw.length === 0) return null;\r\n  const n = Number.parseInt(raw, 10);\r\n  if (!Number.isFinite(n)) return null;\r\n  return Math.max(0, Math.min(100000, n));\r\n}\r\n\r\nexport function JobStatusesSection({ tenantSlug }: { tenantSlug: string }) {\r\n  const auth = useAuth();\r\n  const router = useRouter();\r\n\r\n  const [loading, setLoading] = React.useState(true);\r\n  const [busy, setBusy] = React.useState(false);\r\n  const [error, setError] = React.useState<string | null>(null);\r\n  const [status, setStatus] = React.useState<string | null>(null);\r\n\r\n  const [activeTab, setActiveTab] = React.useState<Domain>(\"job\");\r\n\r\n  const [jobStatuses, setJobStatuses] = React.useState<ApiJobStatus[]>([]);\r\n  const [paymentStatuses, setPaymentStatuses] = React.useState<ApiPaymentStatus[]>([]);\r\n\r\n  const [query, setQuery] = React.useState(\"\");\r\n  const [pageIndex, setPageIndex] = React.useState(0);\r\n  const [pageSize, setPageSize] = React.useState(10);\r\n\r\n  const [editOpen, setEditOpen] = React.useState(false);\r\n  const [editDomain, setEditDomain] = React.useState<Domain>(\"job\");\r\n  const [editSlug, setEditSlug] = React.useState<string>(\"\");\r\n  const [editLabel, setEditLabel] = React.useState<string>(\"\");\r\n  const [editColor, setEditColor] = React.useState<string>(\"\");\r\n  const [editSortOrder, setEditSortOrder] = React.useState<string>(\"\");\r\n\r\n  const openEdit = React.useCallback(\r\n    (domain: Domain, row: { slug: string; label: string; color?: string | null; sort_order?: number | null }) => {\r\n      setEditDomain(domain);\r\n      setEditSlug(row.slug);\r\n      setEditLabel(row.label ?? \"\");\r\n      setEditColor(typeof row.color === \"string\" ? row.color : \"\");\r\n      setEditSortOrder(typeof row.sort_order === \"number\" ? String(row.sort_order) : \"\");\r\n      setEditOpen(true);\r\n    },\r\n    []\r\n  );\r\n\r\n  const loadAll = React.useCallback(async () => {\r\n    if (typeof tenantSlug !== \"string\" || tenantSlug.length === 0) {\r\n      setError(\"Business is missing.\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n      setStatus(null);\r\n\r\n      const [jobsRes, paymentsRes] = await Promise.all([\r\n        apiFetch<{ job_statuses: ApiJobStatus[] }>(`/api/${tenantSlug}/app/repairbuddy/job-statuses`),\r\n        apiFetch<{ payment_statuses: ApiPaymentStatus[] }>(`/api/${tenantSlug}/app/repairbuddy/payment-statuses`),\r\n      ]);\r\n\r\n      setJobStatuses(Array.isArray(jobsRes.job_statuses) ? jobsRes.job_statuses : []);\r\n      setPaymentStatuses(Array.isArray(paymentsRes.payment_statuses) ? paymentsRes.payment_statuses : []);\r\n    } catch (e) {\r\n      if (e instanceof ApiError && e.status === 428 && typeof tenantSlug === \"string\" && tenantSlug.length > 0) {\r\n        const next = `/app/${tenantSlug}/business-settings?section=job-statuses`;\r\n        router.replace(`/app/${tenantSlug}/branches/select?next=${encodeURIComponent(next)}`);\r\n        return;\r\n      }\r\n      setError(e instanceof Error ? e.message : \"Failed to load statuses.\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [router, tenantSlug]);\r\n\r\n  React.useEffect(() => {\r\n    if (auth.loading) return;\r\n    if (!auth.isAuthenticated) return;\r\n    if (!auth.can(\"jobs.view\")) {\r\n      router.replace(\"/app\");\r\n      return;\r\n    }\r\n    void loadAll();\r\n  }, [auth, loadAll, router]);\r\n\r\n  const activeRows = React.useMemo(() => {\r\n    const rows = activeTab === \"job\" ? jobStatuses : paymentStatuses;\r\n    const needle = query.trim().toLowerCase();\r\n    if (!needle) return rows;\r\n    return rows.filter((s) => `${s.slug} ${s.label} ${s.color ?? \"\"} ${s.sort_order ?? \"\"}`.toLowerCase().includes(needle));\r\n  }, [activeTab, jobStatuses, paymentStatuses, query]);\r\n\r\n  const totalRows = activeRows.length;\r\n  const pageRows = React.useMemo(() => {\r\n    const start = pageIndex * pageSize;\r\n    const end = start + pageSize;\r\n    return activeRows.slice(start, end);\r\n  }, [activeRows, pageIndex, pageSize]);\r\n\r\n  const jobColumns = React.useMemo<Array<DataTableColumn<ApiJobStatus>>>(\r\n    () => [\r\n      {\r\n        id: \"label\",\r\n        header: \"Label\",\r\n        cell: (row) => (\r\n          <div className=\"min-w-0\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <Badge variant={badgeVariantFromValue(row.color)}>{row.label}</Badge>\r\n              {typeof row.color === \"string\" && row.color.length > 0 ? <span className=\"text-xs text-zinc-500\">({row.color})</span> : null}\r\n            </div>\r\n            <div className=\"mt-1 truncate text-xs text-zinc-600\">{row.slug}</div>\r\n          </div>\r\n        ),\r\n        className: \"min-w-[280px]\",\r\n      },\r\n      {\r\n        id: \"invoice\",\r\n        header: \"Invoice label\",\r\n        cell: (row) => <div className=\"text-sm text-zinc-700\">{row.invoice_label ?? \"—\"}</div>,\r\n        className: \"min-w-[200px]\",\r\n      },\r\n      {\r\n        id: \"order\",\r\n        header: \"Order\",\r\n        cell: (row) => <div className=\"text-sm text-zinc-700\">{typeof row.sort_order === \"number\" ? row.sort_order : \"—\"}</div>,\r\n        className: \"whitespace-nowrap\",\r\n      },\r\n      {\r\n        id: \"active\",\r\n        header: \"Active\",\r\n        cell: (row) => <div className=\"text-sm text-zinc-700\">{row.is_active === false ? \"No\" : \"Yes\"}</div>,\r\n        className: \"whitespace-nowrap\",\r\n      },\r\n      {\r\n        id: \"actions\",\r\n        header: \"Actions\",\r\n        cell: (row) => (\r\n          <div className=\"whitespace-nowrap\">\r\n            <Button variant=\"outline\" size=\"sm\" onClick={() => openEdit(\"job\", row)}>\r\n              Edit\r\n            </Button>\r\n          </div>\r\n        ),\r\n        className: \"whitespace-nowrap\",\r\n      },\r\n    ],\r\n    [openEdit]\r\n  );\r\n\r\n  const paymentColumns = React.useMemo<Array<DataTableColumn<ApiPaymentStatus>>>(\r\n    () => [\r\n      {\r\n        id: \"label\",\r\n        header: \"Label\",\r\n        cell: (row) => (\r\n          <div className=\"min-w-0\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <Badge variant={badgeVariantFromValue(row.color)}>{row.label}</Badge>\r\n              {typeof row.color === \"string\" && row.color.length > 0 ? <span className=\"text-xs text-zinc-500\">({row.color})</span> : null}\r\n            </div>\r\n            <div className=\"mt-1 truncate text-xs text-zinc-600\">{row.slug}</div>\r\n          </div>\r\n        ),\r\n        className: \"min-w-[280px]\",\r\n      },\r\n      {\r\n        id: \"order\",\r\n        header: \"Order\",\r\n        cell: (row) => <div className=\"text-sm text-zinc-700\">{typeof row.sort_order === \"number\" ? row.sort_order : \"—\"}</div>,\r\n        className: \"whitespace-nowrap\",\r\n      },\r\n      {\r\n        id: \"active\",\r\n        header: \"Active\",\r\n        cell: (row) => <div className=\"text-sm text-zinc-700\">{row.is_active === false ? \"No\" : \"Yes\"}</div>,\r\n        className: \"whitespace-nowrap\",\r\n      },\r\n      {\r\n        id: \"actions\",\r\n        header: \"Actions\",\r\n        cell: (row) => (\r\n          <div className=\"whitespace-nowrap\">\r\n            <Button variant=\"outline\" size=\"sm\" onClick={() => openEdit(\"payment\", row)}>\r\n              Edit\r\n            </Button>\r\n          </div>\r\n        ),\r\n        className: \"whitespace-nowrap\",\r\n      },\r\n    ],\r\n    [openEdit]\r\n  );\r\n\r\n  async function saveOverride(mode: \"save\" | \"reset\") {\r\n    if (busy) return;\r\n    if (typeof tenantSlug !== \"string\" || tenantSlug.length === 0) {\r\n      setError(\"Business is missing.\");\r\n      return;\r\n    }\r\n\r\n    const endpoint =\r\n      editDomain === \"job\"\r\n        ? `/api/${tenantSlug}/app/repairbuddy/job-statuses/${encodeURIComponent(editSlug)}`\r\n        : `/api/${tenantSlug}/app/repairbuddy/payment-statuses/${encodeURIComponent(editSlug)}`;\r\n\r\n    const payload =\r\n      mode === \"reset\"\r\n        ? { label: null, color: null, sort_order: null }\r\n        : {\r\n            label: normalizeNullableString(editLabel),\r\n            color: normalizeNullableString(editColor),\r\n            sort_order: normalizeNullableInt(editSortOrder),\r\n          };\r\n\r\n    try {\r\n      setBusy(true);\r\n      setError(null);\r\n      setStatus(null);\r\n\r\n      await apiFetch(endpoint, {\r\n        method: \"PATCH\",\r\n        body: payload,\r\n      });\r\n\r\n      setEditOpen(false);\r\n      setStatus(mode === \"reset\" ? \"Status reset to defaults.\" : \"Status saved.\");\r\n      await loadAll();\r\n    } catch (e) {\r\n      if (e instanceof ApiError && e.status === 428 && typeof tenantSlug === \"string\" && tenantSlug.length > 0) {\r\n        const next = `/app/${tenantSlug}/business-settings?section=job-statuses`;\r\n        router.replace(`/app/${tenantSlug}/branches/select?next=${encodeURIComponent(next)}`);\r\n        return;\r\n      }\r\n\r\n      setError(e instanceof Error ? e.message : \"Failed to save status.\");\r\n    } finally {\r\n      setBusy(false);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <SectionShell title=\"Statuses\" description=\"Customize display labels, colors, and ordering for job and payment statuses.\">\r\n      <div className=\"flex flex-wrap items-center justify-between gap-3\">\r\n        {status ? <div className=\"text-sm text-zinc-600\">{status}</div> : <div />}\r\n        <Button variant=\"outline\" size=\"sm\" onClick={() => void loadAll()} disabled={loading || busy}>\r\n          Refresh\r\n        </Button>\r\n      </div>\r\n\r\n      {error ? <div className=\"text-sm text-red-600\">{error}</div> : null}\r\n\r\n      <Tabs\r\n        value={activeTab}\r\n        onValueChange={(next) => {\r\n          if (next === \"job\" || next === \"payment\") {\r\n            setActiveTab(next);\r\n            setQuery(\"\");\r\n            setPageIndex(0);\r\n          }\r\n        }}\r\n      >\r\n        <TabsList>\r\n          <TabsTrigger value=\"job\">Job statuses</TabsTrigger>\r\n          <TabsTrigger value=\"payment\">Payment statuses</TabsTrigger>\r\n        </TabsList>\r\n\r\n        <TabsContent value=\"job\">\r\n          <Card className=\"shadow-none\">\r\n            <CardContent className=\"pt-5\">\r\n              <DataTable\r\n                title={`Job statuses · ${tenantSlug}`}\r\n                data={pageRows as ApiJobStatus[]}\r\n                columns={jobColumns}\r\n                getRowId={(row) => row.id}\r\n                emptyMessage=\"No job statuses.\"\r\n                server={{\r\n                  query,\r\n                  onQueryChange: (value) => {\r\n                    setQuery(value);\r\n                    setPageIndex(0);\r\n                  },\r\n                  pageIndex,\r\n                  onPageIndexChange: setPageIndex,\r\n                  pageSize,\r\n                  onPageSizeChange: (value) => {\r\n                    setPageSize(value);\r\n                    setPageIndex(0);\r\n                  },\r\n                  totalRows,\r\n                }}\r\n              />\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"payment\">\r\n          <Card className=\"shadow-none\">\r\n            <CardContent className=\"pt-5\">\r\n              <DataTable\r\n                title={`Payment statuses · ${tenantSlug}`}\r\n                data={pageRows as ApiPaymentStatus[]}\r\n                columns={paymentColumns}\r\n                getRowId={(row) => row.id}\r\n                emptyMessage=\"No payment statuses.\"\r\n                server={{\r\n                  query,\r\n                  onQueryChange: (value) => {\r\n                    setQuery(value);\r\n                    setPageIndex(0);\r\n                  },\r\n                  pageIndex,\r\n                  onPageIndexChange: setPageIndex,\r\n                  pageSize,\r\n                  onPageSizeChange: (value) => {\r\n                    setPageSize(value);\r\n                    setPageIndex(0);\r\n                  },\r\n                  totalRows,\r\n                }}\r\n              />\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n      </Tabs>\r\n\r\n      <Modal\r\n        open={editOpen}\r\n        onClose={() => {\r\n          if (busy) return;\r\n          setEditOpen(false);\r\n        }}\r\n        title={editDomain === \"job\" ? `Edit job status` : `Edit payment status`}\r\n        footer={\r\n          <div className=\"flex flex-wrap items-center justify-between gap-2\">\r\n            <Button variant=\"outline\" disabled={busy} onClick={() => void saveOverride(\"reset\")}>\r\n              Reset to defaults\r\n            </Button>\r\n            <div className=\"flex items-center gap-2\">\r\n              <Button variant=\"outline\" disabled={busy} onClick={() => setEditOpen(false)}>\r\n                Cancel\r\n              </Button>\r\n              <Button disabled={busy} onClick={() => void saveOverride(\"save\")}>\r\n                {busy ? \"Saving...\" : \"Save\"}\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        }\r\n      >\r\n        <div className=\"space-y-4\">\r\n          <div className=\"space-y-1\">\r\n            <label className=\"text-sm font-medium\">Label</label>\r\n            <Input value={editLabel} onChange={(e) => setEditLabel(e.target.value)} placeholder=\"e.g. In Service\" maxLength={255} />\r\n            <div className=\"text-xs text-zinc-500\">Leave blank to fall back to the default label.</div>\r\n          </div>\r\n\r\n          <div className=\"space-y-1\">\r\n            <label className=\"text-sm font-medium\">Color</label>\r\n            <Select value={editColor} onChange={(e) => setEditColor(e.target.value)}>\r\n              {badgeOptions.map((opt) => (\r\n                <option key={opt.label + opt.value} value={opt.value}>\r\n                  {opt.label}\r\n                </option>\r\n              ))}\r\n            </Select>\r\n            <div className=\"text-xs text-zinc-500\">Used to style badges in the UI.</div>\r\n          </div>\r\n\r\n          <div className=\"space-y-1\">\r\n            <label className=\"text-sm font-medium\">Sort order</label>\r\n            <Input value={editSortOrder} onChange={(e) => setEditSortOrder(e.target.value)} placeholder=\"e.g. 10\" inputMode=\"numeric\" />\r\n            <div className=\"text-xs text-zinc-500\">Lower numbers appear first. Leave blank to use the default order.</div>\r\n          </div>\r\n        </div>\r\n      </Modal>\r\n    </SectionShell>\r\n  );\r\n}\r\n","import { apiFetch } from \"@/lib/api\";\r\n\r\nexport type MaintenanceReminderRule = {\r\n  id: number;\r\n  name: string;\r\n  description: string | null;\r\n  interval_days: number;\r\n  device_type_id: number | null;\r\n  device_brand_id: number | null;\r\n  device_type_name?: string | null;\r\n  device_brand_name?: string | null;\r\n  email_enabled: boolean;\r\n  sms_enabled: boolean;\r\n  reminder_enabled: boolean;\r\n  email_body: string | null;\r\n  sms_body: string | null;\r\n  last_executed_at: string | null;\r\n  created_at: string;\r\n  updated_at: string;\r\n};\r\n\r\nexport async function listMaintenanceReminders(business: string, args?: { q?: string }): Promise<{ reminders: MaintenanceReminderRule[] }> {\r\n  const qs = new URLSearchParams();\r\n  if (args?.q) qs.set(\"q\", args.q);\r\n  const suffix = qs.toString() ? `?${qs.toString()}` : \"\";\r\n  return apiFetch<{ reminders: MaintenanceReminderRule[] }>(`/api/${business}/app/repairbuddy/maintenance-reminders${suffix}`);\r\n}\r\n\r\nexport type MaintenanceReminderUpsertInput = {\r\n  name: string;\r\n  description?: string | null;\r\n  interval_days: number;\r\n  device_type_id?: number | null;\r\n  device_brand_id?: number | null;\r\n  email_enabled?: boolean;\r\n  sms_enabled?: boolean;\r\n  reminder_enabled?: boolean;\r\n  email_body?: string | null;\r\n  sms_body?: string | null;\r\n};\r\n\r\nexport async function createMaintenanceReminder(business: string, input: MaintenanceReminderUpsertInput): Promise<{ reminder: MaintenanceReminderRule }> {\r\n  return apiFetch(`/api/${business}/app/repairbuddy/maintenance-reminders`, {\r\n    method: \"POST\",\r\n    body: input,\r\n  });\r\n}\r\n\r\nexport async function updateMaintenanceReminder(\r\n  business: string,\r\n  id: number,\r\n  input: Partial<MaintenanceReminderUpsertInput>,\r\n): Promise<{ reminder: MaintenanceReminderRule }> {\r\n  return apiFetch(`/api/${business}/app/repairbuddy/maintenance-reminders/${id}`, {\r\n    method: \"PATCH\",\r\n    body: input,\r\n  });\r\n}\r\n\r\nexport async function deleteMaintenanceReminder(business: string, id: number): Promise<{ ok: boolean }> {\r\n  return apiFetch(`/api/${business}/app/repairbuddy/maintenance-reminders/${id}`, {\r\n    method: \"DELETE\",\r\n  });\r\n}\r\n\r\nexport async function testMaintenanceReminder(\r\n  business: string,\r\n  id: number,\r\n  input: { email?: string | null; phone?: string | null },\r\n): Promise<{ ok: boolean; unsubscribe_url: string; preview: { email: string; sms: string }; status: { email: string; sms: string } }> {\r\n  return apiFetch(`/api/${business}/app/repairbuddy/maintenance-reminders/${id}/test`, {\r\n    method: \"POST\",\r\n    body: input,\r\n  });\r\n}\r\n","\"use client\";\r\n\r\nimport React, { useEffect, useMemo, useState } from \"react\";\r\nimport Link from \"next/link\";\r\nimport { Button } from \"@/components/ui/Button\";\r\nimport { Badge } from \"@/components/ui/Badge\";\r\nimport { Card, CardContent } from \"@/components/ui/Card\";\r\nimport { DataTable, type DataTableColumn } from \"@/components/ui/DataTable\";\r\nimport { Input } from \"@/components/ui/Input\";\r\nimport { Modal } from \"@/components/ui/Modal\";\r\nimport { Select } from \"@/components/ui/Select\";\r\nimport { SectionShell } from \"@/app/app/[tenant]/settings/_components/repairbuddy/sections/SectionShell\";\r\nimport type { RepairBuddySettingsDraft } from \"@/app/app/[tenant]/settings/_components/repairbuddy/types\";\r\nimport { ApiError, apiFetch } from \"@/lib/api\";\r\nimport {\r\n  createMaintenanceReminder,\r\n  deleteMaintenanceReminder,\r\n  listMaintenanceReminders,\r\n  testMaintenanceReminder,\r\n  updateMaintenanceReminder,\r\n  type MaintenanceReminderRule,\r\n  type MaintenanceReminderUpsertInput,\r\n} from \"@/lib/repairbuddy-maintenance-reminders\";\r\n\r\ntype DeviceType = { id: number; name: string; is_active?: boolean };\r\ntype DeviceBrand = { id: number; name: string; is_active?: boolean };\r\n\r\nfunction yesNo(v: boolean) {\r\n  return v ? \"Yes\" : \"No\";\r\n}\r\n\r\nfunction enabledVariant(v: boolean): \"success\" | \"warning\" {\r\n  return v ? \"success\" : \"warning\";\r\n}\r\n\r\nexport function MaintenanceRemindersSection({\r\n  tenantSlug,\r\n  draft,\r\n  isMock,\r\n}: {\r\n  tenantSlug: string;\r\n  draft: RepairBuddySettingsDraft;\r\n  isMock: boolean;\r\n}) {\r\n  void draft;\r\n  void isMock;\r\n\r\n  const [addOpen, setAddOpen] = useState(false);\r\n  const [testOpen, setTestOpen] = useState(false);\r\n  const [editing, setEditing] = useState<MaintenanceReminderRule | null>(null);\r\n  const [testTarget, setTestTarget] = useState<MaintenanceReminderRule | null>(null);\r\n  const [query, setQuery] = useState(\"\");\r\n  const [pageIndex, setPageIndex] = useState(0);\r\n  const [pageSize, setPageSize] = useState(10);\r\n\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [reminders, setReminders] = useState<MaintenanceReminderRule[]>([]);\r\n\r\n  const [deviceTypes, setDeviceTypes] = useState<DeviceType[]>([]);\r\n  const [deviceBrands, setDeviceBrands] = useState<DeviceBrand[]>([]);\r\n\r\n  const refresh = React.useCallback(async () => {\r\n    setLoading(true);\r\n    setError(null);\r\n    try {\r\n      const res = await listMaintenanceReminders(String(tenantSlug), { q: query.trim() || undefined });\r\n      setReminders(Array.isArray(res.reminders) ? res.reminders : []);\r\n    } catch (e) {\r\n      setError(e instanceof Error ? e.message : \"Failed to load reminders.\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [query, tenantSlug]);\r\n\r\n  useEffect(() => {\r\n    void refresh();\r\n  }, [refresh]);\r\n\r\n  useEffect(() => {\r\n    let alive = true;\r\n\r\n    async function loadTargets() {\r\n      try {\r\n        const [typesRes, brandsRes] = await Promise.all([\r\n          apiFetch<{ device_types: DeviceType[] }>(`/api/${String(tenantSlug)}/app/repairbuddy/device-types?limit=200`),\r\n          apiFetch<{ device_brands: DeviceBrand[] }>(`/api/${String(tenantSlug)}/app/repairbuddy/device-brands?limit=200`),\r\n        ]);\r\n        if (!alive) return;\r\n        setDeviceTypes(Array.isArray(typesRes.device_types) ? typesRes.device_types : []);\r\n        setDeviceBrands(Array.isArray(brandsRes.device_brands) ? brandsRes.device_brands : []);\r\n      } catch {\r\n        if (!alive) return;\r\n        setDeviceTypes([]);\r\n        setDeviceBrands([]);\r\n      }\r\n    }\r\n\r\n    void loadTargets();\r\n    return () => {\r\n      alive = false;\r\n    };\r\n  }, [tenantSlug]);\r\n\r\n  const totalRows = reminders.length;\r\n  const pageRows = useMemo(() => {\r\n    const start = pageIndex * pageSize;\r\n    const end = start + pageSize;\r\n    return reminders.slice(start, end);\r\n  }, [pageIndex, pageSize, reminders]);\r\n\r\n  const columns = useMemo<Array<DataTableColumn<MaintenanceReminderRule>>>(\r\n    () => [\r\n      {\r\n        id: \"name\",\r\n        header: \"Name\",\r\n        cell: (r) => (\r\n          <div className=\"min-w-0\">\r\n            <div className=\"truncate font-medium text-[var(--rb-text)]\">{r.name}</div>\r\n            {r.description ? <div className=\"truncate text-xs text-zinc-600\">{r.description}</div> : null}\r\n          </div>\r\n        ),\r\n        className: \"min-w-[240px]\",\r\n      },\r\n      {\r\n        id: \"interval\",\r\n        header: \"Interval\",\r\n        cell: (r) => <div className=\"text-sm text-zinc-700\">{r.interval_days} days</div>,\r\n        className: \"whitespace-nowrap\",\r\n      },\r\n      {\r\n        id: \"type\",\r\n        header: \"Device Type\",\r\n        cell: (r) => <div className=\"text-sm text-zinc-700\">{r.device_type_name ?? \"All\"}</div>,\r\n        className: \"min-w-[160px]\",\r\n      },\r\n      {\r\n        id: \"brand\",\r\n        header: \"Brand\",\r\n        cell: (r) => <div className=\"text-sm text-zinc-700\">{r.device_brand_name ?? \"All\"}</div>,\r\n        className: \"min-w-[160px]\",\r\n      },\r\n      {\r\n        id: \"email\",\r\n        header: \"Email\",\r\n        cell: (r) => <Badge variant={enabledVariant(r.email_enabled)}>{yesNo(r.email_enabled)}</Badge>,\r\n        className: \"whitespace-nowrap\",\r\n      },\r\n      {\r\n        id: \"sms\",\r\n        header: \"SMS\",\r\n        cell: (r) => <Badge variant={enabledVariant(r.sms_enabled)}>{yesNo(r.sms_enabled)}</Badge>,\r\n        className: \"whitespace-nowrap\",\r\n      },\r\n      {\r\n        id: \"enabled\",\r\n        header: \"Reminder\",\r\n        cell: (r) => <Badge variant={enabledVariant(r.reminder_enabled)}>{r.reminder_enabled ? \"Enabled\" : \"Disabled\"}</Badge>,\r\n        className: \"whitespace-nowrap\",\r\n      },\r\n      {\r\n        id: \"last_run\",\r\n        header: \"Last run\",\r\n        cell: (r) => <div className=\"text-sm text-zinc-700\">{r.last_executed_at ? new Date(r.last_executed_at).toLocaleString() : \"—\"}</div>,\r\n        className: \"whitespace-nowrap\",\r\n      },\r\n      {\r\n        id: \"actions\",\r\n        header: \"Actions\",\r\n        cell: (r) => (\r\n          <div className=\"flex items-center gap-2\">\r\n            <Button\r\n              size=\"sm\"\r\n              variant=\"outline\"\r\n              onClick={() => {\r\n                setEditing(r);\r\n                setAddOpen(true);\r\n              }}\r\n            >\r\n              Edit\r\n            </Button>\r\n            <Button\r\n              size=\"sm\"\r\n              variant=\"outline\"\r\n              onClick={() => {\r\n                setTestTarget(r);\r\n                setTestOpen(true);\r\n              }}\r\n            >\r\n              Send test\r\n            </Button>\r\n            <Button asChild size=\"sm\" variant=\"outline\">\r\n              <Link href={`/app/${String(tenantSlug)}/reminder-logs?reminder_id=${r.id}`}>Logs</Link>\r\n            </Button>\r\n          </div>\r\n        ),\r\n        className: \"whitespace-nowrap\",\r\n      },\r\n    ],\r\n    [tenantSlug],\r\n  );\r\n\r\n  async function onDelete(reminder: MaintenanceReminderRule) {\r\n    if (!globalThis.confirm(`Delete reminder \"${reminder.name}\"?`)) return;\r\n    setError(null);\r\n    try {\r\n      await deleteMaintenanceReminder(String(tenantSlug), reminder.id);\r\n      await refresh();\r\n    } catch (e) {\r\n      setError(e instanceof Error ? e.message : \"Delete failed.\");\r\n    }\r\n  }\r\n\r\n  return (\r\n    <SectionShell title=\"Maintenance Reminders\" description=\"Automated service follow-ups based on delivery date.\">\r\n      <div className=\"flex flex-wrap items-center justify-end gap-2\">\r\n        <Button\r\n          variant=\"outline\"\r\n          onClick={() => {\r\n            setEditing(null);\r\n            setAddOpen(true);\r\n          }}\r\n        >\r\n          Add reminder\r\n        </Button>\r\n      </div>\r\n\r\n      <Card className=\"shadow-none\">\r\n        <CardContent className=\"pt-5\">\r\n          <DataTable\r\n            title=\"Reminders\"\r\n            data={pageRows}\r\n            columns={columns}\r\n            getRowId={(row) => row.id}\r\n            loading={loading}\r\n            emptyMessage=\"No reminders configured.\"\r\n            search={{ placeholder: \"Search reminders...\" }}\r\n            server={{\r\n              query,\r\n              onQueryChange: (value) => {\r\n                setQuery(value);\r\n                setPageIndex(0);\r\n              },\r\n              pageIndex,\r\n              onPageIndexChange: setPageIndex,\r\n              pageSize,\r\n              onPageSizeChange: (value) => {\r\n                setPageSize(value);\r\n                setPageIndex(0);\r\n              },\r\n              totalRows,\r\n            }}\r\n          />\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {error ? <div className=\"text-sm text-red-600\">{error}</div> : null}\r\n\r\n      <Modal\r\n        open={addOpen}\r\n        onClose={() => {\r\n          setAddOpen(false);\r\n          setEditing(null);\r\n        }}\r\n        title={editing ? `Edit reminder · ${editing.name}` : \"Add reminder\"}\r\n        footer={\r\n          <div className=\"flex items-center justify-between gap-2\">\r\n            <div>\r\n              {editing ? (\r\n                <Button variant=\"outline\" onClick={() => void onDelete(editing)}>\r\n                  Delete\r\n                </Button>\r\n              ) : null}\r\n            </div>\r\n            <div className=\"flex items-center justify-end gap-2\">\r\n              <Button\r\n                variant=\"outline\"\r\n                onClick={() => {\r\n                  setAddOpen(false);\r\n                  setEditing(null);\r\n                }}\r\n              >\r\n              Close\r\n            </Button>\r\n              <Button form=\"maintenanceReminderForm\" type=\"submit\">\r\n                Save\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        }\r\n      >\r\n        <ReminderForm\r\n          tenantSlug={tenantSlug}\r\n          deviceTypes={deviceTypes}\r\n          deviceBrands={deviceBrands}\r\n          initial={editing}\r\n          onSaved={async () => {\r\n            setAddOpen(false);\r\n            setEditing(null);\r\n            await refresh();\r\n          }}\r\n          onError={(msg) => setError(msg)}\r\n        />\r\n      </Modal>\r\n\r\n      <Modal\r\n        open={testOpen}\r\n        onClose={() => {\r\n          setTestOpen(false);\r\n          setTestTarget(null);\r\n        }}\r\n        title={testTarget ? `Send test · ${testTarget.name}` : \"Send test\"}\r\n        footer={\r\n          <div className=\"flex items-center justify-end gap-2\">\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={() => {\r\n                setTestOpen(false);\r\n                setTestTarget(null);\r\n              }}\r\n            >\r\n              Close\r\n            </Button>\r\n          </div>\r\n        }\r\n      >\r\n        <TestReminderForm\r\n          tenantSlug={tenantSlug}\r\n          reminder={testTarget}\r\n          onError={(msg) => setError(msg)}\r\n        />\r\n      </Modal>\r\n    </SectionShell>\r\n  );\r\n}\r\n\r\nfunction ReminderForm({\r\n  tenantSlug,\r\n  deviceTypes,\r\n  deviceBrands,\r\n  initial,\r\n  onSaved,\r\n  onError,\r\n}: {\r\n  tenantSlug: string;\r\n  deviceTypes: DeviceType[];\r\n  deviceBrands: DeviceBrand[];\r\n  initial: MaintenanceReminderRule | null;\r\n  onSaved: () => void | Promise<void>;\r\n  onError: (msg: string) => void;\r\n}) {\r\n  const [busy, setBusy] = useState(false);\r\n  const [formError, setFormError] = useState<string | null>(null);\r\n\r\n  const [name, setName] = useState(initial?.name ?? \"\");\r\n  const [description, setDescription] = useState(initial?.description ?? \"\");\r\n  const [intervalDays, setIntervalDays] = useState<number>(initial?.interval_days ?? 180);\r\n  const [deviceTypeId, setDeviceTypeId] = useState<number | 0>(initial?.device_type_id ?? 0);\r\n  const [deviceBrandId, setDeviceBrandId] = useState<number | 0>(initial?.device_brand_id ?? 0);\r\n  const [reminderEnabled, setReminderEnabled] = useState<boolean>(initial?.reminder_enabled ?? true);\r\n  const [emailEnabled, setEmailEnabled] = useState<boolean>(initial?.email_enabled ?? false);\r\n  const [smsEnabled, setSmsEnabled] = useState<boolean>(initial?.sms_enabled ?? false);\r\n  const [emailBody, setEmailBody] = useState<string>(initial?.email_body ?? \"\");\r\n  const [smsBody, setSmsBody] = useState<string>(initial?.sms_body ?? \"\");\r\n\r\n  useEffect(() => {\r\n    setName(initial?.name ?? \"\");\r\n    setDescription(initial?.description ?? \"\");\r\n    setIntervalDays(initial?.interval_days ?? 180);\r\n    setDeviceTypeId(initial?.device_type_id ?? 0);\r\n    setDeviceBrandId(initial?.device_brand_id ?? 0);\r\n    setReminderEnabled(initial?.reminder_enabled ?? true);\r\n    setEmailEnabled(initial?.email_enabled ?? false);\r\n    setSmsEnabled(initial?.sms_enabled ?? false);\r\n    setEmailBody(initial?.email_body ?? \"\");\r\n    setSmsBody(initial?.sms_body ?? \"\");\r\n  }, [initial]);\r\n\r\n  async function onSubmit(e: React.FormEvent) {\r\n    e.preventDefault();\r\n    setFormError(null);\r\n\r\n    const nextName = name.trim();\r\n    if (!nextName) {\r\n      setFormError(\"Name is required.\");\r\n      return;\r\n    }\r\n    if (!Number.isFinite(intervalDays) || intervalDays <= 0) {\r\n      setFormError(\"Interval must be at least 1 day.\");\r\n      return;\r\n    }\r\n    if (emailEnabled && !emailBody.trim()) {\r\n      setFormError(\"Email body is required when email is enabled.\");\r\n      return;\r\n    }\r\n    if (smsEnabled && !smsBody.trim()) {\r\n      setFormError(\"SMS body is required when SMS is enabled.\");\r\n      return;\r\n    }\r\n\r\n    const payload: MaintenanceReminderUpsertInput = {\r\n      name: nextName,\r\n      description: description.trim() ? description.trim() : null,\r\n      interval_days: intervalDays,\r\n      device_type_id: deviceTypeId ? deviceTypeId : null,\r\n      device_brand_id: deviceBrandId ? deviceBrandId : null,\r\n      reminder_enabled: reminderEnabled,\r\n      email_enabled: emailEnabled,\r\n      sms_enabled: smsEnabled,\r\n      email_body: emailBody.trim() ? emailBody : null,\r\n      sms_body: smsBody.trim() ? smsBody : null,\r\n    };\r\n\r\n    setBusy(true);\r\n    try {\r\n      if (initial) {\r\n        await updateMaintenanceReminder(String(tenantSlug), initial.id, payload);\r\n      } else {\r\n        await createMaintenanceReminder(String(tenantSlug), payload);\r\n      }\r\n      await onSaved();\r\n    } catch (err) {\r\n      const msg = err instanceof ApiError ? err.message : err instanceof Error ? err.message : \"Save failed.\";\r\n      setFormError(msg);\r\n      onError(msg);\r\n    } finally {\r\n      setBusy(false);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <form id=\"maintenanceReminderForm\" onSubmit={onSubmit} className=\"space-y-4\">\r\n      {formError ? <div className=\"text-sm text-red-600\">{formError}</div> : null}\r\n\r\n      <div className=\"grid grid-cols-1 gap-3 sm:grid-cols-2\">\r\n        <div className=\"space-y-1\">\r\n          <label className=\"text-sm font-medium\">Name</label>\r\n          <Input value={name} onChange={(e) => setName(e.target.value)} placeholder=\"e.g. 6-month service\" disabled={busy} />\r\n        </div>\r\n\r\n        <div className=\"space-y-1\">\r\n          <label className=\"text-sm font-medium\">Interval (days)</label>\r\n          <Input\r\n            type=\"number\"\r\n            min={1}\r\n            max={3650}\r\n            value={String(intervalDays)}\r\n            onChange={(e) => setIntervalDays(Number(e.target.value || 0))}\r\n            disabled={busy}\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"space-y-1\">\r\n        <label className=\"text-sm font-medium\">Description</label>\r\n        <Input value={description} onChange={(e) => setDescription(e.target.value)} placeholder=\"Optional\" disabled={busy} />\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-1 gap-3 sm:grid-cols-2\">\r\n        <div className=\"space-y-1\">\r\n          <label className=\"text-sm font-medium\">Device Type</label>\r\n          <Select value={String(deviceTypeId)} onChange={(e) => setDeviceTypeId(Number(e.target.value))} disabled={busy}>\r\n            <option value=\"0\">All</option>\r\n            {deviceTypes\r\n              .filter((t) => t && typeof t.id === \"number\")\r\n              .map((t) => (\r\n                <option key={t.id} value={String(t.id)}>\r\n                  {t.name}\r\n                </option>\r\n              ))}\r\n          </Select>\r\n        </div>\r\n        <div className=\"space-y-1\">\r\n          <label className=\"text-sm font-medium\">Brand</label>\r\n          <Select value={String(deviceBrandId)} onChange={(e) => setDeviceBrandId(Number(e.target.value))} disabled={busy}>\r\n            <option value=\"0\">All</option>\r\n            {deviceBrands\r\n              .filter((b) => b && typeof b.id === \"number\")\r\n              .map((b) => (\r\n                <option key={b.id} value={String(b.id)}>\r\n                  {b.name}\r\n                </option>\r\n              ))}\r\n          </Select>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-1 gap-3 sm:grid-cols-3\">\r\n        <label className=\"flex items-center gap-2 text-sm\">\r\n          <input type=\"checkbox\" checked={reminderEnabled} onChange={(e) => setReminderEnabled(e.target.checked)} disabled={busy} />\r\n          <span>Reminder enabled</span>\r\n        </label>\r\n        <label className=\"flex items-center gap-2 text-sm\">\r\n          <input type=\"checkbox\" checked={emailEnabled} onChange={(e) => setEmailEnabled(e.target.checked)} disabled={busy} />\r\n          <span>Email enabled</span>\r\n        </label>\r\n        <label className=\"flex items-center gap-2 text-sm\">\r\n          <input type=\"checkbox\" checked={smsEnabled} onChange={(e) => setSmsEnabled(e.target.checked)} disabled={busy} />\r\n          <span>SMS enabled</span>\r\n        </label>\r\n      </div>\r\n\r\n      <div className=\"space-y-1\">\r\n        <div className=\"text-xs text-zinc-500\">\r\n          Template variables: {\"{{customer_name}}\"} {\"{{device_name}}\"} {\"{{unsubscribe_device}}\"}\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"space-y-1\">\r\n        <label className=\"text-sm font-medium\">Email body</label>\r\n        <textarea\r\n          className=\"w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)] outline-none transition focus-visible:ring-2 focus-visible:ring-[color:color-mix(in_srgb,var(--rb-orange),white_65%)]\"\r\n          rows={6}\r\n          value={emailBody}\r\n          onChange={(e) => setEmailBody(e.target.value)}\r\n          placeholder=\"Write your email message...\"\r\n          disabled={busy}\r\n        />\r\n      </div>\r\n\r\n      <div className=\"space-y-1\">\r\n        <label className=\"text-sm font-medium\">SMS body</label>\r\n        <textarea\r\n          className=\"w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)] outline-none transition focus-visible:ring-2 focus-visible:ring-[color:color-mix(in_srgb,var(--rb-orange),white_65%)]\"\r\n          rows={4}\r\n          value={smsBody}\r\n          onChange={(e) => setSmsBody(e.target.value)}\r\n          placeholder=\"Write your SMS message...\"\r\n          disabled={busy}\r\n        />\r\n      </div>\r\n    </form>\r\n  );\r\n}\r\n\r\nfunction TestReminderForm({\r\n  tenantSlug,\r\n  reminder,\r\n  onError,\r\n}: {\r\n  tenantSlug: string;\r\n  reminder: MaintenanceReminderRule | null;\r\n  onError: (msg: string) => void;\r\n}) {\r\n  const [email, setEmail] = useState(\"\");\r\n  const [phone, setPhone] = useState(\"\");\r\n  const [busy, setBusy] = useState(false);\r\n  const [localError, setLocalError] = useState<string | null>(null);\r\n  const [preview, setPreview] = useState<{ email: string; sms: string } | null>(null);\r\n  const [status, setStatus] = useState<{ email: string; sms: string } | null>(null);\r\n\r\n  useEffect(() => {\r\n    setLocalError(null);\r\n    setPreview(null);\r\n    setStatus(null);\r\n  }, [reminder]);\r\n\r\n  async function onSend() {\r\n    if (!reminder) return;\r\n    setLocalError(null);\r\n    setPreview(null);\r\n    setStatus(null);\r\n\r\n    const nextEmail = email.trim();\r\n    const nextPhone = phone.trim();\r\n\r\n    if (!nextEmail && !nextPhone) {\r\n      setLocalError(\"Email or phone is required.\");\r\n      return;\r\n    }\r\n\r\n    setBusy(true);\r\n    try {\r\n      const res = await testMaintenanceReminder(String(tenantSlug), reminder.id, {\r\n        email: nextEmail || null,\r\n        phone: nextPhone || null,\r\n      });\r\n      setPreview(res.preview);\r\n      setStatus(res.status);\r\n    } catch (e) {\r\n      const msg = e instanceof ApiError ? e.message : e instanceof Error ? e.message : \"Test failed.\";\r\n      setLocalError(msg);\r\n      onError(msg);\r\n    } finally {\r\n      setBusy(false);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-3\">\r\n      {localError ? <div className=\"text-sm text-red-600\">{localError}</div> : null}\r\n\r\n      <div className=\"grid grid-cols-1 gap-3 sm:grid-cols-2\">\r\n        <div className=\"space-y-1\">\r\n          <label className=\"text-sm font-medium\">Email</label>\r\n          <Input value={email} onChange={(e) => setEmail(e.target.value)} placeholder=\"name@company.com\" disabled={busy} />\r\n        </div>\r\n        <div className=\"space-y-1\">\r\n          <label className=\"text-sm font-medium\">Phone</label>\r\n          <Input value={phone} onChange={(e) => setPhone(e.target.value)} placeholder=\"+1 555 000 0000\" disabled={busy} />\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"flex items-center justify-end\">\r\n        <Button onClick={() => void onSend()} disabled={busy || !reminder}>\r\n          {busy ? \"Sending...\" : \"Send test\"}\r\n        </Button>\r\n      </div>\r\n\r\n      {status ? (\r\n        <div className=\"grid grid-cols-1 gap-2 sm:grid-cols-2\">\r\n          <div className=\"text-xs text-zinc-600\">Email status: {status.email}</div>\r\n          <div className=\"text-xs text-zinc-600\">SMS status: {status.sms}</div>\r\n        </div>\r\n      ) : null}\r\n\r\n      {preview ? (\r\n        <div className=\"space-y-3\">\r\n          <div className=\"rounded border border-zinc-200 bg-white p-3\">\r\n            <div className=\"text-xs font-semibold text-zinc-700\">Email preview</div>\r\n            <pre className=\"mt-2 whitespace-pre-wrap text-xs text-zinc-700\">{preview.email || \"(empty)\"}</pre>\r\n          </div>\r\n          <div className=\"rounded border border-zinc-200 bg-white p-3\">\r\n            <div className=\"text-xs font-semibold text-zinc-700\">SMS preview</div>\r\n            <pre className=\"mt-2 whitespace-pre-wrap text-xs text-zinc-700\">{preview.sms || \"(empty)\"}</pre>\r\n          </div>\r\n        </div>\r\n      ) : null}\r\n    </div>\r\n  );\r\n}\r\n","\"use client\";\r\n\r\nimport React from \"react\";\r\nimport { Select } from \"@/components/ui/Select\";\r\nimport { SectionShell } from \"@/app/app/[tenant]/settings/_components/repairbuddy/sections/SectionShell\";\r\nimport type { RepairBuddySettingsDraft } from \"@/app/app/[tenant]/settings/_components/repairbuddy/types\";\r\n\r\nexport function MyAccountSection({\r\n  draft,\r\n  updateMyAccount,\r\n}: {\r\n  draft: RepairBuddySettingsDraft;\r\n  updateMyAccount: (patch: Partial<RepairBuddySettingsDraft[\"myAccount\"]>) => void;\r\n}) {\r\n  const a = draft.myAccount;\r\n\r\n  return (\r\n    <SectionShell title=\"My Account\" description=\"Customer portal toggles and booking form type.\">\r\n      <div className=\"grid gap-4 sm:grid-cols-2\">\r\n        <label className=\"sm:col-span-2 flex items-center gap-2 text-sm\">\r\n          <input type=\"checkbox\" checked={a.disableBooking} onChange={(e) => updateMyAccount({ disableBooking: e.target.checked })} />\r\n          Disable booking\r\n        </label>\r\n        <label className=\"sm:col-span-2 flex items-center gap-2 text-sm\">\r\n          <input type=\"checkbox\" checked={a.disableEstimates} onChange={(e) => updateMyAccount({ disableEstimates: e.target.checked })} />\r\n          Disable estimates\r\n        </label>\r\n        <label className=\"sm:col-span-2 flex items-center gap-2 text-sm\">\r\n          <input type=\"checkbox\" checked={a.disableReviews} onChange={(e) => updateMyAccount({ disableReviews: e.target.checked })} />\r\n          Disable reviews\r\n        </label>\r\n\r\n        <div className=\"space-y-1\">\r\n          <label className=\"text-sm font-medium\">Booking form type</label>\r\n          <Select value={a.bookingFormType} onChange={(e) => updateMyAccount({ bookingFormType: e.target.value as RepairBuddySettingsDraft[\"myAccount\"][\"bookingFormType\"] })}>\r\n            <option value=\"simple\">Simple</option>\r\n            <option value=\"detailed\">Detailed</option>\r\n          </Select>\r\n        </div>\r\n      </div>\r\n    </SectionShell>\r\n  );\r\n}\r\n","\"use client\";\r\n\r\nimport React from \"react\";\r\nimport { SectionShell } from \"@/app/app/[tenant]/settings/_components/repairbuddy/sections/SectionShell\";\r\nimport type { RepairBuddySettingsDraft } from \"@/app/app/[tenant]/settings/_components/repairbuddy/types\";\r\n\r\nexport function PaymentsSection({\r\n  draft,\r\n  updatePayments,\r\n  isMock,\r\n}: {\r\n  draft: RepairBuddySettingsDraft;\r\n  updatePayments: (patch: Partial<RepairBuddySettingsDraft[\"payments\"]>) => void;\r\n  isMock: boolean;\r\n}) {\r\n  void isMock;\r\n  const p = draft.payments;\r\n\r\n  return (\r\n    <SectionShell title=\"Payments\" description=\"Allowed payment methods.\">\r\n      <div>\r\n        <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Payment methods</div>\r\n        <div className=\"mt-2 grid gap-2 sm:grid-cols-2\">\r\n          <label className=\"flex items-center gap-2 text-sm\">\r\n            <input\r\n              type=\"checkbox\"\r\n              checked={p.paymentMethods.cash}\r\n              onChange={(e) => updatePayments({ paymentMethods: { ...p.paymentMethods, cash: e.target.checked } })}\r\n            />\r\n            Cash\r\n          </label>\r\n          <label className=\"flex items-center gap-2 text-sm text-zinc-400\">\r\n            <input type=\"checkbox\" checked={p.paymentMethods.card} disabled />\r\n            Card\r\n          </label>\r\n          <label className=\"flex items-center gap-2 text-sm text-zinc-400\">\r\n            <input type=\"checkbox\" checked={p.paymentMethods.bankTransfer} disabled />\r\n            Bank transfer\r\n          </label>\r\n          <label className=\"flex items-center gap-2 text-sm text-zinc-400\">\r\n            <input type=\"checkbox\" checked={p.paymentMethods.paypal} disabled />\r\n            PayPal\r\n          </label>\r\n          <label className=\"flex items-center gap-2 text-sm text-zinc-400\">\r\n            <input type=\"checkbox\" checked={p.paymentMethods.other} disabled />\r\n            Other\r\n          </label>\r\n        </div>\r\n      </div>\r\n    </SectionShell>\r\n  );\r\n}\r\n","\"use client\";\r\n\r\nimport React, { useMemo } from \"react\";\r\nimport { Input } from \"@/components/ui/Input\";\r\nimport { Select } from \"@/components/ui/Select\";\r\nimport { SectionShell } from \"@/app/app/[tenant]/settings/_components/repairbuddy/sections/SectionShell\";\r\nimport type { RepairBuddySettingsDraft } from \"@/app/app/[tenant]/settings/_components/repairbuddy/types\";\r\n\r\nexport function ReviewsSection({\r\n  draft,\r\n  updateReviews,\r\n}: {\r\n  draft: RepairBuddySettingsDraft;\r\n  updateReviews: (patch: Partial<RepairBuddySettingsDraft[\"reviews\"]>) => void;\r\n}) {\r\n  const r = draft.reviews;\r\n  const statusOptions = useMemo(() => draft.jobStatuses.statuses, [draft.jobStatuses.statuses]);\r\n\r\n  return (\r\n    <SectionShell title=\"Reviews\" description=\"Customer feedback request rules and message templates.\">\r\n      <div className=\"grid gap-4 sm:grid-cols-2\">\r\n        <label className=\"sm:col-span-2 flex items-center gap-2 text-sm\">\r\n          <input type=\"checkbox\" checked={r.requestFeedbackBySms} onChange={(e) => updateReviews({ requestFeedbackBySms: e.target.checked })} />\r\n          Request feedback by SMS\r\n        </label>\r\n        <label className=\"sm:col-span-2 flex items-center gap-2 text-sm\">\r\n          <input type=\"checkbox\" checked={r.requestFeedbackByEmail} onChange={(e) => updateReviews({ requestFeedbackByEmail: e.target.checked })} />\r\n          Request feedback by Email\r\n        </label>\r\n\r\n        <div className=\"space-y-1\">\r\n          <label className=\"text-sm font-medium\">Feedback page selection</label>\r\n          <Select value={r.feedbackPage} onChange={(e) => updateReviews({ feedbackPage: e.target.value })}>\r\n            <option value=\"\">Select page (mock)</option>\r\n            <option value=\"feedback\">Feedback</option>\r\n            <option value=\"reviews\">Reviews</option>\r\n          </Select>\r\n        </div>\r\n\r\n        <div className=\"space-y-1\">\r\n          <label className=\"text-sm font-medium\">Send review request if job status is</label>\r\n          <Select value={r.sendReviewRequestIfJobStatusId} onChange={(e) => updateReviews({ sendReviewRequestIfJobStatusId: e.target.value })}>\r\n            {statusOptions.map((s) => (\r\n              <option key={s.id} value={s.id}>\r\n                {s.name}\r\n              </option>\r\n            ))}\r\n          </Select>\r\n        </div>\r\n\r\n        <div className=\"space-y-1\">\r\n          <label className=\"text-sm font-medium\">Auto feedback request interval (days)</label>\r\n          <Input\r\n            type=\"number\"\r\n            min={0}\r\n            value={String(r.autoFeedbackRequestIntervalDays)}\r\n            onChange={(e) => updateReviews({ autoFeedbackRequestIntervalDays: Number(e.target.value || 0) })}\r\n          />\r\n        </div>\r\n\r\n        <div className=\"sm:col-span-2 space-y-1\">\r\n          <label className=\"text-sm font-medium\">Email subject</label>\r\n          <Input value={r.emailSubject} onChange={(e) => updateReviews({ emailSubject: e.target.value })} />\r\n        </div>\r\n\r\n        <div className=\"sm:col-span-2 space-y-1\">\r\n          <label className=\"text-sm font-medium\">Email message template</label>\r\n          <textarea\r\n            className=\"min-h-[120px] w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm\"\r\n            value={r.emailMessageTemplate}\r\n            onChange={(e) => updateReviews({ emailMessageTemplate: e.target.value })}\r\n          />\r\n        </div>\r\n\r\n        <div className=\"sm:col-span-2 space-y-1\">\r\n          <label className=\"text-sm font-medium\">SMS message template</label>\r\n          <textarea\r\n            className=\"min-h-[90px] w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm\"\r\n            value={r.smsMessageTemplate}\r\n            onChange={(e) => updateReviews({ smsMessageTemplate: e.target.value })}\r\n          />\r\n        </div>\r\n      </div>\r\n    </SectionShell>\r\n  );\r\n}\r\n","\"use client\";\r\n\r\nimport React from \"react\";\r\nimport { Select } from \"@/components/ui/Select\";\r\nimport { SectionShell } from \"@/app/app/[tenant]/settings/_components/repairbuddy/sections/SectionShell\";\r\nimport type { RepairBuddySettingsDraft } from \"@/app/app/[tenant]/settings/_components/repairbuddy/types\";\r\n\r\nexport function ServiceSettingsSection({\r\n  draft,\r\n  updateServiceSettings,\r\n}: {\r\n  draft: RepairBuddySettingsDraft;\r\n  updateServiceSettings: (patch: Partial<RepairBuddySettingsDraft[\"serviceSettings\"]>) => void;\r\n}) {\r\n  const s = draft.serviceSettings;\r\n\r\n  return (\r\n    <SectionShell title=\"Service Settings\" description=\"Settings for the public service page and booking behavior.\">\r\n      <div className=\"grid gap-4 sm:grid-cols-2\">\r\n        <div className=\"sm:col-span-2 space-y-1\">\r\n          <label className=\"text-sm font-medium\">Sidebar description</label>\r\n          <textarea\r\n            className=\"min-h-[120px] w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm\"\r\n            value={s.sidebarDescription}\r\n            onChange={(e) => updateServiceSettings({ sidebarDescription: e.target.value })}\r\n          />\r\n        </div>\r\n\r\n        <label className=\"sm:col-span-2 flex items-center gap-2 text-sm\">\r\n          <input\r\n            type=\"checkbox\"\r\n            checked={s.disableBookingOnServicePage}\r\n            onChange={(e) => updateServiceSettings({ disableBookingOnServicePage: e.target.checked })}\r\n          />\r\n          Disable booking on service page\r\n        </label>\r\n\r\n        <div className=\"space-y-1\">\r\n          <label className=\"text-sm font-medium\">Booking form type</label>\r\n          <Select\r\n            value={s.bookingFormType}\r\n            onChange={(e) => updateServiceSettings({ bookingFormType: e.target.value as RepairBuddySettingsDraft[\"serviceSettings\"][\"bookingFormType\"] })}\r\n          >\r\n            <option value=\"simple\">Simple</option>\r\n            <option value=\"detailed\">Detailed</option>\r\n          </Select>\r\n        </div>\r\n      </div>\r\n    </SectionShell>\r\n  );\r\n}\r\n","\"use client\";\r\n\r\nimport React, { useMemo } from \"react\";\r\nimport { Input } from \"@/components/ui/Input\";\r\nimport { Select } from \"@/components/ui/Select\";\r\nimport { SectionShell } from \"@/app/app/[tenant]/settings/_components/repairbuddy/sections/SectionShell\";\r\nimport type { RepairBuddySettingsDraft, RepairBuddySignatureWorkflowSettings } from \"@/app/app/[tenant]/settings/_components/repairbuddy/types\";\r\n\r\nexport function SignatureWorkflowSection({\r\n  draft,\r\n  updateSignatureWorkflow,\r\n}: {\r\n  draft: RepairBuddySettingsDraft;\r\n  updateSignatureWorkflow: (patch: Partial<RepairBuddySettingsDraft[\"signatureWorkflow\"]>) => void;\r\n}) {\r\n  const s = draft.signatureWorkflow;\r\n  const statuses = useMemo(() => draft.jobStatuses.statuses, [draft.jobStatuses.statuses]);\r\n\r\n  function updatePickup(patch: Partial<RepairBuddySignatureWorkflowSettings[\"pickup\"]>) {\r\n    updateSignatureWorkflow({ pickup: { ...s.pickup, ...patch } });\r\n  }\r\n\r\n  function updateDelivery(patch: Partial<RepairBuddySignatureWorkflowSettings[\"delivery\"]>) {\r\n    updateSignatureWorkflow({ delivery: { ...s.delivery, ...patch } });\r\n  }\r\n\r\n  return (\r\n    <SectionShell title=\"Signature Workflow\" description=\"Pickup and delivery signature automation.\">\r\n      <div className=\"grid gap-6\">\r\n        <SignatureBlock\r\n          title=\"Pickup signature\"\r\n          value={s.pickup}\r\n          statuses={statuses}\r\n          onChange={updatePickup}\r\n        />\r\n        <SignatureBlock\r\n          title=\"Delivery signature\"\r\n          value={s.delivery}\r\n          statuses={statuses}\r\n          onChange={updateDelivery}\r\n        />\r\n      </div>\r\n    </SectionShell>\r\n  );\r\n}\r\n\r\nfunction SignatureBlock({\r\n  title,\r\n  value,\r\n  statuses,\r\n  onChange,\r\n}: {\r\n  title: string;\r\n  value: RepairBuddySignatureWorkflowSettings[\"pickup\"];\r\n  statuses: RepairBuddySettingsDraft[\"jobStatuses\"][\"statuses\"];\r\n  onChange: (patch: Partial<RepairBuddySignatureWorkflowSettings[\"pickup\"]>) => void;\r\n}) {\r\n  return (\r\n    <div className=\"rounded-[var(--rb-radius-md)] border border-[var(--rb-border)] bg-white p-4\">\r\n      <div className=\"text-sm font-semibold text-[var(--rb-text)]\">{title}</div>\r\n\r\n      <div className=\"mt-3 grid gap-4 sm:grid-cols-2\">\r\n        <label className=\"sm:col-span-2 flex items-center gap-2 text-sm\">\r\n          <input type=\"checkbox\" checked={value.enabled} onChange={(e) => onChange({ enabled: e.target.checked })} />\r\n          Enable\r\n        </label>\r\n\r\n        <div className=\"space-y-1\">\r\n          <label className=\"text-sm font-medium\">Trigger status</label>\r\n          <Select value={value.triggerStatusId} onChange={(e) => onChange({ triggerStatusId: e.target.value })}>\r\n            {statuses.map((s) => (\r\n              <option key={s.id} value={s.id}>\r\n                {s.name}\r\n              </option>\r\n            ))}\r\n          </Select>\r\n        </div>\r\n\r\n        <div className=\"space-y-1\">\r\n          <label className=\"text-sm font-medium\">Status after submission</label>\r\n          <Select value={value.statusAfterSubmissionId} onChange={(e) => onChange({ statusAfterSubmissionId: e.target.value })}>\r\n            {statuses.map((s) => (\r\n              <option key={s.id} value={s.id}>\r\n                {s.name}\r\n              </option>\r\n            ))}\r\n          </Select>\r\n        </div>\r\n\r\n        <div className=\"sm:col-span-2 space-y-1\">\r\n          <label className=\"text-sm font-medium\">Email subject</label>\r\n          <Input value={value.templates.emailSubject} onChange={(e) => onChange({ templates: { ...value.templates, emailSubject: e.target.value } })} />\r\n        </div>\r\n\r\n        <div className=\"sm:col-span-2 space-y-1\">\r\n          <label className=\"text-sm font-medium\">Email template</label>\r\n          <textarea\r\n            className=\"min-h-[140px] w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm\"\r\n            value={value.templates.emailTemplate}\r\n            onChange={(e) => onChange({ templates: { ...value.templates, emailTemplate: e.target.value } })}\r\n          />\r\n        </div>\r\n\r\n        <div className=\"sm:col-span-2 space-y-1\">\r\n          <label className=\"text-sm font-medium\">SMS text</label>\r\n          <textarea\r\n            className=\"min-h-[90px] w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm\"\r\n            value={value.templates.smsText}\r\n            onChange={(e) => onChange({ templates: { ...value.templates, smsText: e.target.value } })}\r\n          />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","\"use client\";\r\n\r\nimport React, { useMemo } from \"react\";\r\nimport { Input } from \"@/components/ui/Input\";\r\nimport { Select } from \"@/components/ui/Select\";\r\nimport { SectionShell } from \"@/app/app/[tenant]/settings/_components/repairbuddy/sections/SectionShell\";\r\nimport type { RepairBuddySettingsDraft, RepairBuddySmsGateway } from \"@/app/app/[tenant]/settings/_components/repairbuddy/types\";\r\n\r\nexport function SmsSection({\r\n  draft,\r\n  updateSms,\r\n}: {\r\n  draft: RepairBuddySettingsDraft;\r\n  updateSms: (patch: Partial<RepairBuddySettingsDraft[\"sms\"]>) => void;\r\n}) {\r\n  const s = draft.sms;\r\n  const statusOptions = useMemo(() => draft.jobStatuses.statuses, [draft.jobStatuses.statuses]);\r\n\r\n  function toggleStatus(id: string) {\r\n    const set = new Set(s.sendWhenStatusChangedToIds);\r\n    if (set.has(id)) set.delete(id);\r\n    else set.add(id);\r\n    updateSms({ sendWhenStatusChangedToIds: Array.from(set) });\r\n  }\r\n\r\n  return (\r\n    <SectionShell title=\"SMS\" description=\"SMS gateway setup and when messages are sent (UI-only).\">\r\n      <div className=\"grid gap-4 sm:grid-cols-2\">\r\n        <label className=\"sm:col-span-2 flex items-center gap-2 text-sm\">\r\n          <input\r\n            type=\"checkbox\"\r\n            checked={s.activateSmsForSelectiveStatuses}\r\n            onChange={(e) => updateSms({ activateSmsForSelectiveStatuses: e.target.checked })}\r\n          />\r\n          Activate SMS for selective statuses\r\n        </label>\r\n\r\n        <div className=\"space-y-1\">\r\n          <label className=\"text-sm font-medium\">Gateway selection</label>\r\n          <Select value={s.gateway} onChange={(e) => updateSms({ gateway: e.target.value as RepairBuddySmsGateway })}>\r\n            <option value=\"twilio\">Twilio</option>\r\n            <option value=\"nexmo\">Nexmo</option>\r\n            <option value=\"custom\">Custom</option>\r\n          </Select>\r\n        </div>\r\n\r\n        <div className=\"space-y-1\">\r\n          <label className=\"text-sm font-medium\">From number</label>\r\n          <Input value={s.gatewayFromNumber} onChange={(e) => updateSms({ gatewayFromNumber: e.target.value })} placeholder=\"+15551234567\" />\r\n        </div>\r\n\r\n        <div className=\"space-y-1\">\r\n          <label className=\"text-sm font-medium\">Account SID</label>\r\n          <Input value={s.gatewayAccountSid} onChange={(e) => updateSms({ gatewayAccountSid: e.target.value })} placeholder=\"(mock)\" />\r\n        </div>\r\n        <div className=\"space-y-1\">\r\n          <label className=\"text-sm font-medium\">Auth token</label>\r\n          <Input value={s.gatewayAuthToken} onChange={(e) => updateSms({ gatewayAuthToken: e.target.value })} placeholder=\"(mock)\" />\r\n        </div>\r\n\r\n        <div className=\"sm:col-span-2\">\r\n          <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Send when status changed to</div>\r\n          <div className=\"mt-2 grid gap-2 sm:grid-cols-2\">\r\n            {statusOptions.map((st) => (\r\n              <label key={st.id} className=\"flex items-center gap-2 text-sm\">\r\n                <input type=\"checkbox\" checked={s.sendWhenStatusChangedToIds.includes(st.id)} onChange={() => toggleStatus(st.id)} />\r\n                {st.name}\r\n              </label>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"sm:col-span-2\">\r\n          <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Test SMS</div>\r\n          <div className=\"mt-2 grid gap-3 sm:grid-cols-2\">\r\n            <Input value={s.testNumber} onChange={(e) => updateSms({ testNumber: e.target.value })} placeholder=\"Test number\" />\r\n            <Input value={s.testMessage} onChange={(e) => updateSms({ testMessage: e.target.value })} placeholder=\"Test message\" />\r\n          </div>\r\n          <div className=\"mt-2 text-xs text-zinc-500\">Sending is disabled in this phase.</div>\r\n        </div>\r\n      </div>\r\n    </SectionShell>\r\n  );\r\n}\r\n","\"use client\";\r\n\r\nimport React from \"react\";\r\nimport { Input } from \"@/components/ui/Input\";\r\nimport { SectionShell } from \"@/app/app/[tenant]/settings/_components/repairbuddy/sections/SectionShell\";\r\nimport type { RepairBuddySettingsDraft } from \"@/app/app/[tenant]/settings/_components/repairbuddy/types\";\r\n\r\nexport function StylingLabelsSection({\r\n  draft,\r\n  updateStylingLabels,\r\n}: {\r\n  draft: RepairBuddySettingsDraft;\r\n  updateStylingLabels: (patch: Partial<RepairBuddySettingsDraft[\"stylingLabels\"]>) => void;\r\n}) {\r\n  const s = draft.stylingLabels;\r\n\r\n  return (\r\n    <SectionShell title=\"Styling & Labels\" description=\"Customer-facing label text and primary/secondary colors.\">\r\n      <div className=\"grid gap-4 sm:grid-cols-2\">\r\n        <div className=\"sm:col-span-2\">\r\n          <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Labels</div>\r\n          <div className=\"mt-2 grid gap-3 sm:grid-cols-2\">\r\n            <Input value={s.labels.delivery} onChange={(e) => updateStylingLabels({ labels: { ...s.labels, delivery: e.target.value } })} placeholder=\"Delivery\" />\r\n            <Input value={s.labels.pickup} onChange={(e) => updateStylingLabels({ labels: { ...s.labels, pickup: e.target.value } })} placeholder=\"Pickup\" />\r\n            <Input value={s.labels.nextService} onChange={(e) => updateStylingLabels({ labels: { ...s.labels, nextService: e.target.value } })} placeholder=\"Next service\" />\r\n            <Input value={s.labels.caseNumber} onChange={(e) => updateStylingLabels({ labels: { ...s.labels, caseNumber: e.target.value } })} placeholder=\"Case number\" />\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"sm:col-span-2\">\r\n          <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Colors</div>\r\n          <div className=\"mt-2 grid gap-3 sm:grid-cols-2\">\r\n            <div>\r\n              <label className=\"text-xs font-medium text-zinc-600\">Primary</label>\r\n              <div className=\"mt-1 flex items-center gap-3\">\r\n                <input\r\n                  type=\"color\"\r\n                  value={s.colors.primary}\r\n                  onChange={(e) => updateStylingLabels({ colors: { ...s.colors, primary: e.target.value } })}\r\n                  className=\"h-10 w-14 rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white shadow-sm\"\r\n                />\r\n                <Input value={s.colors.primary} onChange={(e) => updateStylingLabels({ colors: { ...s.colors, primary: e.target.value } })} />\r\n              </div>\r\n            </div>\r\n            <div>\r\n              <label className=\"text-xs font-medium text-zinc-600\">Secondary</label>\r\n              <div className=\"mt-1 flex items-center gap-3\">\r\n                <input\r\n                  type=\"color\"\r\n                  value={s.colors.secondary}\r\n                  onChange={(e) => updateStylingLabels({ colors: { ...s.colors, secondary: e.target.value } })}\r\n                  className=\"h-10 w-14 rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white shadow-sm\"\r\n                />\r\n                <Input value={s.colors.secondary} onChange={(e) => updateStylingLabels({ colors: { ...s.colors, secondary: e.target.value } })} />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </SectionShell>\r\n  );\r\n}\r\n","\"use client\";\r\n\r\nimport React, { useEffect, useMemo, useState } from \"react\";\r\nimport { Button } from \"@/components/ui/Button\";\r\nimport { Card, CardContent } from \"@/components/ui/Card\";\r\nimport { DataTable, type DataTableColumn } from \"@/components/ui/DataTable\";\r\nimport { Input } from \"@/components/ui/Input\";\r\nimport { Modal } from \"@/components/ui/Modal\";\r\nimport { Select } from \"@/components/ui/Select\";\r\nimport { SectionShell } from \"@/app/app/[tenant]/settings/_components/repairbuddy/sections/SectionShell\";\r\nimport type { RepairBuddyTax, RepairBuddySettingsDraft } from \"@/app/app/[tenant]/settings/_components/repairbuddy/types\";\r\nimport { updateRepairBuddySettings } from \"@/lib/repairbuddy-settings\";\r\nimport { getSetup, updateSetup } from \"@/lib/setup\";\r\nimport {\r\n  createRepairBuddyTax,\r\n  deleteRepairBuddyTax,\r\n  getRepairBuddyTaxes,\r\n  setRepairBuddyTaxActive,\r\n  setRepairBuddyTaxDefault,\r\n  updateRepairBuddyTax,\r\n  type ApiRepairBuddyTax,\r\n} from \"@/lib/repairbuddy-taxes\";\r\n\r\nexport function TaxesSection({\r\n  tenantSlug,\r\n  draft,\r\n  updateTaxes,\r\n  isMock,\r\n}: {\r\n  tenantSlug: string;\r\n  draft: RepairBuddySettingsDraft;\r\n  updateTaxes: (patch: Partial<RepairBuddySettingsDraft[\"taxes\"]>) => void;\r\n  isMock: boolean;\r\n}) {\r\n  const [addOpen, setAddOpen] = useState(false);\r\n  const [editOpen, setEditOpen] = useState(false);\r\n  const [busy, setBusy] = useState(false);\r\n  const [savingMeta, setSavingMeta] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [status, setStatus] = useState<string | null>(null);\r\n\r\n  const [taxRegistered, setTaxRegistered] = useState(false);\r\n  const [billingVatNumber, setBillingVatNumber] = useState(\"\");\r\n  const [invoicePrefix, setInvoicePrefix] = useState(\"RB\");\r\n\r\n  const [taxes, setTaxes] = useState<ApiRepairBuddyTax[]>([]);\r\n  const [loadingTaxes, setLoadingTaxes] = useState(false);\r\n\r\n  const [query, setQuery] = useState(\"\");\r\n  const [pageIndex, setPageIndex] = useState(0);\r\n  const [pageSize, setPageSize] = useState(10);\r\n  const t = draft.taxes;\r\n\r\n  async function persistTaxesPrefs(next: RepairBuddySettingsDraft[\"taxes\"]) {\r\n    if (isMock) return;\r\n    try {\r\n      await updateRepairBuddySettings(String(tenantSlug), {\r\n        ...draft,\r\n        taxes: next,\r\n      });\r\n    } catch (e) {\r\n      setError(e instanceof Error ? e.message : \"Failed to save tax preferences.\");\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    let alive = true;\r\n    async function load() {\r\n      setError(null);\r\n      setLoadingTaxes(true);\r\n      try {\r\n        const [res, setupRes] = await Promise.all([getRepairBuddyTaxes(String(tenantSlug)), getSetup(String(tenantSlug))]);\r\n        if (!alive) return;\r\n        setTaxes(Array.isArray(res.taxes) ? res.taxes : []);\r\n\r\n        const vat = typeof setupRes.tenant?.billing_vat_number === \"string\" ? setupRes.tenant.billing_vat_number : \"\";\r\n        setBillingVatNumber(vat);\r\n\r\n        const state = (setupRes.setup?.state ?? {}) as Record<string, unknown>;\r\n        const taxState = (state.tax ?? {}) as Record<string, unknown>;\r\n        setTaxRegistered(typeof taxState.tax_registered === \"boolean\" ? taxState.tax_registered : false);\r\n        setInvoicePrefix(typeof taxState.invoice_prefix === \"string\" ? taxState.invoice_prefix : \"RB\");\r\n      } catch (e) {\r\n        if (!alive) return;\r\n        setError(e instanceof Error ? e.message : \"Failed to load taxes.\");\r\n      } finally {\r\n        if (!alive) return;\r\n        setLoadingTaxes(false);\r\n      }\r\n    }\r\n    void load();\r\n    return () => {\r\n      alive = false;\r\n    };\r\n  }, [tenantSlug]);\r\n\r\n  async function saveTaxMeta() {\r\n    if (isMock) return;\r\n    setStatus(null);\r\n    setError(null);\r\n    setSavingMeta(true);\r\n    try {\r\n      const setupRes = await getSetup(String(tenantSlug));\r\n      const prevState = (setupRes.setup?.state ?? {}) as Record<string, unknown>;\r\n      const prevTax = (prevState.tax ?? {}) as Record<string, unknown>;\r\n      const nextState: Record<string, unknown> = {\r\n        ...prevState,\r\n        tax: {\r\n          ...prevTax,\r\n          tax_registered: Boolean(taxRegistered),\r\n          invoice_prefix: invoicePrefix.trim() || null,\r\n        },\r\n      };\r\n\r\n      await updateSetup(String(tenantSlug), {\r\n        billing_vat_number: billingVatNumber.trim() || null,\r\n        setup_state: nextState,\r\n      });\r\n      setStatus(\"Saved.\");\r\n    } catch (e) {\r\n      setError(e instanceof Error ? e.message : \"Failed to save tax settings.\");\r\n    } finally {\r\n      setSavingMeta(false);\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    function onBranchChanged() {\r\n      setStatus(null);\r\n      setError(null);\r\n      setEditOpen(false);\r\n      setAddOpen(false);\r\n      void refresh();\r\n    }\r\n\r\n    if (typeof window === \"undefined\") return;\r\n\r\n    window.addEventListener(\"rb:branch-changed\", onBranchChanged);\r\n    return () => {\r\n      window.removeEventListener(\"rb:branch-changed\", onBranchChanged);\r\n    };\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [tenantSlug]);\r\n\r\n  function syncDraft(nextTaxes: ApiRepairBuddyTax[]) {\r\n    const mapped: RepairBuddyTax[] = nextTaxes.map((x) => ({\r\n      id: String(x.id),\r\n      name: x.name,\r\n      ratePercent: Number(x.rate),\r\n      status: x.is_active ? \"active\" : \"inactive\",\r\n    }));\r\n\r\n    const defaultFromDb = nextTaxes.find((x) => x.is_default) ?? null;\r\n    const nextIds = new Set(nextTaxes.map((x) => String(x.id)));\r\n    const active = nextTaxes.filter((x) => x.is_active);\r\n    const activeIds = new Set(active.map((x) => String(x.id)));\r\n\r\n    const currentDefault = t.defaultTaxId;\r\n    const currentIsKnown = typeof currentDefault === \"string\" && currentDefault.length > 0 && nextIds.has(currentDefault);\r\n    const currentIsActive = currentIsKnown && activeIds.has(currentDefault);\r\n\r\n    const fallbackDefault = active.length > 0 ? String(active[0]?.id) : \"\";\r\n    const nextDefaultTaxId = defaultFromDb ? String(defaultFromDb.id) : currentIsActive ? currentDefault : fallbackDefault;\r\n\r\n    updateTaxes({\r\n      taxes: mapped,\r\n      defaultTaxId: nextDefaultTaxId,\r\n    });\r\n  }\r\n\r\n  useEffect(() => {\r\n    syncDraft(taxes);\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [taxes]);\r\n\r\n  const activeTaxes = useMemo(() => taxes.filter((x) => x.is_active), [taxes]);\r\n\r\n  const defaultTaxSelectValue = useMemo(() => {\r\n    const activeIds = new Set(activeTaxes.map((x) => String(x.id)));\r\n    if (t.defaultTaxId && activeIds.has(String(t.defaultTaxId))) return String(t.defaultTaxId);\r\n    return \"\";\r\n  }, [activeTaxes, t.defaultTaxId]);\r\n\r\n  const filtered = useMemo(() => {\r\n    const needle = query.trim().toLowerCase();\r\n    if (!needle) return taxes;\r\n    return taxes.filter((x) => `${x.id} ${x.name} ${x.rate}`.toLowerCase().includes(needle));\r\n  }, [query, taxes]);\r\n\r\n  const totalRows = filtered.length;\r\n  useEffect(() => {\r\n    const totalPages = Math.max(1, Math.ceil(totalRows / pageSize));\r\n    const clamped = Math.min(pageIndex, totalPages - 1);\r\n    if (clamped !== pageIndex) setPageIndex(clamped);\r\n  }, [pageIndex, pageSize, totalRows]);\r\n\r\n  const pageRows = useMemo(() => {\r\n    const start = pageIndex * pageSize;\r\n    const end = start + pageSize;\r\n    return filtered.slice(start, end);\r\n  }, [filtered, pageIndex, pageSize]);\r\n\r\n  const columns = useMemo<Array<DataTableColumn<ApiRepairBuddyTax>>>(\r\n    () => [\r\n      { id: \"name\", header: \"Name\", cell: (x) => <div className=\"text-sm text-zinc-700\">{x.name}</div>, className: \"min-w-[220px]\" },\r\n      { id: \"rate\", header: \"Rate (%)\", cell: (x) => <div className=\"text-sm text-zinc-700\">{Number(x.rate)}</div>, className: \"whitespace-nowrap\" },\r\n      {\r\n        id: \"active\",\r\n        header: \"Active\",\r\n        cell: (x) => <div className=\"text-sm text-zinc-700\">{x.is_active ? \"Yes\" : \"No\"}</div>,\r\n        className: \"whitespace-nowrap\",\r\n      },\r\n      {\r\n        id: \"default\",\r\n        header: \"Default\",\r\n        cell: (x) => <div className=\"text-sm text-zinc-700\">{x.is_default ? \"Yes\" : \"No\"}</div>,\r\n        className: \"whitespace-nowrap\",\r\n      },\r\n      {\r\n        id: \"actions\",\r\n        header: \"Actions\",\r\n        cell: (row) => (\r\n          <div className=\"flex items-center gap-2\">\r\n            <Button\r\n              size=\"sm\"\r\n              variant=\"outline\"\r\n              disabled={isMock || busy}\r\n              onClick={() => {\r\n                setEditId(String(row.id));\r\n                setEditName(row.name);\r\n                setEditRate(String(row.rate));\r\n                setEditActive(row.is_active);\r\n                setEditDefault(row.is_default);\r\n                setEditOpen(true);\r\n              }}\r\n            >\r\n              Edit\r\n            </Button>\r\n            <Button\r\n              size=\"sm\"\r\n              variant=\"outline\"\r\n              disabled={isMock || busy}\r\n              onClick={() => void onDelete(row)}\r\n            >\r\n              Delete\r\n            </Button>\r\n          </div>\r\n        ),\r\n        className: \"whitespace-nowrap\",\r\n      },\r\n    ],\r\n    [busy, isMock],\r\n  );\r\n\r\n  const [addName, setAddName] = useState(\"\");\r\n  const [addRate, setAddRate] = useState(\"0\");\r\n  const [addActive, setAddActive] = useState(true);\r\n  const [addDefault, setAddDefault] = useState(false);\r\n\r\n  const [editId, setEditId] = useState<string | null>(null);\r\n  const [editName, setEditName] = useState(\"\");\r\n  const [editRate, setEditRate] = useState(\"0\");\r\n  const [editActive, setEditActive] = useState(true);\r\n  const [editDefault, setEditDefault] = useState(false);\r\n\r\n  async function refresh() {\r\n    setLoadingTaxes(true);\r\n    try {\r\n      const res = await getRepairBuddyTaxes(String(tenantSlug));\r\n      setTaxes(Array.isArray(res.taxes) ? res.taxes : []);\r\n    } catch (e) {\r\n      setError(e instanceof Error ? e.message : \"Failed to load taxes.\");\r\n    } finally {\r\n      setLoadingTaxes(false);\r\n    }\r\n  }\r\n\r\n  async function onAdd() {\r\n    setStatus(null);\r\n    setError(null);\r\n    setBusy(true);\r\n    try {\r\n      const name = addName.trim();\r\n      const rate = Number(addRate);\r\n      if (!name) throw new Error(\"Name is required.\");\r\n      if (!Number.isFinite(rate)) throw new Error(\"Rate is invalid.\");\r\n\r\n      await createRepairBuddyTax(String(tenantSlug), {\r\n        name,\r\n        rate,\r\n        is_active: addActive,\r\n        is_default: addDefault,\r\n      });\r\n      await refresh();\r\n      setAddOpen(false);\r\n      setAddName(\"\");\r\n      setAddRate(\"0\");\r\n      setAddActive(true);\r\n      setAddDefault(false);\r\n      setStatus(\"Tax created.\");\r\n    } catch (e) {\r\n      setError(e instanceof Error ? e.message : \"Failed to create tax.\");\r\n    } finally {\r\n      setBusy(false);\r\n    }\r\n  }\r\n\r\n  async function onEditSave() {\r\n    if (!editId) return;\r\n    setStatus(null);\r\n    setError(null);\r\n    setBusy(true);\r\n    try {\r\n      const id = Number(editId);\r\n      if (!Number.isFinite(id)) throw new Error(\"Invalid tax.\");\r\n\r\n      const name = editName.trim();\r\n      const rate = Number(editRate);\r\n      if (!name) throw new Error(\"Name is required.\");\r\n      if (!Number.isFinite(rate)) throw new Error(\"Rate is invalid.\");\r\n\r\n      await updateRepairBuddyTax(String(tenantSlug), id, { name, rate });\r\n      await setRepairBuddyTaxActive(String(tenantSlug), id, editActive);\r\n      if (editDefault) {\r\n        await setRepairBuddyTaxDefault(String(tenantSlug), id);\r\n      }\r\n\r\n      await refresh();\r\n      setEditOpen(false);\r\n      setStatus(\"Tax updated.\");\r\n    } catch (e) {\r\n      setError(e instanceof Error ? e.message : \"Failed to update tax.\");\r\n    } finally {\r\n      setBusy(false);\r\n    }\r\n  }\r\n\r\n  async function onDelete(row: ApiRepairBuddyTax) {\r\n    if (!globalThis.confirm(`Delete tax \"${row.name}\"?`)) return;\r\n    setStatus(null);\r\n    setError(null);\r\n    setBusy(true);\r\n    try {\r\n      setTaxes((prev) => prev.filter((t) => String(t.id) !== String(row.id)));\r\n      await deleteRepairBuddyTax(String(tenantSlug), Number(row.id));\r\n      await refresh();\r\n      setStatus(\"Tax deleted.\");\r\n    } catch (e) {\r\n      setError(e instanceof Error ? e.message : \"Failed to delete tax.\");\r\n      void refresh();\r\n    } finally {\r\n      setBusy(false);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <SectionShell title=\"Taxes\" description=\"Tax rates and invoice calculation preferences.\">\r\n      {error ? <div className=\"text-sm text-red-600\">{error}</div> : null}\r\n      {status ? <div className=\"text-sm text-green-700\">{status}</div> : null}\r\n\r\n      <Card className=\"shadow-none\">\r\n        <CardContent className=\"pt-5\">\r\n          <div className=\"grid gap-4 sm:grid-cols-2\">\r\n            <div className=\"sm:col-span-2\">\r\n              <label className=\"flex items-center gap-2 text-sm\">\r\n                <input type=\"checkbox\" checked={taxRegistered} onChange={(e) => setTaxRegistered(e.target.checked)} disabled={savingMeta || busy} />\r\n                Tax/VAT registered?\r\n              </label>\r\n            </div>\r\n            <div className=\"space-y-1\">\r\n              <label className=\"text-sm font-medium\">VAT number</label>\r\n              <Input value={billingVatNumber} onChange={(e) => setBillingVatNumber(e.target.value)} placeholder=\"EU123456789\" disabled={savingMeta || busy} />\r\n            </div>\r\n            <div className=\"space-y-1\">\r\n              <label className=\"text-sm font-medium\">Invoice prefix (optional)</label>\r\n              <Input value={invoicePrefix} onChange={(e) => setInvoicePrefix(e.target.value)} placeholder=\"RB\" disabled={savingMeta || busy} />\r\n            </div>\r\n            <div className=\"sm:col-span-2 flex items-center justify-end gap-2\">\r\n              <Button variant=\"outline\" disabled={isMock || savingMeta || busy} onClick={() => void saveTaxMeta()}>\r\n                {savingMeta ? \"Saving...\" : \"Save\"}\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <label className=\"flex items-center gap-2 text-sm\">\r\n        <input\r\n          type=\"checkbox\"\r\n          checked={t.enableTaxes}\r\n          onChange={(e) => {\r\n            const next = e.target.checked;\r\n            updateTaxes({ enableTaxes: next });\r\n            void persistTaxesPrefs({ ...t, enableTaxes: next });\r\n          }}\r\n        />\r\n        Enable taxes\r\n      </label>\r\n\r\n      <div className=\"flex items-center justify-between gap-3\">\r\n        <div className=\"text-sm text-zinc-600\">Manage tax rates for this business.</div>\r\n        <Button variant=\"outline\" disabled={isMock || busy} onClick={() => setAddOpen(true)}>\r\n          Add tax\r\n        </Button>\r\n      </div>\r\n\r\n      <Card className=\"shadow-none\">\r\n        <CardContent className=\"pt-5\">\r\n          <DataTable\r\n            title=\"Taxes\"\r\n            data={pageRows}\r\n            columns={columns}\r\n            getRowId={(row) => row.id}\r\n            loading={loadingTaxes}\r\n            emptyMessage=\"No tax rates.\"\r\n            search={{ placeholder: \"Search taxes...\" }}\r\n            server={{\r\n              query,\r\n              onQueryChange: (value) => {\r\n                setQuery(value);\r\n                setPageIndex(0);\r\n              },\r\n              pageIndex,\r\n              onPageIndexChange: setPageIndex,\r\n              pageSize,\r\n              onPageSizeChange: (value) => {\r\n                setPageSize(value);\r\n                setPageIndex(0);\r\n              },\r\n              totalRows,\r\n            }}\r\n          />\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <div className=\"grid gap-4 sm:grid-cols-2\">\r\n        <div className=\"space-y-1\">\r\n          <label className=\"text-sm font-medium\">Default tax</label>\r\n          <Select\r\n            value={defaultTaxSelectValue}\r\n            disabled={activeTaxes.length === 0 || busy || loadingTaxes}\r\n            onChange={async (e) => {\r\n              const next = e.target.value;\r\n              updateTaxes({ defaultTaxId: next });\r\n              void persistTaxesPrefs({ ...t, defaultTaxId: next });\r\n              if (!next) return;\r\n              const id = Number(next);\r\n              if (!Number.isFinite(id) || id <= 0) return;\r\n              try {\r\n                setBusy(true);\r\n                await setRepairBuddyTaxDefault(String(tenantSlug), id);\r\n                await refresh();\r\n              } catch (err) {\r\n                setError(err instanceof Error ? err.message : \"Failed to set default tax.\");\r\n              } finally {\r\n                setBusy(false);\r\n              }\r\n            }}\r\n          >\r\n            <option value=\"\">None</option>\r\n            {activeTaxes.map((x) => (\r\n              <option key={x.id} value={String(x.id)}>\r\n                {x.name} ({Number(x.rate)}%)\r\n              </option>\r\n            ))}\r\n          </Select>\r\n        </div>\r\n        <div className=\"space-y-1\">\r\n          <label className=\"text-sm font-medium\">Invoice amounts</label>\r\n          <Select\r\n            value={t.invoiceAmounts}\r\n            onChange={(e) => {\r\n              const next = e.target.value as RepairBuddySettingsDraft[\"taxes\"][\"invoiceAmounts\"];\r\n              updateTaxes({ invoiceAmounts: next });\r\n              void persistTaxesPrefs({ ...t, invoiceAmounts: next });\r\n            }}\r\n          >\r\n            <option value=\"exclusive\">Exclusive</option>\r\n            <option value=\"inclusive\">Inclusive</option>\r\n          </Select>\r\n        </div>\r\n      </div>\r\n\r\n      <Modal\r\n        open={addOpen}\r\n        onClose={() => setAddOpen(false)}\r\n        title=\"Add tax\"\r\n        footer={\r\n          <div className=\"flex items-center justify-end gap-2\">\r\n            <Button variant=\"outline\" onClick={() => setAddOpen(false)}>\r\n              Close\r\n            </Button>\r\n            <Button disabled={isMock || busy} onClick={() => void onAdd()}>\r\n              {busy ? \"Saving...\" : \"Save\"}\r\n            </Button>\r\n          </div>\r\n        }\r\n      >\r\n        <div className=\"space-y-3\">\r\n          <div className=\"space-y-1\">\r\n            <label className=\"text-sm font-medium\">Name</label>\r\n            <Input value={addName} onChange={(e) => setAddName(e.target.value)} placeholder=\"e.g. VAT\" />\r\n          </div>\r\n          <div className=\"space-y-1\">\r\n            <label className=\"text-sm font-medium\">Rate (%)</label>\r\n            <Input type=\"number\" min={0} value={addRate} onChange={(e) => setAddRate(e.target.value)} />\r\n          </div>\r\n          <div className=\"grid gap-3 sm:grid-cols-2\">\r\n            <div className=\"space-y-1\">\r\n              <label className=\"text-sm font-medium\">Active</label>\r\n              <Select value={addActive ? \"yes\" : \"no\"} onChange={(e) => setAddActive(e.target.value === \"yes\")}>\r\n                <option value=\"yes\">Yes</option>\r\n                <option value=\"no\">No</option>\r\n              </Select>\r\n            </div>\r\n            <div className=\"space-y-1\">\r\n              <label className=\"text-sm font-medium\">Default</label>\r\n              <Select value={addDefault ? \"yes\" : \"no\"} onChange={(e) => setAddDefault(e.target.value === \"yes\")}>\r\n                <option value=\"no\">No</option>\r\n                <option value=\"yes\">Yes</option>\r\n              </Select>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </Modal>\r\n\r\n      <Modal\r\n        open={editOpen}\r\n        onClose={() => setEditOpen(false)}\r\n        title=\"Edit tax\"\r\n        footer={\r\n          <div className=\"flex items-center justify-end gap-2\">\r\n            <Button variant=\"outline\" onClick={() => setEditOpen(false)}>\r\n              Close\r\n            </Button>\r\n            <Button disabled={isMock || busy} onClick={() => void onEditSave()}>\r\n              {busy ? \"Saving...\" : \"Save\"}\r\n            </Button>\r\n          </div>\r\n        }\r\n      >\r\n        <div className=\"space-y-3\">\r\n          <div className=\"space-y-1\">\r\n            <label className=\"text-sm font-medium\">Name</label>\r\n            <Input value={editName} onChange={(e) => setEditName(e.target.value)} />\r\n          </div>\r\n          <div className=\"space-y-1\">\r\n            <label className=\"text-sm font-medium\">Rate (%)</label>\r\n            <Input type=\"number\" min={0} value={editRate} onChange={(e) => setEditRate(e.target.value)} />\r\n          </div>\r\n          <div className=\"grid gap-3 sm:grid-cols-2\">\r\n            <div className=\"space-y-1\">\r\n              <label className=\"text-sm font-medium\">Active</label>\r\n              <Select value={editActive ? \"yes\" : \"no\"} onChange={(e) => setEditActive(e.target.value === \"yes\")}>\r\n                <option value=\"yes\">Yes</option>\r\n                <option value=\"no\">No</option>\r\n              </Select>\r\n            </div>\r\n            <div className=\"space-y-1\">\r\n              <label className=\"text-sm font-medium\">Default</label>\r\n              <Select value={editDefault ? \"yes\" : \"no\"} onChange={(e) => setEditDefault(e.target.value === \"yes\")}>\r\n                <option value=\"no\">No</option>\r\n                <option value=\"yes\">Yes</option>\r\n              </Select>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </Modal>\r\n    </SectionShell>\r\n  );\r\n}\r\n","\"use client\";\r\n\r\nimport React, { useEffect, useMemo, useState } from \"react\";\r\nimport { Select } from \"@/components/ui/Select\";\r\nimport { SectionShell } from \"@/app/app/[tenant]/settings/_components/repairbuddy/sections/SectionShell\";\r\nimport type { RepairBuddySettingsDraft } from \"@/app/app/[tenant]/settings/_components/repairbuddy/types\";\r\nimport { getRepairBuddyTaxes, type ApiRepairBuddyTax } from \"@/lib/repairbuddy-taxes\";\r\n\r\nexport function TimeLogsSection({\r\n  tenantSlug,\r\n  draft,\r\n  updateTimeLogs,\r\n  isMock,\r\n}: {\r\n  tenantSlug: string;\r\n  draft: RepairBuddySettingsDraft;\r\n  updateTimeLogs: (patch: Partial<RepairBuddySettingsDraft[\"timeLogs\"]>) => void;\r\n  isMock: boolean;\r\n}) {\r\n  const t = draft.timeLogs;\r\n  const statusOptions = useMemo(() => draft.jobStatuses.statuses, [draft.jobStatuses.statuses]);\r\n\r\n  const [taxes, setTaxes] = useState<ApiRepairBuddyTax[]>([]);\r\n  const [loadingTaxes, setLoadingTaxes] = useState(false);\r\n\r\n  useEffect(() => {\r\n    let alive = true;\r\n\r\n    async function load() {\r\n      if (isMock) return;\r\n      setLoadingTaxes(true);\r\n      try {\r\n        const res = await getRepairBuddyTaxes(String(tenantSlug));\r\n        if (!alive) return;\r\n        setTaxes(Array.isArray(res.taxes) ? res.taxes : []);\r\n      } catch {\r\n        if (!alive) return;\r\n        setTaxes([]);\r\n      } finally {\r\n        if (!alive) return;\r\n        setLoadingTaxes(false);\r\n      }\r\n    }\r\n\r\n    void load();\r\n\r\n    return () => {\r\n      alive = false;\r\n    };\r\n  }, [isMock, tenantSlug]);\r\n\r\n  const activeTaxOptions = useMemo(() => {\r\n    const source = isMock\r\n      ? draft.taxes.taxes.map((x) => ({\r\n          id: Number.isFinite(Number(x.id)) ? Number(x.id) : 0,\r\n          name: x.name,\r\n          rate: x.ratePercent,\r\n          is_default: x.id === draft.taxes.defaultTaxId,\r\n          is_active: x.status === \"active\",\r\n        }))\r\n      : taxes;\r\n\r\n    return source\r\n      .filter((x) => x && x.is_active)\r\n      .map((x) => ({\r\n        id: String(x.id),\r\n        name: x.name,\r\n        ratePercent: Number(x.rate),\r\n        isDefault: Boolean(x.is_default),\r\n      }));\r\n  }, [draft.taxes.defaultTaxId, draft.taxes.taxes, isMock, taxes]);\r\n\r\n  const defaultTaxIdFromTenant = useMemo(() => {\r\n    const fromApi = activeTaxOptions.find((x) => x.isDefault)?.id ?? \"\";\r\n    if (fromApi) return fromApi;\r\n    const fallback = activeTaxOptions[0]?.id ?? \"\";\r\n    return fallback;\r\n  }, [activeTaxOptions]);\r\n\r\n  const defaultTaxSelectValue = useMemo(() => {\r\n    const activeIds = new Set(activeTaxOptions.map((x) => x.id));\r\n    if (t.defaultTaxIdForHours && activeIds.has(String(t.defaultTaxIdForHours))) return String(t.defaultTaxIdForHours);\r\n    if (defaultTaxIdFromTenant && activeIds.has(String(defaultTaxIdFromTenant))) return String(defaultTaxIdFromTenant);\r\n    return \"\";\r\n  }, [defaultTaxIdFromTenant, activeTaxOptions, t.defaultTaxIdForHours]);\r\n\r\n  useEffect(() => {\r\n    if (!defaultTaxSelectValue) return;\r\n    if (t.defaultTaxIdForHours === defaultTaxSelectValue) return;\r\n    updateTimeLogs({ defaultTaxIdForHours: defaultTaxSelectValue });\r\n  }, [defaultTaxSelectValue, t.defaultTaxIdForHours, updateTimeLogs]);\r\n\r\n  function toggleStatus(id: string) {\r\n    const set = new Set(t.enableTimeLogForStatusIds);\r\n    if (set.has(id)) set.delete(id);\r\n    else set.add(id);\r\n    updateTimeLogs({ enableTimeLogForStatusIds: Array.from(set) });\r\n  }\r\n\r\n  return (\r\n    <SectionShell title=\"Time Logs\" description=\"Time tracking and hourly tax defaults.\">\r\n      <div className=\"space-y-4\">\r\n        <label className=\"flex items-center gap-2 text-sm\">\r\n          <input type=\"checkbox\" checked={t.disableTimeLog} onChange={(e) => updateTimeLogs({ disableTimeLog: e.target.checked })} />\r\n          Disable time log\r\n        </label>\r\n\r\n        <div className=\"grid gap-4 sm:grid-cols-2\">\r\n          <div className=\"space-y-1\">\r\n            <label className=\"text-sm font-medium\">Default tax for hours</label>\r\n            <Select\r\n              value={defaultTaxSelectValue}\r\n              disabled={loadingTaxes || activeTaxOptions.length === 0}\r\n              onChange={(e) => updateTimeLogs({ defaultTaxIdForHours: e.target.value })}\r\n            >\r\n              {activeTaxOptions.length === 0 ? (\r\n                <option value=\"\">No active taxes</option>\r\n              ) : (\r\n                activeTaxOptions.map((x) => (\r\n                  <option key={x.id} value={x.id}>\r\n                    {x.name} ({x.ratePercent}%)\r\n                  </option>\r\n                ))\r\n              )}\r\n            </Select>\r\n          </div>\r\n        </div>\r\n\r\n        <div>\r\n          <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Enable time log for statuses</div>\r\n          <div className=\"mt-2 grid gap-2 sm:grid-cols-3\">\r\n            {statusOptions.map((s) => (\r\n              <label key={s.id} className=\"flex items-center gap-2 text-sm\">\r\n                <input type=\"checkbox\" checked={t.enableTimeLogForStatusIds.includes(s.id)} onChange={() => toggleStatus(s.id)} />\r\n                {s.name}\r\n              </label>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"space-y-1\">\r\n          <label className=\"text-sm font-medium\">Activities</label>\r\n          <textarea\r\n            className=\"min-h-[140px] w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm\"\r\n            value={t.activities}\r\n            onChange={(e) => updateTimeLogs({ activities: e.target.value })}\r\n            placeholder=\"List of activities (one per line)\"\r\n          />\r\n        </div>\r\n      </div>\r\n    </SectionShell>\r\n  );\r\n}\r\n"],"names":[],"mappings":"wDAGA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,KCHA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAEA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,MAAA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,MAAA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,MAAA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,OAgBA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,MACA,EAAA,EAAA,CAAA,CAAA,OClBO,IAAM,EAAuC,CAClD,CAAE,IAAK,kBAAmB,MAAO,YAAa,EAC9C,CAAE,IAAK,UAAW,MAAO,SAAU,EACnC,CAAE,IAAK,WAAY,MAAO,UAAW,EACrC,CAAE,IAAK,mBAAoB,MAAO,oBAAqB,EACvD,CAAE,IAAK,eAAgB,MAAO,UAAW,EACzC,CAAE,IAAK,WAAY,MAAO,UAAW,EACrC,CAAE,IAAK,UAAW,MAAO,SAAU,EACnC,CAAE,IAAK,YAAa,MAAO,WAAY,EACvC,CAAE,IAAK,aAAc,MAAO,YAAa,EACzC,CAAE,IAAK,iBAAkB,MAAO,kBAAmB,EACnD,CAAE,IAAK,MAAO,MAAO,KAAM,EAC3B,CAAE,IAAK,QAAS,MAAO,OAAQ,EAC/B,CAAE,IAAK,mBAAoB,MAAO,kBAAmB,EACrD,CAAE,IAAK,YAAa,MAAO,WAAY,EACvC,CAAE,IAAK,wBAAyB,MAAO,uBAAwB,EAC/D,CAAE,IAAK,iBAAkB,MAAO,kBAAmB,EACnD,CAAE,IAAK,qBAAsB,MAAO,oBAAqB,EACzD,CAAE,IAAK,UAAW,MAAO,SAAU,EACpC,CCvBY,EAAoD,CAC/D,QAAS,CACP,aAAc,GACd,cAAe,GACf,gBAAiB,GACjB,QAAS,GACT,MAAO,GACP,YAAa,GACb,mBAAoB,GACpB,mBAAoB,GACpB,iBAAkB,KAClB,iBAAkB,EAClB,eAAe,EACf,WAAW,EACX,wBAAwB,EACxB,mBAAoB,iCACpB,cAAe,iBACf,YAAa,GACb,eAAgB,KAChB,4BAA4B,CAC9B,EACA,SAAU,CACR,SAAU,MACV,iBAAkB,OAClB,kBAAmB,IACnB,iBAAkB,IAClB,iBAAkB,CACpB,EACA,gBAAiB,CACf,oBAAoB,EACpB,qBAAsB,+BACtB,iBAAkB,WAClB,mBAAmB,EACnB,qBAAqB,EACrB,wBAAwB,EACxB,uBAAwB,GACxB,gBAAiB,WACjB,SAAU,GACV,qBAAsB,KACtB,+BAA+B,EAC/B,oCAAoC,EACpC,yBAA0B,EAC5B,EACA,YAAa,CACX,SAAU,CACR,CACE,GAAI,kBACJ,KAAM,WACN,KAAM,WACN,YAAa,eACb,aAAc,WACd,eAAgB,GAChB,OAAQ,QACV,EACA,CACE,GAAI,mBACJ,KAAM,YACN,KAAM,YACN,YAAa,gBACb,aAAc,YACd,gBAAgB,EAChB,OAAQ,QACV,EACA,CACE,GAAI,mBACJ,KAAM,YACN,KAAM,YACN,YAAa,gBACb,aAAc,YACd,eAAgB,GAChB,OAAQ,QACV,EACD,CACD,kBAAmB,mBACnB,kBAAmB,kBACrB,EACA,SAAU,CACR,SAAU,CACR,CAAE,GAAI,aAAc,KAAM,SAAU,KAAM,SAAU,YAAa,GAAI,OAAQ,QAAS,EACtF,CAAE,GAAI,WAAY,KAAM,OAAQ,KAAM,OAAQ,YAAa,GAAI,OAAQ,QAAS,EAChF,CAAE,GAAI,eAAgB,KAAM,WAAY,KAAM,WAAY,YAAa,GAAI,OAAQ,QAAS,EAC7F,CACD,eAAgB,CACd,MAAM,EACN,MAAM,EACN,cAAc,EACd,QAAQ,EACR,OAAO,CACT,CACF,EACA,QAAS,CACP,sBAAsB,EACtB,wBAAwB,EACxB,aAAc,GACd,+BAAgC,mBAChC,gCAAiC,EACjC,aAAc,iBACd,qBAAsB,iDACtB,mBAAoB,+CACtB,EACA,UAAW,CACT,qBAAsB,gBACtB,kBAAmB,+BACnB,kBAAkB,EAClB,wBAAwB,EACxB,+BAAgC,oBAChC,4BAA6B,uCAC/B,EACA,UAAW,CACT,gBAAgB,EAChB,kBAAkB,EAClB,eAAgB,GAChB,gBAAiB,QACnB,EACA,cAAe,CACb,oBAAoB,EACpB,wBAAwB,EACxB,yBAAyB,EACzB,OAAQ,CACN,KAAM,OACN,IAAK,MACL,OAAQ,SACR,YAAa,QACb,WAAY,OACZ,KAAM,MACR,EACA,uBAAwB,EAAE,CAC1B,uBAAuB,EACvB,aAAc,IACd,eAAgB,IAChB,eAAe,EACf,aAAc,IACd,cAAe,GACjB,EACA,WAAY,CACV,cAAe,GACf,gBAAiB,GACjB,aAAc,GACd,YAAa,GACb,aAAc,GACd,UAAW,GACX,mBAAoB,GACpB,oBAAoB,CACtB,EACA,IAAK,CACH,iCAAiC,EACjC,QAAS,SACT,kBAAmB,GACnB,iBAAkB,GAClB,kBAAmB,GACnB,2BAA4B,CAAC,kBAAmB,mBAAmB,CACnE,WAAY,GACZ,YAAa,cACf,EACA,MAAO,CACL,aAAa,EACb,MAAO,CACL,CAAE,GAAI,WAAY,KAAM,SAAU,YAAa,EAAG,OAAQ,QAAS,EACnE,CAAE,GAAI,eAAgB,KAAM,WAAY,YAAa,GAAI,OAAQ,QAAS,EAC3E,CACD,aAAc,WACd,eAAgB,WAClB,EACA,gBAAiB,CACf,mBAAoB,GACpB,6BAA6B,EAC7B,gBAAiB,QACnB,EACA,SAAU,CACR,gBAAgB,EAChB,qBAAsB,WACtB,0BAA2B,EAAE,CAC7B,WAAY,4DACd,EACA,qBAAsB,CACpB,UAAW,CACT,CAAE,GAAI,aAAc,KAAM,uBAAwB,aAAc,IAAK,OAAQ,QAAS,EACvF,AACH,EACA,cAAe,CACb,OAAQ,CACN,SAAU,WACV,OAAQ,SACR,YAAa,eACb,WAAY,aACd,EACA,OAAQ,CACN,QAAS,UACT,UAAW,SACb,CACF,EACA,kBAAmB,CACjB,OAAQ,CACN,SAAS,EACT,gBAAiB,mBACjB,UAAW,CACT,aAAc,6BACd,cAAe,+BACf,QAAS,8BACX,EACA,wBAAyB,kBAC3B,EACA,SAAU,CACR,SAAS,EACT,gBAAiB,mBACjB,UAAW,CACT,aAAc,+BACd,cAAe,iCACf,QAAS,gCACX,EACA,wBAAyB,kBAC3B,CACF,EACA,QAAS,CACP,qBAAsB,uBACtB,kBAAmB,2BACnB,kBAAmB,cACnB,eAAgB,mCAChB,kBAAmB,YACnB,qBAAsB,SACtB,wBAAwB,EACxB,8BAA+B,yBAC/B,yBAAyB,EACzB,qBAAqB,EACrB,qBAAqB,EACrB,wBAAwB,EACxB,YAAa,GACb,aAAc,GACd,cAAe,EACjB,CACF,EClOA,IAAA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAuDA,SAAS,EAA2B,CAA+B,CAAE,CAAc,EACjF,QANM,EAMA,EAAc,EAAO,WAAW,EAAI,CAAC,EACrC,EAAoB,EAAW,QAAQ,EAA0C,SACjF,EAAqB,EAAW,QAAQ,EAAI,CAAC,EAC7C,EACuB,UAA3B,OAAO,EAAO,QAAQ,CAClB,EAAO,QAAQ,CACa,UAA5B,OAAO,EACL,EACA,GACF,EAAmD,UAAlC,OAAO,EAAO,eAAe,CAAgB,EAAO,eAAe,CAAC,IAAI,GAAG,WAAW,GAAK,GAElH,MAAO,CACL,GAAG,CAAK,CACR,QAAS,CACP,GAAG,EAAM,OAAO,CAChB,aAAc,EAAO,IAAI,EAAI,GAC7B,cAAe,EAAO,aAAa,EAAI,GACvC,MAAO,EAAO,aAAa,EAAI,GAC/B,YAAuD,UAA1C,OAAO,EAAkB,YAAY,CAAgB,EAAkB,YAAY,CAAG,EAAM,OAAO,CAAC,WAAW,CAC5H,mBACoD,UAAlD,OAAO,EAAkB,oBAAoB,CAAgB,EAAkB,oBAAoB,CAAG,EAAM,OAAO,CAAC,kBAAkB,CACxI,mBACmD,UAAjD,OAAO,EAAkB,mBAAmB,CAAgB,EAAkB,mBAAmB,CAAG,EAAM,OAAO,CAAC,kBAAkB,CACtI,eAAA,EApCE,AAoCe,EApCP,EAAO,oBAAoB,EAAI,CAAC,EACxC,EAAkB,EAAE,CACA,UAAtB,OAAO,EAAK,KAAK,EAAiB,EAAK,KAAK,CAAC,IAAI,IAAI,EAAM,IAAI,CAAC,EAAK,KAAK,CAAC,IAAI,IACzD,UAAtB,OAAO,EAAK,KAAK,EAAiB,EAAK,KAAK,CAAC,IAAI,IAAI,EAAM,IAAI,CAAC,EAAK,KAAK,CAAC,IAAI,IAC1D,UAArB,OAAO,EAAK,IAAI,EAAiB,EAAK,IAAI,CAAC,IAAI,IAAI,EAAM,IAAI,CAAC,EAAK,IAAI,CAAC,IAAI,IACtD,UAAtB,OAAO,EAAK,KAAK,EAAiB,EAAK,KAAK,CAAC,IAAI,IAAI,EAAM,IAAI,CAAC,EAAK,KAAK,CAAC,IAAI,IACnD,UAA5B,OAAO,EAAK,WAAW,EAAiB,EAAK,WAAW,CAAC,IAAI,IAAI,EAAM,IAAI,CAAC,EAAK,WAAW,CAAC,IAAI,IAEjG,GAD8C,UAAlC,OAAO,AA6BkB,EA7BX,eAAe,CAAgB,EAAO,eAAe,CAAC,IAAI,GAAG,WAAW,GAAK,KAC9F,EAAM,IAAI,CAAC,GACjB,EAAM,IAAI,CAAC,eA4Bd,EACA,eAAgB,GAAkB,EAAM,OAAO,CAAC,cAAc,AAChE,CACF,CACF,CCpFA,IAAA,EAAA,EAAA,CAAA,CAAA,OAYA,IAAM,EAAoB,CACxB,MACA,gBACA,gBACA,eACA,eACA,aACA,cACA,eACA,iBACA,aACA,mBACA,mBACA,kBACA,iBACA,sBACD,CAEM,SAAS,EAAsB,YAAE,CAAU,CAA0B,EAC1E,GAAM,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACjC,CAAC,EAAQ,EAAU,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAC/B,CAAC,EAAe,EAAiB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAC7C,CAAC,EAAO,EAAS,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgB,MAC5C,CAAC,EAAQ,EAAU,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgB,MAE9C,CAAC,EAAM,EAAQ,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAyB,MAEnD,CAAC,EAAc,EAAgB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAC3C,CAAC,EAAc,EAAgB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAC3C,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACjC,CAAC,EAAgB,EAAkB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAE/C,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,OACnC,CAAC,EAAc,EAAgB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,uBAC3C,CAAC,EAAkB,EAAoB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACnD,CAAC,EAAe,EAAiB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAC7C,CAAC,EAAoB,EAAsB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACvD,CAAC,EAAsB,EAAwB,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,GAAS,GAE3D,EAAkB,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,KAC9B,GAAI,CACF,IAAM,EAAU,KACV,EAA8C,YAArC,OAAO,EAAQ,iBAAiB,CAAkB,EAAQ,iBAAiB,CAAC,YAAc,KACzG,OAAO,MAAM,OAAO,CAAC,IAAW,EAAO,MAAM,CAAG,EAAI,EAAS,CAC/D,CAAE,KAAM,CACN,OAAO,CACT,CACF,EAAG,EAAE,EAEL,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,IAAI,GAAQ,EA0CZ,OAxCA,AAsCK,eAtCU,EACb,GAAI,CACF,EAAS,MACT,EAAU,MACV,GAAW,GAEX,IAAM,EAAO,MAAM,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,OAAO,IACnC,GAAI,CAAC,EAAO,OAEZ,EAAQ,GAER,IAAM,EAAI,EAAI,MAAM,CACpB,EAAY,EAAE,QAAQ,EAAI,OAE1B,IAAM,EAAS,EAAI,KAAK,EAAE,OAAS,CAAC,EAC9B,EAAY,EAAM,QAAQ,EAAI,CAAC,EAC/B,EAAc,EAAM,UAAU,EAAI,CAAC,EAEzC,EAAkD,UAAlC,OAAO,EAAS,aAAa,CAAgB,EAAS,aAAa,CAAG,IACtF,EAAkD,UAAlC,OAAO,EAAS,aAAa,CAAgB,EAAS,aAAa,CAAG,IACtF,EAAW,AAA4B,iBAArB,EAAS,OAAO,CAAgB,EAAS,OAAO,CAAG,IACrE,EAAsD,UAApC,OAAO,EAAS,eAAe,CAAgB,EAAS,eAAe,CAAG,IAE5F,EAAoD,UAApC,OAAO,EAAW,aAAa,CAAgB,EAAW,aAAa,CAAG,uBAC1F,EAA6D,AAAzC,iBAAO,EAAW,kBAAkB,CAAgB,EAAW,kBAAkB,CAAG,IACxG,EAAiB,AAAqC,iBAA9B,EAAW,cAAc,CAAgB,EAAW,cAAc,CAAG,IAC7F,EAAiE,WAA3C,OAAO,EAAW,oBAAoB,EAAiB,EAAW,oBAAoB,EAC5G,CAD+G,CAC1C,WAA7C,OAAO,EAAW,sBAAsB,EAAiB,EAAW,sBAAsB,CACpH,CAAE,CADqH,KAC9G,EAAG,CACV,GAAI,CAAC,EAAO,OACZ,EAAS,aAAa,MAAQ,EAAE,OAAO,CAAG,4BAC1C,EAAQ,KACV,QAAU,CACR,GAAI,CAAC,EAAO,OACZ,GAAW,EACb,CACF,IAIO,KACL,GAAQ,CACV,CACF,EAAG,CAAC,EAAW,EAEf,IAAM,EAAU,GAAM,OAChB,EAAoB,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,IAAO,GAAM,OAAO,OAAS,KAAyC,CAAC,GAAM,OAAO,MAAM,EAEtH,EAAa,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,KACzB,GAAI,CAAC,EAAS,OAAO,EAErB,IAAM,EAAK,GAAqB,CAAC,EAC3B,EAAY,EAAE,QAAQ,EAAI,CAAC,EAC3B,EAAc,EAAE,UAAU,EAAI,CAAC,EAErC,MACE,CAAC,EAAS,IAAI,IAAM,EAAA,CAAE,GAAO,CAAC,EAAF,CAAU,QAAQ,EAAI,EAAA,CAAE,CAAE,IAAI,IAAM,EAAA,CAAE,EAClE,CAAC,EAAa,IAAI,IAAM,EAAA,CAAE,IAAyC,EAAnC,QAAC,OAAO,EAAS,aAAa,CAAgB,EAAS,aAAa,CAAC,IAAI,GAAK,EAAA,CAAE,EAChH,AAAC,GAAa,IAAI,IAAM,EAAA,CAAE,IAAyC,EAAnC,QAAC,OAAO,EAAS,aAAa,CAAgB,EAAS,aAAa,CAAC,IAAI,GAAK,EAAA,CAAE,EAChH,AAAC,GAAQ,IAAI,IAAM,EAAA,CAAE,IAAmC,EAA7B,QAAC,OAAO,EAAS,OAAO,CAAgB,EAAS,OAAO,CAAC,IAAI,GAAK,EAAA,CAAE,EAC/F,CAAC,EAAe,IAAI,IAAM,EAAA,CAAE,IAA2C,EAArC,QAAC,OAAO,EAAS,eAAe,CAAgB,EAAS,eAAe,CAAC,IAAI,GAAK,EAAA,CAAE,EACtH,CAAC,EAAa,IAAI,IAAM,EAAA,CAAE,IAA2C,EAArC,QAAC,OAAO,EAAW,aAAa,CAAgB,EAAW,aAAa,CAAC,IAAI,GAAK,EAAA,CAAE,EACpH,CAAC,EAAiB,IAAI,IAAM,EAAA,CAAE,IAAgD,EAA1C,QAAC,OAAO,EAAW,kBAAkB,CAAgB,EAAW,kBAAkB,CAAC,IAAI,GAAK,EAAA,CAAE,EAClI,CAAC,EAAc,IAAI,IAAM,EAAA,CAAE,IAA4C,EAAtC,QAAC,OAAO,EAAW,cAAc,CAAgB,EAAW,cAAc,CAAC,IAAI,GAAK,EAAA,CAAE,EACvH,KAAwB,AAA2C,kBAA5C,AAAQ,EAAW,oBAAoB,EAAiB,EAAW,oBAAoB,AAAG,CAAI,EAAJ,AACjH,IAA0B,CAA6C,kBAAtC,EAAR,AAAmB,sBAAsB,EAAiB,EAAW,sBAAsB,AAAG,CAAK,AAEhI,EAF2H,AAExH,CACD,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACD,EAEK,EAAe,EAAA,OAAK,CAAC,WAAW,CACpC,MAAO,IACL,GAAiB,GACjB,EAAS,MACT,GAAI,CACF,IAAM,EAAU,MAAM,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,OAAO,GAAa,CAAE,KAAM,CAAK,GACnE,EAAQ,AAAC,GACP,EACI,CACE,GAAG,CAAI,CACP,OAAQ,EAAQ,MAAM,AACxB,EACA,EAER,CAAE,MAAO,EAAG,CACV,EAAS,aAAa,MAAQ,EAAE,OAAO,CAAG,yBAC5C,QAAU,CACR,GAAiB,EACnB,CACF,EACA,CAAC,EAAW,EAGd,eAAe,EAAO,CAAkB,EAKtC,GAJA,EAAE,cAAc,GAChB,EAAS,MACT,EAAU,MAEN,CAAC,EAAS,IAAI,GAAI,YACpB,EAAS,yBAIX,GAAU,GAEV,GAAI,CAEF,IAAM,EAA0C,CADD,GAAvB,GAAM,OAAO,OAAS,CAAC,CAE7C,CACA,EADG,OACO,CACR,MAFe,QAEA,EAAa,IAAI,IAAM,KACtC,cAAe,EAAa,IAAI,IAAM,KACtC,QAAS,EAAQ,IAAI,IAAM,KAC3B,gBAAiB,EAAe,IAAI,IAAM,IAC5C,EACA,WAAY,CACV,cAAe,EAAa,IAAI,IAAM,KACtC,mBAAoB,EAAiB,IAAI,IAAM,KAC/C,eAAgB,EAAc,IAAI,IAAM,KACxC,sBAAsB,CAAQ,EAC9B,wBAAwB,CAAQ,CAClC,CACF,EAEM,EAAU,MAAM,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,OAAO,GAAa,CACpD,SAAU,EAAS,IAAI,IAAM,KAC7B,SAAU,KACV,YAAa,CACf,GAEA,EAAS,AAAD,GACN,EACI,CACE,GAAG,CAAI,CACP,OAAQ,EAAQ,MAAM,CACtB,MAAO,CACL,GAAG,EAAK,KAAK,CACb,MAAO,CACT,CACF,EACA,GAGN,EAAU,kBACZ,CAAE,MAAO,EAAK,CACR,aAAe,EAAA,QAAQ,CACzB,CAD2B,CAClB,EAAI,OAAO,EAEpB,EAAS,2BAEb,QAAU,CACR,GAAU,EACZ,CACF,CAEA,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACZ,EACC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,SAAS,MAAM,2CAC3B,IAED,KAEH,EACC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,UAAU,MAAM,mBAC5B,IAED,KAEH,EAAU,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iCAAwB,wBAA4B,KAE7E,CAAC,GAAW,EACX,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,YAAY,SAAU,YACpC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,IAAI,CAAA,WACH,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,UAAU,CAAA,WACT,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UAAC,aACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,eAAe,CAAA,UAAC,wDAEnB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,qBACrB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sCACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,qDAA4C,SAC7D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,yCACZ,GAAM,QAAQ,SAEb,CAAA,CADA,CACA,EAAA,GAAA,EAAC,MAAA,CACC,IAAK,EAAK,MAAM,CAAC,QAAQ,CACzB,IAAI,OACJ,KAJmD,KAIzC,qGAGZ,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,sFAGjB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,kBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,OACL,OAAO,kCACP,SAAU,EACV,SAAU,AAAC,IACT,IAAM,EAAO,EAAE,MAAM,CAAC,KAAK,EAAI,EAAE,MAAM,CAAC,KAAK,CAAC,EAAE,CAAG,EAAE,MAAM,CAAC,KAAK,CAAC,EAAE,CAAG,IACnE,IACG,EADG,AACU,EAEtB,EACA,UAAU,gSAIhB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,sCAA8B,EAAgB,eAAiB,8BAGhF,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,0BACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,uDAA8C,uCAC7D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2CACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAc,SAAU,AAAC,GAAM,EAAgB,EAAE,MAAM,CAAC,KAAK,EAAG,YAAY,uBAAuB,SAAU,IAC3H,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAc,SAAU,AAAC,GAAM,EAAgB,EAAE,MAAM,CAAC,KAAK,EAAG,YAAY,uBAAuB,SAAU,IAC3H,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yBACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAS,SAAU,AAAC,GAAM,EAAW,EAAE,MAAM,CAAC,KAAK,EAAG,YAAY,qBAAqB,SAAU,MAEjH,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yBACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,MAAO,EACP,SAAU,AAAC,GAAM,EAAkB,EAAE,MAAM,CAAC,KAAK,EACjD,YAAY,kCACZ,SAAU,oBASxB,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,IAAI,CAAA,WACH,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,UAAU,CAAA,WACT,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UAAC,eACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,eAAe,CAAA,UAAC,mCAEnB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,qBACrB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sCACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,qDAA4C,aAC7D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,iBACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAU,SAAW,AAAD,GAAO,EAAY,EAAE,MAAM,CAAC,KAAK,EAAG,YAAY,MAAM,KAAK,eAAe,SAAU,IACtH,CAAA,EAAA,EAAA,GAAA,EAAC,WAAA,CAAS,GAAG,wBACV,EAAgB,GAAG,CAAC,AAAC,GACpB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAgB,MAAO,GAAX,SAInB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,sCAA6B,qDAG9C,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,qDAA4C,aAC7D,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gBACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAM,eAAe,QAAQ,CAAA,CAAA,MAEtC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,sCAA6B,6CAG9C,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,0BACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,uDAA8C,mCAC7D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2CACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yBACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,MAAO,EACP,SAAU,AAAC,GAAM,EAAgB,EAAE,MAAM,CAAC,KAAK,EAC/C,YAAY,2CACZ,SAAU,MAGd,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,MAAO,EACP,SAAU,AAAC,GAAM,EAAoB,EAAE,MAAM,CAAC,KAAK,EACnD,YAAY,gCACZ,SAAU,IAEZ,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,MAAO,EACP,SAAU,AAAC,GAAM,EAAiB,EAAE,MAAM,CAAC,KAAK,EAChD,YAAY,oCACZ,SAAU,IAEZ,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,gFACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,KAAK,WAAW,QAAS,EAAoB,SAAU,AAAC,GAAM,EAAsB,EAAE,MAAM,CAAC,OAAO,EAAG,SAAU,IAAU,4BAGpI,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,gFACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,WACL,QAAS,EACT,SAAU,AAAC,GAAM,EAAwB,EAAE,MAAM,CAAC,OAAO,EACzD,SAAU,IACV,4CASd,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,+CACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,KAAK,SAAS,SAAU,GAAU,CAAC,WACxC,EAAS,YAAc,sBAI5B,OAGV,CCzYA,IAAA,EAAA,EAAA,CAAA,CAAA,OCCO,SAAS,EAAa,OAC3B,CAAK,aACL,CAAW,UACX,CAAQ,CAKT,EACC,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,IAAI,CAAA,WACH,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,UAAU,CAAA,WACT,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UAAE,IACX,EAAc,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,eAAe,CAAA,UAAE,IAAiC,QAEpE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,qBAAa,MAG1C,CDfO,SAAS,EAAe,OAC7B,CAAK,eACL,CAAa,CAId,EACC,IAAM,EAAI,EAAM,OAAO,CAEvB,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAa,MAAM,UAAU,YAAY,sDACxC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,uDAA8C,oBAC7D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2CACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,2BACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,oBAAoB,CAAE,SAAU,AAAC,GAAM,EAAc,CAAE,qBAAsB,EAAE,MAAM,CAAC,KAAM,AAAD,QAE7G,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,wBACvC,CAAA,EAAA,EAAA,GAAA,EAAC,WAAA,CACC,UAAU,iHACV,MAAO,EAAE,iBAAiB,CAC1B,SAAU,AAAC,GAAM,EAAc,CAAE,kBAAmB,EAAE,MAAM,CAAC,KAAK,AAAC,QAIvE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,wBACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,iBAAiB,CAAE,SAAU,AAAC,GAAM,EAAc,CAAE,kBAAmB,EAAE,MAAM,CAAC,KAAK,AAAC,QAExG,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,qBACvC,CAAA,EAAA,EAAA,GAAA,EAAC,WAAA,CACC,UAAU,iHACV,MAAO,EAAE,cAAc,CACvB,SAAU,AAAC,GAAM,EAAc,CAAE,eAAgB,EAAE,MAAM,CAAC,KAAK,AAAC,cAMxE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,uDAA8C,qBAC7D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,4BACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wCACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,wBACvC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CAAC,MAAO,EAAE,iBAAiB,CAAE,SAAU,AAAC,GAAM,EAAc,CAAE,kBAAmB,EAAE,MAAM,CAAC,KAAK,AAA+B,aACnI,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,qBAAY,+BAC1B,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,mBAAU,oCACxB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,oBAAW,gDAI7B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wCACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,4BACvC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CACL,MAAO,EAAE,oBAAoB,EAAI,SACjC,SAAU,AAAC,GAAM,EAAc,CAAE,qBAAsB,EAAE,MAAM,CAAC,KAAK,AAA+C,aAEpH,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,kBAAS,kBACvB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,kBAAS,sBAEzB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iCAAwB,qDAGzC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wCACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,gCACvC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CACL,MAAO,EAAE,6BAA6B,EAAI,yBAC1C,SAAU,AAAC,GACT,EAAc,CACZ,8BAA+B,EAAE,MAAM,CAAC,KAAK,AAC/C,aAGF,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,kCAAyB,iCACvC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,wBAAe,oBAE/B,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iCAAwB,6FAGzC,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,4CACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,KAAK,WAAW,QAAS,EAAE,sBAAsB,CAAE,SAAU,AAAC,GAAM,EAAc,CAAE,uBAAwB,EAAE,MAAM,CAAC,OAAO,AAAC,KAAM,gCAG5I,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,4CACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,WACL,QAAS,EAAE,uBAAuB,CAClC,SAAW,AAAD,GAAO,EAAc,CAAE,wBAAyB,EAAE,MAAM,CAAC,OAAO,AAAC,KAC3E,mCAGJ,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,4CACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,KAAK,WAAW,QAAS,EAAE,mBAAmB,CAAE,SAAU,AAAC,GAAM,EAAc,CAAE,oBAAqB,EAAE,MAAM,CAAC,OAAO,AAAC,KAAM,8BAGtI,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,4CACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,KAAK,WAAW,QAAS,EAAE,mBAAmB,CAAE,SAAU,AAAC,GAAM,EAAc,CAAE,oBAAqB,EAAE,MAAM,CAAC,OAAQ,AAAD,KAAO,4BAGtI,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,4CACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,WACL,QAAS,EAAE,sBAAsB,CACjC,SAAW,AAAD,GAAO,EAAc,CAAE,uBAAwB,EAAE,MAAM,CAAC,OAAO,AAAC,KAC1E,uCAMR,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,uDAA8C,aAC7D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2CACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,WAAW,CAAE,SAAU,AAAC,GAAM,EAAc,CAAE,YAAa,EAAE,MAAM,CAAC,KAAK,AAAC,GAAI,YAAY,iBAC1G,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,YAAY,CAAE,SAAU,AAAC,GAAM,EAAc,CAAE,aAAc,EAAE,MAAM,CAAC,KAAK,AAAC,GAAI,YAAY,kBAC5G,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,aAAa,CAAE,SAAU,AAAC,GAAM,EAAc,CAAE,cAAe,EAAE,MAAM,CAAC,KAAK,AAAC,GAAI,YAAY,6BAM1H,CE9HA,IAAA,EAAA,EAAA,CAAA,CAAA,OAEA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAIA,EAAA,EAAA,CAAA,CAAA,OAEO,SAAS,EAAgB,OAC9B,CAAK,gBACL,CAAc,CAIf,EACC,IAAM,EAAI,EAAM,QAAQ,CAElB,EAAS,CAAA,EAAA,EAAA,SAAA,AAAS,IAClB,EAAa,EAAO,QAAQ,EAAI,EAAO,MAAM,CAE7C,CAAC,EAAmB,EAAqB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACrD,CAAC,EAAiB,EAAmB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgB,MAChE,CAAC,EAAkB,EAAoB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgB,MAClE,CAAC,EAAgB,EAAkB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAE/C,CAAC,EAAiB,EAAmB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAmB,EAAE,EACrE,CAAC,EAAoB,EAAsB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAmB,EAAE,EAE3E,CAAC,EAAY,EAAc,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACvC,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACjC,CAAC,EAAW,EAAa,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACrC,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACjC,CAAC,EAAW,EAAa,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACrC,CAAC,EAAY,EAAc,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,GAAS,GAEvC,CAAC,EAAY,EAAc,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgB,MAE5D,SAAS,EAAU,CAAsB,EACvC,IAAM,EAAO,CAAC,MAAM,OAAO,CAAC,GAAQ,EAAO,EAAA,AAAE,EAC1C,GAAG,CAAC,AAAC,IAAM,AAAC,CACX,KAAM,CAAC,EAAE,IAAI,EAAI,EAAA,CAAE,CAAE,IAAI,GAAG,WAAW,GACvC,OAAQ,EAAE,MAAM,EAAI,KACpB,KAAM,CAAC,EAAE,IAAI,EAAI,EAAA,CAAE,CAAE,IAAI,GACzB,WAAW,CAAQ,EAAE,SAAS,CAC9B,YAAY,CAAQ,EAAE,UAAU,CAClC,CAAC,EACA,MAAM,CAAC,AAAC,GAAM,aAAa,IAAI,CAAC,EAAE,IAAI,GAAK,EAAE,IAAI,CAAC,MAAM,CAAG,GAG9D,GAAI,CADe,AACd,EADmB,IAAI,CAAC,AAAC,GAAM,EAAE,UAAU,EAAI,EAAE,SAAS,EAC9C,CACf,IAAM,EAAc,EAAK,IAAI,CAAC,AAAC,GAAM,EAAE,SAAS,EAC5C,EAAa,EAAY,UAAU,EAAG,EACjC,CAAI,CAAC,EAAE,GAAE,CAAI,CAAC,EAAE,CAAC,UAAU,EAAG,CAAA,CACzC,CAEA,IAAI,GAAc,EAClB,OAAO,EACJ,GAAG,CAAC,AAAC,IACJ,IAAM,EAAI,CAAE,GAAG,CAAC,AAAC,EAMjB,OALI,AAAC,EAAE,SAAS,GAAE,EAAE,UAAU,EAAG,CAAA,EAC7B,EAAE,UAAU,EAAE,CACZ,IAAa,EAAE,UAAU,CAAG,EAAA,EAChC,GAAc,GAET,CACT,GACC,IAAI,CAAC,CAAC,EAAG,IAAM,EAAE,IAAI,CAAC,aAAa,CAAC,EAAE,IAAI,EAC/C,CAEA,IAAM,EAAmB,EAAA,OAAK,CAAC,WAAW,CAAC,UACzC,GAA0B,UAAtB,OAAO,GAAiD,GAAG,CAAzB,EAAW,MAAM,EAEvD,GAAqB,GACrB,EAAmB,MACnB,EAAoB,MAEpB,GAAI,CACF,IAAM,EAAM,MAAM,CAAA,EAAA,EAAA,mBAAA,AAAmB,EAAC,OAAO,IACvC,EAAa,EAAU,MAAM,OAAO,CAAC,EAAI,UAAU,EAAI,EAAI,UAAU,CAAG,EAAE,EAChF,EAAmB,GACnB,EAAsB,GAEtB,IAAM,EAAc,EAAW,IAAI,CAAC,AAAC,GAAM,EAAE,UAAU,GAAG,MAAQ,KAC9D,GAAe,aAAa,IAAI,CAAC,IACnC,EAAe,CAAE,OADgC,EACtB,CAAY,EAE3C,CAAE,MAAO,EAAG,CACV,EAAmB,aAAa,MAAQ,EAAE,OAAO,CAAG,8BACpD,EAAmB,EAAE,EACrB,EAAsB,EAAE,CAC1B,QAAU,CACR,GAAqB,EACvB,EACF,EAAG,CAAC,EAAY,EAAe,EAE/B,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACH,GACP,EAAG,CAAC,EAAiB,EAErB,IAAM,EAAoB,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,IACzB,KAAK,SAAS,CAAC,EAAU,MAAsB,KAAK,SAAS,CAAC,EAAU,IAC9E,CAAC,EAAiB,EAAmB,EAElC,EAAc,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,IACnB,EAAgB,IAAI,CAAC,AAAC,GAAM,EAAE,UAAU,GAAG,MAAQ,GACzD,CAAC,EAAgB,EAEd,EAAmB,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,IACxB,EAAgB,MAAM,CAAC,AAAC,GAAM,EAAE,SAAS,EAC/C,CAAC,EAAgB,EAEd,EAAY,EAAA,OAAK,CAAC,WAAW,CAAC,CAAC,EAAc,KACjD,EAAmB,AAAC,IAClB,IAAM,EAAO,EAAK,GAAG,CAAC,AAAC,GAAO,EAAE,IAAI,GAAK,EAAO,CAAE,GAAG,CAAC,CAAE,GAAG,CAAK,AAAC,EAAI,UAErE,AAAI,EAAM,UAAU,CACX,CADa,CACR,GAAG,CAAC,AAAC,GAAO,EAAE,IAAI,GAAK,EAAO,CAAE,GAAG,CAAC,CAAE,YAAY,EAAM,WAAW,CAAK,EAAI,CAAE,GAAG,CAAC,CAAE,YAAY,CAAM,IAG5F,IAApB,EAAM,CAAqB,QAAZ,CACV,EAAK,GAAG,CAAC,AAAC,GAAO,EAAE,IAAI,GAAK,EAAO,CAAE,GAAG,CAAC,CAAE,WAAW,EAAO,YAAY,CAAM,EAAI,GAGrF,CACT,EACF,EAAG,EAAE,EAEC,EAAa,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,KACzB,IAAM,EAAO,EAAQ,IAAI,GAAG,WAAW,SACvC,CAAI,CAAC,aAAa,IAAI,CAAC,IAChB,EAAgB,CADO,GACH,CAAC,AAAC,GADQ,AACF,EAAE,IAAI,GAAK,EAChD,EAAG,CAAC,EAAiB,EAAQ,EAuC7B,eAAe,IACb,GAA0B,UAAtB,OAAO,GAAiD,GAAG,CAAzB,EAAW,MAAM,EAClD,GAEL,EAAmB,MACnB,EAAoB,MAHI,AAIxB,EAAkB,IAElB,GAAI,CACF,IAAM,EAAa,EAAU,GACvB,EAAM,MAAM,CAAA,EAAA,EAAA,sBAAsB,AAAtB,EAChB,OAAO,GACP,EAAW,GAAG,CAAE,AAAD,IAAO,AAAC,CACrB,KAAM,EAAE,IAAI,CACZ,OAAQ,EAAE,MAAM,EAAI,KACpB,KAAM,EAAE,IAAI,CACZ,WAAW,CAAQ,EAAE,SAAS,CAC9B,YAAY,CAAQ,EAAE,UAAU,CAClC,CAAC,GAGG,EAAO,EAAU,MAAM,OAAO,CAAC,EAAI,UAAU,EAAI,EAAI,UAAU,CAAG,EAAE,EAC1E,EAAmB,GACnB,EAAsB,GAEtB,IAAM,EAAc,EAAK,IAAI,CAAC,AAAC,GAAM,EAAE,UAAU,GAAG,MAAQ,KACxD,GAAe,aAAa,IAAI,CAAC,IACnC,EAAe,CAAE,OADgC,EACtB,CAAY,GAGzC,EAAoB,sBACtB,CAAE,MAAO,EAAG,CACN,aAAa,EAAA,QAAQ,CAAE,EAAmB,EAAE,OAAO,EAClD,EAAmB,aAAa,MAAQ,EAAE,OAAO,CAAG,6BAC3D,QAAU,CACR,EAAkB,GACpB,EACF,CAEA,IAAM,EAAS,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,IACd,aAAa,IAAI,CAAC,EAAQ,IAAI,GAAG,WAAW,MAAO,CAAQ,EAAQ,IAAI,IAAO,CAAC,EACrF,CAAC,EAAY,EAAS,EAAQ,EAE3B,GAAqB,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,KACjC,IAAM,EAAI,AAAC,GAAE,iBAAiB,EAAI,EAAA,CAAE,CAAE,IAAI,GACpC,EAAI,CAAC,EAAE,gBAAgB,EAAI,EAAA,CAAE,CAAE,IAAI,GACzC,OAAO,EAAE,MAAM,CAAG,GAAK,EAAE,MAAM,CAAG,GAAK,IAAM,CAC/C,EAAG,CAAC,EAAE,gBAAgB,CAAE,EAAE,iBAAiB,CAAC,EAE5C,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,IAAI,CAAA,WACH,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,UAAU,CAAA,WACT,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UAAC,wBACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,eAAe,CAAA,UAAC,mFAEnB,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,sBACxB,EACC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,SAAS,MAAM,qCAC3B,IAED,KAEH,EACC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,UAAU,MAAM,kBAC5B,IAED,KAEJ,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,8DACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,8CACZ,EAAoB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,mBAAU,oBAA0B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,mBAAU,UAChG,EAAc,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,iBAAO,YAAU,KAAuB,QAGxE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,8CACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,KAAK,SAAS,QAAQ,UAAU,KAAK,KAAK,QAAS,IAAM,KAAK,IAAoB,SAAU,GAAqB,WAAgB,YAGzI,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,KAAK,SACL,QAAQ,UACR,KAAK,KACL,QAAS,KACP,EAAmB,EAAU,IAC7B,EAAmB,MACnB,EAAoB,KACtB,EACA,SAAU,GAAqB,GAAkB,CAAC,WACnD,UAGD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,KAAK,SAAS,QAAQ,YAAY,KAAK,KAAK,QAAS,IAAM,KAAK,IAAoB,SAAU,GAAqB,GAAkB,CAAC,WAC3I,EAAiB,YAAc,SAElC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,KAAK,SACL,QAAQ,UACR,KAAK,KACL,QAAS,KACP,EAAW,IACX,EAAa,IACb,EAAW,IACX,GAAa,GACb,GAAc,GACd,GAAc,EAChB,EACA,SAAU,GAAqB,WAChC,uBAMJ,EAAoB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iCAAwB,0BAA8B,KAEzF,AAAC,EAuFE,KAtFF,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,mGACb,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,yDACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,wCACf,CAAA,EAAA,EAAA,IAAA,EAAC,KAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,sIAA6H,SAC3I,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,sIAA6H,SAC3I,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,sIAA6H,WAC3I,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,sIAA6H,WAC3I,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,oIAGlB,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,UAC6B,IAA3B,EAAgB,MAAM,CACrB,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UACC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,kCAAkC,QAAS,WAAG,+DAK9D,EAAgB,GAAG,CAAC,AAAC,GACnB,CAAA,EAAA,EAAA,IAAA,EAAC,KAAA,CAAkB,UAAU,+CAC3B,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,kCACZ,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,6BAAqB,EAAI,IAAI,GAC5C,EAAI,UAAU,CAAG,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,gBAAO,YAAkB,UAG9D,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,kCACZ,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAI,IAAI,CAAE,SAAU,AAAC,GAAM,EAAU,EAAI,IAAI,CAAE,CAAE,KAAM,EAAE,MAAM,CAAC,KAAK,AAAC,GAAI,SAAU,EAAgB,YAAY,oBAEhI,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,kCACZ,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAI,MAAM,EAAI,GAAI,SAAU,AAAC,GAAM,EAAU,EAAI,IAAI,CAAE,CAAE,OAAQ,EAAE,MAAM,CAAC,KAAK,AAAC,GAAI,SAAU,EAAgB,YAAY,QAE1I,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,kCACZ,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAS,EAAI,SAAS,CAAG,UAAY,mBAAY,EAAI,SAAS,CAAG,SAAW,eAErF,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,6CACZ,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,YAAY,CAAA,CACX,MAAM,QACN,QAAS,CAAC,QAAE,CAAM,CAAE,GAClB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,QAAQ,UAAU,KAAK,KAAK,QAAS,EAAQ,SAAU,WAAgB,qBAKhF,CAAC,CAAE,OAAK,CAAE,GACT,CAAA,EAAA,EAAA,IAAA,EAAA,EAAA,QAAA,CAAA,WACE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,gBAAgB,CAAA,CACf,SAAU,KACR,IACA,EAAU,EAAI,IAAI,CAAE,CAAE,YAAY,CAAK,EACzC,EACA,SAAU,GAAkB,EAAI,UAAU,EAAI,CAAC,EAAI,SAAS,UAC7D,gBAGD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,gBAAgB,CAAA,CACf,SAAU,KACR,IACA,EAAU,EAAI,IAAI,CAAE,CAAE,UAAW,CAAC,EAAI,SAAS,AAAC,EAClD,EACA,SAAU,GAAkB,EAAI,UAAU,UAEzC,EAAI,SAAS,CAAG,UAAY,WAE/B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,qBAAqB,CAAA,CAAA,GACtB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,gBAAgB,CAAA,CACf,SAAU,KACR,IACA,EAAc,EAAI,IAAI,CACxB,EACA,WAAW,CAAA,CAAA,EACX,SAAU,GAAkB,EAAI,UAAU,UAC3C,oBArDF,EAAI,IAAI,UAoE5B,AAA4B,KAAK,CAAhB,MAAM,EAAW,EAI/B,KAHF,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,UAAU,MAAM,8BAAqB,iEAQtD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,KAAM,EACN,QAAS,KACH,AAAC,GAAgB,EAAc,GACrC,EACA,MAAM,eACN,OACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,gDACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,QAAQ,UAAU,QAAS,IAAM,GAAc,GAAQ,SAAU,WAAgB,WAGzF,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAAQ,YACR,QAAS,MAxQrB,AAyQc,SAzQL,EACP,IAAM,EAAO,EAAQ,IAAI,GAAG,WAAW,GACvC,GAAI,CAAC,aAAa,IAAI,CAAC,GAAO,OAC9B,IAAM,EAAO,EAAQ,IAAI,GACzB,GAAI,CAAC,GACD,EAAgB,IAAI,CAAC,AAAC,GAAM,EAAE,IAAI,GAAK,GADhC,IACuC,GAElD,IAAM,EAAuB,MAC3B,EACA,OAAQ,EAAU,IAAI,GAAK,EAAU,IAAI,GAAK,UAC9C,EACA,WAAW,CAAQ,EACnB,YAAY,CAAQ,CACtB,EAEA,EAAoB,AAAD,IAEjB,IAAI,EAAW,IADE,EAAK,MAAM,CAAC,AAAC,GAAM,EAAE,IAAI,GAAK,GAClB,EAAK,CAMlC,OAJI,EAAK,UAAU,EAAE,CACnB,EAAW,EAAS,GAAG,CAAC,AAAC,GAAO,EAAE,IAAI,GAAK,EAAO,CAAE,GAAG,CAAC,CAAE,YAAY,EAAM,WAAW,CAAK,EAAI,CAAE,GAAG,CAAC,CAAE,YAAY,CAAM,EAAA,EAGrH,EAAU,EACnB,GAEA,EAAW,IACX,EAAa,IACb,EAAW,IACX,GAAa,GACb,GAAc,EAChB,IA2Oc,GAAc,EAChB,EACA,SAAU,GAAkB,CAAC,WAC9B,oBAML,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,OAAO,MAAM,eAAM,qHAIlC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kDACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,sBAAsB,QAAQ,6BAAoB,SAGnE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,GAAG,oBACH,MAAO,EACP,SAAU,AAAC,GAAM,EAAW,EAAE,MAAM,CAAC,KAAK,CAAC,WAAW,GAAG,OAAO,CAAC,UAAW,IAAI,KAAK,CAAC,EAAG,IACzF,KAAK,OACL,YAAY,MACZ,SAAU,IAEX,EAAa,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iCAAwB,oCAAwC,QAE/F,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,sBAAsB,QAAQ,+BAAsB,WAGrE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,GAAG,sBACH,MAAO,EACP,SAAW,AAAD,GAAO,EAAa,EAAE,MAAM,CAAC,KAAK,EAC5C,KAAK,OACL,YAAY,IACZ,SAAU,UAIhB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,sBAAsB,QAAQ,6BAAoB,SAGnE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,GAAG,oBACH,MAAO,EACP,SAAU,AAAC,GAAM,EAAW,EAAE,MAAM,CAAC,KAAK,EAC1C,KAAK,OACL,YAAY,YACZ,SAAU,OAGd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kDACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,+BAAsB,WACrC,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,oJACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,KAAK,WAAW,QAAS,EAAW,SAAU,AAAC,GAAM,EAAa,EAAE,MAAM,CAAC,OAAO,EAAG,SAAU,GAAkB,IAAc,eAI1I,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,+BAAsB,YACrC,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,oJACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,WACL,QAAS,EACT,SAAU,AAAC,IACT,IAAM,EAAI,EAAE,MAAM,CAAC,OAAO,CAC1B,EAAc,GACV,GAAG,EAAa,GACtB,EACA,SAAU,IACV,+BAQZ,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,aAAa,CAAA,CACZ,KAAqB,OAAf,EACN,MAAM,kBACN,QACE,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,WAAK,mBACY,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,qBAAa,IAAkB,0BAGnE,YAAY,SACZ,eAAe,UACf,KAAM,EACN,SAAU,IAAM,EAAc,MAC9B,UAAW,KACL,GAzUV,EAAmB,AAAC,GAAS,EAAU,EAyUjB,AAzUsB,MAAM,CAAE,AAAD,GAAO,EAAE,IAAI,GAyUhC,EAzUqC,GA0U/D,EAAc,KAChB,IAGF,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,IAAI,CAAA,WACH,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,UAAU,CAAA,WACT,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UAAC,wBACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,eAAe,CAAA,UAAC,yFAEnB,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,sBACpB,GACC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,UAAU,MAAM,iCAAwB,mFAGrD,KAEJ,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sCACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,0BACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,GAAe,EAAE,QAAQ,CAAE,YAAY,MAAM,QAAQ,CAAA,CAAA,OAErE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,sBACvC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CACL,MAAO,EAAE,gBAAgB,CACzB,SAAU,AAAC,GAAM,EAAe,CAAE,iBAAkB,EAAE,MAAM,CAAC,KAAkE,AAA7D,aAElE,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,gBAAO,SACrB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,iBAAQ,UACtB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,sBAAa,iBAC3B,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,uBAAc,wBAGhC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,uBACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,MAAO,EAAE,iBAAiB,CAC1B,SAAU,AAAC,GAAM,EAAe,CAAE,kBAAmB,EAAE,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,EAAG,EAAG,GAChF,YAAY,IACZ,UAAW,OAGf,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,sBACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,MAAO,EAAE,gBAAgB,CACzB,SAAU,AAAC,GAAM,EAAe,CAAE,iBAAkB,EAAE,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,EAAG,EAAG,GAC/E,YAAY,IACZ,UAAW,OAGf,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,uBACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,MAAO,OAAO,EAAE,gBAAgB,EAChC,SAAW,AAAD,IAER,IAAM,EAAI,OAAO,QAAQ,CADb,AACc,EADZ,MAAM,CAAC,KAAK,CACK,IAE/B,EAAe,CAAE,iBADJ,CACsB,MADf,QAAQ,CAAC,GAAK,KAAK,GAAG,CAAC,EAAG,KAAK,GAAG,CAAC,EAAG,IAAM,CACxB,EAC1C,EACA,KAAK,SACL,IAAK,EACL,IAAK,kBAQrB,CC3jBA,IAAA,EAAA,EAAA,CAAA,CAAA,OAOO,SAAS,EAAqB,CACnC,OAAK,qBACL,CAAmB,QACnB,CAAM,CAKP,EACC,GAAM,CAAC,EAAgB,EAAkB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAC/C,CAAC,EAAgB,EAAkB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgB,MAC9D,CAAC,EAAY,EAAc,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,EAAwB,MACtD,EAAI,EAAM,aAAa,CAEvB,CAAC,EAAO,EAAS,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAC7B,CAAC,EAAW,EAAa,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,GACrC,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAEnC,EAAS,EAAE,sBAAsB,CAEjC,EAAW,EAAA,OAAK,CAAC,OAAO,CAAC,KAC7B,IAAM,EAAS,EAAM,IAAI,GAAG,WAAW,UACvC,AAAK,EACE,EADH,AACU,IADD,EACO,CAAC,AAAC,GAAM,CAAA,EAAG,EAAE,EAAE,CAAC,CAAC,EAAE,EAAE,KAAK,CAAA,CAAE,CAAC,WAAW,GAAG,QAAQ,CAAC,IADpD,CAEtB,EAAG,CAAC,EAAQ,EAAM,EAEZ,EAAY,EAAS,MAAM,CAC3B,EAAW,EAAA,OAAK,CAAC,OAAO,CAAC,KAC7B,IAAM,EAAQ,EAAY,EACpB,EAAM,EAAQ,EACpB,OAAO,EAAS,KAAK,CAAC,EAAO,EAC/B,EAAG,CAAC,EAAU,EAAW,EAAS,EAE5B,EAAe,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,IAC3B,AAAK,EACE,EAAO,AADV,IACc,CAAC,AAAC,GAAM,EAAE,EAAE,AADT,GACc,IAAmB,KAD1B,KAE3B,CAAC,EAAgB,EAAO,EAErB,CAAC,EAAY,EAAc,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAmC,IAAM,CAAC,CACpF,GAAI,GACJ,MAAO,GACP,KAAM,OACN,sBAAsB,EACtB,kBAAkB,EAClB,mBAAoB,GACtB,CAAC,EAED,SAAS,IACP,EAAc,MACd,EAAkB,MAClB,EAAc,CACZ,GAAI,GACJ,MAAO,GACP,KAAM,OACN,sBAAsB,EACtB,kBAAkB,EAClB,oBAAoB,CACtB,GACA,GAAkB,EACpB,CAEA,IAAM,EAAgB,EAAA,OAAK,CAAC,WAAW,CAAC,AAAC,IACvC,EAAc,MACd,EAAkB,EAAM,EAAE,EAC1B,EAAc,CAAE,GAAG,CAAK,AAAC,GACzB,GAAkB,EACpB,EAAG,EAAE,EAEL,SAAS,IACP,GAAkB,GAClB,EAAkB,MAClB,EAAc,KAChB,CAQA,SAAS,IACP,MAAM,EAAY,EAAW,KAAK,CAAC,IAAI,GAEvC,GAAI,CAAC,EAAW,YACd,EAAc,sBAIhB,IAAM,EAAyC,CAC7C,GAAI,IAdA,EAAI,WACV,AAAI,CAaoB,CAblB,MAAM,EAAE,WAAmB,CAAC,AAAR,aAAqB,EAAE,EAAE,MAAM,CAAC,UAAU,GAAA,CAAI,CACjE,CAAC,aAAa,EAAE,KAAK,GAAG,GAAG,CAAC,EAAE,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,KAAK,CAAC,GAAA,CAAI,EAaxE,MAAO,EACP,KAAM,OACN,sBAAsB,CAAQ,EAAW,oBAAoB,CAC7D,kBAAkB,CAAQ,EAAW,gBAAgB,CACrD,oBAAoB,CAAQ,EAAW,kBACzC,AAD2D,EAI3D,EAAoB,CAAE,uBADH,CAC2B,CADV,EAAO,GAAG,CAAC,AAAC,GAAO,EAAE,EAAE,GAAK,EAAiB,EAAO,GAAM,IAAI,EAAQ,EAAK,AACtD,GACzD,GACF,CAEA,IAAM,EAAc,EAAA,OAAK,CAAC,WAAW,CACnC,AAAC,IACM,WAAW,OAAO,CAAC,CAAC,cAAc,EAAE,EAAM,KAAK,CAAC,EAAE,CAAC,GAAG,AAC3D,EAAoB,CAAE,uBAAwB,EAAO,MAAM,CAAC,AAAC,GAAM,EAAE,EAAE,GAAK,EAAM,EAAE,CAAE,EACxF,EACA,CAAC,EAAQ,EAAoB,EAGzB,EAAU,EAAA,OAAK,CAAC,OAAO,CAC3B,IAAM,CACJ,CACE,GAAI,QACJ,OAAQ,QACR,KAAO,AAAD,GACJ,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,0BACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,qDAA6C,EAAE,KAAK,GACnE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,yCAA+B,OAAK,EAAE,EAAE,MAG7D,EACA,CAAE,GAAI,OAAQ,OAAQ,OAAQ,KAAM,IAAM,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iCAAwB,SAAY,UAAW,mBAAoB,EAC5H,CACE,GAAI,UACJ,OAAQ,mBACR,KAAM,AAAC,GAAM,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAS,EAAE,oBAAoB,CAAG,UAAY,mBAAY,EAAE,oBAAoB,CAAG,UAAY,SACnH,UAAW,mBACb,EACA,CACE,GAAI,UACJ,OAAQ,cACR,KAAO,AAAD,GAAO,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAS,EAAE,gBAAgB,CAAG,UAAY,mBAAY,EAAE,gBAAgB,CAAG,UAAY,SAC3G,UAAW,mBACb,EACA,CACE,GAAI,WACJ,OAAQ,sBACR,KAAM,AAAC,GAAM,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAS,EAAE,kBAAkB,CAAG,UAAY,mBAAY,EAAE,kBAAkB,CAAG,UAAY,SAC/G,UAAW,mBACb,EACA,CACE,GAAI,UACJ,OAAQ,UACR,KAAM,AAAC,GACL,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,KAAK,KAAK,QAAQ,UAAU,SAAU,EAAQ,QAAS,IAAM,EAAc,YAAI,SAGvF,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,KAAK,KAAK,QAAQ,UAAU,SAAU,EAAQ,QAAS,IAAM,EAAY,YAAI,cAKzF,UAAW,mBACb,EACD,CACD,CAAC,EAAa,EAAQ,EAAc,EAGtC,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,CAAa,MAAM,mBAAmB,YAAY,sEACjD,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,qCACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,0BACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,uDAA8C,gBAC7D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,4BACb,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,2CACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,WACL,QAAS,EAAE,kBAAkB,CAC7B,SAAU,AAAC,GAAM,EAAoB,CAAE,mBAAoB,EAAE,MAAM,CAAC,OAAO,AAAC,KAE9E,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,mDAA0C,0BAC1D,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,8CAAqC,+CAGzD,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,2CACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,WACL,QAAS,EAAE,sBAAsB,CACjC,SAAU,AAAC,GAAM,EAAoB,CAAE,uBAAwB,EAAE,MAAM,CAAC,OAAO,AAAC,GAChF,SAAU,CAAC,EAAE,kBAAkB,GAEjC,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,mDAA0C,+BAC1D,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,8CAAqC,8EAO/D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,uDAA8C,WAC7D,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,sCAA6B,mDAC5C,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2CACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,eACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,MAAM,CAAC,IAAI,CAAE,SAAU,AAAC,GAAM,EAAoB,CAAE,OAAQ,CAAE,GAAG,EAAE,MAAM,CAAE,KAAM,EAAE,MAAM,CAAC,KAAK,AAAC,CAAE,GAAI,YAAY,YAEpI,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,cACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,MAAM,CAAC,GAAG,CAAE,SAAU,AAAC,GAAM,EAAoB,CAAE,OAAQ,CAAE,GAAG,EAAE,MAAM,CAAE,IAAK,EAAE,MAAM,CAAC,KAAK,AAAC,CAAE,GAAI,YAAY,WAElI,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,iBACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,MAAM,CAAC,MAAM,CAAE,SAAW,AAAD,GAAO,EAAoB,CAAE,OAAQ,CAAE,GAAG,EAAE,MAAM,CAAE,OAAQ,EAAE,MAAM,CAAC,KAAK,AAAC,CAAE,GAAI,YAAY,cAExI,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,gBACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,MAAM,CAAC,WAAW,CAAE,SAAU,AAAC,GAAM,EAAoB,CAAE,OAAQ,CAAE,GAAG,EAAE,MAAM,CAAE,YAAa,EAAE,MAAM,CAAC,KAAK,AAAC,CAAE,GAAI,YAAY,aAElJ,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,eACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,MAAM,CAAC,UAAU,CAAE,SAAU,AAAC,GAAM,EAAoB,CAAE,OAAQ,CAAE,GAAG,EAAE,MAAM,CAAE,WAAY,EAAE,MAAM,CAAC,KAAK,AAAC,CAAE,GAAI,YAAY,YAEhJ,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,eACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,MAAM,CAAC,IAAI,CAAE,SAAU,AAAC,GAAM,EAAoB,CAAE,OAAQ,CAAE,GAAG,EAAE,MAAM,CAAE,KAAM,EAAE,MAAM,CAAC,KAAK,AAAC,CAAE,GAAI,YAAY,kBAKxI,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oDACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,uDAA8C,6BAC7D,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,sCAA6B,+CAE9C,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,QAAQ,UAAU,SAAU,EAAQ,QAAS,WAAc,iBAKrE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAC,UAAU,uBACd,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,iBACrB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CACR,MAAM,2BACN,KAAM,EACN,QAAS,EACT,SAAU,AAAC,GAAQ,EAAI,EAAE,CACzB,aAAa,4BACb,OAAQ,CAAE,YAAa,kBAAmB,EAC1C,WAAY,OAAS,EAAY,AAAC,GAAQ,EAAc,GACxD,OAAQ,OACN,EACA,cAAe,AAAC,IACd,EAAS,GACT,EAAa,EACf,YACA,EACA,kBAAmB,WACnB,EACA,iBAAkB,AAAC,IACjB,EAAY,GACZ,EAAa,EACf,EACA,WACF,IAGiB,IAAlB,EAAO,MAAM,CACZ,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,yKACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iCAAwB,+FACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,QAAQ,UAAU,KAAK,KAAK,SAAU,EAAQ,QAAS,WAAc,iBAI7E,UAIR,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,uDAA8C,sBAC7D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2CACb,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,0DACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,WACL,QAAS,EAAE,qBAAqB,CAChC,SAAW,AAAD,GAAO,EAAoB,CAAE,sBAAuB,EAAE,MAAM,CAAC,OAAO,AAAC,KAC/E,6BAGJ,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,kBACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,MAAO,EAAE,YAAY,CACrB,SAAU,AAAC,GAAM,EAAoB,CAAE,aAAc,EAAE,MAAM,CAAC,KAAK,AAAC,GACpE,YAAY,gBACZ,SAAU,CAAC,EAAE,qBAAqB,MAGtC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,oBACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,MAAO,EAAE,cAAc,CACvB,SAAU,AAAC,GAAM,EAAoB,CAAE,eAAgB,EAAE,MAAM,CAAC,KAAK,AAAC,GACtE,YAAY,kBACZ,SAAU,CAAC,EAAE,qBAAqB,YAM1C,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,uDAA8C,WAC7D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2CACb,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,0DACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,KAAK,WAAW,QAAS,EAAE,aAAa,CAAE,SAAU,AAAC,GAAM,EAAoB,CAAE,cAAe,EAAE,MAAM,CAAC,OAAO,AAAC,KAAM,oBAGhI,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,YACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,MAAO,EAAE,YAAY,CACrB,SAAU,AAAC,GAAM,EAAoB,CAAE,aAAc,EAAE,MAAM,CAAC,KAAK,AAAC,GACpE,YAAY,UACZ,SAAU,CAAC,EAAE,aAAa,MAG9B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,aACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,MAAO,EAAE,aAAa,CACtB,SAAU,AAAC,GAAM,EAAoB,CAAE,cAAe,EAAE,MAAM,CAAC,KAAK,AAAC,GACrE,YAAY,WACZ,SAAU,CAAC,EAAE,aAAa,YAMlC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,KAAM,EACN,QAAS,EACT,MAAO,EAAe,+BAAiC,8BACvD,OACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,gDACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,QAAQ,UAAU,QAAS,WAAiB,UAGpD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,SAAU,EAAQ,QAAS,WAAW,qBAMlD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACZ,EAAa,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gCAAwB,IAAoB,KACzE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,UACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,MAAO,EAAW,KAAK,CACvB,SAAU,AAAC,IACT,EAAc,MACd,EAAc,AAAC,IAAO,AAAD,CAAG,GAAG,CAAC,CAAE,MAAO,EAAE,MAAM,CAAC,KAAK,AAAC,CAAC,EACvD,EACA,YAAY,gBACZ,SAAS,CAAA,CAAA,EACT,UAAW,AAAC,IACI,SAAS,CAAnB,EAAE,GAAG,GACP,EAAE,cAAc,GAChB,IAEJ,OAGJ,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,SACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,MAAO,EAAW,IAAI,CAAE,SAAU,KAAO,EAAG,QAAQ,CAAA,CAAA,WAC1D,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,gBAAO,cAGzB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sCACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,qBACvC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CACL,MAAO,EAAW,oBAAoB,CAAG,MAAQ,KACjD,SAAU,AAAC,GAAM,EAAc,AAAC,GAAO,CAAD,CAAG,GAAG,CAAC,CAAE,qBAAyC,AAAnB,UAAE,MAAM,CAAC,KAAK,CAAW,CAAC,YAE/F,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,eAAM,YACpB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,cAAK,eAGvB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,gBACvC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CAAC,MAAO,EAAW,gBAAgB,CAAG,MAAQ,KAAM,SAAU,AAAC,GAAM,EAAc,AAAC,IAAM,AAAC,CAAE,GAAG,CAAC,CAAE,iBAAqC,QAAnB,EAAE,MAAM,CAAC,KAAK,CAAW,CAAC,YACpJ,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,eAAM,YACpB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,cAAK,eAGvB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,wBACvC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CACL,MAAO,EAAW,kBAAkB,CAAG,MAAQ,KAC/C,SAAW,AAAD,GAAO,EAAc,AAAC,GAAO,CAAD,CAAG,GAAG,CAAC,CAAE,mBAAuC,QAAnB,EAAE,MAAM,CAAC,KAAK,CAAW,CAAC,YAE7F,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,eAAM,YACpB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,cAAK,yBAQnC,CC5ZO,SAAS,EAAiB,OAC/B,CAAK,iBACL,CAAe,CAIhB,EACC,IAAM,EAAI,EAAM,SAAS,CAEzB,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAa,MAAM,YAAY,YAAY,0DAC1C,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sCACb,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,0DACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,KAAK,WAAW,QAAS,EAAE,gBAAgB,CAAE,SAAU,AAAC,GAAO,EAAgB,CAAE,iBAAkB,EAAG,MAAM,CAAC,OAAO,AAAC,KAAM,uBAGpI,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,0DACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,WACL,QAAS,EAAE,sBAAsB,CACjC,SAAW,AAAD,GAAQ,EAAgB,CAAE,uBAAwB,EAAG,MAAM,CAAC,OAAO,AAAC,KAC9E,yCAIJ,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,8BACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,oBAAoB,CAAE,SAAU,AAAC,GAAO,EAAgB,CAAE,qBAAsB,EAAG,MAAM,CAAC,KAAK,AAAC,QAElH,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,2BACvC,CAAA,EAAA,EAAA,GAAA,EAAC,WAAA,CACC,UAAU,iHACV,MAAO,EAAE,iBAAiB,CAC1B,SAAU,AAAC,GAAO,EAAgB,CAAE,kBAAmB,EAAG,MAAM,CAAC,KAAM,AAAD,QAI1E,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,0CACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,8BAA8B,CAAE,SAAU,AAAC,GAAO,EAAgB,CAAE,+BAAgC,EAAG,MAAM,CAAC,KAAK,AAAC,QAEtI,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,uCACvC,CAAA,EAAA,EAAA,GAAA,EAAC,WAAA,CACC,UAAU,iHACV,MAAO,EAAE,2BAA2B,CACpC,SAAU,AAAC,GAAO,EAAgB,CAAE,4BAA6B,EAAG,MAAM,CAAC,KAAK,AAAC,YAM7F,CCrDO,SAAS,EAAe,OAC7B,CAAK,eACL,CAAa,CAId,EACC,IAAM,EAAI,EAAM,OAAO,CAEvB,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAa,MAAM,UAAU,YAAY,kFACxC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sCACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,kBACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,YAAY,CAAE,SAAW,AAAD,GAAO,EAAc,CAAE,aAAc,EAAE,MAAM,CAAC,KAAK,AAAC,QAE9F,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,iBACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,WAAW,CAAE,SAAU,AAAC,GAAM,EAAc,CAAE,YAAa,EAAE,MAAM,CAAC,KAAK,AAAC,GAAI,YAAY,iCAE5G,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,gCACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,kBAAkB,CAAE,SAAU,AAAC,GAAM,EAAc,CAAE,mBAAoB,EAAE,MAAM,CAAC,KAAK,AAAC,GAAI,YAAY,yBAE1H,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,iCACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,kBAAkB,CAAE,SAAU,AAAC,GAAM,EAAc,CAAE,mBAAoB,EAAE,MAAM,CAAC,KAAK,AAAC,GAAI,YAAY,gBAE1H,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,mBACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,aAAa,CAAE,SAAU,AAAC,GAAM,EAAc,CAAE,cAAe,EAAE,MAAM,CAAC,KAAK,AAAC,GAAI,YAAY,uBAEhH,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,UACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,KAAK,CAAE,SAAU,AAAC,GAAM,EAAc,CAAE,MAAO,EAAE,MAAM,CAAC,KAAK,AAAC,GAAI,KAAK,QAAQ,YAAY,2BAE7G,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,qBACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,eAAe,CAAE,SAAU,AAAC,GAAM,EAAc,CAAE,gBAAiB,EAAE,MAAM,CAAC,KAAK,AAAC,GAAI,YAAY,4BAEpH,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,aACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,OAAO,CAAE,SAAU,AAAC,GAAM,EAAc,CAAE,QAAS,EAAE,MAAM,CAAC,KAAK,AAAC,GAAI,YAAY,mBAGpG,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,uBACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,gBAAgB,CAAE,SAAU,AAAC,GAAM,EAAc,CAAE,iBAAkB,EAAE,MAAM,CAAC,KAAK,AAAC,GAAI,YAAY,UAEtH,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,uBACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,MAAO,OAAO,EAAE,gBAAgB,EAChC,SAAU,AAAC,GAAM,EAAc,CAAE,iBAAkB,OAAO,EAAE,MAAM,CAAC,KAAK,EAAI,EAAG,GAC/E,KAAK,SACL,IAAK,OAIT,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,2CACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,UAAU,SACV,KAAK,WACL,QAAS,EAAE,aAAa,CACxB,SAAU,AAAC,GAAM,EAAc,CAAE,cAAe,EAAE,MAAM,CAAC,OAAO,AAAC,KAEnE,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,uBAAc,sBAEhC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,sCAA6B,kDAE9C,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,2CACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,SAAS,KAAK,WAAW,QAAS,EAAE,SAAS,CAAE,SAAU,AAAC,GAAM,EAAc,CAAE,UAAW,EAAE,MAAM,CAAC,OAAO,AAAC,KAC7H,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,uBAAc,kBAEhC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,sCAA6B,sDAE9C,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,2CACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,UAAU,SACV,KAAK,WACL,QAAS,EAAE,sBAAsB,CACjC,SAAU,AAAC,GAAM,EAAc,CAAE,uBAAwB,EAAE,MAAM,CAAC,OAAO,AAAC,KAE5E,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,uBAAc,yBAEhC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,sCAA6B,kEAG9C,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,yBACvC,CAAA,EAAA,EAAA,GAAA,EAAC,WAAA,CACC,UAAU,gHACV,MAAO,EAAE,kBAAkB,CAC3B,SAAU,AAAC,GAAM,EAAc,CAAE,mBAAoB,EAAE,MAAM,CAAC,KAAK,AAAC,QAGxE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,oBACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,aAAa,CAAE,SAAU,AAAC,GAAM,EAAc,CAAE,cAAe,EAAE,MAAM,CAAC,KAAK,AAAC,QAEhG,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,kBACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,WAAW,CAAE,SAAU,AAAC,GAAM,EAAc,CAAE,YAAa,EAAE,MAAM,CAAC,KAAK,AAAC,GAAI,YAAY,mBAG5G,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,oBACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,cAAc,CAAE,SAAU,AAAC,GAAM,EAAc,CAAE,eAAgB,EAAE,MAAM,CAAC,KAAK,AAAC,GAAI,YAAY,UAGlH,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,2CACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,UAAU,SACV,KAAK,WACL,QAAS,EAAE,0BAA0B,CACrC,SAAU,AAAC,GAAM,EAAc,CAAE,2BAA4B,EAAE,MAAM,CAAC,OAAO,AAAC,KAEhF,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,uBAAc,sCAEhC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,sCAA6B,oFAKtD,CC/HO,SAAS,EAAuB,OACrC,CAAK,uBACL,CAAqB,CAItB,EACC,IAAM,EAAI,EAAM,eAAe,CAE/B,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAa,MAAM,qBAAqB,YAAY,8EACnD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sCACb,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,0DACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,KAAK,WAAW,QAAS,EAAE,kBAAkB,CAAE,SAAU,AAAC,GAAM,EAAsB,CAAE,mBAAoB,EAAE,MAAM,CAAC,OAAQ,AAAD,KAAO,4BAI5I,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,2BACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,oBAAoB,CAAE,SAAU,AAAC,GAAM,EAAsB,CAAE,qBAAsB,EAAE,MAAM,CAAC,KAAK,AAAC,QAGtH,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,uBACvC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CAAC,MAAO,EAAE,gBAAgB,CAAE,SAAU,AAAC,GAAM,EAAsB,CAAE,iBAAkB,EAAE,MAAM,CAAC,KAAK,AAAoE,aAC9K,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,oBAAW,aACzB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,mBAAU,kBAI5B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,sBACvC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CAAC,MAAO,EAAE,eAAe,CAAE,SAAU,AAAC,GAAM,EAAsB,CAAE,gBAAiB,EAAE,MAAM,CAAC,KAAK,AAAmE,aAC3K,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,oBAAW,aACzB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,oBAAW,mBAI7B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,4BACvC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CACL,MAAO,EAAE,oBAAoB,CAC7B,SAAU,AAAC,GAAM,EAAsB,CAAE,qBAAsB,EAAE,MAAM,CAAC,KAAK,AAAwE,aAErJ,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,cAAK,OACnB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,kBAAS,iBAI3B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,qCACb,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,4CACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,KAAK,WAAW,QAAS,EAAE,iBAAiB,CAAE,SAAU,AAAC,GAAM,EAAsB,CAAE,kBAAmB,EAAE,MAAM,CAAC,OAAO,AAAC,KAAM,yBAG1I,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,4CACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,KAAK,WAAW,QAAS,EAAE,mBAAmB,CAAE,SAAU,AAAC,GAAM,EAAsB,CAAE,oBAAqB,EAAE,MAAM,CAAC,OAAO,AAAC,KAAM,2BAG9I,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,4CACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,WACL,QAAS,EAAE,sBAAsB,CACjC,SAAU,AAAC,GAAM,EAAsB,CAAE,uBAAwB,EAAE,MAAM,CAAC,OAAQ,AAAD,KACjF,kCAKN,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,+BACvC,CAAA,EAAA,EAAA,GAAA,EAAC,WAAA,CACC,UAAU,iHACV,MAAO,EAAE,sBAAsB,CAC/B,SAAU,AAAC,GAAM,EAAsB,CAAE,uBAAwB,EAAE,MAAM,CAAC,KAAK,AAAC,QAIpF,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,cACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,QAAQ,CAAE,SAAU,AAAC,GAAM,EAAsB,CAAE,SAAU,EAAE,MAAM,CAAC,KAAM,AAAD,GAAK,YAAY,mBAG9G,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,0DACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,WACL,QAAS,EAAE,6BAA6B,CACxC,SAAU,AAAC,GAAM,EAAsB,CAAE,8BAA+B,EAAE,MAAM,CAAC,OAAO,AAAC,KACzF,sCAGJ,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,0DACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,WACL,QAAS,EAAE,kCAAkC,CAC7C,SAAU,AAAC,GAAM,EAAsB,CAAE,mCAAoC,EAAE,MAAM,CAAC,OAAO,AAAC,KAC9F,4CAIJ,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,gCACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,wBAAwB,CAAE,SAAU,AAAC,GAAM,EAAsB,CAAE,yBAA0B,EAAE,MAAM,CAAC,KAAK,AAAC,YAKtI,CCvGA,IAAA,EAAA,EAAA,CAAA,CAAA,OAEA,EAAA,EAAA,CAAA,CAAA,OA0BA,IAAM,EAAmE,CACvE,CAAE,MAAO,GAAI,MAAO,SAAU,EAC9B,CAAE,MAAO,OAAQ,MAAO,MAAO,EAC/B,CAAE,MAAO,UAAW,MAAO,SAAU,EACrC,CAAE,MAAO,UAAW,MAAO,SAAU,EACrC,CAAE,MAAO,SAAU,MAAO,QAAS,EACpC,CAED,SAAS,EAAsB,CAAc,QAC3C,AAAc,SAAV,GAA8B,YAAV,GAAiC,YAAV,GAAiC,AAAV,cAAgC,WAAW,CAArB,EACnF,EAEF,SACT,CAEA,SAAS,EAAwB,CAAc,EAC7C,GAAI,AAAiB,iBAAV,EAAoB,OAAO,KACtC,IAAM,EAAU,EAAM,IAAI,GAC1B,OAAO,EAAQ,MAAM,CAAG,EAAI,EAAU,IACxC,CAWO,SAAS,EAAmB,YAAE,CAAU,CAA0B,EACvE,IAAM,EAAO,CAAA,EAAA,EAAA,OAAA,AAAO,IACd,EAAS,CAAA,EAAA,EAAA,SAAA,AAAS,IAElB,CAAC,EAAS,EAAW,CAAG,EAAA,OAAK,CAAC,QAAQ,EAAC,GACvC,CAAC,EAAM,EAAQ,CAAG,EAAA,OAAK,CAAC,QAAQ,EAAC,GACjC,CAAC,EAAO,EAAS,CAAG,EAAA,OAAK,CAAC,QAAQ,CAAgB,MAClD,CAAC,EAAQ,EAAU,CAAG,EAAA,OAAK,CAAC,QAAQ,CAAgB,MAEpD,CAAC,EAAW,EAAa,CAAG,EAAA,OAAK,CAAC,QAAQ,CAAS,OAEnD,CAAC,EAAa,EAAe,CAAG,EAAA,OAAK,CAAC,QAAQ,CAAiB,EAAE,EACjE,CAAC,EAAiB,EAAmB,CAAG,EAAA,OAAK,CAAC,QAAQ,CAAqB,EAAE,EAE7E,CAAC,EAAO,EAAS,CAAG,EAAA,OAAK,CAAC,QAAQ,CAAC,IACnC,CAAC,EAAW,EAAa,CAAG,EAAA,OAAK,CAAC,QAAQ,CAAC,GAC3C,CAAC,EAAU,EAAY,CAAG,EAAA,OAAK,CAAC,QAAQ,CAAC,IAEzC,CAAC,EAAU,EAAY,CAAG,EAAA,OAAK,CAAC,QAAQ,EAAC,GACzC,CAAC,EAAY,EAAc,CAAG,EAAA,OAAK,CAAC,QAAQ,CAAS,OACrD,CAAC,EAAU,EAAY,CAAG,EAAA,OAAK,CAAC,QAAQ,CAAS,IACjD,CAAC,EAAW,EAAa,CAAG,EAAA,OAAK,CAAC,QAAQ,CAAS,IACnD,CAAC,EAAW,EAAa,CAAG,EAAA,OAAK,CAAC,QAAQ,CAAS,IACnD,CAAC,EAAe,EAAiB,CAAG,EAAA,OAAK,CAAC,QAAQ,CAAS,IAE3D,EAAW,EAAA,OAAK,CAAC,WAAW,CAChC,CAAC,EAAgB,KACf,EAAc,GACd,EAAY,EAAI,IAAI,EACpB,EAAa,EAAI,KAAK,EAAI,IAC1B,EAAkC,UAArB,OAAO,EAAI,KAAK,CAAgB,EAAI,KAAK,CAAG,IACzD,EAA2C,UAA1B,OAAO,EAAI,UAAU,CAAgB,OAAO,EAAI,UAAU,EAAI,IAC/E,GAAY,EACd,EACA,EAAE,EAGE,EAAU,EAAA,OAAK,CAAC,WAAW,CAAC,UAChC,GAA0B,UAAtB,OAAO,GAAiD,IAAtB,EAAW,MAAM,CAAQ,YAC7D,EAAS,wBAIX,GAAI,CACF,GAAW,GACX,EAAS,MACT,EAAU,MAEV,GAAM,CAAC,EAAS,EAAY,CAAG,MAAM,QAAQ,GAAG,CAAC,CAC/C,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAmC,CAAC,KAAK,EAAE,EAAW,6BAA6B,CAAC,EAC5F,CAAA,EAAA,EAAA,QAAA,AAAQ,EAA2C,CAAC,KAAK,EAAE,EAAW,iCAAiC,CAAC,EACzG,EAED,EAAe,MAAM,OAAO,CAAC,EAAQ,YAAY,EAAI,EAAQ,YAAY,CAAG,EAAE,EAC9E,EAAmB,MAAM,OAAO,CAAC,EAAY,gBAAgB,EAAI,EAAY,gBAAgB,CAAG,EAAE,CACpG,CAAE,MAAO,EAAG,CACV,GAAI,aAAa,EAAA,QAAQ,EAAiB,AAAb,QAAE,MAAM,EAAY,AAAsB,iBAAf,GAA2B,EAAW,MAAM,CAAG,EAAG,CACxG,IAAM,EAAO,CAAC,KAAK,EAAE,EAAW,uCAAuC,CAAC,CACxE,EAAO,OAAO,CAAC,CAAC,KAAK,EAAE,EAAW,sBAAsB,EAAE,mBAAmB,GAAA,CAAO,EACpF,MACF,CACA,EAAS,aAAa,MAAQ,EAAE,OAAO,CAAG,2BAC5C,QAAU,CACR,GAAW,EACb,CACF,EAAG,CAAC,EAAQ,EAAW,EAEvB,EAAA,OAAK,CAAC,SAAS,CAAC,KACd,IAAI,EAAK,OAAO,EAAE,AACb,EAAK,eAAe,EACzB,AAD2B,GACvB,CAAC,EAAK,GAAG,CAAC,aAAc,YAC1B,EAAO,OAAO,CAAC,QAGZ,IACP,EAAG,CAAC,EAAM,EAAS,EAAO,EAE1B,IAAM,GAAa,EAAA,OAAK,CAAC,OAAO,CAAC,KAC/B,IAAM,EAAqB,QAAd,EAAsB,EAAc,EAC3C,EAAS,EAAM,IAAI,GAAG,WAAW,UACvC,AAAK,EACE,EADH,AACQ,IADC,EACK,CAAE,AAAD,GAAO,CAAA,EAAG,EAAE,IAAI,CAAC,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC,EAAE,EAAE,KAAK,EAAI,GAAG,CAAC,EAAE,EAAE,UAAU,EAAI,GAAA,CAAI,CAAC,WAAW,GAAG,QAAQ,CAAC,IAD3F,CAEtB,EAAG,CAAC,EAAW,EAAa,EAAiB,EAAM,EAE7C,GAAY,GAAW,MAAM,CAC7B,GAAW,EAAA,OAAK,CAAC,OAAO,CAAC,KAC7B,IAAM,EAAQ,EAAY,EACpB,EAAM,EAAQ,EACpB,OAAO,GAAW,KAAK,CAAC,EAAO,EACjC,EAAG,CAAC,GAAY,EAAW,EAAS,EAE9B,GAAa,EAAA,OAAK,CAAC,OAAO,CAC9B,IAAM,CACJ,CACE,GAAI,QACJ,OAAQ,QACR,KAAM,AAAC,GACL,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oBACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAS,EAAsB,EAAI,KAAK,WAAI,EAAI,KAAK,GACtC,UAArB,OAAO,EAAI,KAAK,EAAiB,EAAI,KAAK,CAAC,MAAM,CAAG,EAAI,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,kCAAwB,IAAE,EAAI,KAAK,CAAC,OAAW,QAE1H,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,+CAAuC,EAAI,IAAI,MAGlE,UAAW,eACb,EACA,CACE,GAAI,UACJ,OAAQ,gBACR,KAAM,AAAC,GAAQ,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iCAAyB,EAAI,aAAa,EAAI,MAC5E,UAAW,eACb,EACA,CACE,GAAI,QACJ,OAAQ,QACR,KAAM,AAAC,GAAQ,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iCAAmD,UAA1B,OAAO,EAAI,UAAU,CAAgB,EAAI,UAAU,CAAG,MAC7G,UAAW,mBACb,EACA,CACE,GAAI,SACJ,OAAQ,SACR,KAAM,AAAC,GAAQ,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iCAA2C,AAAlB,OAAI,SAAS,CAAa,KAAO,QACxF,UAAW,mBACb,EACA,CACE,GAAI,UACJ,OAAQ,UACR,KAAM,AAAC,GACL,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,6BACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,QAAQ,UAAU,KAAK,KAAK,QAAS,IAAM,EAAS,MAAO,YAAM,WAK7E,UAAW,mBACb,EACD,CACD,CAAC,EAAS,EAGN,GAAiB,EAAA,OAAK,CAAC,OAAO,CAClC,IAAM,CACJ,CACE,GAAI,QACJ,OAAQ,QACR,KAAM,AAAC,GACL,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oBACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAS,EAAsB,EAAI,KAAK,WAAI,EAAI,KAAK,GACtC,UAArB,OAAO,EAAI,KAAK,EAAiB,EAAI,KAAK,CAAC,MAAM,CAAG,EAAI,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,kCAAwB,IAAE,EAAI,KAAK,CAAC,OAAW,QAE1H,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,+CAAuC,EAAI,IAAI,MAGlE,UAAW,eACb,EACA,CACE,GAAI,QACJ,OAAQ,QACR,KAAM,AAAC,GAAQ,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iCAAmD,UAA1B,OAAO,EAAI,UAAU,CAAgB,EAAI,UAAU,CAAG,MAC7G,UAAW,mBACb,EACA,CACE,GAAI,SACJ,OAAQ,SACR,KAAM,AAAC,GAAQ,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,kCAA2C,IAAlB,EAAI,SAAS,CAAa,KAAO,QACxF,UAAW,mBACb,EACA,CACE,GAAI,UACJ,OAAQ,UACR,KAAM,AAAC,GACL,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,6BACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,QAAQ,UAAU,KAAK,KAAK,QAAS,IAAM,EAAS,UAAW,YAAM,WAKjF,UAAW,mBACb,EACD,CACD,CAAC,EAAS,EAGZ,eAAe,GAAa,CAAsB,EAChD,GAAI,EAAM,OACV,GAA0B,UAAtB,OAAO,GAAiD,IAAtB,EAAW,MAAM,CAAQ,YAC7D,EAAS,wBAIX,IAAM,EACJ,AAAe,UACX,CAAC,KAAK,EAAE,EAAW,8BAA8B,EAAE,mBAAmB,GAAA,CAAW,CACjF,CAAC,KAAK,EAAE,EAAW,kCAAkC,EAAE,mBAAmB,GAAA,CAAW,CAErF,EACK,UAAT,EACI,CAAE,MAAO,KAAM,MAAO,KAAM,WAAY,IAAK,EAC7C,CACE,MAAO,EAAwB,GAC/B,MAAO,EAAwB,GAC/B,WApNZ,AAoNwB,SApNf,AAAqB,CAAc,EAC1C,GAAqB,UAAjB,OAAO,GAAsB,AAAiB,iBAAV,EAAoB,OAAO,KACnE,IAAM,EAAM,OAAO,GAAO,IAAI,GAC9B,GAAmB,IAAf,EAAI,MAAM,CAAQ,OAAO,KAC7B,IAAM,EAAI,OAAO,QAAQ,CAAC,EAAK,WAC/B,AAAK,IAAD,GAAQ,QAAQ,CAAC,GACd,CADkB,IACb,GAAG,CAAC,EAAG,KAAK,GAAG,CAAC,IAAQ,IADJ,IAElC,EA6M6C,EACnC,EAEN,GAAI,CACF,EAAQ,IACR,EAAS,MACT,EAAU,MAEV,MAAM,CAAA,EAAA,EAAA,QAAQ,AAAR,EAAS,EAAU,CACvB,OAAQ,QACR,KAAM,CACR,GAEA,GAAY,GACZ,EAAmB,UAAT,EAAmB,4BAA8B,iBAC3D,MAAM,GACR,CAAE,MAAO,EAAG,CACV,GAAI,aAAa,EAAA,QAAQ,EAAiB,MAAb,EAAE,MAAM,EAAkC,UAAtB,OAAO,GAA2B,EAAW,MAAM,CAAG,EAAG,CACxG,IAAM,EAAO,CAAC,KAAK,EAAE,EAAW,uCAAuC,CAAC,CACxE,EAAO,OAAO,CAAC,CAAC,KAAK,EAAE,EAAW,sBAAsB,EAAE,mBAAmB,GAAA,CAAO,EACpF,MACF,CAEA,EAAS,aAAa,MAAQ,EAAE,OAAO,CAAG,yBAC5C,QAAU,CACR,GAAQ,EACV,CACF,CAEA,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,CAAa,MAAM,WAAW,YAAY,yFACzC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,8DACZ,EAAS,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iCAAyB,IAAgB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAA,GACnE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,QAAQ,UAAU,KAAK,KAAK,QAAS,IAAM,KAAK,IAAW,SAAU,GAAW,WAAM,eAK/F,EAAQ,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gCAAwB,IAAe,KAE/D,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,IAAI,CAAA,CACH,MAAO,EACP,cAAe,AAAC,KACD,QAAT,GAA2B,YAAT,CAAS,GAAW,CACxC,EAAa,GACb,EAAS,IACT,EAAa,GAEjB,YAEA,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,QAAQ,CAAA,WACP,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,MAAM,eAAM,iBACzB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,MAAM,mBAAU,wBAG/B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,MAAM,eACjB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAC,UAAU,uBACd,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,gBACrB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CACR,MAAO,CAAC,kBAAe,EAAE,EAAA,CAAY,CACrC,KAAM,GACN,QAAS,GACT,SAAU,AAAC,GAAQ,EAAI,EAAE,CACzB,aAAa,mBACb,OAAQ,OACN,EACA,cAAe,AAAC,IACd,EAAS,GACT,EAAa,EACf,YACA,EACA,kBAAmB,WACnB,EACA,iBAAkB,AAAC,IACjB,EAAY,GACZ,EAAa,EACf,YACA,EACF,UAMR,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,MAAM,mBACjB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAC,UAAU,uBACd,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,gBACrB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CACR,MAAO,CAAC,sBAAmB,EAAE,EAAA,CAAY,CACzC,KAAM,GACN,QAAS,GACT,SAAU,AAAC,GAAQ,EAAI,EAAE,CACzB,aAAa,uBACb,OAAQ,OACN,EACA,cAAgB,AAAD,IACb,EAAS,GACT,EAAa,EACf,YACA,EACA,kBAAmB,WACnB,EACA,iBAAkB,AAAC,IACjB,EAAY,GACZ,EAAa,EACf,YACA,EACF,aAOV,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,KAAM,EACN,QAAS,KACH,GACJ,GADU,AACE,EACd,EACA,MAAsB,QAAf,EAAuB,CAAC,eAAe,CAAC,CAAG,CAAC,mBAAmB,CAAC,CACvE,OACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,8DACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,QAAQ,UAAU,SAAU,EAAM,QAAS,IAAM,KAAK,GAAa,kBAAU,sBAGrF,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,QAAQ,UAAU,SAAU,EAAM,QAAS,IAAM,GAAY,YAAQ,WAG7E,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,SAAU,EAAM,QAAS,IAAM,KAAK,GAAa,iBACtD,EAAO,YAAc,wBAM9B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,UACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAW,SAAU,AAAC,GAAM,EAAa,EAAE,MAAM,CAAC,KAAK,EAAG,YAAY,kBAAkB,UAAW,MACjH,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iCAAwB,sDAGzC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,UACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,MAAO,EAAW,SAAU,AAAC,GAAM,EAAa,EAAE,MAAM,CAAC,KAAK,WACnE,EAAa,GAAG,CAAE,AAAD,GAChB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAmC,MAAO,EAAI,KAAK,UACjD,EAAI,KAAK,EADC,EAAI,KAAK,CAAG,EAAI,KAAK,KAKtC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iCAAwB,uCAGzC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,eACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAe,SAAU,AAAC,GAAM,EAAiB,EAAE,MAAM,CAAC,KAAK,EAAG,YAAY,UAAU,UAAU,YAChH,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iCAAwB,gFAMnD,CChaO,eAAe,GAAyB,CAAgB,CAAE,CAAqB,EACpF,IAAM,EAAK,IAAI,gBACX,GAAM,GAAG,EAAG,GAAG,CAAC,IAAK,EAAK,CAAC,EAC/B,IAAM,EAAS,EAAG,QAAQ,GAAK,CAAC,CAAC,EAAE,EAAG,QAAQ,GAAA,CAAI,CAAG,GACrD,MAAO,CAAA,EAAA,EAAA,QAAA,AAAQ,EAA2C,CAAC,KAAK,EAAE,EAAS,sCAAsC,EAAE,EAAA,CAAQ,CAC7H,CAeO,eAAe,GAA0B,CAAgB,CAAE,CAAqC,EACrG,MAAO,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,CAAC,KAAK,EAAE,EAAS,sCAAsC,CAAC,CAAE,CACxE,OAAQ,OACR,KAAM,CACR,EACF,CAEO,eAAe,GACpB,CAAgB,CAChB,CAAU,CACV,CAA8C,EAE9C,MAAO,CAAA,EAAA,EAAA,QAAQ,AAAR,EAAS,CAAC,KAAK,EAAE,EAAS,uCAAuC,EAAE,EAAA,CAAI,CAAE,CAC9E,OAAQ,QACR,KAAM,CACR,EACF,CAEO,eAAe,GAA0B,CAAgB,CAAE,CAAU,EAC1E,MAAO,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,CAAC,KAAK,EAAE,EAAS,uCAAuC,EAAE,EAAA,CAAI,CAAE,CAC9E,OAAQ,QACV,EACF,CAEO,eAAe,GACpB,CAAgB,CAChB,CAAU,CACV,CAAuD,EAEvD,MAAO,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,CAAC,KAAK,EAAE,EAAS,uCAAuC,EAAE,EAAG,KAAK,CAAC,CAAE,CACnF,OAAQ,OACR,KAAM,CACR,EACF,CC/CA,SAAS,GAAM,CAAU,EACvB,OAAO,EAAI,MAAQ,IACrB,CAEA,SAAS,GAAe,CAAU,EAChC,OAAO,EAAI,UAAY,SACzB,CAEO,SAAS,GAA4B,YAC1C,CAAU,OACV,CAAK,QACL,CAAM,CAKP,EAIC,GAAM,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,GAAS,GACjC,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACnC,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAiC,MACjE,CAAC,EAAY,EAAc,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAiC,MACvE,CAAC,EAAO,EAAS,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAC7B,CAAC,EAAW,EAAa,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,GACrC,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAEnC,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACjC,CAAC,EAAO,EAAS,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgB,MAC5C,CAAC,EAAW,EAAa,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAA4B,EAAE,EAElE,CAAC,EAAa,EAAe,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAe,EAAE,EACzD,CAAC,EAAc,EAAgB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgB,EAAE,EAE5D,EAAU,EAAA,OAAK,CAAC,WAAW,CAAC,UAChC,GAAW,GACX,EAAS,MACT,GAAI,CACF,IAAM,EAAM,MAAM,GAAyB,OAAO,GAAa,CAAE,EAAG,EAAM,IAAI,SAAM,CAAU,GAC9F,EAAa,MAAM,OAAO,CAAC,EAAI,SAAS,EAAI,EAAI,SAAS,CAAG,EAAE,CAChE,CAAE,MAAO,EAAG,CACV,EAAS,aAAa,MAAQ,EAAE,OAAO,CAAG,4BAC5C,QAAU,CACR,EAAW,GACb,CACF,EAAG,CAAC,EAAO,EAAW,EAEtB,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACH,GACP,EAAG,CAAC,EAAQ,EAEZ,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,IAAI,GAAQ,EAmBZ,OAjBA,AAgBK,eAhBU,EACb,GAAI,CACF,GAAM,CAAC,EAAU,EAAU,CAAG,MAAM,QAAQ,GAAG,CAAC,CAC9C,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAiC,CAAC,KAAK,EAAE,OAAO,GAAY,uCAAuC,CAAC,EAC5G,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAmC,CAAC,KAAK,EAAE,OAAO,GAAY,wCAAwC,CAAC,EAChH,EACD,GAAI,CAAC,EAAO,OACZ,EAAe,MAAM,OAAO,CAAC,EAAS,YAAY,EAAI,EAAS,YAAY,CAAG,EAAE,EAChF,EAAgB,MAAM,OAAO,CAAC,EAAU,aAAa,EAAI,EAAU,aAAa,CAAG,EAAE,CACvF,CAAE,KAAM,CACN,GAAI,CAAC,EAAO,OACZ,EAAe,EAAE,EACjB,EAAgB,EAAE,CACpB,CACF,IAGO,KACL,GAAQ,CACV,CACF,EAAG,CAAC,EAAW,EAEf,IAAM,EAAY,EAAU,MAAM,CAC5B,EAAW,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,KACvB,IAAM,EAAQ,EAAY,EACpB,EAAM,EAAQ,EACpB,OAAO,EAAU,KAAK,CAAC,EAAO,EAChC,EAAG,CAAC,EAAW,EAAU,EAAU,EAE7B,EAAU,CAAA,EAAA,EAAA,OAAA,AAAO,EACrB,IAAM,CACJ,CACE,GAAI,OACJ,OAAQ,OACR,KAAM,AAAC,GACL,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oBACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,sDAA8C,EAAE,IAAI,GAClE,EAAE,WAAW,CAAG,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,0CAAkC,EAAE,WAAW,GAAU,QAG7F,UAAW,eACb,EACA,CACE,GAAI,WACJ,OAAQ,WACR,KAAM,AAAC,GAAM,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kCAAyB,EAAE,aAAa,CAAC,WACrE,UAAW,mBACb,EACA,CACE,GAAI,OACJ,OAAQ,cACR,KAAM,AAAC,GAAM,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iCAAyB,EAAE,gBAAgB,EAAI,QAC3E,UAAW,eACb,EACA,CACE,GAAI,QACJ,OAAQ,QACR,KAAM,AAAC,GAAM,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iCAAyB,EAAE,iBAAiB,EAAI,QAC5E,UAAW,eACb,EACA,CACE,GAAI,QACJ,OAAQ,QACR,KAAM,AAAC,GAAM,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAS,GAAe,EAAE,aAAa,WAAI,GAAM,EAAE,aAAa,IACpF,UAAW,mBACb,EACA,CACE,GAAI,MACJ,OAAQ,MACR,KAAM,AAAC,GAAM,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAS,GAAe,EAAE,WAAW,WAAI,GAAM,EAAE,WAAW,IAChF,UAAW,mBACb,EACA,CACE,GAAI,UACJ,OAAQ,WACR,KAAM,AAAC,GAAM,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAS,GAAe,EAAE,gBAAgB,WAAI,EAAE,gBAAgB,CAAG,UAAY,aACnG,UAAW,mBACb,EACA,CACE,GAAI,WACJ,OAAQ,WACR,KAAM,AAAC,GAAM,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iCAAyB,EAAE,gBAAgB,CAAG,IAAI,KAAK,EAAE,gBAAgB,EAAE,cAAc,GAAK,MAC1H,UAAW,mBACb,EACA,CACE,GAAI,UACJ,OAAQ,UACR,KAAM,AAAC,GACL,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,KAAK,KACL,QAAQ,UACR,QAAS,KACP,EAAW,GACX,GAAW,EACb,WACD,SAGD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,KAAK,KACL,QAAQ,UACR,QAAS,KACP,EAAc,GACd,GAAY,EACd,WACD,cAGD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,OAAO,CAAA,CAAA,EAAC,KAAK,KAAK,QAAQ,mBAChC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAI,CAAA,CAAC,KAAM,CAAC,KAAK,EAAE,OAAO,GAAY,2BAA2B,EAAE,EAAE,EAAE,CAAA,CAAE,UAAE,cAIlF,UAAW,mBACb,EACD,CACD,CAAC,EAAW,EAGd,eAAe,EAAS,CAAiC,EACvD,GAAK,CAAD,UAAY,OAAO,CAAC,CAAC,iBAAiB,EAAE,EAAS,IAAI,CAAC,EAAE,CAAC,GAAG,AAChE,EAAS,MACT,GAAI,CACF,MAAM,GAA0B,OAAO,GAAa,EAAS,EAAE,EAC/D,MAAM,GACR,CAAE,MAAO,EAAG,CACV,EAAS,aAAa,MAAQ,EAAE,OAAO,CAAG,iBAC5C,EACF,CAEA,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,CAAa,MAAM,wBAAwB,YAAY,iEACtD,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yDACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAAQ,UACR,QAAS,KACP,EAAW,MACX,EAAW,GACb,WACD,mBAKH,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAC,UAAU,uBACd,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,gBACrB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CACR,MAAM,YACN,KAAM,EACN,QAAS,EACT,SAAW,AAAD,GAAS,EAAI,EAAE,CACzB,QAAS,EACT,aAAa,2BACb,OAAQ,CAAE,YAAa,qBAAsB,EAC7C,OAAQ,OACN,EACA,cAAe,AAAC,IACd,EAAS,GACT,EAAa,EACf,YACA,EACA,kBAAmB,EACnB,WACA,iBAAkB,AAAC,IACjB,EAAY,GACZ,EAAa,EACf,YACA,CACF,QAKL,EAAQ,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gCAAwB,IAAe,KAE/D,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,KAAM,EACN,QAAS,KACP,GAAW,GACX,EAAW,KACb,EACA,MAAO,EAAU,CAAC,mBAAgB,EAAE,EAAQ,IAAI,CAAA,CAAE,CAAG,eACrD,OACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oDACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,UACE,EACC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,QAAQ,UAAU,QAAS,IAAM,KAAK,EAAS,YAAU,WAG/D,OAEN,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,gDACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAAQ,UACR,QAAS,KACP,GAAW,GACX,EAAW,KACb,WACD,UAGD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,KAAK,0BAA0B,KAAK,kBAAS,wBAO3D,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,CACC,WAAY,EACZ,YAAa,EACb,aAAc,EACd,QAAS,EACT,QAAS,UACP,GAAW,GACX,EAAW,MACX,MAAM,GACR,EACA,QAAS,AAAC,GAAQ,EAAS,OAI/B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,KAAM,EACN,QAAS,KACP,GAAY,GACZ,EAAc,KAChB,EACA,MAAO,EAAa,CAAC,eAAY,EAAE,EAAW,IAAI,CAAA,CAAE,CAAG,YACvD,OACE,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,+CACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAAQ,UACR,QAAS,KACP,GAAY,GACZ,EAAc,KAChB,WACD,qBAML,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,CACC,WAAY,EACZ,SAAU,EACV,QAAS,AAAC,GAAQ,EAAS,SAKrC,CAEA,SAAS,GAAa,YACpB,CAAU,CACV,aAAW,cACX,CAAY,SACZ,CAAO,SACP,CAAO,SACP,CAAO,CAQR,EACC,GAAM,CAAC,EAAM,EAAQ,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAC3B,CAAC,EAAW,EAAa,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgB,MAEpD,CAAC,EAAM,EAAQ,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,GAAS,MAAQ,IAC5C,CAAC,EAAa,EAAe,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,GAAS,aAAe,IACjE,CAAC,EAAc,EAAgB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAS,GAAS,eAAiB,KAC7E,CAAC,EAAc,EAAgB,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,EAAqB,GAAS,gBAAkB,GAClF,CAAC,EAAe,EAAiB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAa,GAAS,iBAAmB,GACrF,CAAC,EAAiB,EAAmB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAU,GAAS,mBAAoB,GACvF,CAAC,EAAc,EAAgB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAU,GAAS,gBAAiB,GAC9E,CAAC,EAAY,EAAc,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAU,GAAS,cAAe,GACxE,CAAC,EAAW,EAAa,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAS,GAAS,YAAc,IACpE,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAS,GAAS,UAAY,IAepE,eAAe,EAAS,CAAkB,EACxC,EAAE,cAAc,GAChB,EAAa,MAEb,IAAM,EAAW,EAAK,IAAI,GAC1B,GAAI,CAAC,EAAU,YACb,EAAa,qBAGf,GAAI,CAAC,OAAO,QAAQ,CAAC,IAAiB,GAAgB,EAAG,YACvD,EAAa,oCAGf,GAAI,GAAgB,CAAC,EAAU,IAAI,GAAI,YACrC,EAAa,iDAGf,GAAI,GAAc,CAAC,EAAQ,IAAI,GAAI,YACjC,EAAa,6CAIf,IAAM,EAA0C,CAC9C,KAAM,EACN,YAAa,EAAY,IAAI,GAAK,EAAY,IAAI,GAAK,KACvD,cAAe,EACf,eAAgB,GAA8B,KAC9C,OAD+B,SACd,GAAgC,KACjD,QADiC,SACf,EAClB,cAAe,EACf,YAAa,EACb,WAAY,EAAU,IAAI,GAAK,EAAY,KAC3C,SAAU,EAAQ,IAAI,GAAK,EAAU,IACvC,EAEA,GAAQ,GACR,GAAI,CACE,EACF,MAAM,CADK,EACqB,OAAO,GAAa,EAAQ,EAAE,CAAE,GAEhE,MAAM,GAA0B,OAAO,GAAa,GAEtD,MAAM,GACR,CAAE,MAAO,EAAK,CACZ,IAAM,EAAM,aAAe,EAAA,QAAQ,EAAiB,CAAd,IAAI,OAAO,CAAkB,MAAQ,EAAI,OAAO,CAAG,eACzF,EAAa,GACb,EAAQ,EACV,QAAU,CACR,GAAQ,EACV,CACF,CAEA,MAjEA,CAAA,EAAA,EAAA,SAAS,AAAT,EAAU,KACR,EAAQ,GAAS,MAAQ,IACzB,EAAe,GAAS,aAAe,IACvC,EAAgB,GAAS,eAAiB,KAC1C,EAAgB,GAAS,gBAAkB,GAC3C,EAAiB,GAAS,iBAAmB,GAC7C,EAAmB,GAAS,mBAAoB,GAChD,EAAgB,GAAS,gBAAiB,GAC1C,EAAc,GAAS,cAAe,GACtC,EAAa,GAAS,YAAc,IACpC,EAAW,GAAS,UAAY,GAClC,EAAG,CAAC,EAAQ,EAuDV,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,GAAG,0BAA0B,SAAU,EAAU,UAAU,sBAC9D,EAAY,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gCAAwB,IAAmB,KAEvE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kDACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,SACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAM,SAAW,AAAD,GAAO,EAAQ,EAAE,MAAM,CAAC,KAAK,EAAG,YAAY,uBAAuB,SAAU,OAG7G,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,oBACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,KAAK,SACL,IAAK,EACL,IAAK,KACL,MAAO,OAAO,GACd,SAAU,AAAC,GAAM,EAAgB,OAAO,EAAE,MAAM,CAAC,KAAK,EAAI,IAC1D,SAAU,UAKhB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,gBACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAa,SAAU,AAAC,GAAM,EAAe,EAAE,MAAM,CAAC,KAAK,EAAG,YAAY,WAAW,SAAU,OAG/G,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kDACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,gBACvC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CAAC,MAAO,OAAO,GAAe,SAAU,AAAC,GAAM,EAAgB,OAAO,EAAE,MAAM,CAAC,KAAK,GAAI,SAAU,YACvG,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,aAAI,QACjB,EACE,MAAM,CAAC,AAAC,GAAM,GAAqB,UAAhB,OAAO,EAAE,EAAE,EAC9B,GAAG,CAAC,AAAC,GACJ,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAkB,MAAO,OAAO,EAAE,EAAE,WAClC,EAAE,IAAI,EADI,EAAE,EAAE,SAMzB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,UACvC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CAAC,MAAO,OAAO,GAAgB,SAAU,AAAC,GAAM,EAAiB,OAAO,EAAE,MAAM,CAAC,KAAK,GAAI,SAAU,YACzG,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,aAAI,QACjB,EACE,MAAM,CAAC,AAAC,GAAM,GAAqB,UAAhB,OAAO,EAAE,EAAE,EAC9B,GAAG,CAAC,AAAC,GACJ,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAkB,MAAO,OAAO,EAAE,EAAE,WAClC,EAAE,IAAI,EADI,EAAE,EAAE,YAQ3B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kDACb,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,4CACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,KAAK,WAAW,QAAS,EAAiB,SAAU,AAAC,GAAM,EAAmB,EAAE,MAAM,CAAC,OAAO,EAAG,SAAU,IAClH,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UAAK,wBAER,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,4CACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,KAAK,WAAW,QAAS,EAAc,SAAU,AAAC,GAAM,EAAgB,EAAE,MAAM,CAAC,OAAO,EAAG,SAAU,IAC5G,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UAAK,qBAER,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,4CACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,KAAK,WAAW,QAAS,EAAY,SAAU,AAAC,GAAM,EAAc,EAAE,MAAM,CAAC,OAAO,EAAG,SAAU,IACxG,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UAAK,sBAIV,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,qBACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kCAAwB,uBAChB,oBAAoB,IAAE,kBAAkB,IAAE,8BAInE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,eACvC,CAAA,EAAA,EAAA,GAAA,EAAC,WAAA,CACC,UAAU,qOACV,KAAM,EACN,MAAO,EACP,SAAU,AAAC,GAAM,EAAa,EAAE,MAAM,CAAC,KAAK,EAC5C,YAAY,8BACZ,SAAU,OAId,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,aACvC,CAAA,EAAA,EAAA,GAAA,EAAC,WAAA,CACC,UAAU,qOACV,KAAM,EACN,MAAO,EACP,SAAW,AAAD,GAAO,EAAW,EAAE,MAAM,CAAC,KAAK,EAC1C,YAAY,4BACZ,SAAU,SAKpB,CAEA,SAAS,GAAiB,CACxB,YAAU,UACV,CAAQ,SACR,CAAO,CAKR,EACC,GAAM,CAAC,EAAO,EAAS,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAC7B,CAAC,EAAO,EAAS,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,EAAS,IAC7B,CAAC,EAAM,EAAQ,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAC3B,CAAC,EAAY,EAAc,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgB,MACtD,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAwC,MACxE,CAAC,EAAQ,EAAU,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAwC,MAQ5E,eAAe,IACb,GAAI,CAAC,EAAU,OACf,EAAc,MACd,EAAW,MACX,EAAU,MAEV,IAAM,EAAY,EAAM,IAAI,GACtB,EAAY,EAAM,IAAI,GAE5B,GAAI,CAAC,GAAa,CAAC,EAAW,YAC5B,EAAc,+BAIhB,GAAQ,GACR,GAAI,CACF,IAAM,EAAM,MAAM,GAAwB,OAAO,GAAa,EAAS,EAAE,CAAE,CACzE,MAAO,GAAa,KACpB,MAAO,GAAa,IACtB,GACA,EAAW,EAAI,OAAO,EACtB,EAAU,EAAI,MAAM,CACtB,CAAE,MAAO,EAAG,CACV,IAAM,EAAM,aAAa,EAAA,QAAQ,EAAe,CAAZ,EAAE,OAAO,GAAgB,MAAQ,EAAE,OAAO,CAAG,eACjF,EAAc,GACd,EAAQ,EACV,QAAU,CACR,GAAQ,EACV,CACF,CAEA,MArCA,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,EAAc,MACd,EAAW,MACX,EAAU,KACZ,EAAG,CAAC,EAAS,EAkCX,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACZ,EAAa,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gCAAwB,IAAoB,KAEzE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kDACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,UACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAO,SAAU,AAAC,GAAM,EAAS,EAAE,MAAM,CAAC,KAAK,EAAG,YAAY,mBAAmB,SAAU,OAE3G,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,UACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAO,SAAU,AAAC,GAAM,EAAS,EAAE,MAAM,CAAC,KAAK,EAAG,YAAY,kBAAkB,SAAU,UAI5G,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yCACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,QAAS,IAAM,KAAK,IAAU,SAAU,GAAQ,CAAC,WACtD,EAAO,aAAe,gBAI1B,EACC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kDACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kCAAwB,iBAAe,EAAO,KAAK,IAClE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kCAAwB,eAAa,EAAO,GAAG,OAE9D,KAEH,EACC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wDACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,+CAAsC,kBACrD,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,0DAAkD,EAAQ,KAAK,EAAI,eAEpF,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wDACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,+CAAsC,gBACrD,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,0DAAkD,EAAQ,GAAG,EAAI,kBAGlF,OAGV,CC/mBO,SAAS,GAAiB,OAC/B,CAAK,iBACL,CAAe,CAIhB,EACC,IAAM,EAAI,EAAM,SAAS,CAEzB,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAa,MAAM,aAAa,YAAY,0DAC3C,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sCACb,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,0DACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,KAAK,WAAW,QAAS,EAAE,cAAc,CAAE,SAAU,AAAC,GAAM,EAAgB,CAAE,eAAgB,EAAE,MAAM,CAAC,OAAQ,AAAD,KAAO,qBAG9H,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,0DACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,KAAK,WAAW,QAAS,EAAE,gBAAgB,CAAE,SAAU,AAAC,GAAM,EAAgB,CAAE,iBAAkB,EAAE,MAAM,CAAC,OAAO,AAAC,KAAM,uBAGlI,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,0DACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,KAAK,WAAW,QAAS,EAAE,cAAc,CAAE,SAAU,AAAC,GAAM,EAAgB,CAAE,eAAgB,EAAE,MAAM,CAAC,OAAO,AAAC,KAAM,qBAI9H,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,sBACvC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CAAC,MAAO,EAAE,eAAe,CAAE,SAAU,AAAC,GAAM,EAAgB,CAAE,gBAAiB,EAAE,MAAM,CAAC,KAAK,AAA6D,aAC/J,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,kBAAS,WACvB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,oBAAW,uBAMrC,CCpCO,SAAS,GAAgB,OAC9B,CAAK,CACL,gBAAc,QACd,CAAM,CAKP,EAEC,IAAM,EAAI,EAAM,QAAQ,CAExB,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAa,MAAM,WAAW,YAAY,oCACzC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,uDAA8C,oBAC7D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2CACb,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,4CACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,WACL,QAAS,EAAE,cAAc,CAAC,IAAI,CAC9B,SAAU,AAAC,GAAM,EAAe,CAAE,eAAgB,CAAE,GAAG,EAAE,cAAc,CAAE,KAAM,EAAE,MAAM,CAAC,OAAO,AAAC,CAAE,KAClG,UAGJ,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,0DACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,KAAK,WAAW,QAAS,EAAE,cAAc,CAAC,IAAI,CAAE,QAAQ,CAAA,CAAA,IAAG,UAGpE,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,0DACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,KAAK,WAAW,QAAS,EAAE,cAAc,CAAC,YAAY,CAAE,QAAQ,CAAA,CAAA,IAAG,mBAG5E,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,0DACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,KAAK,WAAW,QAAS,EAAE,cAAc,CAAC,MAAM,CAAE,QAAQ,CAAA,CAAA,IAAG,YAGtE,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,0DACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,KAAK,WAAW,QAAS,EAAE,cAAc,CAAC,KAAK,CAAE,QAAQ,CAAA,CAAA,IAAG,kBAO/E,CC3CO,SAAS,GAAe,OAC7B,CAAK,eACL,CAAa,CAId,EACC,IAAM,EAAI,EAAM,OAAO,CACjB,EAAgB,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,IAAM,EAAM,WAAW,CAAC,QAAQ,CAAE,CAAC,EAAM,WAAW,CAAC,QAAQ,CAAC,EAE5F,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAa,MAAM,UAAU,YAAY,kEACxC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sCACb,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,0DACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,KAAK,WAAW,QAAS,EAAE,oBAAoB,CAAE,SAAU,AAAC,GAAM,EAAc,CAAE,qBAAsB,EAAE,MAAM,CAAC,OAAO,AAAC,KAAM,6BAGxI,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,0DACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,KAAK,WAAW,QAAS,EAAE,sBAAsB,CAAE,SAAW,AAAD,GAAO,EAAc,CAAE,uBAAwB,EAAE,MAAM,CAAC,OAAO,AAAC,KAAM,+BAI5I,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,4BACvC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CAAC,MAAO,EAAE,YAAY,CAAE,SAAU,AAAC,GAAM,EAAc,CAAE,aAAc,EAAE,MAAM,CAAC,KAAK,AAAC,aAC3F,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,YAAG,uBACjB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,oBAAW,aACzB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,mBAAU,kBAI5B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,yCACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,MAAO,EAAE,8BAA8B,CAAE,SAAU,AAAC,GAAM,EAAc,CAAE,+BAAgC,EAAE,MAAM,CAAC,KAAK,AAAC,YAC9H,EAAc,GAAG,CAAC,AAAC,GAClB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAkB,MAAO,EAAE,EAAE,UAC3B,EAAE,IAAI,EADI,EAAE,EAAE,QAOvB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,0CACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,KAAK,SACL,IAAK,EACL,MAAO,OAAO,EAAE,+BAA+B,EAC/C,SAAU,AAAC,GAAM,EAAc,CAAE,gCAAiC,OAAO,EAAE,MAAM,CAAC,KAAK,EAAI,EAAG,QAIlG,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,kBACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,YAAY,CAAE,SAAU,AAAC,GAAM,EAAc,CAAE,aAAc,EAAE,MAAM,CAAC,KAAK,AAAC,QAG9F,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,2BACvC,CAAA,EAAA,EAAA,GAAA,EAAC,WAAA,CACC,UAAU,iHACV,MAAO,EAAE,oBAAoB,CAC7B,SAAU,AAAC,GAAM,EAAc,CAAE,qBAAsB,EAAE,MAAM,CAAC,KAAK,AAAC,QAI1E,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,yBACvC,CAAA,EAAA,EAAA,GAAA,EAAC,WAAA,CACC,UAAU,gHACV,MAAO,EAAE,kBAAkB,CAC3B,SAAU,AAAC,GAAM,EAAc,CAAE,mBAAoB,EAAE,MAAM,CAAC,KAAK,AAAC,YAMhF,CC9EO,SAAS,GAAuB,OACrC,CAAK,uBACL,CAAqB,CAItB,EACC,IAAM,EAAI,EAAM,eAAe,CAE/B,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAa,MAAM,mBAAmB,YAAY,sEACjD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sCACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,wBACvC,CAAA,EAAA,EAAA,GAAA,EAAC,WAAA,CACC,UAAU,iHACV,MAAO,EAAE,kBAAkB,CAC3B,SAAU,AAAC,GAAM,EAAsB,CAAE,mBAAoB,EAAE,MAAM,CAAC,KAAK,AAAC,QAIhF,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,0DACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,WACL,QAAS,EAAE,2BAA2B,CACtC,SAAU,AAAC,GAAM,EAAsB,CAAE,4BAA6B,EAAE,MAAM,CAAC,OAAO,AAAC,KACvF,qCAIJ,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,sBACvC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CACL,MAAO,EAAE,eAAe,CACxB,SAAU,AAAC,GAAM,EAAsB,CAAE,gBAAiB,EAAE,MAAM,CAAC,KAAK,AAAmE,aAE3I,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,kBAAS,WACvB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,oBAAW,uBAMrC,CC1CO,SAAS,GAAyB,OACvC,CAAK,yBACL,CAAuB,CAIxB,EACC,IAAM,EAAI,EAAM,iBAAiB,CAC3B,EAAW,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,IAAM,EAAM,WAAW,CAAC,QAAQ,CAAE,CAAC,EAAM,WAAW,CAAC,QAAQ,CAAC,EAUvF,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAa,MAAM,qBAAqB,YAAY,qDACnD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,uBACb,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,CACC,MAAM,mBACN,MAAO,EAAE,MAAM,CACf,SAAU,EACV,SAfR,CAekB,QAfT,AAAa,CAA8D,EAClF,EAAwB,CAAE,OAAQ,CAAE,GAAG,EAAE,MAAM,CAAE,GAAG,CAAK,AAAC,CAAE,EAC9D,IAeM,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,CACC,MAAM,qBACN,MAAO,EAAE,QAAQ,CACjB,SAAU,EACV,SAjBR,CAiBkB,QAjBT,AAAe,CAAgE,EACtF,EAAwB,CAAE,SAAU,CAAE,GAAG,EAAE,QAAQ,CAAE,GAAG,CAAK,AAAC,CAAE,EAClE,QAoBF,CAEA,SAAS,GAAe,OACtB,CAAK,OACL,CAAK,UACL,CAAQ,UACR,CAAQ,CAMT,EACC,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wFACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,uDAA+C,IAE9D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2CACb,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,0DACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,KAAK,WAAW,QAAS,EAAM,OAAO,CAAE,SAAU,AAAC,GAAM,EAAS,CAAE,QAAS,EAAE,MAAM,CAAC,OAAQ,AAAD,KAAO,YAI7G,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,mBACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,MAAO,EAAM,eAAe,CAAE,SAAU,AAAC,GAAM,EAAS,CAAE,gBAAiB,EAAE,MAAM,CAAC,KAAK,AAAC,YAC/F,EAAS,GAAG,CAAC,AAAC,GACb,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAkB,MAAO,EAAE,EAAE,UAC3B,EAAE,IAAI,EADI,EAAE,EAAE,QAOvB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,4BACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,MAAO,EAAM,uBAAuB,CAAE,SAAW,AAAD,GAAO,EAAS,CAAE,wBAAyB,EAAE,MAAM,CAAC,KAAK,AAAC,YAC/G,EAAS,GAAG,CAAC,AAAC,GACb,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAkB,MAAO,EAAE,EAAE,UAC3B,EAAE,IAAI,EADI,EAAE,EAAE,QAOvB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,kBACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAM,SAAS,CAAC,YAAY,CAAE,SAAU,AAAC,GAAM,EAAS,CAAE,UAAW,CAAE,GAAG,EAAM,SAAS,CAAE,aAAc,EAAE,MAAM,CAAC,KAAK,AAAC,CAAE,QAG1I,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,mBACvC,CAAA,EAAA,EAAA,GAAA,EAAC,WAAA,CACC,UAAU,iHACV,MAAO,EAAM,SAAS,CAAC,aAAa,CACpC,SAAW,AAAD,GAAO,EAAS,CAAE,UAAW,CAAE,GAAG,EAAM,SAAS,CAAE,cAAe,EAAE,MAAM,CAAC,KAAK,AAAC,CAAE,QAIjG,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,aACvC,CAAA,EAAA,EAAA,GAAA,EAAC,WAAA,CACC,UAAU,gHACV,MAAO,EAAM,SAAS,CAAC,OAAO,CAC9B,SAAU,AAAC,GAAM,EAAS,CAAE,UAAW,CAAE,GAAG,EAAM,SAAS,CAAE,QAAS,EAAE,MAAM,CAAC,KAAM,AAAD,CAAG,aAMnG,CC1GO,SAAS,GAAW,OACzB,CAAK,WACL,CAAS,CAIV,EACC,IAAM,EAAI,EAAM,GAAG,CACb,EAAgB,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,IAAM,EAAM,WAAW,CAAC,QAAQ,CAAE,CAAC,EAAM,WAAW,CAAC,QAAQ,CAAC,EAS5F,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAa,MAAM,MAAM,YAAY,mEACpC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sCACb,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,0DACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,WACL,QAAS,EAAE,+BAA+B,CAC1C,SAAW,AAAD,GAAO,EAAU,CAAE,gCAAiC,EAAE,MAAM,CAAC,OAAO,AAAC,KAC/E,yCAIJ,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,sBACvC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CAAC,MAAO,EAAE,OAAO,CAAE,SAAU,AAAC,GAAM,EAAU,CAAE,QAAS,EAAE,MAAM,CAAC,KAAK,AAA0B,aACtG,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,kBAAS,WACvB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,iBAAQ,UACtB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,kBAAS,iBAI3B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,gBACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,iBAAiB,CAAE,SAAU,AAAC,GAAM,EAAU,CAAE,kBAAmB,EAAE,MAAM,CAAC,KAAK,AAAC,GAAI,YAAY,oBAGpH,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,gBACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,iBAAiB,CAAE,SAAU,AAAC,GAAM,EAAU,CAAE,kBAAmB,EAAE,MAAM,CAAC,KAAK,AAAC,GAAI,YAAY,cAEpH,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,eACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,gBAAgB,CAAE,SAAU,AAAC,GAAM,EAAU,CAAE,iBAAkB,EAAE,MAAM,CAAC,KAAK,AAAC,GAAI,YAAY,cAGlH,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,0BACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,uDAA8C,gCAC7D,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,0CACZ,EAAc,GAAG,CAAC,AAAC,GAClB,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAkB,UAAU,4CAC3B,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,KAAK,WAAW,QAAS,EAAE,0BAA0B,CAAC,QAAQ,CAAC,EAAG,EAAE,EAAG,SAAU,IAAM,oBA/CtF,EA+CmG,AA/CzF,EA+C4F,EAAE,MA7CxH,CADE,EAAM,IAAI,IAAI,EAAE,0BAA0B,GACxC,GAAG,CAAC,GAAK,EAAI,MAAM,CAAC,GACvB,EAAI,GAAG,CAAC,GACb,EAAU,CAAE,2BAA4B,MAAM,IAAI,CAAC,EAAK,OA4C3C,EAAG,IAAI,GAFE,EAAG,EAAE,QAQvB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,0BACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,uDAA8C,aAC7D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2CACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,UAAU,CAAE,SAAU,AAAC,GAAM,EAAU,CAAE,WAAY,EAAE,MAAM,CAAC,KAAK,AAAC,GAAI,YAAY,gBACpG,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,WAAW,CAAE,SAAU,AAAC,GAAM,EAAU,CAAE,YAAa,EAAE,MAAM,CAAC,KAAK,AAAC,GAAI,YAAY,oBAExG,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,sCAA6B,8CAKtD,CC5EO,SAAS,GAAqB,OACnC,CAAK,qBACL,CAAmB,CAIpB,EACC,IAAM,EAAI,EAAM,aAAa,CAE7B,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAa,MAAM,mBAAmB,YAAY,oEACjD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sCACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,0BACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,uDAA8C,WAC7D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2CACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,MAAM,CAAC,QAAQ,CAAE,SAAU,AAAC,GAAM,EAAoB,CAAE,OAAQ,CAAE,GAAG,EAAE,MAAM,CAAE,SAAU,EAAE,MAAM,CAAC,KAAK,AAAC,CAAE,GAAI,YAAY,aAC1I,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,MAAM,CAAC,MAAM,CAAE,SAAU,AAAC,GAAM,EAAoB,CAAE,OAAQ,CAAE,GAAG,EAAE,MAAM,CAAE,OAAQ,EAAE,MAAM,CAAC,KAAK,AAAC,CAAE,GAAI,YAAY,WACtI,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,MAAM,CAAC,WAAW,CAAE,SAAU,AAAC,GAAM,EAAoB,CAAE,OAAQ,CAAE,GAAG,EAAE,MAAM,CAAE,YAAa,EAAE,MAAM,CAAC,KAAK,AAAC,CAAE,GAAI,YAAY,iBAChJ,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,MAAM,CAAC,UAAU,CAAE,SAAU,AAAC,GAAM,EAAoB,CAAE,OAAQ,CAAE,GAAG,EAAE,MAAM,CAAE,WAAY,EAAE,MAAM,CAAC,KAAK,AAAC,CAAE,GAAI,YAAY,sBAIlJ,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,0BACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,uDAA8C,WAC7D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2CACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,6CAAoC,YACrD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,yCACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,QACL,MAAO,EAAE,MAAM,CAAC,OAAO,CACvB,SAAU,AAAC,GAAM,EAAoB,CAAE,OAAQ,CAAE,GAAG,EAAE,MAAM,CAAE,QAAS,EAAE,MAAM,CAAC,KAAK,AAAC,CAAE,GACxF,UAAU,gGAEZ,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,MAAM,CAAC,OAAO,CAAE,SAAW,AAAD,GAAO,EAAoB,CAAE,OAAQ,CAAE,GAAG,EAAE,MAAM,CAAE,QAAS,EAAE,MAAM,CAAC,KAAK,AAAC,CAAE,WAG5H,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,6CAAoC,cACrD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,yCACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,QACL,MAAO,EAAE,MAAM,CAAC,SAAS,CACzB,SAAU,AAAC,GAAM,EAAoB,CAAE,OAAQ,CAAE,GAAG,EAAE,MAAM,CAAE,UAAW,EAAE,MAAM,CAAC,KAAK,AAAC,CAAE,GAC1F,UAAU,gGAEZ,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAE,MAAM,CAAC,SAAS,CAAE,SAAW,AAAD,GAAO,EAAoB,CAAE,OAAQ,CAAE,GAAG,EAAE,MAAM,CAAE,UAAW,EAAE,MAAM,CAAC,KAAK,AAAC,CAAE,qBAQ5I,CChDA,IAAA,GAAA,EAAA,CAAA,CAAA,MAUO,SAAS,GAAa,YAC3B,CAAU,OACV,CAAK,aACL,CAAW,QACX,CAAM,CAMP,EACC,GAAM,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACjC,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACnC,CAAC,EAAM,EAAQ,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAC3B,CAAC,EAAY,EAAc,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACvC,CAAC,EAAO,EAAS,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgB,MAC5C,CAAC,EAAQ,EAAU,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgB,MAE9C,CAAC,EAAe,EAAiB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAC7C,CAAC,EAAkB,EAAoB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACnD,CAAC,EAAe,EAAiB,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,EAAS,MAE7C,CAAC,EAAO,EAAS,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAsB,EAAE,EACpD,CAAC,EAAc,EAAgB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAE3C,CAAC,EAAO,EAAS,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,EAAS,IAC7B,CAAC,EAAW,EAAa,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,GACrC,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,EAAS,IACnC,EAAI,EAAM,KAAK,CAErB,eAAe,EAAkB,CAAuC,EACtE,IAAI,EACJ,GAAI,CACF,EAFU,IAEJ,CAAA,EAAA,EAAA,yBAAA,AAAyB,EAAC,OAAO,GAAa,CAClD,GAAG,CAAK,CACR,MAAO,CACT,EACF,CAAE,MAAO,EAAG,CACV,EAAS,aAAa,MAAQ,EAAE,OAAO,CAAG,kCAC5C,CACF,CAiCA,eAAe,IACb,IAAI,GACJ,EAAU,GADE,GAEZ,EAAS,MACT,GAAc,GACd,GAAI,CACF,IAAM,EAAW,MAAM,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,OAAO,IACjC,EAAa,EAAS,KAAK,EAAE,OAAS,CAAC,EACvC,EAAW,EAAU,GAAG,EAAI,CAAC,EAC7B,EAAqC,CACzC,GAAG,CAAS,CACZ,IAAK,CACH,GAAG,CAAO,CACV,gBAAgB,CAAQ,EACxB,eAAgB,EAAc,IAAI,IAAM,IAC1C,CACF,CAEA,OAAM,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,OAAO,GAAa,CACpC,mBAAoB,EAAiB,IAAI,IAAM,KAC/C,YAAa,CACf,GACA,EAAU,SACZ,CAAE,MAAO,EAAG,CACV,EAAS,aAAa,MAAQ,EAAE,OAAO,CAAG,+BAC5C,QAAU,CACR,GAAc,EAChB,EACF,CA3DA,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,IAAI,GAAQ,EAyBZ,OADK,AAvBL,eAAe,EACb,EAAS,MACT,GAAgB,GAChB,GAAI,CACF,GAAM,CAAC,EAAK,EAAS,CAAG,MAAM,QAAQ,GAAG,CAAC,CAAC,CAAA,EAAA,GAAA,mBAAA,AAAmB,EAAC,OAAO,IAAc,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,OAAO,IAAa,EACjH,GAAI,CAAC,EAAO,OACZ,EAAS,MAAM,OAAO,CAAC,EAAI,KAAK,EAAI,EAAI,KAAK,CAAG,EAAE,EAElD,IAAM,EAAqD,UAA/C,OAAO,EAAS,MAAM,EAAE,mBAAkC,EAAS,MAAM,CAAC,kBAAkB,CAAG,GAC3G,EAAoB,GAGpB,IAAM,EADS,AACG,GADM,KAAK,EAAE,OAAS,EAAC,EACjB,GAAG,EAAI,CAAC,EAChC,EAAoD,WAAnC,OAAO,EAAS,cAAc,EAAiB,EAAS,cAAc,EACvF,CAD0F,CACtC,UAAnC,OAAO,EAAS,cAAc,CAAgB,EAAS,cAAc,CAAG,KAC3F,CAAE,MAAO,EAAG,CACV,GAAI,CAAC,EAAO,OACZ,EAAS,aAAa,MAAQ,EAAE,OAAO,CAAG,wBAC5C,QAAU,CACR,GAAI,CAAC,EAAO,OACZ,GAAgB,EAClB,CACF,IAEO,KACL,GAAQ,CACV,CACF,EAAG,CAAC,EAAW,EAgCf,CAAA,EAAA,EAAA,SAAS,AAAT,EAAU,KAgBV,EAAG,CAAC,EAAW,EA4Bf,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,WAlBF,cAPA,EAA2B,AA0BvB,EA1BiC,GAAG,CAAC,AAAC,IAAM,AAAC,CACrD,GAAI,OAAO,EAAE,EAAE,EACf,KAAM,EAAE,IAAI,CACZ,YAAa,OAAO,EAAE,IAAI,EAC1B,OAAQ,EAAE,SAAS,CAAG,SAAW,UACnC,CAAC,KAEqB,EAAU,IAAI,CAAC,AAAC,GAAM,EAAE,UAAU,GAAK,KACvD,EAAU,IAAI,IAAI,EAAU,GAAG,CAAC,AAAC,GAAM,OAAO,EAAE,EAAE,IAElD,EAAY,IAAI,IAAI,CADpB,EAAS,EAAU,MAAM,CAAC,AAAC,GAAM,EAAE,SAAS,GACjB,GAAG,CAAC,AAAC,GAAM,OAAO,EAAE,EAAE,IAIjD,EAD2C,AACzB,UADD,OAAO,AADxB,EAAiB,EAAE,YAAY,GACwB,EAAe,MAAM,CAAG,GAAK,EAAQ,GAAG,CAAC,IAC5D,EAAU,GAAG,CAAC,GAElD,EAAkB,EAAO,MAAM,CAAG,EAAI,OAAO,CAAM,CAAC,EAAE,EAAE,IAAM,GAGpE,EAAY,CACV,MAAO,EACP,aAJuB,CAIT,CAJyB,OAAO,EAAc,EAAE,EAAI,EAAkB,EAAiB,CAKvG,EAMF,EAAG,CAAC,EAAM,EAEV,IAAM,EAAc,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,IAAM,EAAM,MAAM,CAAC,AAAC,GAAM,EAAE,SAAS,EAAG,CAAC,EAAM,EAErE,EAAwB,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,KACpC,IAAM,EAAY,IAAI,IAAI,EAAY,GAAG,CAAE,AAAD,GAAO,OAAO,EAAE,EAAE,WAC5D,AAAI,EAAE,YAAY,EAAI,EAAU,GAAG,CAAC,OAAO,EAAE,YAAY,GAAW,CAAP,MAAc,EAAE,YAAY,EAClF,EACT,EAAG,CAAC,EAAa,EAAE,YAAY,CAAC,EAE1B,EAAW,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,KACvB,IAAM,EAAS,EAAM,IAAI,GAAG,WAAW,UACvC,AAAK,EACE,EADH,AACS,IADA,EACM,CAAC,AAAC,GAAM,CAAA,EAAG,EAAE,EAAE,CAAC,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC,EAAE,EAAE,IAAI,CAAA,CAAE,CAAC,WAAW,GAAG,QAAQ,CAAC,IAD5D,CAEtB,EAAG,CAAC,EAAO,EAAM,EAEX,EAAY,EAAS,MAAM,CACjC,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KAER,IAAM,EAAU,KAAK,GAAG,CAAC,EADN,AACiB,KADZ,GAAG,CAAC,EAAG,KAAK,IAAI,CAAC,EAAY,IACJ,GAC7C,IAAY,GAAW,EAAa,EAC1C,EAAG,CAAC,EAAW,EAAU,EAAU,EAEnC,IAAM,EAAW,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,KACvB,IAAM,EAAQ,EAAY,EACpB,EAAM,EAAQ,EACpB,OAAO,EAAS,KAAK,CAAC,EAAO,EAC/B,EAAG,CAAC,EAAU,EAAW,EAAS,EAE5B,EAAU,CAAA,EAAA,EAAA,OAAA,AAAO,EACrB,IAAM,CACJ,CAAE,GAAI,OAAQ,OAAQ,OAAQ,KAAM,AAAC,GAAM,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iCAAyB,EAAE,IAAI,GAAS,UAAW,eAAgB,EAC7H,CAAE,GAAI,OAAQ,OAAQ,WAAY,KAAM,AAAC,GAAM,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iCAAyB,OAAO,EAAE,IAAI,IAAU,UAAW,mBAAoB,EAC7I,CACE,GAAI,SACJ,OAAQ,SACR,KAAM,AAAC,GAAM,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iCAAyB,EAAE,SAAS,CAAG,MAAQ,OAC3E,UAAW,mBACb,EACA,CACE,GAAI,UACJ,OAAQ,UACR,KAAM,AAAC,GAAM,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iCAAyB,EAAE,UAAU,CAAG,MAAQ,OAC5E,UAAW,mBACb,EACA,CACE,GAAI,UACJ,OAAQ,UACR,KAAM,AAAC,GACL,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,KAAK,KACL,QAAQ,UACR,SAAU,GAAU,EACpB,QAAS,KACP,GAAU,OAAO,EAAI,EAAE,GACvB,GAAY,EAAI,IAAI,EACpB,GAAY,OAAO,EAAI,IAAI,GAC3B,GAAc,EAAI,SAAS,EAC3B,GAAe,EAAI,UAAU,EAC7B,GAAY,EACd,WACD,SAGD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,KAAK,KACL,QAAQ,UACR,SAAU,GAAU,EACpB,QAAS,IAAM,KAAK,GAAS,YAC9B,cAKL,UAAW,mBACb,EACD,CACD,CAAC,EAAM,EAAO,EAGV,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACjC,CAAC,GAAS,GAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,KACjC,CAAC,GAAW,GAAa,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACrC,CAAC,GAAY,GAAc,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAEvC,CAAC,GAAQ,GAAU,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgB,MAC9C,CAAC,GAAU,GAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACnC,CAAC,GAAU,GAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,KACnC,CAAC,GAAY,GAAc,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACvC,CAAC,GAAa,GAAe,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAE/C,eAAe,KACb,GAAgB,GAChB,GAAI,CACF,IAAM,EAAM,MAAM,CAAA,EAAA,GAAA,mBAAA,AAAmB,EAAC,OAAO,IAC7C,EAAS,MAAM,OAAO,CAAC,EAAI,KAAK,EAAI,EAAI,KAAK,CAAG,EAAE,CACpD,CAAE,MAAO,EAAG,CACV,EAAS,aAAa,MAAQ,EAAE,OAAO,CAAG,wBAC5C,QAAU,CACR,GAAgB,EAClB,CACF,CAEA,eAAe,KACb,EAAU,MACV,EAAS,MACT,GAAQ,GACR,GAAI,CACF,IAAM,EAAO,EAAQ,IAAI,GACnB,EAAO,OAAO,IACpB,GAAI,CAAC,EAAM,MAAM,AAAI,MAAM,qBAC3B,GAAI,CAAC,OAAO,QAAQ,CAAC,GAAO,MAAM,AAAI,MAAM,mBAE5C,OAAM,CAAA,EAAA,GAAA,oBAAoB,AAApB,EAAqB,OAAO,GAAa,MAC7C,OACA,EACA,UAAW,GACX,WAAY,EACd,GACA,MAAM,KACN,EAAW,IACX,EAAW,IACX,GAAW,KACX,IAAa,GACb,IAAc,GACd,EAAU,eACZ,CAAE,MAAO,EAAG,CACV,EAAS,aAAa,MAAQ,EAAE,OAAO,CAAG,wBAC5C,QAAU,CACR,GAAQ,EACV,CACF,CAEA,eAAe,KACb,GAAK,CAAD,GACJ,EAAU,EADG,IAEb,EAAS,MACT,GAAQ,GACR,GAAI,CACF,IAAM,EAAK,OAAO,IAClB,GAAI,CAAC,OAAO,QAAQ,CAAC,GAAK,MAAM,AAAI,MAAM,gBAE1C,IAAM,EAAO,GAAS,IAAI,GACpB,EAAO,OAAO,IACpB,GAAI,CAAC,EAAM,MAAM,AAAI,MAAM,qBAC3B,GAAI,CAAC,OAAO,QAAQ,CAAC,GAAO,MAAM,AAAI,MAAM,mBAE5C,OAAM,CAAA,EAAA,GAAA,oBAAA,AAAoB,EAAC,OAAO,GAAa,EAAI,MAAE,EAAM,MAAK,GAChE,MAAM,CAAA,EAAA,GAAA,uBAAA,AAAuB,EAAC,OAAO,GAAa,EAAI,IAClD,IACF,MAAM,CAAA,EADS,AACT,GAAA,wBAAA,AAAwB,EAAC,OAAO,GAAa,GAGrD,MAAM,KACN,GAAY,GACZ,EAAU,eACZ,CAAE,MAAO,EAAG,CACV,EAAS,aAAa,MAAQ,EAAE,OAAO,CAAG,wBAC5C,QAAU,CACR,GAAQ,EACV,EACF,CAEA,eAAe,GAAS,CAAsB,EAC5C,GAAK,CAAD,UAAY,OAAO,CAAC,CAAC,YAAY,EAAE,EAAI,IAAI,CAAC,EAAE,CAAC,GAAG,AACtD,EAAU,MACV,EAAS,MACT,GAAQ,GACR,GAAI,CACF,EAAS,AAAC,GAAS,EAAK,MAAM,CAAC,AAAC,GAAM,OAAO,EAAE,EAAE,IAAM,OAAO,EAAI,EAAE,IACpE,MAAM,CAAA,EAAA,GAAA,oBAAA,AAAoB,EAAC,OAAO,GAAa,OAAO,EAAI,EAAE,GAC5D,MAAM,KACN,EAAU,eACZ,CAAE,MAAO,EAAG,CACV,EAAS,aAAa,MAAQ,EAAE,OAAO,CAAG,yBACrC,IACP,QAAU,CACR,GAAQ,EACV,EACF,CAEA,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,CAAa,MAAM,QAAQ,YAAY,2DACrC,EAAQ,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gCAAwB,IAAe,KAC9D,EAAS,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,kCAA0B,IAAgB,KAEnE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAC,UAAU,uBACd,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,gBACrB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sCACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yBACb,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,4CACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,KAAK,WAAW,QAAS,EAAe,SAAU,AAAC,GAAM,EAAiB,EAAE,MAAM,CAAC,OAAO,EAAG,SAAU,GAAc,IAAQ,2BAIxI,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,eACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAkB,SAAU,AAAC,GAAM,EAAoB,EAAE,MAAM,CAAC,KAAK,EAAG,YAAY,cAAc,SAAU,GAAc,OAE1I,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,8BACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAe,SAAU,AAAC,GAAM,EAAiB,EAAE,MAAM,CAAC,KAAK,EAAG,YAAY,KAAK,SAAU,GAAc,OAE3H,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,6DACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,QAAQ,UAAU,SAAU,GAAU,GAAc,EAAM,QAAS,IAAM,KAAK,aACnF,EAAa,YAAc,kBAOtC,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,4CACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,WACL,QAAS,EAAE,WAAW,CACtB,SAAU,AAAC,IACT,IAAM,EAAO,EAAE,MAAM,CAAC,OAAO,CAC7B,EAAY,CAAE,YAAa,CAAK,GAC3B,EAAkB,CAAE,GAAG,CAAC,CAAE,YAAa,CAAK,EACnD,IACA,kBAIJ,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oDACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iCAAwB,wCACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,QAAQ,UAAU,SAAU,GAAU,EAAM,QAAS,IAAM,GAAW,YAAO,eAKvF,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAC,UAAU,uBACd,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,gBACrB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CACR,MAAM,QACN,KAAM,EACN,QAAS,EACT,SAAU,AAAC,GAAQ,EAAI,EAAE,CACzB,QAAS,EACT,aAAa,gBACb,OAAQ,CAAE,YAAa,iBAAkB,EACzC,OAAQ,OACN,EACA,cAAe,AAAC,IACd,EAAS,GACT,EAAa,EACf,YACA,EACA,kBAAmB,WACnB,EACA,iBAAkB,AAAC,IACjB,EAAY,GACZ,EAAa,EACf,YACA,CACF,QAKN,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sCACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,gBACvC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CACL,MAAO,EACP,SAAiC,IAAvB,EAAY,MAAM,EAAU,GAAQ,EAC9C,SAAU,MAAO,IACf,IAAM,EAAO,EAAE,MAAM,CAAC,KAAK,CAG3B,GAFA,EAAY,CAAE,aAAc,CAAK,GAC5B,EAAkB,CAAE,GAAG,CAAC,CAAE,aAAc,CAAK,GAC9C,CAAC,EAAM,OACX,IAAM,EAAK,OAAO,GAClB,GAAI,AAAC,OAAO,QAAQ,CAAC,MAAO,IAAM,EAClC,CADqC,EACjC,CACF,GAAQ,GACR,MAAM,CAAA,EAAA,GAAA,wBAAA,AAAwB,EAAC,OAAO,GAAa,GACnD,MAAM,IACR,CAAE,MAAO,EAAK,CACZ,EAAS,aAAe,MAAQ,EAAI,OAAO,CAAG,6BAChD,QAAU,CACR,GAAQ,EACV,CACF,YAEA,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,YAAG,SAChB,EAAY,GAAG,CAAC,AAAC,GAChB,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CAAkB,MAAO,OAAO,EAAE,EAAE,YAClC,EAAE,IAAI,CAAC,KAAG,OAAO,EAAE,IAAI,EAAE,OADf,EAAE,EAAE,SAMvB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,oBACvC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CACL,MAAO,EAAE,cAAc,CACvB,SAAW,AAAD,IACR,IAAM,EAAO,EAAE,MAAM,CAAC,KAAK,CAC3B,EAAY,CAAE,eAAgB,CAAK,GAC9B,EAAkB,CAAE,GAAG,CAAC,CAAE,eAAgB,CAAK,EACtD,YAEA,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,qBAAY,cAC1B,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,qBAAY,uBAKhC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,KAAM,EACN,QAAS,IAAM,GAAW,GAC1B,MAAM,UACN,OACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,gDACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,QAAQ,UAAU,QAAS,IAAM,GAAW,YAAQ,UAG5D,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,SAAU,GAAU,EAAM,QAAS,IAAM,KAAK,cACnD,EAAO,YAAc,qBAK5B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,SACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,EAAS,SAAU,AAAC,GAAM,EAAW,EAAE,MAAM,CAAC,KAAK,EAAG,YAAY,gBAElF,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,aACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,KAAK,SAAS,IAAK,EAAG,MAAO,GAAS,SAAU,AAAC,GAAM,GAAW,EAAE,MAAM,CAAC,KAAK,OAEzF,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sCACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,WACvC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CAAC,MAAO,GAAY,MAAQ,KAAM,SAAW,AAAD,GAAO,GAAgC,QAAnB,EAAE,MAAM,CAAC,KAAK,YACnF,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,eAAM,QACpB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,cAAK,aAGvB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,YACvC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CAAC,MAAO,GAAa,MAAQ,KAAM,SAAU,AAAC,GAAM,GAAiC,QAAnB,EAAE,MAAM,CAAC,KAAK,YACrF,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,cAAK,OACnB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,eAAM,sBAO9B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CACJ,KAAM,EACN,QAAS,IAAM,GAAY,GAC3B,MAAM,WACN,OACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,gDACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,QAAQ,UAAU,QAAS,IAAM,GAAY,YAAQ,UAG7D,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,SAAU,GAAU,EAAM,QAAS,IAAM,KAAK,cACnD,EAAO,YAAc,qBAK5B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,SACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,MAAO,GAAU,SAAU,AAAC,GAAM,GAAY,EAAE,MAAM,CAAC,KAAK,OAErE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,aACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,KAAK,SAAS,IAAK,EAAG,MAAO,GAAU,SAAW,AAAD,GAAO,GAAY,EAAE,MAAM,CAAC,KAAK,OAE3F,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sCACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,WACvC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CAAC,MAAO,GAAa,MAAQ,KAAM,SAAU,AAAC,GAAM,GAAiC,QAAnB,EAAE,MAAM,CAAC,KAAK,YACrF,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,eAAM,QACpB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,cAAK,aAGvB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,YACvC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CAAC,MAAO,GAAc,MAAQ,KAAM,SAAU,AAAC,GAAM,GAAkC,QAAnB,EAAE,MAAM,CAAC,KAAK,YACvF,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,cAAK,OACnB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,eAAM,wBAQpC,CCljBO,SAAS,GAAgB,YAC9B,CAAU,OACV,CAAK,gBACL,CAAc,QACd,CAAM,CAMP,EACC,IAAM,EAAI,EAAM,QAAQ,CAClB,EAAgB,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,IAAM,EAAM,WAAW,CAAC,QAAQ,CAAE,CAAC,EAAM,WAAW,CAAC,QAAQ,CAAC,EAEtF,CAAC,EAAO,EAAS,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,EAA8B,EAAE,EACpD,CAAC,EAAc,EAAgB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAEjD,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,IAAI,GAAQ,EAoBZ,OAlBA,AAgBK,eAhBU,EACb,IAAI,GACJ,GAAgB,EADJ,CAEZ,GAAI,CACF,IAAM,EAAM,MAAM,CAAA,EAAA,GAAA,mBAAA,AAAmB,EAAC,OAAO,IAC7C,GAAI,CAAC,EAAO,OACZ,EAAS,MAAM,OAAO,CAAC,EAAI,KAAK,EAAI,EAAI,KAAK,CAAG,EAAE,CACpD,CAAE,KAAM,CACN,GAAI,CAAC,EAAO,OACZ,EAAS,EAAE,CACb,QAAU,CACR,GAAI,CAAC,EAAO,OACZ,GAAgB,EAClB,EACF,IAIO,KACL,GAAQ,CACV,CACF,EAAG,CAAC,EAAQ,EAAW,EAEvB,IAAM,EAAmB,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,IAWxB,CAVQ,EACX,EAAM,KAAK,CAAC,KAAK,CAAC,GAAG,CAAE,AAAD,IAAO,AAAC,CAC5B,GAAI,OAAO,QAAQ,CAAC,OAAO,EAAE,EAAE,GAAK,OAAO,EAAE,EAAE,EAAI,EACnD,KAAM,EAAE,IAAI,CACZ,KAAM,EAAE,WAAW,CACnB,WAAY,EAAE,EAAE,GAAK,EAAM,KAAK,CAAC,YAAY,CAC7C,UAAwB,WAAb,EAAE,MAAM,CACrB,CAAC,EACD,CAAA,EAGD,MAAM,CAAC,AAAC,GAAM,GAAK,EAAE,SAAS,EAC9B,GAAG,CAAC,AAAC,IAAO,AAAD,CACV,GAAI,OAAO,EAAE,EAAE,EACf,KAAM,EAAE,IAAI,CACZ,YAAa,OAAO,EAAE,IAAI,EAC1B,WAAW,CAAQ,EAAE,UAAU,CACjC,CAAC,EACF,CAAC,EAAM,KAAK,CAAC,YAAY,CAAE,EAAM,KAAK,CAAC,KAAK,CAAE,EAAQ,EAAM,EAEzD,EAAyB,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,KACrC,IAAM,EAAU,EAAiB,IAAI,CAAC,AAAC,GAAM,EAAE,SAAS,GAAG,IAAM,UACjE,AAAI,IACa,CAAgB,CAAC,EAAE,CADvB,CACyB,IAAM,EAAA,AADxB,CAGtB,EAAG,CAAC,EAAiB,EAEf,EAAwB,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,KACpC,IAAM,EAAY,IAAI,IAAI,EAAiB,GAAG,CAAE,AAAD,GAAO,EAAE,EAAE,UAC1D,AAAI,EAAE,oBAAoB,EAAI,EAAU,GAAG,CAAC,OAAO,EAAE,oBAAoB,GAAW,CAAP,MAAc,EAAE,oBAAoB,EAC7G,GAA0B,EAAU,GAAG,CAAC,OAAO,IAAiC,OAAO,GACpF,EACT,EAAG,CAAC,EAAwB,EAAkB,EAAE,CAF+B,mBAEX,CAAC,QAErE,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,AAAK,GACD,CADA,CACE,kBADsB,EACF,GAAK,GAC/B,EAAe,CAAE,iBADqC,IACf,CAAsB,EAC/D,EAAG,CAAC,EAAuB,EAAE,oBAAoB,CAAE,EAAe,EAUhE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAa,MAAM,YAAY,YAAY,kDAC1C,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,4CACf,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,KAAK,WAAW,QAAS,EAAE,cAAc,CAAE,SAAU,AAAC,GAAM,EAAe,CAAE,eAAgB,EAAE,MAAM,CAAC,OAAO,AAAC,KAAM,sBAI7H,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,qCACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,0BACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,MAAO,EACP,SAAU,GAA4C,IAA5B,EAAiB,MAAM,CACjD,SAAU,AAAC,GAAM,EAAe,CAAE,qBAAsB,EAAE,MAAM,CAAC,KAAK,AAAC,YAE1C,IAA5B,EAAiB,MAAM,CACtB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,YAAG,oBAEjB,EAAiB,GAAG,CAAC,AAAC,GACpB,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CAAkB,MAAO,EAAE,EAAE,WAC3B,EAAE,IAAI,CAAC,KAAG,EAAE,WAAW,CAAC,OADd,EAAE,EAAE,UAS3B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,uDAA8C,iCAC7D,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,0CACZ,EAAc,GAAG,CAAC,AAAC,GAClB,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAiB,UAAU,4CAC1B,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,KAAK,WAAW,QAAS,EAAE,yBAAyB,CAAC,QAAQ,CAAC,EAAE,EAAE,EAAG,SAAU,IAAM,WAxClG,SADc,EAAU,AAyCuF,EAAE,EAAE,MAvCrH,GADQ,IAAI,IAAI,EAAE,yBAAyB,GACvC,GAAG,CAAC,GAAK,EAAI,MAAM,CAAC,GACvB,EAAI,GAAG,CAAC,GACb,EAAe,CAAE,0BAA2B,MAAM,IAAI,CAAC,EAAK,OAsC/C,EAAE,IAAI,GAFG,EAAE,EAAE,QAQtB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,+BAAsB,eACvC,CAAA,EAAA,EAAA,GAAA,EAAC,WAAA,CACC,UAAU,iHACV,MAAO,EAAE,UAAU,CACnB,SAAU,AAAC,GAAM,EAAe,CAAE,WAAY,EAAE,MAAM,CAAC,KAAM,AAAD,GAC5D,YAAY,6CAMxB,CvB1GA,SAAS,KACP,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,6FACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,6DACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,2CACpB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,gDACpB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,mEAEtB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,gDAIxB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAC,UAAU,uBACd,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,iBACrB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,2CACpB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,kDACpB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,iDACpB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,iDACpB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,0CACZ,MAAM,IAAI,CAAC,CAAE,OAAQ,CAAE,GAAG,GAAG,CAAC,CAAC,EAAG,IACjC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAc,UAAU,6FACvB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,4CADZ,aASxB,CAEA,IAAM,GAAiG,CACrG,kBAAmB,EAAA,SAAS,CAC5B,QAAS,EAAA,QAAQ,CACjB,SAAU,EAAA,UAAU,CACpB,mBAAoB,EAAA,QAAQ,CAC5B,eAAgB,EAAA,GAAG,CACnB,SAAU,EAAA,UAAU,CACpB,QAAS,EAAA,IAAI,CACb,UAAW,EAAA,QAAQ,CACnB,aAAc,EAAA,IAAI,CAClB,iBAAkB,EAAA,MAAM,CACxB,IAAK,EAAA,UAAU,CACf,MAAO,EAAA,UAAU,CACjB,mBAAoB,EAAA,MAAM,CAC1B,YAAa,EAAA,KAAK,CAClB,wBAAyB,EAAA,KAAK,CAC9B,iBAAkB,EAAA,QAAQ,CAC1B,qBAAsB,EAAA,QAAQ,CAC9B,QAAS,EAAA,QAAQ,AACnB,EAEO,SAAS,GAAuB,YAAE,CAAU,CAA0B,EAC3E,IAAM,EAAe,CAAA,EAAA,EAAA,eAAA,AAAe,IAC9B,CAAE,OAAK,eAAE,CAAa,UAAE,CAAQ,CAAE,QAAM,sBAAE,CAAoB,SAAE,CAAO,QAAE,CAAM,OAAE,CAAK,MAAE,CAAI,CAAE,CAAG,AGRlG,SAAS,AAAoB,CAAmB,EACrD,IAAM,EAAS,CAAA,EAAA,EAAA,SAAA,AAAS,IAClB,CAAC,EAAO,EAAS,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAA2B,GACvD,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACjC,CAAC,EAAQ,EAAU,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAC/B,CAAC,EAAO,EAAS,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgB,MAC5C,CAAC,EAAQ,EAAU,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgB,MAE9C,EAAgB,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,CAA2C,EAAQ,KACnF,EAAS,AAAC,IAAU,CAClB,EADiB,CACd,CAAI,CACP,CAAC,EAAI,CAAE,CACL,GAAG,CAAI,CAAC,EAAI,CACZ,GAAG,CAAK,AACV,EACF,CAAC,CACH,EAAG,EAAE,EAEL,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,IAAI,GAAQ,EAyFZ,OAvFA,AAqFK,eArFU,EACb,GAAK,CAAD,EACJ,EAAW,IACX,EAAS,CAFQ,KAGjB,GAAI,CACF,GAAM,CAAC,EAAa,EAAU,EAAe,CAAG,MAAM,QAAQ,GAAG,CAAC,CAChE,CAAA,EAAA,EAAA,sBAAA,AAAsB,EAAC,OAAO,IAC9B,CAAA,EAAA,EAAA,QAAQ,AAAR,EAAS,OAAO,IAChB,CAAA,EAAA,EAAA,QAAA,AAAQ,EACN,CAAC,KAAK,EAAE,OAAO,GAAY,6BAA6B,CAAC,EAE5D,EACD,GAAI,CAAC,EAAO,OAEZ,EAAU,EAAS,MAAM,EAEzB,IAAM,EAAkB,EAAY,QAAQ,EAAoC,UAAhC,OAAO,EAAY,QAAQ,CAAgB,EAAY,QAAQ,CAAG,KAC5G,EAAmC,CACvC,GAAG,CAAuB,CAC1B,GAAI,GAAmB,CAAC,CAAC,CACzB,QAAS,CACP,GAAG,EAAwB,OAAO,CAClC,GAAK,GAAiB,SAAW,CAAC,CAAC,AACrC,CACF,EAEM,EAAiB,MAAM,OAAO,CAAC,GAAgB,cAAgB,EAAe,YAAY,CAAG,EAAE,AACjG,GAAe,MAAM,CAAG,GAAG,CAC7B,EAAO,WAAW,CAAG,CACnB,GAAI,EAAO,WAAW,EAAI,EAAwB,WAAW,CAC7D,SAAU,EAAe,GAAG,CAAC,AAAC,IAC5B,IAAM,EAAyB,UAAlB,OAAO,EAAE,IAAI,CAAgB,EAAE,IAAI,CAAG,GAC7C,EAA2B,UAAnB,OAAO,EAAE,KAAK,CAAgB,EAAE,KAAK,CAAG,EAChD,EAA0C,UAA3B,OAAO,EAAE,aAAa,CAAgB,EAAE,aAAa,CAAG,EAE7E,MAAO,CACL,GAAI,CAAC,OAAO,EAAE,EAAA,CAAM,CACpB,KAAM,OACN,EACA,YAAa,gBACb,EACA,gBAAgB,EAChB,QAAwB,IAAhB,EAAE,SAAS,CAAa,WAAa,QAC/C,CACF,GACA,kBAAmB,EAAO,WAAW,EAAE,mBAAqB,EAAwB,WAAW,CAAC,iBAAiB,CACjH,kBAAmB,EAAO,WAAW,EAAE,mBAAqB,EAAwB,WAAW,CAAC,iBAAiB,CACnH,EAGF,IAAM,EACJ,CAAC,EAAO,QAAQ,EAChB,CAAC,MAAM,OAAO,CAAC,EAAO,QAAQ,CAAC,yBAAyB,GACH,IAArD,EAAO,QAAQ,CAAC,yBAAyB,CAAC,MAAM,CAE5C,EAAoB,EAAO,WAAW,EAAE,kBAC9C,GAAI,GAAgC,EAAO,WAAW,EAAI,MAAM,OAAO,CAAC,EAAO,WAAW,CAAC,QAAQ,EAAG,CACpG,IAAM,EAAU,EAAO,WAAW,CAAC,QAAQ,CACxC,MAAM,CAAC,AAAC,GAAmB,WAAb,EAAE,MAAM,EACtB,GAAG,CAAE,AAAD,GAAO,EAAE,EAAE,EACf,MAAM,CAAC,AAAC,GAAqC,UAA7B,OAAO,IAAkC,GAAoB,IAAO,EAEvF,GAAO,QAAQ,CAAG,CAChB,GAAG,EAAO,AAH+F,QAGvF,CAClB,0BAA2B,CAC7B,CACF,CAEA,EAAS,EA1KjB,AA0K4C,SA1KH,AAAhC,CAA+D,EACtE,IAAM,EAAK,EAAM,aAAa,CAC9B,GAAI,CAAC,GAAM,CAAC,MAAM,OAAO,CAAC,EAAG,sBAAsB,EAAG,OAAO,EAE7D,IAAM,EAAa,EAAG,sBAAsB,CACzC,GAAG,CAAC,AAAC,IACJ,GAAI,CAAC,GAAsB,UAAf,OAAO,EAAkB,OAAO,KAE5C,IAAM,EAAqB,UAAhB,OAAO,AADR,EACU,EAAE,EAAiB,EAAE,EAAE,CAAC,IAAI,GAAK,EAAE,EAAE,CAAC,IAAI,GAAK,CAAC,aAAa,EAAE,KAAK,GAAG,GAAG,CAAC,EAAE,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,KAAK,CAAC,GAAA,CAAI,CAChI,EAA2B,UAAnB,OAAO,EAAE,KAAK,CAAgB,EAAE,KAAK,CAAG,GACtD,GAAI,CAAC,EAAM,IAAI,GAAI,OAAO,KAG1B,IAAM,EAAyD,WAAlC,OAAO,EAAE,oBAAoB,EAAiB,EAAE,oBAAoB,CAC3F,EAD8F,AAC7C,WAA9B,OAAO,EAAE,gBAAgB,EAAiB,EAAE,gBAAgB,CAC/E,EADkF,AAC7B,WAAhC,OAAO,EAAE,kBAAkB,EAAiB,EAAE,kBAAkB,CAE3F,EAF8F,IAEvF,IACL,EACA,MAAO,EAAM,IAAI,GACjB,KARW,4BASX,mBACA,EACA,oBACF,CACF,GACC,MAAM,CAAC,AAAC,IAAkC,CAAQ,GAErD,MAAO,CACL,GAAG,CAAK,CACR,cAAe,CACb,GAAG,CAAE,CACL,uBAAwB,CAC1B,CACF,CACF,EAuI4E,GAAS,EAAS,MAAM,EAC9F,CAAE,MAAO,EAAG,CACV,GAAI,CAAC,EAAO,OAEZ,GAAI,aAAa,EAAA,QAAQ,EAAiB,MAAb,EAAE,MAAM,EAAY,EAAY,CAC3D,IAAM,EAAO,CAAC,KAAK,EAAE,OAAO,GAAY,kBAAkB,CAAC,CAC3D,EAAO,OAAO,CAAC,CAAC,KAAK,EAAE,OAAO,GAAY,sBAAsB,EAAE,mBAAmB,GAAA,CAAO,EAC5F,MACF,CAEA,EAAS,aAAa,MAAQ,EAAE,OAAO,CAAG,oCAC5C,QAAU,CACR,GAAI,CAAC,EAAO,OACZ,GAAW,EACb,EACF,IAIO,KACL,EAAQ,EACV,CACF,EAAG,CAAC,EAAQ,EAAW,EAEvB,IAAM,EAAQ,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,KACxB,EAAS,EACX,EAAG,EAAE,EAEC,EAAO,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,UACvB,GAAK,CAAD,EACJ,GAAU,GACV,EAAS,CAFQ,KAGjB,GAAI,CACF,IAAM,EAAW,MAAM,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,OAAO,IAEjC,EAAqB,EAAM,QAAQ,CAAC,QAAQ,CAAC,IAAI,GAAG,WAAW,GAE/D,EAAc,EAAM,OAAO,CAAC,cAAc,CAAC,IAAI,GAAG,WAAW,GAC7D,EAAe,EAAM,OAAO,CAAC,eAAe,CAAC,IAAI,GACjD,EAAkB,EAAc,AAAI,OAAO,CAAC,KAAK,EAAE,EAAY,CAAC,CAAC,CAAE,KAAO,KAC1E,EAAe,EAAkB,EAAa,OAAO,CAAC,EAAiB,IAAI,IAAI,GAAK,EAEpF,EAAgB,EAAS,MAAM,CAAC,oBAAoB,EAAI,CAAC,EACzD,EAAW,EAAe,CAAE,GAAG,CAAY,CAAE,MAAO,CAAa,EAAI,KAErE,EAAS,EAAS,MAAM,CAAC,WAAW,EAAI,CAAC,EACzC,EAAY,EAAM,QAAQ,EAAI,CAAC,EAC/B,EAAqC,CACzC,GAAG,CAAK,CACR,SAAU,CACR,GAAG,CAAQ,CACX,aAAc,EAAM,OAAO,CAAC,WAAW,EAAI,KAC3C,qBAAsB,EAAM,OAAO,CAAC,kBAAkB,EAAI,KAC1D,oBAAqB,EAAM,OAAO,CAAC,kBAAkB,EAAI,KACzD,SAAU,EAAM,OAAO,CAAC,OAC1B,AADiC,CAEnC,EAEM,EAAiB,MAAM,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,OAAO,GAAa,CAC3D,KAAM,EAAM,OAAO,CAAC,YAAY,CAChC,cAAe,EAAM,OAAO,CAAC,KAAK,EAAI,KACtC,cAAe,EAAM,OAAO,CAAC,aAAa,EAAI,KAC9C,gBAAiB,GAAe,KAChC,qBAAsB,EACtB,SAAwC,IAA9B,EAAmB,MAAM,CAAS,EAAqB,KACjE,YAAa,CACf,GAEA,EAAU,EAAe,MAAM,EAE/B,IAAM,EAAM,MAAM,CAAA,EAAA,EAAA,yBAAA,AAAyB,EAAC,OAAO,GAAa,EAC5D,GAAI,QAAQ,EAAE,AAChB,EAAS,EAA2B,EAAI,QAAQ,CAAE,EAAe,MAAM,EAE3E,CAAE,MAAO,EAAG,CAMV,MALI,aAAa,EAAA,QAAQ,CACvB,CADyB,CAChB,EAAE,OAAO,EAElB,EAAS,aAAa,MAAQ,EAAE,OAAO,CAAG,qCAEtC,CACR,QAAU,CACR,GAAU,EACZ,EACF,EAAG,CAAC,EAAO,EAAW,EAItB,MAAO,CAAA,EAAA,EAAA,OAAA,AAAO,EACZ,IAAM,CAAC,OACL,EACA,WACA,sBACA,OACA,EACA,OATW,WAUX,SACA,QACA,SACA,EACA,qBAhR8B,GAiRhC,CAAC,CACD,CAAC,EAAO,EAAO,EAAS,EAAO,EAAM,EAAQ,EAAQ,EAAc,CAEvE,EHzL6H,GACrH,CAAC,EAAQ,EAAU,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgB,MAE9C,EAAiB,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,AAAC,GAA0C,EAAc,WAAY,GAAQ,CAAC,EAAc,EAEzH,EAAc,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,KAC1B,IAAM,EAAe,EAAa,GAAG,CAAC,WAChC,EAAO,IAAI,IAAI,EAAe,GAAG,CAAC,AAAC,GAAS,EAAK,GAAG,UAC1D,AAAI,GAAgB,EAAK,GAAG,CAAC,GAAsB,EAC5C,UADqC,OAE9C,EAAG,CAAC,EAAa,EAEX,EAAe,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,IAAM,EAAe,IAAI,CAAC,AAAC,GAAS,EAAK,GAAG,GAAK,IAAgB,KAAM,CAAC,EAAY,EAE3G,EAAc,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,KAC1B,OAAQ,GACN,IAAK,kBACH,MAAO,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAsB,WAAY,GAC5C,KAAK,UACH,MAAO,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAe,MAAO,EAAO,cAAgB,AAAD,GAAW,EAAc,UAAW,IAC1F,KAAK,WACH,MAAO,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAgB,MAAO,EAAO,eAAgB,GACxD,KAAK,mBACH,MAAO,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAuB,MAAO,EAAO,sBAAuB,AAAC,GAAU,EAAc,kBAAmB,IAClH,KAAK,eACH,MAAO,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAmB,WAAY,GACzC,KAAK,WACH,MAAO,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,CAAgB,MAAO,EAAO,eAAgB,AAAC,GAAU,EAAc,WAAY,GAAQ,OAAQ,GAC7G,KAAK,UACH,MAAO,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,CAAe,MAAO,EAAO,cAAe,AAAC,GAAU,EAAc,UAAW,IAC1F,KAAK,YACH,MAAO,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAiB,MAAO,EAAO,gBAAiB,AAAC,GAAU,EAAc,YAAa,IAChG,KAAK,aACH,MAAO,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,CAAiB,MAAO,EAAO,gBAAiB,AAAC,GAAU,EAAc,YAAa,IAChG,KAAK,iBACH,MAAO,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAqB,MAAO,EAAO,oBAAqB,AAAC,GAAU,EAAc,gBAAiB,GAAQ,OAAQ,GAC5H,KAAK,MACH,MAAO,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,CAAW,MAAO,EAAO,UAAW,AAAC,GAAU,EAAc,MAAO,IAC9E,KAAK,QACH,MAAO,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,CAAa,WAAY,EAAY,MAAO,EAAO,YAAa,AAAC,GAAU,EAAc,QAAS,GAAQ,OAAQ,GAC5H,KAAK,mBACH,MAAO,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,CAAuB,MAAO,EAAO,sBAAuB,AAAC,GAAU,EAAc,kBAAmB,IAClH,KAAK,YACH,MAAO,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,CAAgB,WAAY,EAAY,MAAO,EAAO,eAAgB,AAAC,GAAU,EAAc,WAAY,GAAQ,OAAQ,GACrI,KAAK,wBACH,MAAO,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,CAA4B,WAAY,EAAY,MAAO,EAAO,OAAQ,GACpF,KAAK,iBACH,MAAO,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,CAAqB,MAAO,EAAO,oBAAsB,AAAD,GAAW,EAAc,gBAAiB,IAC5G,KAAK,qBACH,MAAO,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,CAAyB,MAAO,EAAO,wBAAyB,AAAC,GAAU,EAAc,oBAAqB,IACxH,KAAK,UACH,MAAO,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAe,MAAO,EAAO,cAAe,AAAC,GAAU,EAAc,UAAW,IAC1F,SACE,OAAO,IACX,CACF,EAAG,CAAC,EAAO,EAAQ,EAAa,EAAY,EAAgB,EAAc,EAE1E,eAAe,IACb,EAAU,MACV,GAAI,CACF,MAAM,IACN,EAAU,SACZ,CAAE,KAAM,CACN,MACF,CACF,CAEA,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBAKZ,EACC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,SAAS,MAAM,oDAC3B,IAED,KAEH,EACC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,UAAU,MAAM,mBAC5B,IAED,KAEJ,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,4DACb,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,IAAI,CAAA,WACH,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,UAAU,CAAA,WACT,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UAAC,sBACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,eAAe,CAAA,UAAC,+CAEnB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,qBACpB,EAAe,GAAG,CAAC,AAAC,IACnB,IAAM,EAAW,EAAK,GAAG,GAAK,EACxB,EAAO,EAAQ,CAAC,EAAK,GAAG,CAAC,EAAI,EAAA,UAAU,CAE7C,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAI,CAAA,CAEH,KAAM,CAAC,KAAK,EAAE,EAAW,2BAA2B,EAAE,EAAK,GAAG,CAAA,CAAE,CAChE,QAAQ,EACR,UACE,4EACC,CAAD,CACI,iEACA,kDAAA,CAAkD,UAGxD,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,oCACd,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CACC,UACE,qBACC,CAAD,CAAY,wBAA0B,eAAA,CAAe,CAEvD,aAAW,CAAA,CAAA,IAEb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UAAM,EAAK,KAAK,OAlBd,EAAK,GAAG,CAsBnB,QAIJ,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,6FACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,6DACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,uDAA+C,GAAc,OAAS,sBACrF,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,uCAA6B,aAAW,KACtD,EACC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,sCAA8B,IAC3C,KACJ,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mDACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,OAAO,CAAA,CAAA,EAAC,QAAQ,UAAU,KAAK,cACrC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAI,CAAA,CAAC,KAAM,CAAC,GAAG,EAAE,EAAW,OAAO,CAAC,UAAE,qBAEzC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,OAAO,CAAA,CAAA,EAAC,QAAQ,UAAU,KAAK,cACrC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAI,CAAA,CAAC,KAAM,CAAC,GAAG,EAAE,EAAW,OAAO,CAAC,UAAE,qBAEzC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,OAAO,CAAA,CAAA,EAAC,QAAQ,UAAU,KAAK,cACrC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAI,CAAA,CAAC,KAAM,CAAC,GAAG,EAAE,EAAW,KAAK,CAAC,UAAE,sBAEvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,OAAO,CAAA,CAAA,EAAC,QAAQ,UAAU,KAAK,cACrC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAI,CAAA,CAAC,KAAM,CAAC,GAAG,EAAE,EAAW,SAAS,CAAC,UAAE,uBAE3C,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,OAAO,CAAA,CAAA,EAAC,QAAQ,UAAU,KAAK,cACrC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAI,CAAA,CAAC,KAAM,CAAC,GAAG,EAAE,EAAW,MAAM,CAAC,UAAE,0BAI5C,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,QAAQ,UAAU,QAAS,IAAM,KAAK,IAAU,UAAU,CAAQ,GAAyB,GAAW,WAC3G,EAAS,YAAc,cAK7B,EAAU,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,CAAA,GAAsB,UAK5C,CDhQe,SAAS,KACtB,IAAM,EAAS,CAAA,EAAA,EAAA,SAAS,AAAT,IACT,EAAa,EAAO,QAAQ,EAAI,EAAO,MAAM,QAEnD,AAAK,EAcH,CAAA,CAdE,CAcF,EAAA,GAAA,EAde,AAcd,EAAA,WAAW,CAAA,CAAC,mBAAmB,2BAC9B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CAAC,MAAM,oBAAoB,YAAY,4CAElD,CAAA,EAAA,EAAA,GAAA,EAAC,GAAA,CAAuB,WAAY,SAhBtC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,mBAAmB,2BAC9B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CAAC,MAAM,oBAAoB,YAAY,4CAClD,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,mHAA0G,iCAiBnI"}