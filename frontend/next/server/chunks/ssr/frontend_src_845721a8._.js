module.exports=[648,a=>{"use strict";var b=a.i(57850),c=a.i(7160);function d({title:a,description:d,actions:e,className:f}){return(0,b.jsxs)("div",{className:(0,c.cn)("flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between",f),children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-xl font-semibold text-[var(--rb-text)]",children:a}),d?(0,b.jsx)("p",{className:"mt-1 text-sm text-zinc-600",children:d}):null]}),e?(0,b.jsx)("div",{className:"flex items-center gap-2",children:e}):null]})}a.s(["PageHeader",()=>d])},29054,a=>{"use strict";var b=a.i(57850),c=a.i(7160);function d({className:a,type:d,...e}){return(0,b.jsx)("input",{type:d,className:(0,c.cn)("w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)] outline-none transition","placeholder:text-zinc-400","focus-visible:ring-2 focus-visible:ring-[color:color-mix(in_srgb,var(--rb-orange),white_65%)] focus-visible:ring-offset-2 focus-visible:ring-offset-white","disabled:cursor-not-allowed disabled:bg-[var(--rb-surface-muted)] disabled:opacity-70",a),...e})}a.s(["Input",()=>d])},39159,a=>{"use strict";var b=a.i(57850),c=a.i(7160);function d({className:a,children:d,...e}){return(0,b.jsx)("select",{className:(0,c.cn)("w-full appearance-none rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)] outline-none transition","focus-visible:ring-2 focus-visible:ring-[color:color-mix(in_srgb,var(--rb-orange),white_65%)] focus-visible:ring-offset-2 focus-visible:ring-offset-white","disabled:cursor-not-allowed disabled:bg-[var(--rb-surface-muted)] disabled:opacity-70","bg-[right_0.75rem_center] bg-no-repeat pr-10",'[background-image:url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="%236b7280" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>\')]',a),...e,children:d})}a.s(["Select",()=>d])},71513,a=>{"use strict";var b=a.i(6454);a.s(["notify",0,{success:(a,c={})=>b.toast.success(a,c),error:(a,c={})=>b.toast.error(a,c),info:(a,c={})=>b.toast.info(a,c),warning:(a,c={})=>b.toast.warning(a,c),loading:(a,c={})=>b.toast.loading(a,c),dismiss(a){b.toast.dismiss(a)},message:(a,c,d={})=>"success"===a?b.toast.success(c,d):"error"===a?b.toast.error(c,d):"warning"===a?b.toast.warning(c,d):"loading"===a?b.toast.loading(c,d):b.toast.info(c,d)}])},90319,a=>{"use strict";var b=a.i(57850),c=a.i(7160);function d({label:a,fieldId:d,description:e,error:f,required:g,className:h,labelClassName:i,fieldClassName:j,children:k}){let l=e?`${d}__description`:void 0,m=f?`${d}__error`:void 0,n=[l,m].filter(Boolean).join(" ")||void 0,o="function"==typeof k?k({describedBy:n,descriptionId:l,errorId:m,invalid:!!f}):k;return(0,b.jsxs)("div",{className:(0,c.cn)("grid gap-1 sm:grid-cols-[220px_1fr] sm:gap-4",h),children:[(0,b.jsx)("div",{className:"sm:pt-2",children:(0,b.jsxs)("label",{className:(0,c.cn)("block text-sm font-medium text-[var(--rb-text)]",i),htmlFor:d,children:[a,g?(0,b.jsx)("span",{className:"text-red-600",children:" *"}):null]})}),(0,b.jsxs)("div",{className:(0,c.cn)("min-w-0",j),children:[o,e?(0,b.jsx)("div",{id:l,className:"mt-1 text-xs text-zinc-500",children:e}):null,f?(0,b.jsx)("div",{id:m,className:"mt-1 text-xs text-red-600",children:f}):null]})]})}a.s(["FormRow",()=>d])},52929,a=>{"use strict";var b=a.i(34075);async function c(a){return(0,b.apiFetch)(`/api/${a}/app/currencies`)}async function d(a,c){return(0,b.apiFetch)(`/api/${a}/app/currencies`,{method:"PATCH",body:{currencies:c}})}a.s(["getTenantCurrencies",()=>c,"updateTenantCurrencies",()=>d])},84180,a=>{"use strict";var b=a.i(57850),c=a.i(45056),d=a.i(93609),e=a.i(34075),f=a.i(71513),g=a.i(91601),h=a.i(648),i=a.i(4600),j=a.i(97867),k=a.i(29054),l=a.i(39159),m=a.i(90319),n=a.i(52929);function o(){let a=(0,d.useRouter)(),o=(0,d.useParams)(),p=o.business??o.tenant,q=o.clientId,r="string"==typeof q&&q.length>0?Number(q):null,[s,t]=(0,c.useState)(!0),[u,v]=(0,c.useState)(!1),[w,x]=(0,c.useState)(null),[y,z]=(0,c.useState)(""),[A,B]=(0,c.useState)(""),[C,D]=(0,c.useState)(""),[E,F]=(0,c.useState)(""),[G,H]=(0,c.useState)(""),[I,J]=(0,c.useState)(""),[K,L]=(0,c.useState)(""),[M,N]=(0,c.useState)(""),[O,P]=(0,c.useState)(""),[Q,R]=(0,c.useState)(""),[S,T]=(0,c.useState)(""),[U,V]=(0,c.useState)(""),[W,X]=c.default.useState([]),[Y,Z]=c.default.useState(null);async function $(b){if((b.preventDefault(),"string"==typeof p&&0!==p.length)&&r&&Number.isFinite(r)&&!(r<=0)){v(!0),x(null);try{let b=U.trim().toUpperCase(),c={name:y.trim(),email:A.trim(),phone:""!==C.trim()?C.trim():null,company:""!==E.trim()?E.trim():null,tax_id:""!==G.trim()?G.trim():null,address_line1:""!==I.trim()?I.trim():null,address_line2:""!==K.trim()?K.trim():null,address_city:""!==M.trim()?M.trim():null,address_state:""!==O.trim()?O.trim():null,address_postal_code:""!==Q.trim()?Q.trim():null,address_country:""!==S.trim()?S.trim().toUpperCase():null,currency:3===b.length?b:null};await (0,e.apiFetch)(`/api/${p}/app/clients/${r}`,{method:"PUT",body:c}),f.notify.success("Customer updated."),a.replace(`/app/${p}/clients/${r}`)}catch(a){a instanceof e.ApiError?x(a.message):x("Failed to save customer.")}finally{v(!1)}}}(0,c.useEffect)(()=>{let a=!0;return async function(){if("string"==typeof p&&0!==p.length&&r&&Number.isFinite(r)&&!(r<=0)){t(!0),x(null);try{let b=await (0,e.apiFetch)(`/api/${p}/app/clients/${r}`);if(!a)return;let c=b.client;z(c?.name??""),B(c?.email??""),D(c?.phone??""),F(c?.company??""),H(c?.tax_id??""),J(c?.address_line1??""),L(c?.address_line2??""),N(c?.address_city??""),P(c?.address_state??""),R(c?.address_postal_code??""),T(c?.address_country??""),V("string"==typeof c?.currency?c.currency.toUpperCase():"")}catch(b){if(!a)return;x(b instanceof Error?b.message:"Failed to load customer.")}finally{if(!a)return;t(!1)}}}(),()=>{a=!1}},[r,p]),(0,c.useEffect)(()=>{let a=!0;return async function(){if("string"==typeof p&&0!==p.length)try{let b=await (0,n.getTenantCurrencies)(String(p));if(!a)return;let c=(Array.isArray(b.currencies)?b.currencies:[]).filter(a=>a&&a.is_active);X(c);let d="string"==typeof b.active_currency?b.active_currency.toUpperCase():null;Z(d),V(a=>{if(a&&3===a.length)return a;let b=c.find(a=>a.is_default)?.code??null;return d??b??c[0]?.code??a})}catch{if(!a)return;X([]),Z(null)}}(),()=>{a=!1}},[p]);let _=!r||!Number.isFinite(r)||r<=0;return(0,b.jsx)(g.RequireAuth,{requiredPermission:"clients.view",children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(h.PageHeader,{title:"Edit customer",description:"Update this customer record.",actions:(0,b.jsx)(j.Button,{variant:"outline",size:"sm",onClick:()=>{a.back()},children:"Back"})}),_?(0,b.jsx)("div",{className:"text-sm text-red-600",children:"Customer is invalid."}):null,w?(0,b.jsx)("div",{className:"text-sm text-red-600",children:w}):null,(0,b.jsx)(i.Card,{className:"shadow-none",children:(0,b.jsxs)(i.CardContent,{className:"pt-5",children:[s?(0,b.jsx)("div",{className:"text-sm text-zinc-600",children:"Loading..."}):null,s||_?null:(0,b.jsxs)("form",{className:"grid gap-4",onSubmit:$,children:[(0,b.jsx)(m.FormRow,{label:"Name",fieldId:"client_name",required:!0,description:"Customer full name.",children:({describedBy:a,invalid:c})=>(0,b.jsx)(k.Input,{id:"client_name",value:y,onChange:a=>z(a.target.value),required:!0,disabled:u,maxLength:255,"aria-describedby":a,"aria-invalid":c})}),(0,b.jsx)(m.FormRow,{label:"Email",fieldId:"client_email",required:!0,description:"Used for invoices and notifications.",children:({describedBy:a,invalid:c})=>(0,b.jsx)(k.Input,{id:"client_email",type:"email",value:A,onChange:a=>B(a.target.value),required:!0,disabled:u,maxLength:255,"aria-describedby":a,"aria-invalid":c})}),(0,b.jsx)(m.FormRow,{label:"Phone",fieldId:"client_phone",description:"Optional. Include country code if needed.",children:({describedBy:a,invalid:c})=>(0,b.jsx)(k.Input,{id:"client_phone",value:C,onChange:a=>D(a.target.value),disabled:u,maxLength:64,"aria-describedby":a,"aria-invalid":c})}),(0,b.jsx)(m.FormRow,{label:"Company",fieldId:"client_company",description:"Optional company name.",children:({describedBy:a,invalid:c})=>(0,b.jsx)(k.Input,{id:"client_company",value:E,onChange:a=>F(a.target.value),disabled:u,maxLength:255,"aria-describedby":a,"aria-invalid":c})}),(0,b.jsx)(m.FormRow,{label:"Tax ID",fieldId:"client_tax_id",description:"Optional. VAT / tax identification number.",children:({describedBy:a,invalid:c})=>(0,b.jsx)(k.Input,{id:"client_tax_id",value:G,onChange:a=>H(a.target.value),disabled:u,maxLength:64,"aria-describedby":a,"aria-invalid":c})}),(0,b.jsx)(m.FormRow,{label:"Currency",fieldId:"client_currency",description:"Used for customer-level pricing, invoices, and quotes.",children:({describedBy:a,invalid:c})=>W.length>0?(0,b.jsxs)(l.Select,{value:U,onChange:a=>V(a.target.value),disabled:u,"aria-describedby":a,"aria-invalid":c,children:[W.map(a=>(0,b.jsxs)("option",{value:a.code,children:[a.code," ",a.name?`- ${a.name}`:""]},a.code)),Y&&!W.some(a=>a.code===Y)?(0,b.jsx)("option",{value:Y,children:Y}):null]}):(0,b.jsx)(k.Input,{id:"client_currency",className:"uppercase",value:U,onChange:a=>V(a.target.value.toUpperCase().slice(0,3)),disabled:u,maxLength:3,placeholder:"USD","aria-describedby":a,"aria-invalid":c})}),(0,b.jsx)(m.FormRow,{label:"Address line 1",fieldId:"client_address_line1",description:"Optional street address.",children:({describedBy:a,invalid:c})=>(0,b.jsx)(k.Input,{id:"client_address_line1",value:I,onChange:a=>J(a.target.value),disabled:u,maxLength:255,"aria-describedby":a,"aria-invalid":c})}),(0,b.jsx)(m.FormRow,{label:"Address line 2",fieldId:"client_address_line2",description:"Optional apartment, suite, etc.",children:({describedBy:a,invalid:c})=>(0,b.jsx)(k.Input,{id:"client_address_line2",value:K,onChange:a=>L(a.target.value),disabled:u,maxLength:255,"aria-describedby":a,"aria-invalid":c})}),(0,b.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,b.jsx)(m.FormRow,{label:"City",fieldId:"client_address_city",children:({describedBy:a,invalid:c})=>(0,b.jsx)(k.Input,{id:"client_address_city",value:M,onChange:a=>N(a.target.value),disabled:u,maxLength:255,"aria-describedby":a,"aria-invalid":c})}),(0,b.jsx)(m.FormRow,{label:"State",fieldId:"client_address_state",children:({describedBy:a,invalid:c})=>(0,b.jsx)(k.Input,{id:"client_address_state",value:O,onChange:a=>P(a.target.value),disabled:u,maxLength:255,"aria-describedby":a,"aria-invalid":c})})]}),(0,b.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,b.jsx)(m.FormRow,{label:"Postal code",fieldId:"client_address_postal_code",children:({describedBy:a,invalid:c})=>(0,b.jsx)(k.Input,{id:"client_address_postal_code",value:Q,onChange:a=>R(a.target.value),disabled:u,maxLength:64,"aria-describedby":a,"aria-invalid":c})}),(0,b.jsx)(m.FormRow,{label:"Country (2-letter)",fieldId:"client_address_country",description:"Example: ZA, US, GB.",children:({describedBy:a,invalid:c})=>(0,b.jsx)(k.Input,{id:"client_address_country",className:"uppercase",value:S,onChange:a=>T(a.target.value),disabled:u,maxLength:2,"aria-describedby":a,"aria-invalid":c})})]}),(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2 pt-2",children:[(0,b.jsx)(j.Button,{variant:"outline",onClick:()=>{"string"==typeof p&&p.length>0&&r&&a.push(`/app/${p}/clients/${r}`)},disabled:u,children:"Cancel"}),(0,b.jsx)(j.Button,{type:"submit",disabled:u,children:u?"Saving...":"Save"})]})]})]})})]})})}a.s(["default",()=>o])}];

//# sourceMappingURL=frontend_src_845721a8._.js.map