module.exports=[75385,a=>{"use strict";var b=a.i(57850),c=a.i(7160);function d({variant:a,className:d}){let e="h-4 w-4 shrink-0";return"success"===a?(0,b.jsx)("svg",{viewBox:"0 0 24 24",className:(0,c.cn)(e,d),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:(0,b.jsx)("path",{d:"M20 6L9 17l-5-5"})}):"warning"===a?(0,b.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,c.cn)(e,d),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,b.jsx)("path",{d:"M12 9v4"}),(0,b.jsx)("path",{d:"M12 17h.01"}),(0,b.jsx)("path",{d:"M10.3 3.6l-8.3 14.3A2 2 0 0 0 3.7 21h16.6a2 2 0 0 0 1.7-3.1L13.7 3.6a2 2 0 0 0-3.4 0z"})]}):"danger"===a?(0,b.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,c.cn)(e,d),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,b.jsx)("path",{d:"M18 6L6 18"}),(0,b.jsx)("path",{d:"M6 6l12 12"})]}):(0,b.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,c.cn)(e,d),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,b.jsx)("path",{d:"M12 16v-4"}),(0,b.jsx)("path",{d:"M12 8h.01"}),(0,b.jsx)("path",{d:"M12 22a10 10 0 1 0-10-10 10 10 0 0 0 10 10z"})]})}function e({className:a,variant:e="info",title:f,children:g,...h}){let i={info:{wrapper:"border-[color:color-mix(in_srgb,var(--rb-blue),white_75%)] bg-[color:color-mix(in_srgb,var(--rb-blue),white_92%)] text-[var(--rb-text)]",icon:"text-[var(--rb-blue)]",title:"text-[var(--rb-blue)]"},success:{wrapper:"border-[color:color-mix(in_srgb,#16a34a,white_75%)] bg-[color:color-mix(in_srgb,#16a34a,white_92%)] text-[var(--rb-text)]",icon:"text-[#166534]",title:"text-[#166534]"},warning:{wrapper:"border-[color:color-mix(in_srgb,var(--rb-orange),white_70%)] bg-[color:color-mix(in_srgb,var(--rb-orange),white_92%)] text-[var(--rb-text)]",icon:"text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)]",title:"text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)]"},danger:{wrapper:"border-[color:color-mix(in_srgb,#dc2626,white_75%)] bg-[color:color-mix(in_srgb,#dc2626,white_92%)] text-[var(--rb-text)]",icon:"text-[#991b1b]",title:"text-[#991b1b]"}}[e];return(0,b.jsx)("div",{role:"alert",className:(0,c.cn)("rounded-[var(--rb-radius-md)] border px-4 py-3",i.wrapper,a),...h,children:(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)(d,{variant:e,className:(0,c.cn)("mt-0.5",i.icon)}),(0,b.jsxs)("div",{className:"min-w-0",children:[f?(0,b.jsx)("div",{className:(0,c.cn)("text-sm font-semibold",i.title),children:f}):null,g?(0,b.jsx)("div",{className:(0,c.cn)("text-sm text-zinc-700",f?"mt-1":""),children:g}):null]})]})})}a.s(["Alert",()=>e])},17933,a=>{"use strict";var b=a.i(57850),c=a.i(7160);function d({className:a,variant:d="default",...e}){return(0,b.jsx)("span",{className:(0,c.cn)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-medium",{default:"bg-[var(--rb-surface-muted)] text-[var(--rb-text)] border-[var(--rb-border)]",info:"bg-[color:color-mix(in_srgb,var(--rb-blue),white_85%)] text-[var(--rb-blue)] border-[color:color-mix(in_srgb,var(--rb-blue),white_70%)]",success:"bg-[color:color-mix(in_srgb,#16a34a,white_85%)] text-[#166534] border-[color:color-mix(in_srgb,#16a34a,white_70%)]",warning:"bg-[color:color-mix(in_srgb,var(--rb-orange),white_85%)] text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)] border-[color:color-mix(in_srgb,var(--rb-orange),white_70%)]",danger:"bg-[color:color-mix(in_srgb,#dc2626,white_85%)] text-[#991b1b] border-[color:color-mix(in_srgb,#dc2626,white_70%)]"}[d],a),...e})}a.s(["Badge",()=>d])},4148,a=>{"use strict";function b(a){let b=a.amountCents,c=a.currency?.toUpperCase()??null;if("number"!=typeof b||!Number.isFinite(b))return a.fallback??"—";let d=b/100;if(!c||3!==c.length)return`${d.toFixed(2)}`;try{return new Intl.NumberFormat(void 0,{style:"currency",currency:c,minimumFractionDigits:2,maximumFractionDigits:2}).format(d)}catch{return`${c} ${d.toFixed(2)}`}}a.s(["formatMoney",()=>b])},648,a=>{"use strict";var b=a.i(57850),c=a.i(7160);function d({title:a,description:d,actions:e,className:f}){return(0,b.jsxs)("div",{className:(0,c.cn)("flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between",f),children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-xl font-semibold text-[var(--rb-text)]",children:a}),d?(0,b.jsx)("p",{className:"mt-1 text-sm text-zinc-600",children:d}):null]}),e?(0,b.jsx)("div",{className:"flex items-center gap-2",children:e}):null]})}a.s(["PageHeader",()=>d])},26606,a=>{"use strict";var b=a.i(57850),c=a.i(7160),d=a.i(4600);function e({className:a,"aria-hidden":d=!0,...e}){return(0,b.jsx)("div",{"aria-hidden":d,className:(0,c.cn)("rb-skeleton",a),...e})}function f({lines:a=3,className:f}){let g=Math.max(1,Math.min(a,12));return(0,b.jsx)(d.Card,{className:(0,c.cn)("overflow-hidden",f),children:(0,b.jsxs)(d.CardContent,{className:"space-y-3 pt-5",children:[(0,b.jsx)(e,{className:"h-4 w-32 rounded-[var(--rb-radius-sm)]"}),Array.from({length:g}).map((a,d)=>(0,b.jsx)(e,{className:(0,c.cn)("h-3 rounded-[var(--rb-radius-sm)]",d===g-1?"w-3/5":"w-full")},d))]})})}function g({rows:a=6,columns:d=5,className:f}){let g=Math.max(1,Math.min(a,20)),h=Math.max(1,Math.min(d,10));return(0,b.jsxs)("div",{className:(0,c.cn)("overflow-hidden rounded-[var(--rb-radius-lg)] border border-[var(--rb-border)] bg-white shadow-[var(--rb-shadow)]",f),children:[(0,b.jsx)("div",{className:"border-b border-[var(--rb-border)] px-5 py-4",children:(0,b.jsx)("div",{className:"grid gap-3",style:{gridTemplateColumns:`repeat(${h}, minmax(0, 1fr))`},children:Array.from({length:h}).map((a,c)=>(0,b.jsx)(e,{className:"h-3 w-full rounded-[var(--rb-radius-sm)]"},c))})}),(0,b.jsx)("div",{className:"px-5 pb-5 pt-4",children:(0,b.jsx)("div",{className:"space-y-3",children:Array.from({length:g}).map((a,d)=>(0,b.jsx)("div",{className:"grid gap-3",style:{gridTemplateColumns:`repeat(${h}, minmax(0, 1fr))`},children:Array.from({length:h}).map((a,d)=>(0,b.jsx)(e,{className:(0,c.cn)("h-3 rounded-[var(--rb-radius-sm)]",0===d?"w-3/4":"w-full")},d))},d))})})]})}a.s(["CardSkeleton",()=>f,"Skeleton",()=>e,"TableSkeleton",()=>g])},54177,a=>{"use strict";var b=a.i(57850),c=a.i(45056),d=a.i(7160),e=a.i(97867),f=a.i(46036),g=a.i(26606),h=a.i(34075);function i({title:a,data:i,columns:j,getRowId:k,loading:l=!1,emptyMessage:m="No data.",search:n,filters:o=[],pageSizeOptions:p=[10,25,50],initialPageSize:q=10,server:r,exportConfig:s,columnVisibilityKey:t,onRowClick:u,className:v}){let[w,x]=(0,c.useState)(""),[y,z]=(0,c.useState)(0),[A,B]=(0,c.useState)(q),[C,D]=(0,c.useState)(null),[E,F]=(0,c.useState)(null),[G,H]=(0,c.useState)(0),I=(0,c.useId)(),J=!!r,K=J?r.query:w,L=J?r.onQueryChange:x,M=J?r.pageIndex:y,N=J?r.onPageIndexChange:z,O=J?r.pageSize:A,P=J?r.onPageSizeChange:B,Q=J?r.sort??null:null,R=J?r.onSortChange:void 0,S=(0,c.useMemo)(()=>{let a=Array.isArray(j)?j:[];{let b=a.filter(a=>!a.hiddenByDefault);return b.length>0?b:a.slice(0,1)}},[t,j,G]),T=(0,c.useMemo)(()=>{if(J)return Array.isArray(i)?i:[];let a=K.trim().toLowerCase();return(Array.isArray(i)?i:[]).filter(b=>{if(n&&n.getSearchText&&a.length>0&&!n.getSearchText(b).toLowerCase().includes(a))return!1;for(let a of o)if(a.predicate&&!a.predicate(b,a.value))return!1;return!0})},[i,o,J,K,n]),U=J?r.totalRows:T.length,V=Math.max(1,Math.ceil(U/O)),W=Math.min(M,V-1),X=Math.max(1,Math.min(8,O||10)),Y=(0,c.useMemo)(()=>{if(J)return T;let a=W*O,b=a+O;return T.slice(a,b)},[W,T,J,O]),Z=W>0,$=W<V-1,_=!!n||o.length>0||!!s||!!t;function aa(a,b){}async function ab(a){if(s&&!C){F(null),D(a);try{let b=new URLSearchParams;for(let a of(K.trim().length>0&&b.set("q",K.trim()),o)){let c=a.value;null!=c&&0!==String(c).length&&b.set(a.id,String(c))}if(J&&Q?.id&&Q?.dir&&(b.set("sort",Q.id),b.set("dir",Q.dir)),b.set("format",a),s.extraQuery)for(let[a,c]of Object.entries(s.extraQuery))null!=c&&b.set(a,String(c));let c=`${s.url}${s.url.includes("?")?"&":"?"}${b.toString()}`,d=s.filename?.({format:a});await (0,h.apiDownload)(c,{filename:d})}catch(a){F(a instanceof Error?a.message:"Export failed.")}finally{D(null)}}}return(0,b.jsxs)("div",{className:(0,d.cn)("space-y-3",v),children:[a?(0,b.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:a}):null,_?(0,b.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-end md:justify-between",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-end",children:[n?(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-sm font-medium",htmlFor:`${I}_datatable_search`,children:"Search"}),(0,b.jsx)("input",{id:`${I}_datatable_search`,className:"w-full min-w-[220px] rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:K,onChange:a=>{L(a.target.value),N(0)},placeholder:n.placeholder??"Search..."})]}):null,o.map(a=>(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"text-sm font-medium",htmlFor:`${I}_datatable_filter_${a.id}`,children:a.label}),(0,b.jsx)("select",{id:`${I}_datatable_filter_${a.id}`,className:"w-full min-w-[180px] rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:String(a.value),onChange:b=>{let c=a.options.find(a=>String(a.value)===b.target.value),d=c?c.value:b.target.value;a.onChange(d),N(0)},children:a.options.map(a=>(0,b.jsx)("option",{value:String(a.value),children:a.label},String(a.value)))})]},a.id))]}),(0,b.jsxs)("div",{className:"flex flex-col items-start gap-2 md:items-end",children:[(0,b.jsxs)("div",{className:"text-sm text-zinc-600",children:[U," result(s)"]}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[s?(0,b.jsx)(f.DropdownMenu,{align:"right",trigger:({toggle:a})=>(0,b.jsx)(e.Button,{variant:"outline",size:"sm",onClick:a,disabled:!!C,children:C?"Exporting...":"Export"}),children:({close:a})=>{let c=s.formats??["csv","xlsx","pdf"];return(0,b.jsx)(b.Fragment,{children:c.map(c=>(0,b.jsxs)(f.DropdownMenuItem,{onSelect:()=>{a(),ab(c)},disabled:!!C,children:["Export ",c.toUpperCase()]},c))})}}):null,t?(0,b.jsx)(f.DropdownMenu,{align:"right",trigger:({toggle:a})=>(0,b.jsx)(e.Button,{variant:"outline",size:"sm",onClick:a,children:"Columns"}),children:({close:a})=>(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(f.DropdownMenuItem,{onSelect:()=>{for(let b of(a(),j))aa(b.id,!0)},children:"Show all"}),(0,b.jsx)(f.DropdownMenuItem,{onSelect:()=>{for(let b of(a(),j))aa(b.id,!b.hiddenByDefault)},children:"Reset defaults"}),(0,b.jsx)(f.DropdownMenuSeparator,{}),j.map(a=>{let c=S.some(b=>b.id===a.id);return(0,b.jsxs)(f.DropdownMenuItem,{onSelect:()=>{aa(a.id,!c)},children:[(0,b.jsx)("span",{className:"mr-2 inline-block w-4",children:c?"✓":""}),"string"==typeof a.header?a.header:a.id]},a.id)})]})}):null]})]})]}):null,E?(0,b.jsx)("div",{className:"text-sm text-red-600",children:E}):null,(0,b.jsx)("div",{className:"overflow-x-auto rounded-[var(--rb-radius-md)] border border-[var(--rb-border)] bg-white",children:(0,b.jsxs)("table",{className:"min-w-full border-collapse text-left text-sm",children:[(0,b.jsx)("thead",{className:"bg-[var(--rb-surface-muted)]",children:(0,b.jsx)("tr",{children:S.map(a=>(0,b.jsx)("th",{className:(0,d.cn)("whitespace-nowrap border-b border-[var(--rb-border)] px-3 py-2 text-xs font-semibold uppercase tracking-wide text-zinc-600",a.headerClassName),children:J&&a.sortId&&R?(0,b.jsxs)("button",{type:"button",onClick:()=>(function(a){if(J&&a.sortId&&R){if(!Q||Q.id!==a.sortId){R({id:a.sortId,dir:"asc"}),N(0);return}if("asc"===Q.dir){R({id:a.sortId,dir:"desc"}),N(0);return}R(null),N(0)}})(a),className:"inline-flex items-center gap-1 hover:text-zinc-900",children:[(0,b.jsx)("span",{children:a.header}),J&&a.sortId?Q&&Q.id===a.sortId?"asc"===Q.dir?(0,b.jsx)("span",{className:"ml-1 text-zinc-700",children:"↑"}):(0,b.jsx)("span",{className:"ml-1 text-zinc-700",children:"↓"}):(0,b.jsx)("span",{className:"ml-1 text-zinc-400",children:"↕"}):null]}):a.header},a.id))})}),(0,b.jsx)("tbody",{children:l?Array.from({length:X}).map((a,c)=>(0,b.jsx)("tr",{className:"border-t border-[var(--rb-border)]",children:S.map((a,c)=>(0,b.jsx)("td",{className:(0,d.cn)("px-3 py-2 align-middle",a.className),children:(0,b.jsx)(g.Skeleton,{className:(0,d.cn)("h-3 rounded-[var(--rb-radius-sm)]",0===c?"w-3/4":c===S.length-1?"w-16":"w-full")})},a.id))},`loading_${c}`)):0===Y.length?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{className:"px-3 py-3 text-sm text-zinc-600",colSpan:Math.max(1,S.length),children:m})}):Y.map(a=>(0,b.jsx)("tr",{className:(0,d.cn)("border-t border-[var(--rb-border)]",u?"cursor-pointer hover:bg-[var(--rb-surface-muted)]":null),tabIndex:u?0:void 0,role:u?"button":void 0,onClick:u?()=>{u(a)}:void 0,onKeyDown:u?b=>{("Enter"===b.key||" "===b.key)&&(b.preventDefault(),u(a))}:void 0,children:S.map(c=>(0,b.jsx)("td",{className:(0,d.cn)("px-3 py-2 align-middle",c.className),children:c.cell(a)},c.id))},String(k(a))))})]})}),(0,b.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(e.Button,{variant:"outline",size:"sm",onClick:function(){N(Math.max(0,W-1))},disabled:!Z,children:"Prev"}),(0,b.jsx)(e.Button,{variant:"outline",size:"sm",onClick:function(){N(Math.min(V-1,W+1))},disabled:!$,children:"Next"}),(0,b.jsxs)("div",{className:"text-sm text-zinc-600",children:["Page ",W+1," / ",V]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"text-sm text-zinc-600",children:"Rows per page"}),(0,b.jsx)("select",{className:"rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:String(O),onChange:a=>{P(Number(a.target.value)),N(0)},children:p.map(a=>(0,b.jsx)("option",{value:a,children:a},a))})]})]})]})}a.s(["DataTable",()=>i])},54804,a=>{"use strict";var b=a.i(57850),c=a.i(648),d=a.i(75385),e=a.i(4600);function f({title:a,description:f,actions:g,filters:h,loading:i,loadingFallback:j,error:k,empty:l,emptyTitle:m="Nothing here yet",emptyDescription:n="No items to display.",children:o}){return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(c.PageHeader,{title:a,description:f,actions:g}),h?(0,b.jsx)(e.Card,{className:"shadow-none",children:(0,b.jsx)(e.CardContent,{className:"pt-5",children:h})}):null,k?(0,b.jsx)(d.Alert,{variant:"danger",title:"Something went wrong",children:k}):null,i?j??(0,b.jsx)("div",{className:"text-sm text-zinc-500",children:"Loading..."}):null,i||k||!l?null:(0,b.jsx)(e.Card,{className:"shadow-none",children:(0,b.jsxs)(e.CardContent,{className:"pt-5",children:[(0,b.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:m}),(0,b.jsx)("div",{className:"mt-1 text-sm text-zinc-600",children:n})]})}),i||k||l?null:o]})}a.s(["ListPageShell",()=>f])},71513,a=>{"use strict";var b=a.i(6454);a.s(["notify",0,{success:(a,c={})=>b.toast.success(a,c),error:(a,c={})=>b.toast.error(a,c),info:(a,c={})=>b.toast.info(a,c),warning:(a,c={})=>b.toast.warning(a,c),loading:(a,c={})=>b.toast.loading(a,c),dismiss(a){b.toast.dismiss(a)},message:(a,c,d={})=>"success"===a?b.toast.success(c,d):"error"===a?b.toast.error(c,d):"warning"===a?b.toast.warning(c,d):"loading"===a?b.toast.loading(c,d):b.toast.info(c,d)}])},6183,a=>{"use strict";let b=(0,a.i(31261).default)("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);a.s(["MoreHorizontal",()=>b],6183)},46350,a=>{"use strict";let b=(0,a.i(31261).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);a.s(["Trash2",()=>b],46350)},41379,71907,a=>{"use strict";var b=a.i(31261);let c=(0,b.default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);a.s(["Eye",()=>c],41379);let d=(0,b.default)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]);a.s(["Mail",()=>d],71907)},56470,a=>{"use strict";var b=a.i(57850),c=a.i(45056),d=a.i(93609),e=a.i(75458),f=a.i(31261);let g=(0,f.default)("ban",[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),h=(0,f.default)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var i=a.i(41379),j=a.i(71907),k=a.i(6183);let l=(0,f.default)("pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);var m=a.i(46350);let n=(0,f.default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var o=a.i(97867),p=a.i(17933),q=a.i(4600),r=a.i(54177),s=a.i(46036),t=a.i(54804),u=a.i(34075),v=a.i(4148),w=a.i(71513);function x(){let a=(0,e.useAuth)(),f=(0,d.useRouter)(),x=(0,d.useParams)(),y=x.business??x.tenant,[z,A]=c.default.useState(!0),[B,C]=c.default.useState(null),[D,E]=c.default.useState([]),[F,G]=c.default.useState(""),[H,I]=c.default.useState(null),[J,K]=c.default.useState(null),[L,M]=c.default.useState(0),[N,O]=c.default.useState(0),[P,Q]=c.default.useState(10);c.default.useEffect(()=>{let a=!0;return async function(){try{if(A(!0),C(null),"string"!=typeof y||0===y.trim().length)return void E([]);let b=await (0,u.apiFetch)(`/api/${y}/app/repairbuddy/estimates?limit=200&q=${encodeURIComponent(F.trim())}`,{method:"GET"});if(!a)return;E(Array.isArray(b?.estimates)?b.estimates:[])}catch(b){if(!a)return;if(b instanceof u.ApiError&&428===b.status&&"string"==typeof y&&y.trim().length>0){let a=`/app/${y}/estimates`;f.replace(`/app/${y}/branches/select?next=${encodeURIComponent(a)}`);return}C(b instanceof Error?b.message:"Failed to load estimates.")}finally{if(!a)return;A(!1)}}(),()=>{a=!1}},[F,L,y]);let R=c.default.useMemo(()=>{let a={pending:0,approved:0,rejected:0};for(let b of D){let c="string"==typeof b?.status?b.status:"";c in a&&(a[c]+=1)}return{total:D.length,pending:a.pending,approved:a.approved,rejected:a.rejected}},[D]),S=c.default.useMemo(()=>{let a=[...D];if(!H?.id||!H?.dir)return a;let b="asc"===H.dir?1:-1;return a.sort((a,c)=>"id"===H.id?(a.id-c.id)*b:"case_number"===H.id?a.case_number.localeCompare(c.case_number)*b:"status"===H.id?String(a.status).localeCompare(String(c.status))*b:"updated_at"===H.id?(new Date(a.updated_at).getTime()-new Date(c.updated_at).getTime())*b:"total"===H.id?(("number"==typeof a.totals?.total_cents?a.totals.total_cents:0)-("number"==typeof c.totals?.total_cents?c.totals.total_cents:0))*b:0),a},[D,H]);async function T(b){if("string"==typeof y&&0!==y.trim().length&&a.can("estimates.manage")){K(b);try{await (0,u.apiFetch)(`/api/${y}/app/repairbuddy/estimates/${b}/send`,{method:"POST"}),w.notify.success("Estimate sent."),M(a=>a+1)}catch(a){if(a instanceof u.ApiError&&428===a.status){let a=`/app/${y}/estimates`;f.replace(`/app/${y}/branches/select?next=${encodeURIComponent(a)}`);return}w.notify.error(a instanceof Error?a.message:"Failed to send estimate.")}finally{K(null)}}}async function U(b,c){if("string"==typeof y&&0!==y.trim().length&&a.can("estimates.manage")){K(b);try{await (0,u.apiFetch)(`/api/${y}/app/repairbuddy/estimates/${b}`,{method:"PATCH",body:{status:c}}),M(a=>a+1)}catch(a){if(a instanceof u.ApiError&&428===a.status){let a=`/app/${y}/estimates`;f.replace(`/app/${y}/branches/select?next=${encodeURIComponent(a)}`);return}w.notify.error(a instanceof Error?a.message:"Failed to update estimate.")}finally{K(null)}}}let V=S.length,W=c.default.useMemo(()=>{let a=N*P,b=a+P;return S.slice(a,b)},[N,P,S]),X=c.default.useMemo(()=>[{id:"id",header:"ID",sortId:"id",cell:a=>(0,b.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:a.id}),className:"whitespace-nowrap"},{id:"case",header:"Estimate",sortId:"case_number",cell:a=>(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("div",{className:"truncate font-semibold text-[var(--rb-text)]",children:a.case_number}),(0,b.jsx)("div",{className:"truncate text-xs text-zinc-600",children:a.title})]}),className:"min-w-[220px] max-w-[280px]"},{id:"customer",header:"Customer",cell:a=>(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("div",{className:"truncate text-sm font-semibold text-[var(--rb-text)]",children:a.customer?.name??"—"}),(0,b.jsx)("div",{className:"truncate text-xs text-zinc-600",children:a.customer?.email??""})]}),className:"min-w-[220px] max-w-[320px]"},{id:"status",header:"Status",sortId:"status",cell:a=>{var c;return(0,b.jsx)(p.Badge,{variant:"approved"===(c=a.status)?"success":"rejected"===c?"danger":"warning",children:"string"==typeof a.status?a.status.replace(/_/g," "):"—"})},className:"whitespace-nowrap"},{id:"total",header:"Total",sortId:"total",cell:a=>(0,b.jsx)("div",{className:"text-sm text-zinc-700",children:(0,v.formatMoney)({amountCents:a.totals?.total_cents,currency:a.totals?.currency})}),className:"whitespace-nowrap"},{id:"updated",header:"Updated",sortId:"updated_at",cell:a=>(0,b.jsx)("div",{className:"text-sm text-zinc-600",children:new Date(a.updated_at).toLocaleString()}),className:"whitespace-nowrap"},{id:"actions",header:(0,b.jsx)("div",{className:"text-right",children:"Actions"}),cell:c=>(0,b.jsx)("div",{className:"flex justify-end",children:(0,b.jsx)(s.DropdownMenu,{align:"right",trigger:({toggle:a})=>(0,b.jsx)(o.Button,{variant:"outline",size:"sm",className:"px-2","aria-label":"Actions",disabled:J===c.id,onClick:b=>{b.preventDefault(),b.stopPropagation(),a()},children:(0,b.jsx)(k.MoreHorizontal,{className:"h-4 w-4"})}),children:({close:d})=>(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(s.DropdownMenuItem,{onSelect:()=>{"string"==typeof y&&0!==y.length&&(d(),f.push(`/app/${y}/estimates/${c.id}`))},children:(0,b.jsxs)("span",{className:"flex items-center gap-2",children:[(0,b.jsx)(i.Eye,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"View"})]})}),(0,b.jsx)(s.DropdownMenuItem,{disabled:J===c.id||!a.can("estimates.manage")||!c.customer||!c.customer.email||0===c.customer.email.trim().length,onSelect:()=>{d(),T(c.id)},children:(0,b.jsxs)("span",{className:"flex items-center gap-2",children:[(0,b.jsx)(j.Mail,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Send"})]})}),(0,b.jsx)(s.DropdownMenuItem,{disabled:J===c.id||!a.can("estimates.manage")||"pending"!==c.status,onSelect:()=>{d(),window.confirm("Approve this estimate?")&&U(c.id,"approved")},children:(0,b.jsxs)("span",{className:"flex items-center gap-2",children:[(0,b.jsx)(h,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Approve"})]})}),(0,b.jsx)(s.DropdownMenuItem,{disabled:J===c.id||!a.can("estimates.manage")||"pending"!==c.status,onSelect:()=>{d(),window.confirm("Reject this estimate?")&&U(c.id,"rejected")},children:(0,b.jsxs)("span",{className:"flex items-center gap-2",children:[(0,b.jsx)(n,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Reject"})]})}),(0,b.jsx)(s.DropdownMenuItem,{disabled:!0,onSelect:()=>{},children:(0,b.jsxs)("span",{className:"flex items-center gap-2",children:[(0,b.jsx)(l,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Edit"})]})}),(0,b.jsx)(s.DropdownMenuItem,{disabled:!0,onSelect:()=>{},children:(0,b.jsxs)("span",{className:"flex items-center gap-2",children:[(0,b.jsx)(g,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Cancel"})]})}),(0,b.jsx)(s.DropdownMenuItem,{disabled:!0,onSelect:()=>{},children:(0,b.jsxs)("span",{className:"flex items-center gap-2",children:[(0,b.jsx)(m.Trash2,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Delete"})]})})]})})}),className:"whitespace-nowrap"}],[J,a,f,y]);return(0,b.jsxs)(t.ListPageShell,{title:"Estimates",description:"Create, send, and track customer approvals.",actions:(0,b.jsx)(o.Button,{variant:"outline",size:"sm",onClick:()=>{"string"!=typeof y||0===y.length||a.can("estimates.manage")&&f.push(`/app/${y}/estimates/new`)},disabled:"string"!=typeof y||0===y.length||!a.can("estimates.manage"),children:"New estimate"}),loading:z,error:B,empty:!z&&!B&&0===D.length,emptyTitle:"No estimates found",emptyDescription:"Try adjusting your search.",children:[(0,b.jsx)("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2 lg:grid-cols-4",children:[{id:"pending",label:"Pending",value:R.pending,dot:"bg-amber-500"},{id:"approved",label:"Approved",value:R.approved,dot:"bg-emerald-500"},{id:"rejected",label:"Rejected",value:R.rejected,dot:"bg-rose-500"},{id:"total",label:"Total",value:R.total,dot:"bg-sky-500"}].map(a=>(0,b.jsxs)("div",{className:"rounded-[var(--rb-radius-md)] border border-[var(--rb-border)] bg-white p-4 text-left shadow-none",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,b.jsx)("div",{className:"min-w-0",children:(0,b.jsx)("div",{className:"text-xs font-medium text-zinc-600",children:a.label})}),(0,b.jsx)("div",{className:`mt-1 h-2.5 w-2.5 shrink-0 rounded-full ${a.dot}`,"aria-hidden":"true"})]}),(0,b.jsx)("div",{className:"mt-1 text-2xl font-semibold text-[var(--rb-text)]",children:z?"—":String(a.value)})]},a.id))}),(0,b.jsx)(q.Card,{className:"shadow-none",children:(0,b.jsx)(q.CardContent,{className:"pt-5",children:(0,b.jsx)(r.DataTable,{title:"string"==typeof y?`Estimates \xb7 ${y}`:"Estimates",data:W,loading:z,emptyMessage:"No estimates.",columns:X,getRowId:a=>a.id,search:{placeholder:"Search by case number, title, customer, or ID..."},columnVisibilityKey:"string"==typeof y?`rb:datatable:${y}:estimates`:"rb:datatable:estimates",server:{query:F,onQueryChange:a=>{G(a),O(0)},pageIndex:N,onPageIndexChange:O,pageSize:P,onPageSizeChange:a=>{Q(a),O(0)},totalRows:V,sort:H,onSortChange:a=>{I(a),O(0)}},onRowClick:a=>{"string"==typeof y&&0!==y.length&&f.push(`/app/${y}/estimates/${a.id}`)}})})})]})}a.s(["default",()=>x],56470)}];

//# sourceMappingURL=frontend_471d7323._.js.map