module.exports=[94703,a=>{"use strict";var b=a.i(57850),c=a.i(45056),d=a.i(7160);function e({open:a,onClose:e,title:f,children:g,footer:h,position:i="center",variant:j="glass",className:k}){if((0,c.useEffect)(()=>{function b(b){a&&"Escape"===b.key&&e()}return document.addEventListener("keydown",b),()=>document.removeEventListener("keydown",b)},[e,a]),!a)return null;let l="solid"===j?(0,d.cn)("relative w-full max-w-lg overflow-hidden rounded-[var(--rb-radius-lg)]","border border-[var(--rb-border)]","bg-white","shadow-[var(--rb-shadow)]"):(0,d.cn)("relative w-full max-w-lg overflow-hidden rounded-[var(--rb-radius-lg)]","border border-[color:color-mix(in_srgb,var(--rb-border),white_55%)]","bg-white/75 backdrop-blur-xl","shadow-[0_18px_55px_-18px_rgba(0,0,0,0.55)]","ring-1 ring-white/25");return(0,b.jsxs)("div",{className:"top-center"===i?"fixed inset-0 z-50 flex items-start justify-center px-4 pt-8":"fixed inset-0 z-50 flex items-center justify-center px-4",children:[(0,b.jsx)("button",{type:"button",className:(0,d.cn)("absolute inset-0","bg-black/35 backdrop-blur-md","bg-[radial-gradient(900px_600px_at_20%_20%,color-mix(in_srgb,#16a34a,transparent_82%)_0%,transparent_60%),radial-gradient(900px_600px_at_80%_30%,color-mix(in_srgb,var(--rb-blue),transparent_82%)_0%,transparent_60%),radial-gradient(900px_600px_at_50%_85%,color-mix(in_srgb,var(--rb-orange),transparent_85%)_0%,transparent_65%)]"),"aria-label":"Close",onClick:e}),(0,b.jsxs)("div",{role:"dialog","aria-modal":"true",className:(0,d.cn)(l,k),children:["glass"===j?(0,b.jsx)("div",{className:"pointer-events-none absolute inset-0 bg-[radial-gradient(650px_420px_at_20%_15%,color-mix(in_srgb,#16a34a,transparent_88%)_0%,transparent_60%),radial-gradient(650px_420px_at_80%_5%,color-mix(in_srgb,var(--rb-blue),transparent_90%)_0%,transparent_60%)]"}):null,f?(0,b.jsx)("div",{className:(0,d.cn)("relative px-5 py-4","solid"===j?"border-b border-[var(--rb-border)]":"border-b border-[color:color-mix(in_srgb,var(--rb-border),white_60%)]"),children:(0,b.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:f})}):null,(0,b.jsx)("div",{className:"relative px-5 py-4",children:g}),h?(0,b.jsx)("div",{className:(0,d.cn)("relative px-5 py-4","solid"===j?"border-t border-[var(--rb-border)]":"border-t border-[color:color-mix(in_srgb,var(--rb-border),white_60%)]"),children:h}):null]})]})}a.s(["Modal",()=>e])},21282,a=>{"use strict";var b=a.i(57850),c=a.i(94703),d=a.i(97867);function e({open:a,title:e,message:f,confirmText:g="Confirm",confirmVariant:h="primary",cancelText:i="Cancel",busy:j=!1,onCancel:k,onConfirm:l}){return(0,b.jsx)(c.Modal,{open:a,onClose:()=>{j||k()},title:e,footer:(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,b.jsx)(d.Button,{variant:"outline",onClick:k,disabled:j,children:i}),(0,b.jsx)(d.Button,{variant:h,onClick:l,disabled:j,children:j?"Working...":g})]}),children:(0,b.jsx)("div",{className:"text-sm text-zinc-700",children:f})})}a.s(["ConfirmDialog",()=>e])},4148,a=>{"use strict";function b(a){let b=a.amountCents,c=a.currency?.toUpperCase()??null;if("number"!=typeof b||!Number.isFinite(b))return a.fallback??"—";let d=b/100;if(!c||3!==c.length)return`${d.toFixed(2)}`;try{return new Intl.NumberFormat(void 0,{style:"currency",currency:c,minimumFractionDigits:2,maximumFractionDigits:2}).format(d)}catch{return`${c} ${d.toFixed(2)}`}}a.s(["formatMoney",()=>b])},54804,a=>{"use strict";var b=a.i(57850),c=a.i(648),d=a.i(75385),e=a.i(4600);function f({title:a,description:f,actions:g,filters:h,loading:i,loadingFallback:j,error:k,empty:l,emptyTitle:m="Nothing here yet",emptyDescription:n="No items to display.",children:o}){return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(c.PageHeader,{title:a,description:f,actions:g}),h?(0,b.jsx)(e.Card,{className:"shadow-none",children:(0,b.jsx)(e.CardContent,{className:"pt-5",children:h})}):null,k?(0,b.jsx)(d.Alert,{variant:"danger",title:"Something went wrong",children:k}):null,i?j??(0,b.jsx)("div",{className:"text-sm text-zinc-500",children:"Loading..."}):null,i||k||!l?null:(0,b.jsx)(e.Card,{className:"shadow-none",children:(0,b.jsxs)(e.CardContent,{className:"pt-5",children:[(0,b.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:m}),(0,b.jsx)("div",{className:"mt-1 text-sm text-zinc-600",children:n})]})}),i||k||l?null:o]})}a.s(["ListPageShell",()=>f])},63984,a=>{"use strict";var b=a.i(57850),c=a.i(45056),d=a.i(93609),e=a.i(91601),f=a.i(75458),g=a.i(97867),h=a.i(4600),i=a.i(21282),j=a.i(54177),k=a.i(46036),l=a.i(54804),m=a.i(34075),n=a.i(4148);function o(){let a=(0,f.useAuth)(),o=(0,d.useRouter)(),p="get-up-and-glo",[q,r]=c.default.useState(!0),[s,t]=c.default.useState(null),[u,v]=c.default.useState(null),[w,x]=c.default.useState(!1),[y,z]=c.default.useState([]),[A,B]=c.default.useState([]),[C,D]=c.default.useState(""),[E,F]=c.default.useState(0),[G,H]=c.default.useState(10),[I,J]=c.default.useState(null),[K,L]=c.default.useState(""),[M,N]=c.default.useState(""),[O,P]=c.default.useState(null),[Q,R]=c.default.useState(""),[S,T]=c.default.useState(""),[U,V]=c.default.useState(""),[W,X]=c.default.useState(""),[Y,Z]=c.default.useState(!0),[$,_]=c.default.useState(!1),[aa,ab]=c.default.useState(""),[ac,ad]=c.default.useState(""),[ae,af]=c.default.useState(null),ag=a.can("services.manage");function ah(){J(null),L(""),N(""),P(null),R(""),T(""),V(""),X(""),Z(!0)}async function ai(a){if(a.preventDefault(),!w){if(!ag)return void t("Forbidden.");x(!0),t(null),v(null);try{let a=K.trim();if(0===a.length)return void t("Name is required.");let b=W.trim(),c=b.length>0?Math.round(100*Number(b)):null;if(b.length>0&&(!Number.isFinite(Number(b))||null===c))return void t("Base price is invalid.");let d={name:a,description:M.trim().length>0?M.trim():null,service_type_id:"number"==typeof O?O:null,service_code:Q.trim().length>0?Q.trim():null,time_required:S.trim().length>0?S.trim():null,warranty:U.trim().length>0?U.trim():null,base_price_amount_cents:"number"==typeof c?c:null,is_active:!!Y};if(I){let a=await (0,m.apiFetch)(`/api/${p}/app/repairbuddy/services/${I}`,{method:"PATCH",body:d});v("Service updated."),z(b=>b.map(b=>b.id===I?a.service??b:b))}else{let a=await (0,m.apiFetch)(`/api/${p}/app/repairbuddy/services`,{method:"POST",body:d});v("Service created."),a.service&&z(b=>[a.service,...b])}ah(),F(0)}catch(a){a instanceof m.ApiError?t(a.message):t(I?"Failed to update service.":"Failed to create service.")}finally{x(!1)}}}async function aj(a){if(!w){var c;if(!ag)return void t("Forbidden.");c={title:"Delete service",message:(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{children:["You are about to delete ",(0,b.jsx)("span",{className:"font-semibold",children:a.name}),"."]}),(0,b.jsx)("div",{className:"text-sm text-zinc-600",children:"This action cannot be undone."})]}),action:async()=>{x(!0),t(null),v(null);try{await (0,m.apiFetch)(`/api/${p}/app/repairbuddy/services/${a.id}`,{method:"DELETE"}),z(b=>b.filter(b=>b.id!==a.id)),v("Service deleted."),F(0),I===a.id&&ah()}catch(a){a instanceof m.ApiError?t(a.message):t("Failed to delete service.")}finally{x(!1)}}},ab(c.title),ad(c.message),af(()=>c.action),_(!0)}}c.default.useEffect(()=>{let a=!0;return async function(){try{r(!0),t(null),v(null);let[b,c]=await Promise.all([(0,m.apiFetch)(`/api/${p}/app/repairbuddy/services`),(0,m.apiFetch)(`/api/${p}/app/repairbuddy/service-types?limit=200`)]);if(!a)return;z(Array.isArray(b?.services)?b.services:[]),B(Array.isArray(c?.service_types)?c.service_types:[])}catch(b){if(!a)return;if(b instanceof m.ApiError&&428===b.status){let a=`/app/${p}/services`;o.replace(`/app/${p}/branches/select?next=${encodeURIComponent(a)}`);return}t(b instanceof Error?b.message:"Failed to load services.")}finally{if(!a)return;r(!1)}}(),()=>{a=!1}},[o,p]);let ak=c.default.useMemo(()=>{let a=C.trim().toLowerCase();return a?y.filter(b=>`${b.name} ${b.description??""} ${b.id}`.toLowerCase().includes(a)):y},[C,y]),al=ak.length,am=c.default.useMemo(()=>{let a=E*G,b=a+G;return ak.slice(a,b)},[ak,E,G]),an=c.default.useMemo(()=>[{id:"name",header:"Service",cell:a=>(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("div",{className:"truncate font-semibold text-[var(--rb-text)]",children:a.name}),(0,b.jsx)("div",{className:"truncate text-xs text-zinc-600",children:a.id})]}),className:"min-w-[220px]"},{id:"desc",header:"Description",cell:a=>(0,b.jsx)("div",{className:"text-sm text-zinc-700",children:a.description??"—"}),className:"min-w-[280px]"},{id:"price",header:"Base price",cell:a=>a.base_price?(0,b.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)] whitespace-nowrap",children:(0,n.formatMoney)({amountCents:a.base_price.amount_cents,currency:a.base_price.currency})}):(0,b.jsx)("div",{className:"text-sm text-zinc-600",children:"—"}),className:"whitespace-nowrap"},{id:"actions",header:"",cell:a=>ag?(0,b.jsx)(k.DropdownMenu,{trigger:({toggle:a})=>(0,b.jsx)(g.Button,{size:"sm",variant:"outline",disabled:w,onClick:a,children:"Actions"}),children:({close:c})=>(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(k.DropdownMenuItem,{onSelect:()=>{c(),ag&&(J(a.id),L(a.name),N(a.description??""),P("number"==typeof a.service_type_id?a.service_type_id:null),R(a.service_code??""),T(a.time_required??""),V(a.warranty??""),X(a.base_price?String(a.base_price.amount_cents/100):""),Z(!!a.is_active),t(null),v(null))},children:"Edit"}),(0,b.jsx)(k.DropdownMenuSeparator,{}),(0,b.jsx)(k.DropdownMenuItem,{destructive:!0,onSelect:()=>{c(),aj(a)},children:"Delete"})]})}):null,className:"w-[1%] whitespace-nowrap"}],[w,ag]);return(0,b.jsx)(e.RequireAuth,{children:(0,b.jsxs)(l.ListPageShell,{title:"Services",description:"Service catalog used for estimates and jobs.",filters:null,loading:q,error:s,empty:!1,emptyTitle:"No services",emptyDescription:"Add services to standardize pricing.",children:[(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(h.Card,{className:"shadow-none",children:(0,b.jsxs)(h.CardContent,{className:"pt-5",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("div",{className:"truncate text-sm font-semibold text-[var(--rb-text)]",children:I?"Edit service":"New service"}),(0,b.jsx)("div",{className:"mt-1 text-sm text-zinc-600",children:"Create or update a service record."})]}),(0,b.jsx)(g.Button,{variant:"outline",size:"sm",onClick:function(){ag&&(ah(),t(null),v(null))},disabled:!ag||w,children:"New"})]}),(0,b.jsx)("form",{className:"mt-5 space-y-4",onSubmit:ai,children:(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[(0,b.jsxs)("div",{className:"space-y-1 lg:col-span-2",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-[var(--rb-text)] uppercase tracking-wider",children:"Name"}),(0,b.jsx)("input",{value:K,onChange:a=>L(a.target.value),placeholder:"e.g., Screen replacement",className:"h-9 w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 text-sm",disabled:!ag||w})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-[var(--rb-text)] uppercase tracking-wider",children:"Service code"}),(0,b.jsx)("input",{value:Q,onChange:a=>R(a.target.value),className:"h-9 w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 text-sm",disabled:!ag||w})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-[var(--rb-text)] uppercase tracking-wider",children:"Base price"}),(0,b.jsx)("input",{value:W,onChange:a=>X(a.target.value),placeholder:"e.g., 49.99",className:"h-9 w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 text-sm",disabled:!ag||w})]}),(0,b.jsxs)("div",{className:"space-y-1 lg:col-span-2",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-[var(--rb-text)] uppercase tracking-wider",children:"Description"}),(0,b.jsx)("input",{value:M,onChange:a=>N(a.target.value),placeholder:"Brief service description...",className:"h-9 w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 text-sm",disabled:!ag||w})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-[var(--rb-text)] uppercase tracking-wider",children:"Service type"}),(0,b.jsxs)("select",{value:"number"==typeof O?String(O):"",onChange:a=>{let b=a.target.value;P(b?Number(b):null)},className:"h-9 w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 text-sm",disabled:!ag||w,children:[(0,b.jsx)("option",{value:"",children:"—"}),A.filter(a=>!!a.is_active||"number"==typeof O&&a.id===O).map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3 lg:col-span-1",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-[var(--rb-text)] uppercase tracking-wider",children:"Time"}),(0,b.jsx)("input",{value:S,onChange:a=>T(a.target.value),placeholder:"30 min",className:"h-9 w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-2 text-sm text-center",disabled:!ag||w})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-[var(--rb-text)] uppercase tracking-wider",children:"Warranty"}),(0,b.jsx)("input",{value:U,onChange:a=>V(a.target.value),placeholder:"90 days",className:"h-9 w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-2 text-sm text-center",disabled:!ag||w})]})]}),(0,b.jsx)("div",{className:"flex flex-wrap items-center gap-x-6 gap-y-2 py-1 lg:col-span-3",children:(0,b.jsxs)("label",{className:"flex items-center gap-2 text-sm select-none",children:[(0,b.jsx)("input",{type:"checkbox",checked:Y,onChange:a=>Z(a.target.checked),className:"h-4 w-4 rounded border-zinc-300 text-indigo-600 focus:ring-indigo-500",disabled:!ag||w}),(0,b.jsx)("span",{className:"font-medium text-zinc-700",children:"Active"})]})}),(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2 lg:col-span-1",children:[(0,b.jsx)(g.Button,{type:"button",variant:"outline",size:"sm",onClick:ah,disabled:!ag||w,children:"Clear"}),(0,b.jsx)(g.Button,{type:"submit",size:"sm",disabled:!ag||w,className:"px-6",children:I?"Save":"Create"})]})]})}),u?(0,b.jsx)("div",{className:"mt-4 text-sm text-emerald-700",children:u}):null]})}),(0,b.jsx)(h.Card,{className:"shadow-none",children:(0,b.jsx)(h.CardContent,{className:"pt-5",children:(0,b.jsx)(j.DataTable,{title:"Services · get-up-and-glo",data:am,loading:q,emptyMessage:"No services.",columns:an,getRowId:a=>a.id,search:{placeholder:"Search services..."},server:{query:C,onQueryChange:a=>{D(a),F(0)},pageIndex:E,onPageIndexChange:F,pageSize:G,onPageSizeChange:a=>{H(a),F(0)},totalRows:al}})})})]}),(0,b.jsx)(i.ConfirmDialog,{open:$,title:aa,message:ac,confirmText:"Confirm",busy:w,onCancel:()=>_(!1),onConfirm:function(){(async()=>{ae&&(await ae(),_(!1))})()}})]})})}a.s(["default",()=>o])}];

//# sourceMappingURL=frontend_src_d0a4441a._.js.map