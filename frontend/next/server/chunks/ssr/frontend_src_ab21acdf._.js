module.exports=[648,a=>{"use strict";var b=a.i(57850),c=a.i(7160);function d({title:a,description:d,actions:e,className:f}){return(0,b.jsxs)("div",{className:(0,c.cn)("flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between",f),children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-xl font-semibold text-[var(--rb-text)]",children:a}),d?(0,b.jsx)("p",{className:"mt-1 text-sm text-zinc-600",children:d}):null]}),e?(0,b.jsx)("div",{className:"flex items-center gap-2",children:e}):null]})}a.s(["PageHeader",()=>d])},29054,a=>{"use strict";var b=a.i(57850),c=a.i(7160);function d({className:a,type:d,...e}){return(0,b.jsx)("input",{type:d,className:(0,c.cn)("w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)] outline-none transition","placeholder:text-zinc-400","focus-visible:ring-2 focus-visible:ring-[color:color-mix(in_srgb,var(--rb-orange),white_65%)] focus-visible:ring-offset-2 focus-visible:ring-offset-white","disabled:cursor-not-allowed disabled:bg-[var(--rb-surface-muted)] disabled:opacity-70",a),...e})}a.s(["Input",()=>d])},71513,a=>{"use strict";var b=a.i(6454);a.s(["notify",0,{success:(a,c={})=>b.toast.success(a,c),error:(a,c={})=>b.toast.error(a,c),info:(a,c={})=>b.toast.info(a,c),warning:(a,c={})=>b.toast.warning(a,c),loading:(a,c={})=>b.toast.loading(a,c),dismiss(a){b.toast.dismiss(a)},message:(a,c,d={})=>"success"===a?b.toast.success(c,d):"error"===a?b.toast.error(c,d):"warning"===a?b.toast.warning(c,d):"loading"===a?b.toast.loading(c,d):b.toast.info(c,d)}])},90319,a=>{"use strict";var b=a.i(57850),c=a.i(7160);function d({label:a,fieldId:d,description:e,error:f,required:g,className:h,labelClassName:i,fieldClassName:j,children:k}){let l=e?`${d}__description`:void 0,m=f?`${d}__error`:void 0,n=[l,m].filter(Boolean).join(" ")||void 0,o="function"==typeof k?k({describedBy:n,descriptionId:l,errorId:m,invalid:!!f}):k;return(0,b.jsxs)("div",{className:(0,c.cn)("grid gap-1 sm:grid-cols-[220px_1fr] sm:gap-4",h),children:[(0,b.jsx)("div",{className:"sm:pt-2",children:(0,b.jsxs)("label",{className:(0,c.cn)("block text-sm font-medium text-[var(--rb-text)]",i),htmlFor:d,children:[a,g?(0,b.jsx)("span",{className:"text-red-600",children:" *"}):null]})}),(0,b.jsxs)("div",{className:(0,c.cn)("min-w-0",j),children:[o,e?(0,b.jsx)("div",{id:l,className:"mt-1 text-xs text-zinc-500",children:e}):null,f?(0,b.jsx)("div",{id:m,className:"mt-1 text-xs text-red-600",children:f}):null]})]})}a.s(["FormRow",()=>d])},21077,a=>{"use strict";var b=a.i(57850),c=a.i(45056),d=a.i(93609),e=a.i(34075),f=a.i(71513),g=a.i(91601),h=a.i(648),i=a.i(4600),j=a.i(97867),k=a.i(29054),l=a.i(90319);function m(){let a=(0,d.useRouter)(),m=(0,d.useParams)(),n=m.business??m.tenant,[o,p]=(0,c.useState)(!0),[q,r]=(0,c.useState)(!1),[s,t]=(0,c.useState)(null),[u,v]=(0,c.useState)([]),[w,x]=(0,c.useState)([]),[y,z]=(0,c.useState)([]),[A,B]=(0,c.useState)(""),[C,D]=(0,c.useState)(""),[E,F]=(0,c.useState)(null),[G,H]=(0,c.useState)(null),[I,J]=(0,c.useState)(""),[K,L]=(0,c.useState)(""),[M,N]=(0,c.useState)(""),[O,P]=(0,c.useState)(null),[Q,R]=(0,c.useState)(""),[S,T]=(0,c.useState)(""),[U,V]=(0,c.useState)(""),[W,X]=(0,c.useState)(""),[Y,Z]=(0,c.useState)(""),[$,_]=(0,c.useState)(""),[aa,ab]=(0,c.useState)(!0);async function ac(b){if(b.preventDefault(),"string"==typeof n&&0!==n.length){r(!0),t(null);try{let b=A.trim();if(0===b.length)return void t("Name is required.");let c=M.trim(),d=null;if(c.length>0){let a=Number(c);if(!Number.isFinite(a))return void t("Price is invalid.");d=Math.round(100*a)}let g=W.trim(),h=null;if(g.length>0){let a=Number(g);if(!Number.isFinite(a))return void t("Installation charges is invalid.");h=Math.round(100*a)}let i=$.trim(),j=null;if(i.length>0){let a=Number(i);if(!Number.isFinite(a))return void t("Stock is invalid.");j=Math.trunc(a)}let k={name:b,sku:""!==C.trim()?C.trim():null,part_type_id:E,part_brand_id:G,manufacturing_code:""!==I.trim()?I.trim():null,stock_code:""!==K.trim()?K.trim():null,price_amount_cents:d,tax_id:O,warranty:""!==Q.trim()?Q.trim():null,core_features:""!==U.trim()?U.trim():null,capacity:""!==S.trim()?S.trim():null,installation_charges_amount_cents:h,installation_message:""!==Y.trim()?Y.trim():null,stock:j,is_active:aa};await (0,e.apiFetch)(`/api/${n}/app/repairbuddy/parts`,{method:"POST",body:k}),f.notify.success("Part created."),a.replace(`/app/${n}/parts`)}catch(a){a instanceof e.ApiError?t(a.message):t("Failed to create part.")}finally{r(!1)}}}(0,c.useEffect)(()=>{let a=!0;return async function(){if("string"==typeof n&&0!==n.length){p(!0),t(null);try{let[b,c,d]=await Promise.all([(0,e.apiFetch)(`/api/${n}/app/repairbuddy/part-types?limit=200`),(0,e.apiFetch)(`/api/${n}/app/repairbuddy/part-brands?limit=200`),(0,e.apiFetch)(`/api/${n}/app/repairbuddy/taxes?limit=200`)]);if(!a)return;v(Array.isArray(b.part_types)?b.part_types:[]),x(Array.isArray(c.part_brands)?c.part_brands:[]),z(Array.isArray(d.taxes)?d.taxes:[])}catch(b){if(!a)return;t(b instanceof Error?b.message:"Failed to load form data."),v([]),x([]),z([])}finally{if(!a)return;p(!1)}}}(),()=>{a=!1}},[n]);let ad=q||o;return(0,b.jsx)(g.RequireAuth,{requiredPermission:"parts.manage",children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(h.PageHeader,{title:"New part",description:"Create a new inventory part.",actions:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(j.Button,{variant:"outline",size:"sm",onClick:()=>{"string"==typeof n&&0!==n.length&&a.push(`/app/${n}/parts`)},children:"Cancel"}),(0,b.jsx)(j.Button,{variant:"primary",size:"sm",type:"submit",form:"rb_part_new_form",disabled:ad,children:q?"Saving...":"Save"})]})}),s?(0,b.jsx)("div",{className:"text-sm text-red-600",children:s}):null,(0,b.jsx)(i.Card,{className:"shadow-none",children:(0,b.jsx)(i.CardContent,{className:"pt-5",children:(0,b.jsxs)("form",{id:"rb_part_new_form",className:"space-y-4",onSubmit:ac,children:[(0,b.jsx)(l.FormRow,{label:"Name",fieldId:"part_name",required:!0,children:(0,b.jsx)(k.Input,{id:"part_name",value:A,onChange:a=>B(a.target.value),disabled:ad})}),(0,b.jsx)(l.FormRow,{label:"SKU",fieldId:"part_sku",children:(0,b.jsx)(k.Input,{id:"part_sku",value:C,onChange:a=>D(a.target.value),disabled:ad})}),(0,b.jsx)(l.FormRow,{label:"Manufacturing code",fieldId:"part_manufacturing_code",children:(0,b.jsx)(k.Input,{id:"part_manufacturing_code",value:I,onChange:a=>J(a.target.value),disabled:ad})}),(0,b.jsx)(l.FormRow,{label:"Stock code",fieldId:"part_stock_code",children:(0,b.jsx)(k.Input,{id:"part_stock_code",value:K,onChange:a=>L(a.target.value),disabled:ad})}),(0,b.jsx)(l.FormRow,{label:"Part type",fieldId:"part_type",children:(0,b.jsxs)("select",{id:"part_type",className:"w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)]",value:E??"",onChange:a=>{let b=a.target.value;if(!b)return void F(null);let c=Number(b);F(Number.isFinite(c)?c:null)},disabled:ad,children:[(0,b.jsx)("option",{value:"",children:"(none)"}),u.slice().sort((a,b)=>a.name.localeCompare(b.name)).map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]})}),(0,b.jsx)(l.FormRow,{label:"Part brand",fieldId:"part_brand",children:(0,b.jsxs)("select",{id:"part_brand",className:"w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)]",value:G??"",onChange:a=>{let b=a.target.value;if(!b)return void H(null);let c=Number(b);H(Number.isFinite(c)?c:null)},disabled:ad,children:[(0,b.jsx)("option",{value:"",children:"(none)"}),w.slice().sort((a,b)=>a.name.localeCompare(b.name)).map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]})}),(0,b.jsx)(l.FormRow,{label:"Price",fieldId:"part_price",children:(0,b.jsx)(k.Input,{id:"part_price",value:M,onChange:a=>N(a.target.value),disabled:ad,inputMode:"decimal"})}),(0,b.jsx)(l.FormRow,{label:"Tax",fieldId:"part_tax",children:(0,b.jsxs)("select",{id:"part_tax",className:"w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)]",value:O??"",onChange:a=>{let b=a.target.value;if(!b)return void P(null);let c=Number(b);P(Number.isFinite(c)?c:null)},disabled:ad,children:[(0,b.jsx)("option",{value:"",children:"(none)"}),y.slice().sort((a,b)=>a.name.localeCompare(b.name)).map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]})}),(0,b.jsx)(l.FormRow,{label:"Warranty",fieldId:"part_warranty",children:(0,b.jsx)(k.Input,{id:"part_warranty",value:Q,onChange:a=>R(a.target.value),disabled:ad})}),(0,b.jsx)(l.FormRow,{label:"Capacity",fieldId:"part_capacity",children:(0,b.jsx)(k.Input,{id:"part_capacity",value:S,onChange:a=>T(a.target.value),disabled:ad})}),(0,b.jsx)(l.FormRow,{label:"Core features",fieldId:"part_core_features",children:(0,b.jsx)("textarea",{id:"part_core_features",className:"w-full min-h-[96px] rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)]",value:U,onChange:a=>V(a.target.value),disabled:ad})}),(0,b.jsx)(l.FormRow,{label:"Installation charges",fieldId:"part_installation_charges",children:(0,b.jsx)(k.Input,{id:"part_installation_charges",value:W,onChange:a=>X(a.target.value),disabled:ad,inputMode:"decimal"})}),(0,b.jsx)(l.FormRow,{label:"Installation message",fieldId:"part_installation_message",children:(0,b.jsx)(k.Input,{id:"part_installation_message",value:Y,onChange:a=>Z(a.target.value),disabled:ad})}),(0,b.jsx)(l.FormRow,{label:"Stock",fieldId:"part_stock",children:(0,b.jsx)(k.Input,{id:"part_stock",value:$,onChange:a=>_(a.target.value),disabled:ad,inputMode:"numeric"})}),(0,b.jsxs)("div",{className:"grid gap-1 sm:grid-cols-[220px_1fr] sm:gap-4",children:[(0,b.jsx)("div",{className:"sm:pt-2",children:(0,b.jsx)("span",{className:"block text-sm font-medium text-[var(--rb-text)]",children:"Active"})}),(0,b.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,b.jsx)("input",{type:"checkbox",checked:aa,onChange:a=>ab(a.target.checked),disabled:ad}),"Enabled"]})]})]})})})]})})}a.s(["default",()=>m])}];

//# sourceMappingURL=frontend_src_ab21acdf._.js.map