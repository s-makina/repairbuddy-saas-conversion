module.exports=[51152,a=>{"use strict";var b=a.i(57850),c=a.i(45056),d=a.i(93609),e=a.i(59050),f=a.i(34793),g=a.i(91601),h=a.i(75458),i=a.i(648),j=a.i(97867),k=a.i(29054),l=a.i(90319),m=a.i(94703),n=a.i(34075),o=a.i(71513),p=a.i(49604),q=a.i(33183),r=a.i(55825),s=a.i(7322),t=a.i(67744);function u(){let a=(0,h.useAuth)(),u=(0,d.useRouter)(),v=(0,d.useParams)(),w=v.business??v.tenant,x=(0,c.useMemo)(()=>{let a=new Date,b=String(a.getFullYear()),c=String(a.getMonth()+1).padStart(2,"0"),d=String(a.getDate()).padStart(2,"0"),e=String(a.getHours()).padStart(2,"0"),f=String(a.getMinutes()).padStart(2,"0"),g=String(a.getSeconds()).padStart(2,"0");return`RB-${b}${c}${d}-${e}${f}${g}`},[]),[y,z]=(0,c.useState)(!0),[A,B]=(0,c.useState)(!1),[C,D]=(0,c.useState)(null),[E,F]=(0,c.useState)(1),[G,H]=(0,c.useState)(""),[I,J]=(0,c.useState)(""),[K,L]=(0,c.useState)(""),[M,N]=(0,c.useState)(""),[O,P]=(0,c.useState)(null),[Q,R]=(0,c.useState)(null),[S,T]=(0,c.useState)("existing"),[U,V]=(0,c.useState)(""),[W,X]=(0,c.useState)(""),[Y,Z]=(0,c.useState)(""),[$,_]=(0,c.useState)(""),[aa,ab]=(0,c.useState)(""),[ac,ad]=(0,c.useState)(""),[ae,af]=(0,c.useState)(""),[ag,ah]=(0,c.useState)(""),[ai,aj]=(0,c.useState)(""),[ak,al]=(0,c.useState)(""),[am,an]=(0,c.useState)(!1),[ao,ap]=(0,c.useState)(null),[aq,ar]=(0,c.useState)([{device_id:null,option:null,serial:"",pin:"",notes:"",extra_fields:[]}]),[as,at]=(0,c.useState)(""),[au,av]=(0,c.useState)(""),[aw,ax]=(0,c.useState)(""),[ay,az]=(0,c.useState)(""),[aA,aB]=(0,c.useState)(""),[aC,aD]=(0,c.useState)(""),[aE,aF]=(0,c.useState)(null),[aG,aH]=(0,c.useState)([]),[aI,aJ]=(0,c.useState)([]),[aK,aL]=(0,c.useState)(null),[aM,aN]=(0,c.useState)([]),[aO,aP]=(0,c.useState)(!1),[aQ,aR]=(0,c.useState)(null),[aS,aT]=(0,c.useState)(""),[aU,aV]=(0,c.useState)(""),[aW,aX]=(0,c.useState)(""),[aY,aZ]=(0,c.useState)(""),[a$,a_]=(0,c.useState)("internal"),[a0,a1]=(0,c.useState)(null),[a2,a3]=(0,c.useState)([]),[a4,a5]=(0,c.useState)([]),[a6,a7]=(0,c.useState)([]),[a8,a9]=(0,c.useState)([]),[ba,bb]=(0,c.useState)([]),[bc,bd]=(0,c.useState)(!1),[be,bf]=(0,c.useState)(null),[bg,bh]=(0,c.useState)(""),[bi,bj]=(0,c.useState)(""),[bk,bl]=(0,c.useState)(""),[bm,bn]=(0,c.useState)(""),[bo,bp]=(0,c.useState)(""),[bq,br]=(0,c.useState)(""),[bs,bt]=(0,c.useState)(!1),[bu,bv]=(0,c.useState)(null),[bw,bx]=(0,c.useState)(""),[by,bz]=(0,c.useState)(""),[bA,bB]=(0,c.useState)(""),[bC,bD]=(0,c.useState)(""),[bE,bF]=(0,c.useState)(!1),[bG,bH]=(0,c.useState)(!1),[bI,bJ]=(0,c.useState)(null),[bK,bL]=(0,c.useState)(null),[bM,bN]=(0,c.useState)("1"),[bO,bP]=(0,c.useState)(""),[bQ,bR]=(0,c.useState)(null),[bS,bT]=(0,c.useState)(null),[bU,bV]=(0,c.useState)(null),[bW,bX]=(0,c.useState)("1"),[bY,bZ]=(0,c.useState)(""),[b$,b_]=(0,c.useState)(null),[b0,b1]=(0,c.useState)([]),[b2,b3]=(0,c.useState)([]),[b4,b5]=(0,c.useState)([]),[b6,b7]=(0,c.useState)([]),[b8,b9]=(0,c.useState)([]),[ca,cb]=(0,c.useState)([]),[cc,cd]=(0,c.useState)([]),[ce,cf]=(0,c.useState)([]),[cg,ch]=(0,c.useState)(!1),[ci,cj]=(0,c.useState)([]),[ck,cl]=(0,c.useState)(!1),[cm,cn]=(0,c.useState)("Pin"),[co,cp]=(0,c.useState)([]),[cq,cr]=(0,c.useState)(!1),[cs,ct]=(0,c.useState)(null),[cu,cv]=(0,c.useState)(""),[cw,cx]=(0,c.useState)(""),[cy,cz]=(0,c.useState)([]),[cA,cB]=(0,c.useState)(null),[cC,cD]=(0,c.useState)("existing"),[cE,cF]=(0,c.useState)([]);(0,c.useEffect)(()=>{let a=!0;return async function(){if("string"==typeof w&&0!==w.length){z(!0),D(null);try{let[b,c]=await Promise.all([(0,n.apiFetch)(`/api/${w}/app/repairbuddy/job-statuses`),(0,n.apiFetch)(`/api/${w}/app/repairbuddy/payment-statuses`)]);if(!a)return;let d=Array.isArray(b.job_statuses)?b.job_statuses:[],e=Array.isArray(c.payment_statuses)?c.payment_statuses:[];b7(d),b9(e);try{let b=await (0,n.apiFetch)(`/api/${w}/app/repairbuddy/devices?limit=10`);if(!a)return;cp(Array.isArray(b.devices)?b.devices:[])}catch{if(!a)return;cp([])}try{let b=await (0,n.apiFetch)(`/api/${w}/app/technicians?per_page=100&sort=name&dir=asc`);if(!a)return;cd(Array.isArray(b.users)?b.users:[])}catch{if(!a)return;cd([])}try{let b=await (0,n.apiFetch)(`/api/${w}/app/branches`);if(!a)return;cF(Array.isArray(b.branches)?b.branches:[])}catch{if(!a)return;cF([])}try{let b=await (0,p.getRepairBuddySettings)(String(w));if(!a)return;ch(!!b.settings?.general?.nextServiceDateEnabled),cl(!!b.settings?.devicesBrands?.enablePinCodeField);let c=b.settings?.devicesBrands?.labels,d=c&&"object"==typeof c&&"string"==typeof c.pin?String(c.pin).trim():"";cn(""!==d?d:"Pin");let e=b.settings?.devicesBrands?.additionalDeviceFields,f=(Array.isArray(e)?e:[]).map(a=>{let b="string"==typeof a.id?String(a.id):"",c="string"==typeof a.label?String(a.label):"";return b&&c?{key:b,label:c}:null}).filter(a=>!!a);cj(f)}catch{if(!a)return;ch(!1),cj([]),cl(!1),cn("Pin")}let f=d.find(a=>"new"===a.slug)?.slug??d.find(a=>"neworder"===a.slug)?.slug;J(f??(d.length>0?d[0].slug:"")),L("");try{let b=await (0,n.apiFetch)(`/api/${w}/app/clients?limit=200`);if(!a)return;cb(Array.isArray(b.clients)?b.clients:[])}catch{if(!a)return;cb([])}try{let b=await (0,n.apiFetch)(`/api/${w}/app/repairbuddy/parts?limit=200`);if(!a)return;let c=Array.isArray(b.parts)?b.parts:[];a3(c.map(a=>({id:a.id,name:a.name,code:a.manufacturing_code??"",capacity:a.capacity??""})))}catch{if(!a)return;a3([])}try{let b=await (0,n.apiFetch)(`/api/${w}/app/repairbuddy/part-types?limit=200`);if(!a)return;a9(Array.isArray(b.part_types)?b.part_types:[])}catch{if(!a)return;a9([])}try{let b=await (0,n.apiFetch)(`/api/${w}/app/repairbuddy/part-brands?limit=200`);if(!a)return;bb(Array.isArray(b.part_brands)?b.part_brands:[])}catch{if(!a)return;bb([])}try{let b=await (0,n.apiFetch)(`/api/${w}/app/repairbuddy/services?limit=200`);if(!a)return;let c=Array.isArray(b.services)?b.services:[];a5(c.map(a=>({id:a.id,name:a.name})))}catch{if(!a)return;a5([])}try{let b=await (0,n.apiFetch)(`/api/${w}/app/repairbuddy/service-types?limit=200`);if(!a)return;a7(Array.isArray(b.service_types)?b.service_types:[])}catch{if(!a)return;a7([])}}catch(b){if(!a)return;D(b instanceof Error?b.message:"Failed to load form data."),b7([]),b9([]),cb([]),cd([]),cF([]),ch(!1),cp([]),a3([]),a5([]),a7([]),a9([]),bb([])}finally{if(!a)return;z(!1)}}}(),()=>{a=!1}},[w]),(0,c.useEffect)(()=>{at(a=>""===a.trim()?x:a)},[x]);let cG=async a=>{if("string"!=typeof w||0===w.length)return[];try{let b=new URLSearchParams,c=a.trim();b.set("limit",c?"50":"10"),c&&b.set("q",c);let d=await (0,n.apiFetch)(`/api/${w}/app/repairbuddy/devices?${b.toString()}`);return(Array.isArray(d.devices)?d.devices:[]).map(a=>({value:a.id,label:a.model}))}catch{return[]}},cH=(0,c.useMemo)(()=>ca.slice().sort((a,b)=>`${a.name}`.localeCompare(`${b.name}`)),[ca]),cI=(0,c.useMemo)(()=>cH.map(a=>({value:a.id,label:a.email?`${a.name} (${a.email})`:a.name})),[cH]),cJ=(0,c.useMemo)(()=>co.slice().sort((a,b)=>`${a.model}`.localeCompare(`${b.model}`)).map(a=>({value:a.id,label:a.model})),[co]),cK=(0,c.useMemo)(()=>{let a=aq.map(a=>a.option).filter(a=>!!a&&"number"==typeof a?.value),b=new Map;for(let c of a)b.set(c.value,c);return Array.from(b.values())},[aq]),cL=(0,c.useMemo)(()=>a2.slice().sort((a,b)=>`${a.name}`.localeCompare(`${b.name}`)).map(a=>({value:a.id,label:a.name,code:a.code,capacity:a.capacity})),[a2]),cM=(0,c.useMemo)(()=>a4.slice().sort((a,b)=>`${a.name}`.localeCompare(`${b.name}`)).map(a=>({value:a.id,label:a.name})),[a4]),cN=(0,c.useMemo)(()=>cc.slice().sort((a,b)=>`${a.name}`.localeCompare(`${b.name}`)),[cc]),cO=(0,c.useMemo)(()=>cN.map(a=>({value:a.id,label:a.email?`${a.name} (${a.email})`:a.name})),[cN]),cP=(0,c.useMemo)(()=>{if(0===aG.length)return[];let a=new Set(aG);return cO.filter(b=>a.has(b.value))},[aG,cO]),cQ=(0,c.useMemo)(()=>"new"===cC?cA:cP.length>0?cP[0]:null,[cP,cC,cA]);(0,c.useMemo)(()=>ce.slice().sort((a,b)=>`${a.label}`.localeCompare(`${b.label}`)).map(a=>({value:a.id,label:a.serial?`${a.label} (Serial: ${a.serial})`:a.label})),[ce]),(0,c.useEffect)(()=>{let b=!0;return async function(){if("string"==typeof w&&0!==w.length){if("number"!=typeof O){cf([]),aJ([]),aL(null);return}if(!a.can("customer_devices.view")){cf([]),aJ([]),aL("You do not have permission to view customer devices.");return}try{let a=await (0,n.apiFetch)(`/api/${w}/app/repairbuddy/customer-devices?customer_id=${encodeURIComponent(String(O))}&limit=200`);if(!b)return;cf(Array.isArray(a.customer_devices)?a.customer_devices:[]),aL(null)}catch{if(!b)return;cf([]),aL("Failed to load customer devices.")}}}(),()=>{b=!1}},[a,O,w]);let cR=async a=>{if("string"!=typeof w||0===w.length)return[];try{let b=new URLSearchParams;b.set("limit","50");let c=a.trim();c&&b.set("query",c);let d=await (0,n.apiFetch)(`/api/${w}/app/clients?${b.toString()}`);return(Array.isArray(d.clients)?d.clients:[]).map(a=>({value:a.id,label:a.email?`${a.name} (${a.email})`:a.name}))}catch{return[]}};async function cS(a){if(a.preventDefault(),"string"!=typeof w||0===w.length||A)return;let b=a.nativeEvent,c=b?.submitter,d=c?.getAttribute?.("id")??"";if(3===E&&"rb_job_save"===d){D(null),B(!0);try{let a="new"===S;if(a){if(""===U.trim())return void D("Customer name is required.");if(""===W.trim())return void D("Customer email is required.")}let b=G.trim(),c={devices:aq.length>0?aq.filter(a=>"number"==typeof a.device_id).map(a=>({device_id:a.device_id,serial:""!==a.serial.trim()?a.serial.trim():null,pin:""!==a.pin.trim()?a.pin.trim():null,notes:""!==a.notes.trim()?a.notes.trim():null,extra_fields:Array.isArray(a.extra_fields)&&a.extra_fields.length>0?a.extra_fields.map(a=>({key:"string"==typeof a?.key?a.key:"",label:"string"==typeof a?.label?a.label:"",value_text:"string"==typeof a?.value_text?a.value_text:""})).filter(a=>a.key&&a.label):[]})):[],case_number:""!==as.trim()?as.trim():null,title:""!==b?b:null,status_slug:""!==I.trim()?I:null,payment_status_slug:""!==K.trim()?K:null,priority:""!==M.trim()?M.trim():null,customer_id:a||"number"!=typeof O?null:O,pickup_date:""!==au.trim()?au:null,delivery_date:""!==aw.trim()?aw:null,next_service_date:cg&&""!==ay.trim()?ay:null,case_detail:""!==aA.trim()?aA.trim():null,assigned_technician_id:aG.length>0?aG[0]:null,assigned_technician_ids:aG,job_devices:aI.length>0?aI.map(a=>({customer_device_id:a.customer_device_id,serial:""!==a.serial.trim()?a.serial.trim():null,notes:""!==a.notes.trim()?a.notes.trim():null})):[],wc_order_note:""!==aC.trim()?aC.trim():null};a&&(c.customer_create={name:U.trim(),email:W.trim(),phone:""!==Y.trim()?Y.trim():null,company:""!==$.trim()?$.trim():null,address_line1:""!==aa.trim()?aa.trim():null,address_line2:""!==ac.trim()?ac.trim():null,address_city:""!==ae.trim()?ae.trim():null,address_state:""!==ag.trim()?ag.trim():null,address_postal_code:""!==ai.trim()?ai.trim():null,address_country:""!==ak.trim()?ak.trim():null});let d=new FormData;d.append("payload_json",JSON.stringify(c)),aE&&d.append("job_file",aE);let e=await (0,n.apiFetch)(`/api/${w}/app/repairbuddy/jobs`,{method:"POST",body:d}),f=e.job?.id;if("number"==typeof f){try{for(let a of b2){let b=Math.round(Number(a.qty)),c=Number.isFinite(b)&&b>0?b:1,d=a.price.trim(),e=d.length>0?Number(d):NaN,g=Number.isFinite(e)?Math.round(100*e):void 0;await (0,n.apiFetch)(`/api/${w}/app/repairbuddy/jobs/${f}/items`,{method:"POST",body:{item_type:"service",ref_id:a.service_id,qty:c,..."number"==typeof g?{unit_price_amount_cents:g}:{},meta:{..."number"==typeof a.device_id?{device_id:a.device_id}:{}}}})}for(let a of b4){let b=a.name.trim();if(""===b)continue;let c=Math.round(Number(a.qty)),d=Number.isFinite(c)&&c>0?c:1,e=a.price.trim(),g=e.length>0?Number(e):NaN,h=Number.isFinite(g)?Math.round(100*g):void 0;"number"==typeof h&&await (0,n.apiFetch)(`/api/${w}/app/repairbuddy/jobs/${f}/items`,{method:"POST",body:{item_type:h<0?"discount":"fee",name:b,qty:d,unit_price_amount_cents:h}})}for(let a of b0){let b=Math.round(Number(a.qty)),c=Number.isFinite(b)&&b>0?b:1,d=a.price.trim(),e=d.length>0?Number(d):NaN,g=Number.isFinite(e)?Math.round(100*e):void 0;await (0,n.apiFetch)(`/api/${w}/app/repairbuddy/jobs/${f}/items`,{method:"POST",body:{item_type:"part",ref_id:a.part_id,qty:c,..."number"==typeof g?{unit_price_amount_cents:g}:{},meta:{..."number"==typeof a.device_id?{device_id:a.device_id}:{}}}})}}catch(a){o.notify.error(a instanceof n.ApiError?a.message:"Job created, but failed to attach items.")}o.notify.success("Job created."),u.replace(`/app/${w}/jobs/${f}`)}else o.notify.success("Job created."),u.replace(`/app/${w}/jobs`)}catch(a){a instanceof n.ApiError?D(a.message):D("Failed to create job.")}finally{B(!1)}}}let cT=A||y,cU=1===E,cV=2===E;return(0,b.jsx)(g.RequireAuth,{requiredPermission:"jobs.view",children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(i.PageHeader,{title:"New job",description:"Create a new repair job.",actions:(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(j.Button,{variant:"outline",size:"sm",onClick:()=>{"string"==typeof w&&0!==w.length&&u.push(`/app/${w}/jobs`)},disabled:A,children:"Cancel"})})}),C?(0,b.jsx)("div",{className:"text-sm text-red-600",children:C}):null,(0,b.jsx)(s.CustomerCreateModal,{open:am,title:"Add customer",className:"max-w-3xl",disabled:cT,error:ao,setError:ap,name:U,setName:V,email:W,setEmail:X,phone:Y,setPhone:Z,company:$,setCompany:_,addressLine1:aa,setAddressLine1:ab,addressLine2:ac,setAddressLine2:ad,addressCity:ae,setAddressCity:af,addressState:ag,setAddressState:ah,addressPostalCode:ai,setAddressPostalCode:aj,addressCountry:ak,setAddressCountry:al,onClose:()=>an(!1),onSave:({name:a,email:b,phone:c,company:d,address_line1:e,address_line2:f,address_city:g,address_state:h,address_postal_code:i,address_country:j})=>{T("new"),P(null),R({value:-1,label:`${a} (${b})`}),aJ([]),Z(c),_(d),ab(e??""),ad(f??""),af(g??""),ah(h??""),aj(i??""),al(j??""),an(!1)}}),(0,b.jsx)(m.Modal,{open:bG,title:"Add service",onClose:()=>{b_(null),bH(!1)},className:"max-w-3xl",footer:(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,b.jsx)(j.Button,{type:"button",variant:"outline",onClick:()=>{b_(null),bH(!1)},children:"Cancel"}),(0,b.jsx)(j.Button,{type:"button",variant:"primary",disabled:cT,onClick:()=>{if(!bS)return void b_("Please select a service.");if(!bU)return void b_("Please select a device.");let a=a4.find(a=>a.id===bS.value);if(!a)return void b_("Selected service not found.");let b=globalThis.crypto,c="function"==typeof b?.randomUUID?b.randomUUID():`js-${Date.now()}-${Math.random().toString(16).slice(2)}`;b3(b=>[{id:c,service_id:a.id,service:a,device_id:bU.value,qty:bW,price:bY},...b]),b_(null),bX("1"),bZ(""),bH(!1)},children:"Add"})]}),children:(0,b.jsxs)("div",{className:"space-y-4",children:[b$?(0,b.jsx)("div",{className:"text-sm text-red-600",children:b$}):null,(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Service"}),(0,b.jsx)(e.default,{instanceId:"job_service_select",inputId:"job_service_select",isSearchable:!0,isClearable:!0,options:cM,value:bS,onChange:a=>{b_(null),bT(a??null)},isDisabled:cT,placeholder:cM.length>0?"Search services...":"No services yet",classNamePrefix:"rb-select",styles:{control:a=>({...a,borderRadius:"var(--rb-radius-sm)",borderColor:"#d4d4d8",minHeight:40,boxShadow:"none"}),menu:a=>({...a,zIndex:50})}})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Device"}),(0,b.jsx)(e.default,{instanceId:"job_service_device_select",inputId:"job_service_device_select",isSearchable:!0,isClearable:!0,options:cK,value:bU,onChange:a=>{b_(null),bV(a??null)},isDisabled:cT,placeholder:cK.length>0?"Select device...":"No devices selected",classNamePrefix:"rb-select",styles:{control:a=>({...a,borderRadius:"var(--rb-radius-sm)",borderColor:"#d4d4d8",minHeight:40,boxShadow:"none"}),menu:a=>({...a,zIndex:50})}})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Qty"}),(0,b.jsx)(k.Input,{type:"number",min:0,value:bW,disabled:cT,onChange:a=>{b_(null),bX(a.target.value)}})]}),(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Price (optional override)"}),(0,b.jsx)(k.Input,{type:"number",min:0,step:"0.01",value:bY,disabled:cT,onChange:a=>{b_(null),bZ(a.target.value)}})]})]})]})}),(0,b.jsx)(m.Modal,{open:bE,title:"Add part",onClose:()=>{bR(null),bF(!1)},className:"max-w-3xl",footer:(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,b.jsx)(j.Button,{type:"button",variant:"outline",onClick:()=>{bR(null),bF(!1)},children:"Cancel"}),(0,b.jsx)(j.Button,{type:"button",variant:"primary",disabled:cT,onClick:()=>{if(!bI)return void bR("Please select a part.");if(!bK)return void bR("Please select a device.");let a=a2.find(a=>a.id===bI.value);if(!a)return void bR("Selected part not found.");let b=globalThis.crypto,c="function"==typeof b?.randomUUID?b.randomUUID():`jp-${Date.now()}-${Math.random().toString(16).slice(2)}`;b1(b=>[{id:c,part_id:a.id,part:a,device_id:bK.value,qty:bM,price:bO},...b]),bR(null),bN("1"),bP(""),bF(!1)},children:"Add"})]}),children:(0,b.jsxs)("div",{className:"space-y-4",children:[bQ?(0,b.jsx)("div",{className:"text-sm text-red-600",children:bQ}):null,(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Select part"}),(0,b.jsx)(e.default,{instanceId:"job_part_select",isSearchable:!0,isClearable:!0,options:cL,value:bI,onChange:a=>{bR(null),bJ(a??null)},isDisabled:cT,placeholder:cL.length>0?"Search parts...":"No parts yet",classNamePrefix:"rb-select",styles:{control:a=>({...a,borderRadius:"var(--rb-radius-sm)",borderColor:"#d4d4d8",minHeight:40,boxShadow:"none"}),menu:a=>({...a,zIndex:50})}})]}),(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Device"}),(0,b.jsx)(e.default,{instanceId:"job_part_device",isSearchable:!0,isClearable:!0,options:cK,value:bK,onChange:a=>{bR(null),bL(a??null)},isDisabled:cT,placeholder:cK.length>0?"Select device...":"No devices selected",classNamePrefix:"rb-select",styles:{control:a=>({...a,borderRadius:"var(--rb-radius-sm)",borderColor:"#d4d4d8",minHeight:40,boxShadow:"none"}),menu:a=>({...a,zIndex:50})}})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Qty"}),(0,b.jsx)(k.Input,{type:"number",min:0,value:bM,disabled:cT,onChange:a=>{bR(null),bN(a.target.value)}})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Price"}),(0,b.jsx)(k.Input,{type:"number",min:0,step:"0.01",value:bO,disabled:cT,onChange:a=>{bR(null),bP(a.target.value)}})]})]})]})}),(0,b.jsx)(m.Modal,{open:bs,title:"Create new service",onClose:()=>{bv(null),bt(!1)},className:"max-w-2xl",footer:(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,b.jsx)(j.Button,{type:"button",variant:"outline",onClick:()=>{bv(null),bt(!1)},children:"Cancel"}),(0,b.jsx)(j.Button,{type:"button",variant:"primary",disabled:cT,onClick:async()=>{if(A||"string"!=typeof w||0===w.length)return;let a=bw.trim();if(0===a.length)return void bv("Service name is required.");let b=bC.trim(),c=b.length>0?Number(b):NaN,d=Number.isFinite(c)?Math.round(100*c):null;if(b.length>0&&null===d)return void bv("Base price is invalid.");let e=by.trim(),f=""!==e?Number(e):NaN,g=Number.isFinite(f)&&f>0?Math.trunc(f):null;if(a6.length>0&&null===g)return void bv("Service type is required.");let h=bA.trim();B(!0),bv(null);try{let b=(await (0,n.apiFetch)(`/api/${w}/app/repairbuddy/services`,{method:"POST",body:{name:a,..."number"==typeof g?{service_type_id:g}:{},...""!==h?{service_code:h}:{},..."number"==typeof d?{base_price_amount_cents:d}:{}}})).service;if(!b||"number"!=typeof b.id)return void bv("Failed to create service.");let c={id:b.id,name:b.name};a5(a=>[c,...a.filter(a=>a.id!==c.id)]),bT({value:c.id,label:c.name}),bx(""),bz(""),bB(""),bD(""),bt(!1),o.notify.success("Service created.")}catch(a){a instanceof n.ApiError?bv(a.message):bv("Failed to create service.")}finally{B(!1)}},children:"Save"})]}),children:(0,b.jsxs)("div",{className:"space-y-4",children:[bu?(0,b.jsx)("div",{className:"text-sm text-red-600",children:bu}):null,(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Service name"}),(0,b.jsx)(k.Input,{value:bw,onChange:a=>bx(a.target.value),disabled:cT})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Select type"}),(0,b.jsxs)("select",{className:"w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)]",value:by,onChange:a=>{bv(null),bz(a.target.value)},disabled:cT||0===a6.length,children:[(0,b.jsx)("option",{value:"",children:a6.length>0?"Select type...":"No types available"}),a6.map(a=>(0,b.jsx)("option",{value:String(a.id),children:a.name},a.id))]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Service code"}),(0,b.jsx)(k.Input,{value:bA,onChange:a=>{bv(null),bB(a.target.value)},disabled:cT})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Service price"}),(0,b.jsx)(k.Input,{type:"number",min:0,step:"0.01",value:bC,onChange:a=>{bv(null),bD(a.target.value)},disabled:cT})]})]})]})}),(0,b.jsx)(m.Modal,{open:bc,title:"Create new part",onClose:()=>{bf(null),bd(!1)},className:"max-w-2xl",footer:(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,b.jsx)(j.Button,{type:"button",variant:"outline",onClick:()=>{bf(null),bd(!1)},children:"Cancel"}),(0,b.jsx)(j.Button,{type:"button",variant:"primary",disabled:cT,onClick:async()=>{if(A||"string"!=typeof w||0===w.length)return;let a=bg.trim();if(0===a.length)return void bf("Part name is required.");let b=bi.trim();if(0===b.length)return void bf("Part price is required.");let c=Number(b),d=Number.isFinite(c)?Math.round(100*c):null;if(null===d||d<0)return void bf("Part price is invalid.");let e=bm.trim(),f=""!==e?Number(e):NaN,g=Number.isFinite(f)&&f>0?Math.trunc(f):null;if(a8.length>0&&null===g)return void bf("Part type is required.");let h=bk.trim(),i=""!==h?Number(h):NaN,j=Number.isFinite(i)&&i>0?Math.trunc(i):null;if(ba.length>0&&null===j)return void bf("Part brand is required.");let k=bo.trim(),l=bq.trim();B(!0),bf(null);try{let b=(await (0,n.apiFetch)(`/api/${w}/app/repairbuddy/parts`,{method:"POST",body:{name:a,price_amount_cents:d,..."number"==typeof g?{part_type_id:g}:{},..."number"==typeof j?{part_brand_id:j}:{},manufacturing_code:""!==k?k:null,stock_code:""!==l?l:null}})).part;if(!b||"number"!=typeof b.id)return void bf("Failed to create part.");let c={id:b.id,name:b.name,code:b.manufacturing_code??"",capacity:b.capacity??""};a3(a=>[c,...a.filter(a=>a.id!==c.id)]),bJ({value:c.id,label:c.name,code:c.code,capacity:c.capacity}),bh(""),bj(""),bl(""),bn(""),bp(""),br(""),bd(!1),o.notify.success("Part created.")}catch(a){a instanceof n.ApiError?bf(a.message):bf("Failed to create part.")}finally{B(!1)}},children:"Save"})]}),children:(0,b.jsxs)("div",{className:"space-y-4",children:[be?(0,b.jsx)("div",{className:"text-sm text-red-600",children:be}):null,(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Part name"}),(0,b.jsx)(k.Input,{value:bg,onChange:a=>{bf(null),bh(a.target.value)},disabled:cT})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Part price"}),(0,b.jsx)(k.Input,{type:"number",min:0,step:"0.01",value:bi,onChange:a=>{bf(null),bj(a.target.value)},disabled:cT})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Select brand"}),(0,b.jsxs)("select",{className:"w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)]",value:bk,onChange:a=>{bf(null),bl(a.target.value)},disabled:cT||0===ba.length,children:[(0,b.jsx)("option",{value:"",children:ba.length>0?"Select brand...":"No brands available"}),ba.map(a=>(0,b.jsx)("option",{value:String(a.id),children:a.name},a.id))]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Select type"}),(0,b.jsxs)("select",{className:"w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)]",value:bm,onChange:a=>{bf(null),bn(a.target.value)},disabled:cT||0===a8.length,children:[(0,b.jsx)("option",{value:"",children:a8.length>0?"Select type...":"No types available"}),a8.map(a=>(0,b.jsx)("option",{value:String(a.id),children:a.name},a.id))]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Manufacturing code"}),(0,b.jsx)(k.Input,{value:bo,onChange:a=>{bf(null),bp(a.target.value)},disabled:cT})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Stock code"}),(0,b.jsx)(k.Input,{value:bq,onChange:a=>{bf(null),br(a.target.value)},disabled:cT})]})]})]})}),(0,b.jsx)(m.Modal,{open:aO,title:"Add extra field",onClose:()=>{aR(null),aP(!1)},className:"max-w-3xl",footer:(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,b.jsx)(j.Button,{type:"button",variant:"outline",onClick:()=>{aR(null),aP(!1)},children:"Cancel"}),(0,b.jsx)(j.Button,{type:"button",onClick:()=>{let a=aU.trim(),b=aW.trim();""===a?aR("Field label is required."):""===b?aR("Field data is required."):(aN(c=>[...c,{id:String(Date.now()),datetime:aS,label:a,data:b,description:aY.trim(),visibility:a$,file:a0}]),aR(null),aT(""),aV(""),aX(""),aZ(""),a_("internal"),a1(null),aP(!1))},children:"Save"})]}),children:(0,b.jsxs)("div",{className:"space-y-4",children:[aQ?(0,b.jsx)("div",{className:"text-sm text-red-600",children:aQ}):null,(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Date & time"}),(0,b.jsx)(k.Input,{type:"datetime-local",value:aS,onChange:a=>aT(a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Visibility"}),(0,b.jsxs)("select",{className:"w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)]",value:a$,onChange:a=>a_(a.target.value),children:[(0,b.jsx)("option",{value:"internal",children:"Internal"}),(0,b.jsx)("option",{value:"customer",children:"Customer"})]})]}),(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Field label"}),(0,b.jsx)(k.Input,{value:aU,onChange:a=>aV(a.target.value)})]}),(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Field data"}),(0,b.jsx)("textarea",{value:aW,onChange:a=>aX(a.target.value),rows:3,className:"w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)]"})]}),(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Field description"}),(0,b.jsx)("textarea",{value:aY,onChange:a=>aZ(a.target.value),rows:2,className:"w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)]"})]}),(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"File"}),(0,b.jsx)(k.Input,{type:"file",onChange:a=>{a1(a.target.files?.[0]??null)}})]})]})]})}),(0,b.jsx)(m.Modal,{open:cq,title:"Add technician",onClose:()=>{ct(null),cr(!1)},footer:(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,b.jsx)(j.Button,{type:"button",variant:"outline",onClick:()=>{ct(null),cr(!1)},children:"Cancel"}),(0,b.jsx)(j.Button,{type:"button",disabled:cT,onClick:async()=>{if(A||"string"!=typeof w||0===w.length)return;let a=cu.trim(),b=cw.trim();if(""===a)return void ct("Technician name is required.");if(""===b)return void ct("Technician email is required.");let c=cy.filter(a=>"number"==typeof a&&a>0);if(0===c.length)return void ct("Please select at least one shop.");B(!0),ct(null);try{let d=(await (0,n.apiFetch)(`/api/${w}/app/technicians`,{method:"POST",body:{name:a,email:b,branch_ids:c}})).user;if(!d||"number"!=typeof d.id)return void ct("Failed to create technician.");cd(a=>[d,...a.filter(a=>a.id!==d.id)]),cD("existing"),cB(null),aH([d.id]),cv(""),cx(""),cz([]),cr(!1),o.notify.success("Technician created.")}catch(a){a instanceof n.ApiError?ct(a.message):ct("Failed to create technician.")}finally{B(!1)}},children:"Save"})]}),children:(0,b.jsxs)("div",{className:"space-y-4",children:[cs?(0,b.jsx)("div",{className:"text-sm text-red-600",children:cs}):null,(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Name"}),(0,b.jsx)(k.Input,{value:cu,onChange:a=>{ct(null),cv(a.target.value)},disabled:cT})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Email"}),(0,b.jsx)(k.Input,{value:cw,onChange:a=>{ct(null),cx(a.target.value)},disabled:cT})]}),(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Shops"}),(0,b.jsxs)("select",{multiple:!0,className:"w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)]",value:cy.map(String),onChange:a=>{ct(null),cz(Array.from(a.target.selectedOptions).map(a=>Number(a.value)).filter(a=>Number.isFinite(a)&&a>0).map(a=>Math.trunc(a)))},disabled:cT||0===cE.length,children:[0===cE.length?(0,b.jsx)("option",{value:"",children:"No shops available"}):null,cE.map(a=>(0,b.jsx)("option",{value:String(a.id),children:a.name},a.id))]}),(0,b.jsx)("div",{className:"mt-1 text-xs text-zinc-500",children:"Hold Ctrl / Cmd to select multiple shops."})]})]})]})}),(0,b.jsx)("form",{id:"rb_job_new_form",className:"space-y-6",onSubmit:cS,children:(0,b.jsx)(q.WizardShell,{steps:[{id:1,navTitle:"Customer & devices",navDescription:"Case, dates, customer, technician, description, devices.",pageTitle:"Customer & devices",pageDescription:"Enter the customer, technician, description and devices.",footerTitle:"Customer & devices"},{id:2,navTitle:"Job Items and services",navDescription:"Attach extra fields and files for this job.",pageTitle:"Job Items and services",pageDescription:"Attach extra fields and files for the job.",footerTitle:"Job Items and services"},{id:3,navTitle:"Order information",navDescription:"Status, payment, priority, notes.",pageTitle:"Order information",pageDescription:"Finalize status, payment, priority and notes.",footerTitle:"Order information"}],step:E,disabled:cT,sidebarTitle:"Job steps",sidebarDescription:"Complete the steps to create the job.",sidebarAriaLabel:"Job steps",onStepChange:a=>{D(null),F(a)},footerRight:(0,b.jsx)(j.Button,{id:"rb_job_save",variant:"primary",disabled:cT,type:"submit",children:A?"Saving...":"Save"}),children:cU?(0,b.jsxs)("div",{className:"space-y-5",children:[(0,b.jsx)(l.FormRow,{label:"Case number",fieldId:"job_case_number",children:(0,b.jsx)(k.Input,{id:"job_case_number",value:as,onChange:a=>at(a.target.value),disabled:cT})}),(0,b.jsx)(l.FormRow,{label:"Dates",fieldId:"job_dates",children:(0,b.jsxs)("div",{className:cg?"grid grid-cols-1 gap-3 md:grid-cols-3":"grid grid-cols-1 gap-3 md:grid-cols-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Pickup date"}),(0,b.jsx)(k.Input,{id:"job_pickup_date",type:"date",value:au,onChange:a=>av(a.target.value),disabled:cT})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Delivery date"}),(0,b.jsx)(k.Input,{id:"job_delivery_date",type:"date",value:aw,onChange:a=>ax(a.target.value),disabled:cT})]}),cg?(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Next service date"}),(0,b.jsx)(k.Input,{id:"job_next_service_date",type:"date",value:ay,onChange:a=>az(a.target.value),disabled:cT})]}):null]})}),(0,b.jsx)(l.FormRow,{label:"Customer",fieldId:"job_customer",children:(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-start gap-2",children:[(0,b.jsx)("div",{className:"min-w-0 flex-1",children:(0,b.jsx)(f.default,{inputId:"job_customer",instanceId:"job_customer",cacheOptions:!0,defaultOptions:cI,loadOptions:cR,isClearable:!0,isSearchable:!0,value:Q,onChange:a=>{let b=a??null;T("existing"),R(b),P("number"==typeof b?.value&&b.value>0?b.value:null),aJ([])},isDisabled:cT,placeholder:"Search customers...",classNamePrefix:"rb-select",styles:{control:a=>({...a,borderRadius:"var(--rb-radius-sm)",borderColor:"#d4d4d8",minHeight:40,boxShadow:"none"}),menu:a=>({...a,zIndex:50})}})}),(0,b.jsx)(j.Button,{type:"button",variant:"primary",size:"md",className:"w-10 px-0",disabled:cT,onClick:()=>{ap(null),an(!0)},children:"+"})]}),"new"===S?(0,b.jsx)("div",{className:"text-xs text-zinc-600",children:"This job will create a new customer."}):null]})}),(0,b.jsx)(l.FormRow,{label:"Technician",fieldId:"job_technician",children:(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-start gap-2",children:[(0,b.jsx)("div",{className:"min-w-0 flex-1",children:(0,b.jsx)(e.default,{inputId:"job_technician",instanceId:"job_technician",isSearchable:!0,isClearable:!0,options:cO,value:cQ,onChange:a=>{let b=a??null;cD("existing"),cB(null),aH("number"==typeof b?.value&&b.value>0?[b.value]:[])},isDisabled:cT||0===cO.length,placeholder:cO.length>0?"Select technician...":"No technicians available",classNamePrefix:"rb-select",styles:{control:a=>({...a,borderRadius:"var(--rb-radius-sm)",borderColor:"#d4d4d8",minHeight:40,boxShadow:"none"}),menu:a=>({...a,zIndex:50})}})}),(0,b.jsx)(j.Button,{type:"button",variant:"primary",size:"md",className:"w-10 px-0",disabled:cT,onClick:()=>{ct(null),cr(!0)},children:"+"})]}),"new"===cC?(0,b.jsx)("div",{className:"text-xs text-zinc-600",children:"This job will create a new technician."}):null]})}),(0,b.jsx)(l.FormRow,{label:"Job description",fieldId:"job_case_detail",children:(0,b.jsx)("textarea",{id:"job_case_detail",value:aA,onChange:a=>aB(a.target.value),disabled:cT,rows:4,placeholder:"Enter job description.",className:"w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)]"})}),(0,b.jsx)(l.FormRow,{label:"Add devices to this job",fieldId:"job_devices_admin",children:(0,b.jsx)(r.DevicesAdminEditor,{value:aq,onChange:a=>ar(a),deviceOptions:cJ,loadDeviceOptions:cG,disabled:cT,idPrefix:"job",showPin:ck,serialLabel:"Device ID / IMEI",pinLabel:cm,notesLabel:"Device note",addButtonLabel:"Add device",additionalFields:ci,createEmptyRow:()=>({device_id:null,option:null,serial:"",pin:"",notes:"",extra_fields:ci.map(a=>({key:a.key,label:a.label,value_text:""}))})})})]}):cV?(0,b.jsxs)("div",{className:"space-y-5",children:[(0,b.jsx)(t.ItemsStep,{deviceContextOptions:cK.map(a=>({value:a.value,label:a.label})),disabled:cT,services:b2,setServices:b3,parts:b0,setParts:b1,otherItems:b4,setOtherItems:b5,onAddService:()=>{b_(null),!bU&&cK.length>0&&bV(cK[0]),bH(!0)},serviceAddLabel:"Add service",onCreateService:()=>{bv(null),bt(!0)},serviceCreateLabel:"Create new service",onAddPart:()=>{bR(null),!bK&&cK.length>0&&bL(cK[0]),bF(!0)},partAddLabel:"Add part",onCreatePart:()=>{bf(null),bd(!0)},partCreateLabel:"Create new part",otherItemsTitle:"Other items",otherItemsDescription:"Add custom line items like rent, used cable, etc.",otherItemsAddLabel:"Add other item",createOtherItem:()=>({id:"u">typeof crypto&&"randomUUID"in crypto?crypto.randomUUID():`oi-${Date.now()}-${Math.random().toString(16).slice(2)}`,name:"",qty:"1",price:""}),otherItemNamePlaceholder:"e.g. Rent, Used cable",otherItemPricePlaceholder:"e.g. 10.00 (use -10.00 for discount)"}),(0,b.jsx)("div",{className:"rounded-[var(--rb-radius-md)] border border-[var(--rb-border)] bg-white px-4 py-3",children:(0,b.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:"Attach Fields & Files"}),(0,b.jsx)("div",{className:"mt-1 text-xs text-zinc-600",children:"Add extra fields and optionally attach a file."})]}),(0,b.jsx)("div",{children:(0,b.jsx)(j.Button,{type:"button",variant:"outline",size:"sm",disabled:cT,onClick:()=>{aR(null),aP(!0)},children:"Add extra field"})})]})}),aM.length>0?(0,b.jsx)("div",{className:"space-y-2",children:aM.map(a=>(0,b.jsxs)("div",{className:"flex flex-col gap-2 rounded-[var(--rb-radius-md)] border border-[var(--rb-border)] bg-white px-4 py-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("div",{className:"truncate text-sm font-semibold text-[var(--rb-text)]",children:a.label}),(0,b.jsxs)("div",{className:"mt-1 text-xs text-zinc-600",children:[a.datetime?a.datetime:"—",(0,b.jsx)("span",{className:"mx-2",children:"•"}),a.visibility,a.file?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("span",{className:"mx-2",children:"•"}),a.file.name]}):null]}),a.description?(0,b.jsx)("div",{className:"mt-1 text-xs text-zinc-500",children:a.description}):null]}),(0,b.jsx)("div",{className:"flex items-center gap-2",children:(0,b.jsx)(j.Button,{type:"button",variant:"outline",size:"sm",disabled:cT,onClick:()=>{aN(b=>b.filter(b=>b.id!==a.id))},children:"Remove"})})]},a.id))}):(0,b.jsx)("div",{className:"text-sm text-zinc-600",children:"No extra fields added yet."})]}):(0,b.jsxs)("div",{className:"space-y-5",children:[(0,b.jsx)(l.FormRow,{label:"Status",fieldId:"job_status",required:!0,children:(0,b.jsx)("select",{id:"job_status",className:"w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)]",value:I,onChange:a=>J(a.target.value),disabled:cT||0===b6.length,children:b6.map(a=>(0,b.jsx)("option",{value:a.slug,children:a.label},a.slug))})}),(0,b.jsx)(l.FormRow,{label:"Payment status",fieldId:"job_payment",children:(0,b.jsxs)("select",{id:"job_payment",className:"w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)]",value:K,onChange:a=>L(a.target.value),disabled:cT||0===b8.length,children:[(0,b.jsx)("option",{value:"",children:"—"}),b8.map(a=>(0,b.jsx)("option",{value:a.slug,children:a.label},a.slug))]})}),(0,b.jsx)(l.FormRow,{label:"Priority",fieldId:"job_priority",children:(0,b.jsxs)("select",{id:"job_priority",className:"w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)]",value:M,onChange:a=>N(a.target.value),disabled:cT,children:[(0,b.jsx)("option",{value:"",children:"—"}),(0,b.jsx)("option",{value:"low",children:"Low"}),(0,b.jsx)("option",{value:"normal",children:"Normal"}),(0,b.jsx)("option",{value:"high",children:"High"}),(0,b.jsx)("option",{value:"urgent",children:"Urgent"})]})}),(0,b.jsx)(l.FormRow,{label:"Order notes",fieldId:"job_order_note",description:"Visible to customer.",children:(0,b.jsx)("textarea",{id:"job_order_note",value:aC,onChange:a=>aD(a.target.value),disabled:cT,rows:3,placeholder:"Add a note for the customer...",className:"w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)]"})})]})})})]})})}a.s(["default",()=>u])}];

//# sourceMappingURL=frontend_src_app_app_%5Btenant%5D_jobs_new_page_tsx_454ddb4d._.js.map