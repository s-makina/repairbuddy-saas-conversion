module.exports=[74412,a=>{"use strict";var b=a.i(57850),c=a.i(93609),d=a.i(91601),e=a.i(45056),f=a.i(59050),g=a.i(34793),h=a.i(75458),i=a.i(648),j=a.i(97867),k=a.i(29054),l=a.i(90319),m=a.i(94703),n=a.i(34075),o=a.i(71513),p=a.i(33183),q=a.i(55825),r=a.i(7322),s=a.i(67744),t=a.i(49604);function u(a){return"u">typeof crypto&&"randomUUID"in crypto?`${a}-${crypto.randomUUID()}`:`${a}-${Date.now()}-${Math.random().toString(16).slice(2)}`}function v({tenantSlug:a}){let d=(0,h.useAuth)(),v=(0,c.useRouter)(),w=(0,e.useMemo)(()=>{let a=new Date,b=String(a.getFullYear()),c=String(a.getMonth()+1).padStart(2,"0"),d=String(a.getDate()).padStart(2,"0"),e=String(a.getHours()).padStart(2,"0"),f=String(a.getMinutes()).padStart(2,"0"),g=String(a.getSeconds()).padStart(2,"0");return`RB-${b}${c}${d}-${e}${f}${g}`},[]),[x,y]=(0,e.useState)(!0),[z,A]=(0,e.useState)(!1),[B,C]=(0,e.useState)(null),[D,E]=(0,e.useState)(1),[F,G]=(0,e.useState)(""),[H,I]=(0,e.useState)(w),[J,K]=(0,e.useState)(""),[L,M]=(0,e.useState)(""),[N,O]=(0,e.useState)(""),[P,Q]=(0,e.useState)(null),[R,S]=(0,e.useState)(null),[T,U]=(0,e.useState)("existing"),[V,W]=(0,e.useState)(""),[X,Y]=(0,e.useState)(""),[Z,$]=(0,e.useState)(""),[_,aa]=(0,e.useState)(""),[ab,ac]=(0,e.useState)(!1),[ad,ae]=(0,e.useState)(null),[af,ag]=(0,e.useState)(null),[ah,ai]=(0,e.useState)([{device_id:null,option:null,serial:"",pin:"",notes:"",extra_fields:[]}]),[aj,ak]=(0,e.useState)([]),[al,am]=(0,e.useState)([]),[an,ao]=(0,e.useState)([]),[ap,aq]=(0,e.useState)(!1),[ar,as]=(0,e.useState)("Pin"),[at,au]=(0,e.useState)([]),[av,aw]=(0,e.useState)([]),[ax,ay]=(0,e.useState)([]),[az,aA]=(0,e.useState)([]),[aB,aC]=(0,e.useState)([]),[aD,aE]=(0,e.useState)(!1),[aF,aG]=(0,e.useState)(null),[aH,aI]=(0,e.useState)(null),[aJ,aK]=(0,e.useState)(null),[aL,aM]=(0,e.useState)("1"),[aN,aO]=(0,e.useState)(""),[aP,aQ]=(0,e.useState)(!1),[aR,aS]=(0,e.useState)(null),[aT,aU]=(0,e.useState)(null),[aV,aW]=(0,e.useState)(null),[aX,aY]=(0,e.useState)("1"),[aZ,a$]=(0,e.useState)(""),a_=1===D,a0=2===D,a1=z||x,a2=(0,e.useMemo)(()=>aj.slice().sort((a,b)=>`${a.name}`.localeCompare(`${b.name}`)).map(a=>({value:a.id,label:a.email?`${a.name} (${a.email})`:a.name})),[aj]),a3=(0,e.useMemo)(()=>an.slice().sort((a,b)=>`${a.name}`.localeCompare(`${b.name}`)).map(a=>({value:a.id,label:`${a.name} (${a.email})`})),[an]),a4=(0,e.useMemo)(()=>"number"!=typeof af?null:a3.find(a=>a.value===af)??null,[af,a3]),a5=(0,e.useMemo)(()=>al.slice().sort((a,b)=>`${a.model}`.localeCompare(`${b.model}`)).map(a=>({value:a.id,label:a.model})),[al]),a6=(0,e.useMemo)(()=>ah.map(a=>"number"==typeof a.device_id?a.device_id:null).filter(a=>"number"==typeof a).map(a=>a5.find(b=>b.value===a)??{value:a,label:`Device #${a}`}).filter(Boolean),[a5,ah]),a7=(0,e.useMemo)(()=>a6.map(a=>({value:a.value,label:a.label})),[a6]),a8=(0,e.useMemo)(()=>av.slice().sort((a,b)=>`${a.name}`.localeCompare(`${b.name}`)).map(a=>({value:a.id,label:a.name})),[av]),a9=(0,e.useMemo)(()=>at.slice().sort((a,b)=>`${a.name}`.localeCompare(`${b.name}`)).map(a=>({value:a.id,label:a.name,code:a.code,capacity:a.capacity})),[at]),ba=(0,e.useMemo)(()=>{let a=a=>a.reduce((a,b)=>{let c=Number(b.qty),d=Number(b.price);return Number.isFinite(c)&&Number.isFinite(d)?a+c*d:a},0);return a(ax)+a(az)+a(aB)},[aB,az,ax]),bb=(0,e.useMemo)(()=>"number"!=typeof P?null:aj.find(a=>a.id===P)??null,[aj,P]),bc=(0,e.useMemo)(()=>"new"===T?X.trim().length>0:(bb?.email??"").trim().length>0,[X,T,bb?.email]);(0,e.useEffect)(()=>{let b=!0;return async function(){if("string"==typeof a&&0!==a.length)try{y(!0);let[c,d,e,f,g,h]=await Promise.all([(0,n.apiFetch)(`/api/${a}/app/clients?limit=200`),(0,n.apiFetch)(`/api/${a}/app/repairbuddy/devices?limit=10`),(0,n.apiFetch)(`/api/${a}/app/technicians?per_page=100&sort=name&dir=asc`),(0,n.apiFetch)(`/api/${a}/app/repairbuddy/parts?limit=200`),(0,n.apiFetch)(`/api/${a}/app/repairbuddy/services?limit=200`),(0,t.getRepairBuddySettings)(String(a))]);if(!b)return;ak(Array.isArray(c.clients)?c.clients:[]),am(Array.isArray(d.devices)?d.devices:[]),ao(Array.isArray(e.users)?e.users:[]),aq(!!h.settings?.devicesBrands?.enablePinCodeField);let i=h.settings?.devicesBrands?.labels,j=i&&"object"==typeof i&&"string"==typeof i.pin?String(i.pin).trim():"";as(""!==j?j:"Pin");let k=Array.isArray(f.parts)?f.parts:[];au(k.map(a=>({id:a.id,name:a.name,code:a.manufacturing_code??"",capacity:a.capacity??""})));let l=Array.isArray(g.services)?g.services:[];aw(l.map(a=>({id:a.id,name:a.name}))),C(null)}catch(c){if(!b)return;if(c instanceof n.ApiError&&428===c.status&&"string"==typeof a&&a.trim().length>0){let b=`/app/${a}/estimates/new`;v.replace(`/app/${a}/branches/select?next=${encodeURIComponent(b)}`);return}C(c instanceof Error?c.message:"Failed to load form data."),ak([]),am([]),ao([]),aq(!1),as("Pin")}finally{if(!b)return;y(!1)}}(),()=>{b=!1}},[v,a]);let bd=async b=>{if("string"!=typeof a||0===a.length)return[];try{let c=new URLSearchParams;c.set("limit","50");let d=b.trim();d&&c.set("query",d);let e=await (0,n.apiFetch)(`/api/${a}/app/clients?${c.toString()}`);return(Array.isArray(e.clients)?e.clients:[]).map(a=>({value:a.id,label:a.email?`${a.name} (${a.email})`:a.name}))}catch{return[]}},be=async b=>{if("string"!=typeof a||0===a.length)return[];try{let c=new URLSearchParams;c.set("limit",b.trim()?"50":"10");let d=b.trim();d&&c.set("q",d);let e=await (0,n.apiFetch)(`/api/${a}/app/repairbuddy/devices?${c.toString()}`);return(Array.isArray(e.devices)?e.devices:[]).map(a=>({value:a.id,label:a.model}))}catch{return[]}};async function bf(b){if("string"==typeof a&&0!==a.length&&!z){C(null),A(!0);try{let c=F.trim();if(""===c)return void C("Title is required.");let d="new"===T;if(d){if(""===V.trim())return void C("Customer name is required.");if(""===X.trim())return void C("Customer email is required.")}if(!d&&"number"!=typeof P)return void C("Select a customer.");let e={case_number:""!==H.trim()?H.trim():null,title:c,status:"pending",customer_id:d||"number"!=typeof P?null:P,pickup_date:""!==J.trim()?J.trim():null,delivery_date:""!==L.trim()?L.trim():null,case_detail:""!==N.trim()?N.trim():null,assigned_technician_id:"number"==typeof af?af:null,devices:ah.length>0?ah.filter(a=>"number"==typeof a.device_id).map(a=>({device_id:a.device_id,serial:""!==a.serial.trim()?a.serial.trim():null,pin:ap&&""!==a.pin.trim()?a.pin.trim():null,notes:""!==a.notes.trim()?a.notes.trim():null})):[]};d&&(e.customer_create={name:V.trim(),email:X.trim(),...""!==Z.trim()?{phone:Z.trim()}:{},...""!==_.trim()?{company:_.trim()}:{}});let f=await (0,n.apiFetch)(`/api/${a}/app/repairbuddy/estimates`,{method:"POST",body:e}),g=f?.estimate?.id;if("number"!=typeof g)throw Error("Estimate creation failed.");try{for(let b of ax){let c=Math.round(Number(b.qty)),d=Number.isFinite(c)&&c>0?c:1,e=b.price.trim(),f=e.length>0?Number(e):NaN,h=Number.isFinite(f)?Math.round(100*f):void 0;await (0,n.apiFetch)(`/api/${a}/app/repairbuddy/estimates/${g}/items`,{method:"POST",body:{item_type:"service",ref_id:b.service_id,qty:d,..."number"==typeof h?{unit_price_amount_cents:h}:{},meta:{..."number"==typeof b.device_id?{device_id:b.device_id}:{}}}})}for(let b of aB){let c=b.name.trim();if(""===c)continue;let d=Math.round(Number(b.qty)),e=Number.isFinite(d)&&d>0?d:1,f=b.price.trim(),h=f.length>0?Number(f):NaN,i=Number.isFinite(h)?Math.round(100*h):void 0;"number"==typeof i&&await (0,n.apiFetch)(`/api/${a}/app/repairbuddy/estimates/${g}/items`,{method:"POST",body:{item_type:i<0?"discount":"fee",name:c,qty:e,unit_price_amount_cents:i}})}for(let b of az){let c=Math.round(Number(b.qty)),d=Number.isFinite(c)&&c>0?c:1,e=b.price.trim(),f=e.length>0?Number(e):NaN,h=Number.isFinite(f)?Math.round(100*f):void 0;await (0,n.apiFetch)(`/api/${a}/app/repairbuddy/estimates/${g}/items`,{method:"POST",body:{item_type:"part",ref_id:b.part_id,qty:d,..."number"==typeof h?{unit_price_amount_cents:h}:{},meta:{..."number"==typeof b.device_id?{device_id:b.device_id}:{}}}})}}catch(a){o.notify.error(a instanceof n.ApiError?a.message:"Estimate created, but failed to attach items.")}if("save_send"===b)try{await (0,n.apiFetch)(`/api/${a}/app/repairbuddy/estimates/${g}/send`,{method:"POST"}),o.notify.success("Estimate sent.")}catch(a){o.notify.error(a instanceof n.ApiError?a.message:"Estimate saved, but sending failed.")}o.notify.success("Estimate created."),v.replace(`/app/${a}/estimates/${g}`)}catch(a){a instanceof n.ApiError?C(a.message):C(a instanceof Error?a.message:"Failed to create estimate.")}finally{A(!1)}}}return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(i.PageHeader,{title:"New estimate",description:"Complete the steps to create the estimate."}),B?(0,b.jsx)("div",{className:"text-sm text-red-600",children:B}):null,(0,b.jsx)(r.CustomerCreateModal,{open:ab,title:"Add customer",disabled:a1,error:ad,setError:ae,name:V,setName:W,email:X,setEmail:Y,emailInputType:"email",phone:Z,setPhone:$,company:_,setCompany:aa,onClose:()=>ac(!1),onSave:({name:a,email:b})=>{U("new"),Q(null),S({value:-1,label:`${a} (${b})`}),ac(!1)}}),(0,b.jsx)(m.Modal,{open:aD,title:"Add service",onClose:()=>{aG(null),aE(!1)},footer:(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,b.jsx)(j.Button,{type:"button",variant:"outline",onClick:()=>{aG(null),aE(!1)},children:"Cancel"}),(0,b.jsx)(j.Button,{type:"button",onClick:()=>{if(!aH)return void aG("Please select a service.");if(!aJ)return void aG("Please select a device.");let a=Math.round(Number(aL)),b=Number.isFinite(a)&&a>0?String(a):"1";ay(a=>[...a,{id:u("svc"),service_id:aH.value,service:{id:aH.value,name:aH.label},device_id:aJ.value,qty:b,price:aN}]),aI(null),aM("1"),aO(""),aG(null),aE(!1)},children:"Add"})]}),children:(0,b.jsxs)("div",{className:"space-y-4",children:[aF?(0,b.jsx)("div",{className:"text-sm text-red-600",children:aF}):null,(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Service"}),(0,b.jsx)(f.default,{instanceId:"estimate_service_select",inputId:"estimate_service_select",isSearchable:!0,isClearable:!0,options:a8,value:aH,onChange:a=>aI(a??null),isDisabled:a1,placeholder:a8.length>0?"Search services...":"No services yet",classNamePrefix:"rb-select",styles:{control:a=>({...a,borderRadius:"var(--rb-radius-sm)",borderColor:"#d4d4d8",minHeight:40,boxShadow:"none"}),menu:a=>({...a,zIndex:50})}})]}),(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Device"}),(0,b.jsx)(f.default,{instanceId:"estimate_service_device_select",inputId:"estimate_service_device_select",isSearchable:!0,isClearable:!0,options:a7,value:aJ,onChange:a=>aK(a??null),isDisabled:a1||0===a7.length,placeholder:a7.length>0?"Select device...":"No devices selected",classNamePrefix:"rb-select",styles:{control:a=>({...a,borderRadius:"var(--rb-radius-sm)",borderColor:"#d4d4d8",minHeight:40,boxShadow:"none"}),menu:a=>({...a,zIndex:50})}})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Qty"}),(0,b.jsx)(k.Input,{value:aL,onChange:a=>aM(a.target.value),disabled:a1})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Price"}),(0,b.jsx)(k.Input,{value:aN,onChange:a=>aO(a.target.value),disabled:a1,placeholder:"Optional"})]})]})]})}),(0,b.jsx)(m.Modal,{open:aP,title:"Add part",onClose:()=>{aS(null),aQ(!1)},footer:(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,b.jsx)(j.Button,{type:"button",variant:"outline",onClick:()=>{aS(null),aQ(!1)},children:"Cancel"}),(0,b.jsx)(j.Button,{type:"button",onClick:()=>{if(!aT)return void aS("Please select a part.");if(!aV)return void aS("Please select a device.");let a=Math.round(Number(aX)),b=Number.isFinite(a)&&a>0?String(a):"1";aA(a=>[...a,{id:u("part"),part_id:aT.value,part:{id:aT.value,name:aT.label,code:aT.code,capacity:aT.capacity},device_id:aV.value,qty:b,price:aZ}]),aU(null),aY("1"),a$(""),aS(null),aQ(!1)},children:"Add"})]}),children:(0,b.jsxs)("div",{className:"space-y-4",children:[aR?(0,b.jsx)("div",{className:"text-sm text-red-600",children:aR}):null,(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Select part"}),(0,b.jsx)(f.default,{instanceId:"estimate_part_select",inputId:"estimate_part_select",isSearchable:!0,isClearable:!0,options:a9,value:aT,onChange:a=>aU(a??null),isDisabled:a1,placeholder:a9.length>0?"Search parts...":"No parts yet",classNamePrefix:"rb-select",styles:{control:a=>({...a,borderRadius:"var(--rb-radius-sm)",borderColor:"#d4d4d8",minHeight:40,boxShadow:"none"}),menu:a=>({...a,zIndex:50})}})]}),(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Device"}),(0,b.jsx)(f.default,{instanceId:"estimate_part_device",isSearchable:!0,isClearable:!0,options:a7,value:aV,onChange:a=>aW(a??null),isDisabled:a1||0===a7.length,placeholder:a7.length>0?"Select device...":"No devices selected",classNamePrefix:"rb-select",styles:{control:a=>({...a,borderRadius:"var(--rb-radius-sm)",borderColor:"#d4d4d8",minHeight:40,boxShadow:"none"}),menu:a=>({...a,zIndex:50})}})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Qty"}),(0,b.jsx)(k.Input,{value:aX,onChange:a=>aY(a.target.value),disabled:a1})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Price"}),(0,b.jsx)(k.Input,{value:aZ,onChange:a=>a$(a.target.value),disabled:a1,placeholder:"Optional"})]})]})]})}),(0,b.jsx)("form",{className:"space-y-6",onSubmit:a=>{a.preventDefault()},children:(0,b.jsx)(p.WizardShell,{steps:[{id:1,navTitle:"Customer & devices",navDescription:"Case, dates, customer, technician, description, devices.",pageTitle:"Customer & devices",pageDescription:"Enter the customer, technician, description and devices.",footerTitle:"Customer & devices"},{id:2,navTitle:"Items and services",navDescription:"Add services, parts and other items.",pageTitle:"Items and services",pageDescription:"Attach services, parts and other items.",footerTitle:"Items and services"},{id:3,navTitle:"Review & send",navDescription:"Review and optionally send the estimate.",pageTitle:"Review & send",pageDescription:"Review the estimate and optionally send it to the customer.",footerTitle:"Review & send"}],step:D,disabled:a1,sidebarTitle:"Estimate steps",sidebarDescription:"Complete the steps to create the estimate.",sidebarAriaLabel:"Estimate steps",onStepChange:a=>{C(null),E(a)},footerRight:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(j.Button,{id:"rb_estimate_save",variant:"outline",disabled:a1,type:"button",onClick:()=>void bf("save"),children:z?"Saving...":"Save"}),(0,b.jsx)(j.Button,{id:"rb_estimate_save_send",variant:"primary",disabled:a1||!d.can("estimates.manage")||!bc,type:"button",onClick:()=>void bf("save_send"),children:z?"Saving...":"Save & Send"})]}),children:a_?(0,b.jsxs)("div",{className:"space-y-5",children:[(0,b.jsx)(l.FormRow,{label:"Title",fieldId:"estimate_title",required:!0,children:(0,b.jsx)(k.Input,{id:"estimate_title",value:F,onChange:a=>G(a.target.value),disabled:a1})}),(0,b.jsx)(l.FormRow,{label:"Case number",fieldId:"estimate_case_number",children:(0,b.jsx)(k.Input,{id:"estimate_case_number",value:H,onChange:a=>I(a.target.value),disabled:a1})}),(0,b.jsx)(l.FormRow,{label:"Dates",fieldId:"estimate_dates",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Pickup date"}),(0,b.jsx)(k.Input,{id:"estimate_pickup_date",type:"date",value:J,onChange:a=>K(a.target.value),disabled:a1})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Delivery date"}),(0,b.jsx)(k.Input,{id:"estimate_delivery_date",type:"date",value:L,onChange:a=>M(a.target.value),disabled:a1})]})]})}),(0,b.jsx)(l.FormRow,{label:"Customer",fieldId:"estimate_customer",children:(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-start gap-2",children:[(0,b.jsx)("div",{className:"min-w-0 flex-1",children:(0,b.jsx)(g.default,{inputId:"estimate_customer",instanceId:"estimate_customer",cacheOptions:!0,defaultOptions:a2,loadOptions:bd,isClearable:!0,isSearchable:!0,value:R,onChange:a=>{let b=a??null;U("existing"),S(b),Q("number"==typeof b?.value&&b.value>0?b.value:null)},isDisabled:a1,placeholder:"Search customers...",classNamePrefix:"rb-select",styles:{control:a=>({...a,borderRadius:"var(--rb-radius-sm)",borderColor:"#d4d4d8",minHeight:40,boxShadow:"none"}),menu:a=>({...a,zIndex:50})}})}),(0,b.jsx)(j.Button,{type:"button",variant:"primary",size:"md",className:"w-10 px-0",disabled:a1,onClick:()=>{ae(null),ac(!0)},children:"+"})]}),"new"===T?(0,b.jsx)("div",{className:"text-xs text-zinc-600",children:"This estimate will create a new customer."}):null]})}),(0,b.jsx)(l.FormRow,{label:"Technician",fieldId:"estimate_technician",children:(0,b.jsx)(f.default,{inputId:"estimate_technician",instanceId:"estimate_technician",isSearchable:!0,isClearable:!0,options:a3,value:a4,onChange:a=>{let b=a??null;ag("number"==typeof b?.value&&b.value>0?b.value:null)},isDisabled:a1||0===a3.length,placeholder:a3.length>0?"Select technician...":"No technicians available",classNamePrefix:"rb-select",styles:{control:a=>({...a,borderRadius:"var(--rb-radius-sm)",borderColor:"#d4d4d8",minHeight:40,boxShadow:"none"}),menu:a=>({...a,zIndex:50})}})}),(0,b.jsx)(l.FormRow,{label:"Estimate description",fieldId:"estimate_case_detail",children:(0,b.jsx)("textarea",{id:"estimate_case_detail",value:N,onChange:a=>O(a.target.value),disabled:a1,rows:4,placeholder:"Enter estimate description.",className:"w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)]"})}),(0,b.jsx)(l.FormRow,{label:"Add devices to this estimate",fieldId:"estimate_devices_admin",children:(0,b.jsx)(q.DevicesAdminEditor,{value:ah,onChange:a=>ai(a),deviceOptions:a5,loadDeviceOptions:be,disabled:a1,idPrefix:"estimate",showPin:ap,serialLabel:"Serial / IMEI",pinLabel:ar,notesLabel:"Notes",addButtonLabel:"Add device",createEmptyRow:()=>({device_id:null,option:null,serial:"",pin:"",notes:"",extra_fields:[]})})})]}):a0?(0,b.jsx)(s.ItemsStep,{deviceContextOptions:a7,disabled:a1,services:ax,setServices:ay,parts:az,setParts:aA,otherItems:aB,setOtherItems:aC,onAddService:()=>{aG(null),!aJ&&a7.length>0&&aK(a7[0]),aE(!0)},serviceAddDisabled:a1||0===a7.length,serviceAddLabel:"Add service",onAddPart:()=>{aS(null),!aV&&a7.length>0&&aW(a7[0]),aQ(!0)},partAddDisabled:a1||0===a7.length,partAddLabel:"Add part",otherItemsTitle:"Other items",otherItemsDescription:"Add custom line items like fees or discounts.",otherItemsAddLabel:"Add other item",createOtherItem:()=>({id:u("oi"),name:"",qty:"1",price:""}),otherItemNamePlaceholder:"e.g. Rent, Used cable",otherItemPricePlaceholder:"e.g. 10.00 (use -10.00 for discount)"}):(0,b.jsxs)("div",{className:"space-y-5",children:[(0,b.jsxs)("div",{className:"rounded-[var(--rb-radius-md)] border border-[var(--rb-border)] bg-white px-4 py-3",children:[(0,b.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:"Review"}),(0,b.jsxs)("div",{className:"mt-2 grid gap-4 sm:grid-cols-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wider text-zinc-500",children:"Customer"}),(0,b.jsx)("div",{className:"mt-1 text-sm text-zinc-700",children:"new"===T?V.trim()||"—":bb?.name??R?.label??"—"}),(0,b.jsx)("div",{className:"mt-1 text-xs text-zinc-500",children:"new"===T?X.trim():bb?.email??""})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wider text-zinc-500",children:"Estimated total"}),(0,b.jsx)("div",{className:"mt-1 text-sm font-semibold text-[var(--rb-text)]",children:Number.isFinite(ba)?ba.toFixed(2):"0.00"})]})]})]}),(0,b.jsxs)("div",{className:"rounded-[var(--rb-radius-md)] border border-[var(--rb-border)] bg-white px-4 py-3",children:[(0,b.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:"Devices"}),(0,b.jsxs)("div",{className:"mt-2 space-y-1 text-sm text-zinc-700",children:[0===a6.length?(0,b.jsx)("div",{className:"text-sm text-zinc-600",children:"None"}):null,a6.map(a=>(0,b.jsx)("div",{children:a.label},a.value))]})]}),(0,b.jsxs)("div",{className:"rounded-[var(--rb-radius-md)] border border-[var(--rb-border)] bg-white px-4 py-3",children:[(0,b.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:"Items"}),(0,b.jsxs)("div",{className:"mt-2 space-y-2",children:[0===ax.length&&0===az.length&&0===aB.length?(0,b.jsx)("div",{className:"text-sm text-zinc-600",children:"None"}):null,ax.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between gap-3 text-sm",children:[(0,b.jsxs)("div",{className:"min-w-0 truncate text-zinc-700",children:[a.qty," × ",a.service.name]}),(0,b.jsx)("div",{className:"whitespace-nowrap font-semibold text-[var(--rb-text)]",children:a.price||"—"})]},a.id)),az.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between gap-3 text-sm",children:[(0,b.jsxs)("div",{className:"min-w-0 truncate text-zinc-700",children:[a.qty," × ",a.part.name]}),(0,b.jsx)("div",{className:"whitespace-nowrap font-semibold text-[var(--rb-text)]",children:a.price||"—"})]},a.id)),aB.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between gap-3 text-sm",children:[(0,b.jsxs)("div",{className:"min-w-0 truncate text-zinc-700",children:[a.qty," × ",a.name]}),(0,b.jsx)("div",{className:"whitespace-nowrap font-semibold text-[var(--rb-text)]",children:a.price||"—"})]},a.id))]})]})]})})})]})}function w(){let a=(0,c.useParams)(),e=a.business??a.tenant;return"string"!=typeof e||0===e.trim().length?(0,b.jsx)(d.RequireAuth,{requiredPermission:"estimates.manage",children:(0,b.jsx)("div",{className:"text-sm text-zinc-600",children:"Tenant is missing."})}):(0,b.jsx)(d.RequireAuth,{requiredPermission:"estimates.manage",children:(0,b.jsx)(v,{tenantSlug:e})})}a.s(["default",()=>w],74412)}];

//# sourceMappingURL=frontend_src_app_app_%5Btenant%5D_estimates_new_page_tsx_0ff00a35._.js.map