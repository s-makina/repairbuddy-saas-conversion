{"version":3,"sources":["../../../../../frontend/src/app/app/%5Btenant%5D/users/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { apiFetch, ApiError } from \"@/lib/api\";\r\nimport type { Branch, Role, User, UserStatus } from \"@/lib/types\";\r\nimport { Button } from \"@/components/ui/Button\";\r\nimport { Badge } from \"@/components/ui/Badge\";\r\nimport { Card, CardContent } from \"@/components/ui/Card\";\r\nimport { ConfirmDialog } from \"@/components/ui/ConfirmDialog\";\r\nimport { DataTable } from \"@/components/ui/DataTable\";\r\nimport { DropdownMenu, DropdownMenuItem, DropdownMenuSeparator } from \"@/components/ui/DropdownMenu\";\r\nimport { PageHeader } from \"@/components/ui/PageHeader\";\r\nimport { RequireAuth } from \"@/components/RequireAuth\";\r\nimport { useAuth } from \"@/lib/auth\";\r\nimport { notify } from \"@/lib/notify\";\r\nimport { Skeleton, TableSkeleton } from \"@/components/ui/Skeleton\";\r\nimport { useParams } from \"next/navigation\";\r\nimport React, { useEffect, useMemo, useRef, useState } from \"react\";\r\n\r\nfunction PencilIcon(props: { className?: string }) {\r\n  return (\r\n    <svg\r\n      viewBox=\"0 0 24 24\"\r\n      fill=\"none\"\r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n      className={props.className}\r\n      aria-hidden=\"true\"\r\n    >\r\n      <path\r\n        d=\"M12 20h9\"\r\n        stroke=\"currentColor\"\r\n        strokeWidth=\"2\"\r\n        strokeLinecap=\"round\"\r\n        strokeLinejoin=\"round\"\r\n      />\r\n      <path\r\n        d=\"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4 12.5-12.5z\"\r\n        stroke=\"currentColor\"\r\n        strokeWidth=\"2\"\r\n        strokeLinecap=\"round\"\r\n        strokeLinejoin=\"round\"\r\n      />\r\n    </svg>\r\n  );\r\n}\r\n\r\nfunction ShopIcon(props: { className?: string }) {\r\n  return (\r\n    <svg\r\n      viewBox=\"0 0 24 24\"\r\n      fill=\"none\"\r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n      className={props.className}\r\n      aria-hidden=\"true\"\r\n    >\r\n      <path\r\n        d=\"M3 9.5L5 4h14l2 5.5\"\r\n        stroke=\"currentColor\"\r\n        strokeWidth=\"2\"\r\n        strokeLinecap=\"round\"\r\n        strokeLinejoin=\"round\"\r\n      />\r\n      <path\r\n        d=\"M4 10h16v10H4V10z\"\r\n        stroke=\"currentColor\"\r\n        strokeWidth=\"2\"\r\n        strokeLinecap=\"round\"\r\n        strokeLinejoin=\"round\"\r\n      />\r\n      <path\r\n        d=\"M9 20v-6h6v6\"\r\n        stroke=\"currentColor\"\r\n        strokeWidth=\"2\"\r\n        strokeLinecap=\"round\"\r\n        strokeLinejoin=\"round\"\r\n      />\r\n    </svg>\r\n  );\r\n}\r\n\r\ntype UsersPayload = {\r\n  users: User[];\r\n  meta?: {\r\n    current_page: number;\r\n    per_page: number;\r\n    total: number;\r\n    last_page: number;\r\n  };\r\n};\r\n\r\ntype RolesPayload = {\r\n  roles: Role[];\r\n};\r\n\r\ntype BranchesPayload = {\r\n  branches: Branch[];\r\n};\r\n\r\nexport default function TenantUsersPage() {\r\n  const auth = useAuth();\r\n  const params = useParams() as { tenant?: string; business?: string };\r\n  const tenant = params.business ?? params.tenant;\r\n\r\n  function scrollToInviteForm() {\r\n    const el = document.getElementById(\"invite-user\");\r\n    if (!el) {\r\n      window.scrollTo({ top: 0, behavior: \"smooth\" });\r\n      return;\r\n    }\r\n    el.scrollIntoView({ behavior: \"smooth\", block: \"start\" });\r\n  }\r\n\r\n  const [loading, setLoading] = useState(true);\r\n  const [users, setUsers] = useState<User[]>([]);\r\n  const [roles, setRoles] = useState<Role[]>([]);\r\n  const [branches, setBranches] = useState<Branch[]>([]);\r\n\r\n  const [newName, setNewName] = useState(\"\");\r\n  const [newEmail, setNewEmail] = useState(\"\");\r\n  const [newRoleId, setNewRoleId] = useState<number | null>(null);\r\n  const [newShopQuery, setNewShopQuery] = useState<string>(\"\");\r\n  const [newShopSelected, setNewShopSelected] = useState<Record<number, boolean>>({});\r\n  const [busy, setBusy] = useState(false);\r\n\r\n  const [actionBusyUserId, setActionBusyUserId] = useState<number | null>(null);\r\n\r\n  const [roleFilter, setRoleFilter] = useState<string>(\"all\");\r\n  const [statusFilter, setStatusFilter] = useState<string>(\"all\");\r\n\r\n  const [q, setQ] = useState<string>(\"\");\r\n  const [pageIndex, setPageIndex] = useState<number>(0);\r\n  const [pageSize, setPageSize] = useState<number>(10);\r\n  const [totalUsers, setTotalUsers] = useState<number>(0);\r\n  const [sort, setSort] = useState<{ id: string; dir: \"asc\" | \"desc\" } | null>(null);\r\n\r\n  const [editingUserId, setEditingUserId] = useState<number | null>(null);\r\n\r\n  const [confirmOpen, setConfirmOpen] = useState(false);\r\n  const [confirmTitle, setConfirmTitle] = useState(\"\");\r\n  const [confirmMessage, setConfirmMessage] = useState<React.ReactNode>(\"\");\r\n  const [confirmAction, setConfirmAction] = useState<(() => Promise<void>) | null>(null);\r\n\r\n  const roleNameById = useMemo(() => {\r\n    const map = new Map<number, string>();\r\n    for (const r of roles) {\r\n      map.set(r.id, r.name);\r\n    }\r\n    return map;\r\n  }, [roles]);\r\n\r\n  const branchOptions = useMemo(() => {\r\n    const list = branches.slice().sort((a, b) => `${a.code} ${a.name}`.localeCompare(`${b.code} ${b.name}`));\r\n    return list.map((b) => ({\r\n      id: b.id,\r\n      label: `${b.code} - ${b.name}${b.is_active ? \"\" : \" (inactive)\"}`,\r\n      isActive: b.is_active,\r\n    }));\r\n  }, [branches]);\r\n\r\n  const activeBranchOptions = useMemo(() => branchOptions.filter((b) => b.isActive), [branchOptions]);\r\n\r\n  const filteredNewShopOptions = useMemo(() => {\r\n    const q = newShopQuery.trim().toLowerCase();\r\n    if (!q) return activeBranchOptions;\r\n    return activeBranchOptions.filter((b) => b.label.toLowerCase().includes(q));\r\n  }, [activeBranchOptions, newShopQuery]);\r\n\r\n  const newShopAllChecked = useMemo(() => {\r\n    if (filteredNewShopOptions.length === 0) return false;\r\n    return filteredNewShopOptions.every((b) => Boolean(newShopSelected[b.id]));\r\n  }, [filteredNewShopOptions, newShopSelected]);\r\n\r\n  const newShopSomeChecked = useMemo(() => {\r\n    return filteredNewShopOptions.some((b) => Boolean(newShopSelected[b.id]));\r\n  }, [filteredNewShopOptions, newShopSelected]);\r\n\r\n  const newShopCheckAllRef = useRef<HTMLInputElement | null>(null);\r\n  useEffect(() => {\r\n    if (!newShopCheckAllRef.current) return;\r\n    newShopCheckAllRef.current.indeterminate = newShopSomeChecked && !newShopAllChecked;\r\n  }, [newShopAllChecked, newShopSomeChecked]);\r\n\r\n  const roleOptions = useMemo(() => {\r\n    return [\r\n      { label: \"All roles\", value: \"all\" },\r\n      { label: \"(none)\", value: \"none\" },\r\n      ...roles.map((r) => ({ label: r.name, value: String(r.id) })),\r\n    ];\r\n  }, [roles]);\r\n\r\n  const statusOptions = useMemo(() => {\r\n    return [\r\n      { label: \"All statuses\", value: \"all\" },\r\n      { label: \"Pending\", value: \"pending\" },\r\n      { label: \"Active\", value: \"active\" },\r\n      { label: \"Inactive\", value: \"inactive\" },\r\n      { label: \"Suspended\", value: \"suspended\" },\r\n    ];\r\n  }, []);\r\n\r\n  const statusBadgeVariant = useMemo(() => {\r\n    return new Map<UserStatus, \"default\" | \"info\" | \"success\" | \"warning\" | \"danger\">([\r\n      [\"pending\", \"warning\"],\r\n      [\"active\", \"success\"],\r\n      [\"inactive\", \"default\"],\r\n      [\"suspended\", \"danger\"],\r\n    ]);\r\n  }, []);\r\n\r\n  async function load({ includeRoles }: { includeRoles: boolean }) {\r\n    if (typeof tenant !== \"string\" || tenant.length === 0) return;\r\n    setLoading(true);\r\n\r\n    try {\r\n      const qs = new URLSearchParams();\r\n      if (q.trim().length > 0) qs.set(\"q\", q.trim());\r\n      if (roleFilter && roleFilter !== \"all\") qs.set(\"role\", roleFilter);\r\n      if (statusFilter && statusFilter !== \"all\") qs.set(\"status\", statusFilter);\r\n      if (sort?.id && sort?.dir) {\r\n        qs.set(\"sort\", sort.id);\r\n        qs.set(\"dir\", sort.dir);\r\n      }\r\n      qs.set(\"page\", String(pageIndex + 1));\r\n      qs.set(\"per_page\", String(pageSize));\r\n\r\n      const usersPath = `/api/${tenant}/app/users?${qs.toString()}`;\r\n\r\n      if (includeRoles) {\r\n        const [usersRes, rolesRes, branchesRes] = await Promise.all([\r\n          apiFetch<UsersPayload>(usersPath),\r\n          apiFetch<RolesPayload>(`/api/${tenant}/app/roles`),\r\n          apiFetch<BranchesPayload>(`/api/${tenant}/app/branches`),\r\n        ]);\r\n\r\n        setUsers(Array.isArray(usersRes.users) ? usersRes.users : []);\r\n        setTotalUsers(typeof usersRes.meta?.total === \"number\" ? usersRes.meta.total : 0);\r\n        setPageSize(typeof usersRes.meta?.per_page === \"number\" ? usersRes.meta.per_page : pageSize);\r\n        setRoles(Array.isArray(rolesRes.roles) ? rolesRes.roles : []);\r\n        setBranches(Array.isArray(branchesRes.branches) ? branchesRes.branches : []);\r\n\r\n        const firstRoleId = (Array.isArray(rolesRes.roles) ? rolesRes.roles : [])[0]?.id ?? null;\r\n        setNewRoleId(firstRoleId);\r\n\r\n        const defaultBranchId = auth.tenant?.default_branch_id ?? null;\r\n        const branchList = Array.isArray(branchesRes.branches) ? branchesRes.branches : [];\r\n        const activeBranchIds = branchList.filter((b) => b.is_active).map((b) => b.id);\r\n        const seedIds =\r\n          (defaultBranchId && activeBranchIds.includes(defaultBranchId) ? [defaultBranchId] : [])\r\n            .concat(activeBranchIds.length > 0 ? [activeBranchIds[0]] : [])\r\n            .filter((v, idx, arr) => arr.indexOf(v) === idx);\r\n\r\n        setNewShopSelected((prev) => {\r\n          if (Object.keys(prev).length > 0) return prev;\r\n          const next: Record<number, boolean> = {};\r\n          for (const id of seedIds) next[id] = true;\r\n          return next;\r\n        });\r\n      } else {\r\n        const usersRes = await apiFetch<UsersPayload>(usersPath);\r\n        setUsers(Array.isArray(usersRes.users) ? usersRes.users : []);\r\n        setTotalUsers(typeof usersRes.meta?.total === \"number\" ? usersRes.meta.total : 0);\r\n        setPageSize(typeof usersRes.meta?.per_page === \"number\" ? usersRes.meta.per_page : pageSize);\r\n      }\r\n    } catch (err) {\r\n      notify.error(err instanceof Error ? err.message : \"Failed to load users.\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  async function onSendPasswordReset(userId: number) {\r\n    setActionBusyUserId(userId);\r\n\r\n    try {\r\n      await apiFetch<{ message: string }>(`/api/${tenant}/app/users/${userId}/reset-password`, {\r\n        method: \"POST\",\r\n      });\r\n\r\n      notify.success(\"Password reset link sent.\");\r\n    } catch (err) {\r\n      if (err instanceof ApiError) {\r\n        notify.error(err.message);\r\n      } else {\r\n        notify.error(\"Failed to send password reset link.\");\r\n      }\r\n    } finally {\r\n      setActionBusyUserId(null);\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    setPageIndex(0);\r\n    setSort(null);\r\n    void load({ includeRoles: true });\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [tenant]);\r\n\r\n  useEffect(() => {\r\n    if (typeof tenant !== \"string\" || tenant.length === 0) return;\r\n    void load({ includeRoles: false });\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [q, roleFilter, statusFilter, pageIndex, pageSize, sort?.id, sort?.dir]);\r\n\r\n  async function onSaveUser(e: React.FormEvent) {\r\n    e.preventDefault();\r\n    if (!newRoleId) return;\r\n    if (activeBranchOptions.length === 0) return;\r\n\r\n    const selectedBranchIds = Object.entries(newShopSelected)\r\n      .filter(([, v]) => v)\r\n      .map(([k]) => Number(k))\r\n      .filter((n) => Number.isFinite(n) && n > 0);\r\n\r\n    if (selectedBranchIds.length === 0) {\r\n      notify.error(\"Select at least one shop.\");\r\n      return;\r\n    }\r\n\r\n    setBusy(true);\r\n\r\n    try {\r\n      if (editingUserId) {\r\n        await apiFetch<{ user: User }>(`/api/${tenant}/app/users/${editingUserId}`, {\r\n          method: \"PUT\",\r\n          body: {\r\n            name: newName,\r\n            email: newEmail,\r\n            role_id: newRoleId,\r\n          },\r\n        });\r\n\r\n        const shopsRes = await apiFetch<{ user: User }>(`/api/${tenant}/app/users/${editingUserId}/shop`, {\r\n          method: \"PATCH\",\r\n          body: { branch_ids: selectedBranchIds },\r\n        });\r\n        setUsers((prev) => prev.map((u) => (u.id === editingUserId ? shopsRes.user : u)));\r\n        notify.success(\"User updated.\");\r\n      } else {\r\n        await apiFetch<{ user: User }>(`/api/${tenant}/app/users`, {\r\n          method: \"POST\",\r\n          body: {\r\n            name: newName,\r\n            email: newEmail,\r\n            role_id: newRoleId,\r\n            branch_ids: selectedBranchIds,\r\n          },\r\n        });\r\n        notify.success(\"User created. One-time password emailed.\");\r\n      }\r\n\r\n      setNewName(\"\");\r\n      setNewEmail(\"\");\r\n      setNewShopQuery(\"\");\r\n      setNewShopSelected({});\r\n      setEditingUserId(null);\r\n      setPageIndex(0);\r\n      await load({ includeRoles: false });\r\n      await auth.refresh();\r\n    } catch (err) {\r\n      if (err instanceof ApiError) {\r\n        notify.error(err.message);\r\n      } else {\r\n        notify.error(editingUserId ? \"Failed to update user.\" : \"Failed to create user.\");\r\n      }\r\n    } finally {\r\n      setBusy(false);\r\n    }\r\n  }\r\n\r\n  async function onUpdateUserStatus(userId: number, nextStatus: UserStatus) {\r\n    setActionBusyUserId(userId);\r\n\r\n    try {\r\n      await apiFetch<{ user: User }>(`/api/${tenant}/app/users/${userId}/status`, {\r\n        method: \"PATCH\",\r\n        body: { status: nextStatus },\r\n      });\r\n\r\n      notify.success(\"User updated.\");\r\n      await load({ includeRoles: false });\r\n    } catch (err) {\r\n      if (err instanceof ApiError) {\r\n        notify.error(err.message);\r\n      } else {\r\n        notify.error(\"Failed to update user.\");\r\n      }\r\n    } finally {\r\n      setActionBusyUserId(null);\r\n    }\r\n  }\r\n\r\n  function openEdit(user: User) {\r\n    const current = Array.isArray(user.branches) ? user.branches : [];\r\n    const map: Record<number, boolean> = {};\r\n    for (const b of current) {\r\n      if (typeof b.id === \"number\") map[b.id] = true;\r\n    }\r\n\r\n    setEditingUserId(user.id);\r\n    setNewName(user.name ?? \"\");\r\n    setNewEmail(user.email ?? \"\");\r\n    setNewRoleId(user.role_id ?? null);\r\n    setNewShopSelected(map);\r\n    setNewShopQuery(\"\");\r\n\r\n    window.scrollTo({ top: 0, behavior: \"smooth\" });\r\n  }\r\n\r\n  function openConfirm(args: { title: string; message: React.ReactNode; action: () => Promise<void> }) {\r\n    setConfirmTitle(args.title);\r\n    setConfirmMessage(args.message);\r\n    setConfirmAction(() => args.action);\r\n    setConfirmOpen(true);\r\n  }\r\n\r\n  function UsersSkeleton() {\r\n    return (\r\n      <div className=\"space-y-6\">\r\n        <Card className=\"shadow-none\">\r\n          <CardContent className=\"pt-5\">\r\n            <div className=\"flex items-center justify-between gap-3\">\r\n              <div>\r\n                <Skeleton className=\"h-4 w-32 rounded-[var(--rb-radius-sm)]\" />\r\n                <Skeleton className=\"mt-2 h-4 w-72 rounded-[var(--rb-radius-sm)]\" />\r\n              </div>\r\n              <Skeleton className=\"h-9 w-28 rounded-[var(--rb-radius-sm)]\" />\r\n            </div>\r\n\r\n            <div className=\"mt-4 grid gap-6 lg:grid-cols-12\">\r\n              <div className=\"lg:col-span-7 space-y-3\">\r\n                {Array.from({ length: 4 }).map((_, idx) => (\r\n                  <div key={idx} className=\"space-y-1\">\r\n                    <Skeleton className=\"h-3 w-20 rounded-[var(--rb-radius-sm)]\" />\r\n                    <Skeleton className=\"h-9 w-full rounded-[var(--rb-radius-sm)]\" />\r\n                  </div>\r\n                ))}\r\n                <div className=\"flex items-center gap-2\">\r\n                  <Skeleton className=\"h-9 w-28 rounded-[var(--rb-radius-sm)]\" />\r\n                  <Skeleton className=\"h-9 w-20 rounded-[var(--rb-radius-sm)]\" />\r\n                </div>\r\n              </div>\r\n              <div className=\"lg:col-span-5\">\r\n                <div className=\"rounded-[var(--rb-radius-md)] border border-[var(--rb-border)] bg-[var(--rb-surface-muted)] p-4\">\r\n                  <div className=\"flex items-start justify-between gap-3\">\r\n                    <div>\r\n                      <Skeleton className=\"h-4 w-20 rounded-[var(--rb-radius-sm)]\" />\r\n                      <Skeleton className=\"mt-2 h-3 w-48 rounded-[var(--rb-radius-sm)]\" />\r\n                    </div>\r\n                    <Skeleton className=\"h-3 w-20 rounded-[var(--rb-radius-sm)]\" />\r\n                  </div>\r\n                  <div className=\"mt-4 space-y-2\">\r\n                    {Array.from({ length: 6 }).map((_, idx) => (\r\n                      <div key={idx} className=\"rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2\">\r\n                        <Skeleton className=\"h-4 w-40 rounded-[var(--rb-radius-sm)]\" />\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <TableSkeleton rows={8} columns={6} />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (loading && users.length === 0 && roles.length === 0 && branches.length === 0) {\r\n    return (\r\n      <RequireAuth requiredPermission=\"users.manage\">\r\n        <div className=\"space-y-6\">\r\n          <PageHeader\r\n            title=\"Users\"\r\n            description=\"Manage tenant users and their roles.\"\r\n            actions={\r\n              <Button type=\"button\" disabled>\r\n                Invite user\r\n              </Button>\r\n            }\r\n          />\r\n          <UsersSkeleton />\r\n        </div>\r\n      </RequireAuth>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <RequireAuth requiredPermission=\"users.manage\">\r\n      <div className=\"space-y-6\">\r\n        <PageHeader\r\n          title=\"Users\"\r\n          description=\"Manage tenant users and their roles.\"\r\n          actions={\r\n            <Button\r\n              type=\"button\"\r\n              onClick={() => {\r\n                setEditingUserId(null);\r\n                setNewName(\"\");\r\n                setNewEmail(\"\");\r\n                setNewShopQuery(\"\");\r\n                setNewShopSelected({});\r\n                scrollToInviteForm();\r\n              }}\r\n            >\r\n              Invite user\r\n            </Button>\r\n          }\r\n        />\r\n\r\n        <ConfirmDialog\r\n          open={confirmOpen}\r\n          title={confirmTitle}\r\n          message={confirmMessage}\r\n          busy={!!actionBusyUserId}\r\n          onCancel={() => {\r\n            if (actionBusyUserId) return;\r\n            setConfirmOpen(false);\r\n            setConfirmAction(null);\r\n          }}\r\n          onConfirm={() => {\r\n            if (!confirmAction) return;\r\n            void (async () => {\r\n              await confirmAction();\r\n              setConfirmOpen(false);\r\n              setConfirmAction(null);\r\n            })();\r\n          }}\r\n        />\r\n\r\n        <div className=\"space-y-6\">\r\n          <div>\r\n            <Card className=\"shadow-none\">\r\n              <CardContent className=\"pt-5\">\r\n                <div id=\"invite-user\" />\r\n                <div className=\"text-sm font-semibold text-[var(--rb-text)]\">{editingUserId ? \"Edit user\" : \"Create user\"}</div>\r\n                <form className=\"mt-4\" onSubmit={onSaveUser}>\r\n                  <div className=\"grid gap-6 lg:grid-cols-12\">\r\n                    <div className=\"lg:col-span-7\">\r\n                      <div className=\"grid gap-3\">\r\n                        <div className=\"space-y-1\">\r\n                          <label className=\"text-sm font-medium\" htmlFor=\"user_name\">\r\n                            Name\r\n                          </label>\r\n                          <input\r\n                            id=\"user_name\"\r\n                            className=\"w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm\"\r\n                            value={newName}\r\n                            onChange={(e) => setNewName(e.target.value)}\r\n                            required\r\n                          />\r\n                        </div>\r\n\r\n                        <div className=\"space-y-1\">\r\n                          <label className=\"text-sm font-medium\" htmlFor=\"user_email\">\r\n                            Email\r\n                          </label>\r\n                          <input\r\n                            id=\"user_email\"\r\n                            className=\"w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm\"\r\n                            value={newEmail}\r\n                            onChange={(e) => setNewEmail(e.target.value)}\r\n                            type=\"email\"\r\n                            required\r\n                          />\r\n                        </div>\r\n\r\n                        <div className=\"space-y-1\">\r\n                          <div className=\"text-sm text-zinc-600\">\r\n                            A one-time password will be generated and emailed to the user.\r\n                          </div>\r\n                        </div>\r\n\r\n                        <div className=\"space-y-1\">\r\n                          <label className=\"text-sm font-medium\" htmlFor=\"user_role\">\r\n                            Role\r\n                          </label>\r\n                          <select\r\n                            id=\"user_role\"\r\n                            className=\"w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm\"\r\n                            value={newRoleId ?? \"\"}\r\n                            onChange={(e) => setNewRoleId(Number(e.target.value))}\r\n                            required\r\n                          >\r\n                            {roles.map((r) => (\r\n                              <option key={r.id} value={r.id}>\r\n                                {r.name}\r\n                              </option>\r\n                            ))}\r\n                          </select>\r\n                        </div>\r\n\r\n                        <div>\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <Button\r\n                              type=\"submit\"\r\n                              disabled={\r\n                                busy ||\r\n                                loading ||\r\n                                roles.length === 0 ||\r\n                                activeBranchOptions.length === 0 ||\r\n                                Object.values(newShopSelected).filter(Boolean).length === 0\r\n                              }\r\n                            >\r\n                              {busy ? \"Saving...\" : editingUserId ? \"Save changes\" : \"Create user\"}\r\n                            </Button>\r\n                            {editingUserId ? (\r\n                              <Button\r\n                                type=\"button\"\r\n                                variant=\"outline\"\r\n                                disabled={busy || loading}\r\n                                onClick={() => {\r\n                                  setEditingUserId(null);\r\n                                  setNewName(\"\");\r\n                                  setNewEmail(\"\");\r\n                                  setNewShopQuery(\"\");\r\n                                  setNewShopSelected({});\r\n                                }}\r\n                              >\r\n                                Cancel\r\n                              </Button>\r\n                            ) : null}\r\n                          </div>\r\n                          {roles.length === 0 ? (\r\n                            <div className=\"mt-2 text-sm text-zinc-600\">Create a role first before adding users.</div>\r\n                          ) : null}\r\n                          {activeBranchOptions.length === 0 ? (\r\n                            <div className=\"mt-2 text-sm text-zinc-600\">Create a shop first before adding users.</div>\r\n                          ) : null}\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"lg:col-span-5\">\r\n                      <div className=\"rounded-[var(--rb-radius-md)] border border-[var(--rb-border)] bg-[var(--rb-surface-muted)] p-4\">\r\n                        <div className=\"flex items-start justify-between gap-3\">\r\n                          <div>\r\n                            <div className=\"text-sm font-semibold text-[var(--rb-text)]\">Shops</div>\r\n                            <div className=\"mt-1 text-xs text-zinc-600\">Select one or more shops this user can access.</div>\r\n                          </div>\r\n                          <div className=\"text-xs text-zinc-600\">Selected: {Object.values(newShopSelected).filter(Boolean).length}</div>\r\n                        </div>\r\n\r\n                        <div className=\"mt-3 space-y-1\">\r\n                          <label className=\"text-sm font-medium\" htmlFor=\"new_user_shop_search\">\r\n                            Search\r\n                          </label>\r\n                          <input\r\n                            id=\"new_user_shop_search\"\r\n                            className=\"w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm\"\r\n                            value={newShopQuery}\r\n                            onChange={(e) => setNewShopQuery(e.target.value)}\r\n                            placeholder=\"Search shops...\"\r\n                            disabled={busy || loading}\r\n                          />\r\n                        </div>\r\n\r\n                        <div className=\"mt-3 max-h-[260px] overflow-y-auto pr-1\">\r\n                          <div className=\"grid gap-2\">\r\n                            <label className=\"flex items-center justify-between gap-3 rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2\">\r\n                              <div className=\"min-w-0\">\r\n                                <div className=\"truncate text-sm font-medium text-[var(--rb-text)]\">Check all</div>\r\n                              </div>\r\n                              <input\r\n                                ref={newShopCheckAllRef}\r\n                                type=\"checkbox\"\r\n                                checked={newShopAllChecked}\r\n                                onChange={(e) => {\r\n                                  const next = e.target.checked;\r\n                                  setNewShopSelected((prev) => {\r\n                                    const copy = { ...prev };\r\n                                    for (const b of filteredNewShopOptions) {\r\n                                      copy[b.id] = next;\r\n                                    }\r\n                                    return copy;\r\n                                  });\r\n                                }}\r\n                                disabled={busy || loading}\r\n                              />\r\n                            </label>\r\n\r\n                            {filteredNewShopOptions.map((b) => {\r\n                                const checked = Boolean(newShopSelected[b.id]);\r\n                                return (\r\n                                  <label\r\n                                    key={b.id}\r\n                                    className=\"flex items-center justify-between gap-3 rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2\"\r\n                                  >\r\n                                    <div className=\"min-w-0\">\r\n                                      <div className=\"truncate text-sm font-medium text-[var(--rb-text)]\">{b.label}</div>\r\n                                    </div>\r\n                                    <input\r\n                                      type=\"checkbox\"\r\n                                      checked={checked}\r\n                                      onChange={(e) =>\r\n                                        setNewShopSelected((prev) => ({\r\n                                          ...prev,\r\n                                          [b.id]: e.target.checked,\r\n                                        }))\r\n                                      }\r\n                                      disabled={busy || loading}\r\n                                    />\r\n                                  </label>\r\n                                );\r\n                              })}\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </form>\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n\r\n          <div>\r\n            <Card className=\"shadow-none\">\r\n              <CardContent className=\"pt-5\">\r\n                <DataTable\r\n                  title=\"Users\"\r\n                  data={users}\r\n                  loading={loading}\r\n                  emptyMessage=\"No users yet.\"\r\n                  getRowId={(u) => u.id}\r\n                  search={{\r\n                    placeholder: \"Search name or email...\",\r\n                  }}\r\n                  server={{\r\n                    query: q,\r\n                    onQueryChange: (value) => {\r\n                      setQ(value);\r\n                      setPageIndex(0);\r\n                    },\r\n                    pageIndex,\r\n                    onPageIndexChange: setPageIndex,\r\n                    pageSize,\r\n                    onPageSizeChange: (value) => {\r\n                      setPageSize(value);\r\n                      setPageIndex(0);\r\n                    },\r\n                    totalRows: totalUsers,\r\n                    sort,\r\n                    onSortChange: (next) => {\r\n                      setSort(next);\r\n                      setPageIndex(0);\r\n                    },\r\n                  }}\r\n                  exportConfig={{\r\n                    url: `/api/${tenant}/app/users/export`,\r\n                    formats: [\"csv\", \"xlsx\", \"pdf\"],\r\n                    filename: ({ format }) => `users_export.${format}`,\r\n                  }}\r\n                  columnVisibilityKey={`rb:datatable:${tenant}:users`}\r\n                  filters={[\r\n                    {\r\n                      id: \"role\",\r\n                      label: \"Role\",\r\n                      value: roleFilter,\r\n                      options: roleOptions,\r\n                      onChange: (value) => {\r\n                        setRoleFilter(String(value));\r\n                        setPageIndex(0);\r\n                      },\r\n                    },\r\n                    {\r\n                      id: \"status\",\r\n                      label: \"Status\",\r\n                      value: statusFilter,\r\n                      options: statusOptions,\r\n                      onChange: (value) => {\r\n                        setStatusFilter(String(value));\r\n                        setPageIndex(0);\r\n                      },\r\n                    },\r\n                  ]}\r\n                  columns={[\r\n                    {\r\n                      id: \"name\",\r\n                      header: \"Name\",\r\n                      sortId: \"name\",\r\n                      cell: (u) => (\r\n                        <div className=\"min-w-0\">\r\n                          <div className=\"truncate font-semibold text-[var(--rb-text)]\">{u.name}</div>\r\n                          <div className=\"truncate text-xs text-zinc-600\">{u.email}</div>\r\n                        </div>\r\n                      ),\r\n                      className: \"max-w-[340px]\",\r\n                    },\r\n                    {\r\n                      id: \"email\",\r\n                      header: \"Email\",\r\n                      sortId: \"email\",\r\n                      hiddenByDefault: true,\r\n                      cell: (u) => <div className=\"text-sm text-zinc-700\">{u.email}</div>,\r\n                      className: \"whitespace-nowrap\",\r\n                    },\r\n                    {\r\n                      id: \"role\",\r\n                      header: \"Role\",\r\n                      cell: (u) => {\r\n                        const currentRoleId = u.role_id ?? null;\r\n                        return (\r\n                          <div className=\"text-sm text-zinc-700\">\r\n                            {currentRoleId ? roleNameById.get(currentRoleId) ?? \"(unknown)\" : \"(none)\"}\r\n                          </div>\r\n                        );\r\n                      },\r\n                      className: \"whitespace-nowrap\",\r\n                    },\r\n                    {\r\n                      id: \"shop\",\r\n                      header: \"Shops\",\r\n                      className: \"min-w-[220px]\",\r\n                      cell: (u) => {\r\n                        const branches = Array.isArray(u.branches) ? u.branches : [];\r\n                        const active = branches.filter((b) => Boolean(b?.is_active));\r\n                        const list = (active.length > 0 ? active : branches)\r\n                          .filter((b) => b && typeof b.id === \"number\")\r\n                          .slice()\r\n                          .sort((a, b) => `${a.code ?? \"\"} ${a.name ?? \"\"}`.localeCompare(`${b.code ?? \"\"} ${b.name ?? \"\"}`));\r\n\r\n                        const shown = list.slice(0, 2);\r\n                        const overflow = list.slice(2);\r\n                        const more = overflow.length;\r\n                        const overflowTitle = overflow\r\n                          .map((b) => `${b.code ? `${b.code} - ` : \"\"}${b.name}`)\r\n                          .join(\"\\n\");\r\n\r\n                        return (\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <ShopIcon className=\"h-4 w-4 text-zinc-500\" />\r\n                            <div className=\"flex flex-wrap gap-1\">\r\n                              {shown.length === 0 ? (\r\n                                <span className=\"text-sm text-zinc-600\">(none)</span>\r\n                              ) : (\r\n                                <>\r\n                                  {shown.map((b) => (\r\n                                    <span\r\n                                      key={b.id}\r\n                                      className=\"inline-flex items-center rounded-full border border-[var(--rb-border)] bg-white px-2 py-0.5 text-xs text-zinc-700\"\r\n                                      title={`${b.code ? `${b.code} - ` : \"\"}${b.name}`}\r\n                                    >\r\n                                      {b.code ? `${b.code} - ` : \"\"}\r\n                                      {b.name}\r\n                                    </span>\r\n                                  ))}\r\n                                  {more > 0 ? (\r\n                                    <span\r\n                                      className=\"inline-flex items-center rounded-full border border-[var(--rb-border)] bg-white px-2 py-0.5 text-xs text-zinc-700\"\r\n                                      title={overflowTitle}\r\n                                    >\r\n                                      +{more} more\r\n                                    </span>\r\n                                  ) : null}\r\n                                </>\r\n                              )}\r\n                            </div>\r\n                          </div>\r\n                        );\r\n                      },\r\n                    },\r\n                    {\r\n                      id: \"status\",\r\n                      header: \"Status\",\r\n                      sortId: \"status\",\r\n                      className: \"whitespace-nowrap\",\r\n                      cell: (u) => {\r\n                        const s = (u.status ?? \"active\") as UserStatus;\r\n                        return <Badge variant={statusBadgeVariant.get(s) ?? \"default\"}>{s}</Badge>;\r\n                      },\r\n                    },\r\n                    {\r\n                      id: \"actions\",\r\n                      header: \"\",\r\n                      headerClassName: \"text-right\",\r\n                      className: \"whitespace-nowrap text-right\",\r\n                      cell: (u) => {\r\n                        const s = (u.status ?? \"active\") as UserStatus;\r\n                        const rowBusy = actionBusyUserId === u.id || busy;\r\n                        return (\r\n                          <DropdownMenu\r\n                            align=\"right\"\r\n                            trigger={({ toggle }) => (\r\n                              <Button\r\n                                variant=\"ghost\"\r\n                                size=\"sm\"\r\n                                onClick={toggle}\r\n                                disabled={rowBusy}\r\n                                aria-label=\"User actions\"\r\n                                title=\"User actions\"\r\n                                className=\"px-2\"\r\n                              >\r\n                                <PencilIcon className=\"h-4 w-4\" />\r\n                              </Button>\r\n                            )}\r\n                          >\r\n                            {({ close }) => (\r\n                              <>\r\n                                <DropdownMenuItem\r\n                                  onSelect={() => {\r\n                                    close();\r\n                                    openEdit(u);\r\n                                  }}\r\n                                  disabled={rowBusy}\r\n                                >\r\n                                  Edit\r\n                                </DropdownMenuItem>\r\n\r\n                                <DropdownMenuSeparator />\r\n\r\n                                <DropdownMenuItem\r\n                                  onSelect={() => {\r\n                                    close();\r\n                                    openConfirm({\r\n                                      title: \"Send password reset\",\r\n                                      message: (\r\n                                        <div>\r\n                                          Send a password reset link to <span className=\"font-semibold\">{u.email}</span>?\r\n                                        </div>\r\n                                      ),\r\n                                      action: async () => onSendPasswordReset(u.id),\r\n                                    });\r\n                                  }}\r\n                                  disabled={rowBusy}\r\n                                >\r\n                                  Reset password\r\n                                </DropdownMenuItem>\r\n\r\n                                <DropdownMenuSeparator />\r\n\r\n                                <DropdownMenuItem\r\n                                  onSelect={() => {\r\n                                    close();\r\n                                    openConfirm({\r\n                                      title: \"Suspend user\",\r\n                                      message: (\r\n                                        <div>\r\n                                          Suspend <span className=\"font-semibold\">{u.email}</span>? They may lose access\r\n                                          immediately.\r\n                                        </div>\r\n                                      ),\r\n                                      action: async () => onUpdateUserStatus(u.id, \"suspended\"),\r\n                                    });\r\n                                  }}\r\n                                  destructive\r\n                                  disabled={rowBusy || s === \"suspended\"}\r\n                                >\r\n                                  Suspend\r\n                                </DropdownMenuItem>\r\n\r\n                                <DropdownMenuItem\r\n                                  onSelect={() => {\r\n                                    close();\r\n                                    openConfirm({\r\n                                      title: \"Set user inactive\",\r\n                                      message: (\r\n                                        <div>\r\n                                          Set <span className=\"font-semibold\">{u.email}</span> to inactive? They will not\r\n                                          be able to sign in.\r\n                                        </div>\r\n                                      ),\r\n                                      action: async () => onUpdateUserStatus(u.id, \"inactive\"),\r\n                                    });\r\n                                  }}\r\n                                  destructive\r\n                                  disabled={rowBusy || s === \"inactive\"}\r\n                                >\r\n                                  Set inactive\r\n                                </DropdownMenuItem>\r\n\r\n                                <DropdownMenuItem\r\n                                  onSelect={() => {\r\n                                    close();\r\n                                    void onUpdateUserStatus(u.id, \"active\");\r\n                                  }}\r\n                                  disabled={rowBusy || s === \"active\"}\r\n                                >\r\n                                  Activate\r\n                                </DropdownMenuItem>\r\n                              </>\r\n                            )}\r\n                          </DropdownMenu>\r\n                        );\r\n                      },\r\n                    },\r\n                  ]}\r\n                />\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </RequireAuth>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}