{"version":3,"sources":["../../../../../frontend/src/app/admin/tenants/page.tsx","../../../../../frontend/src/components/ui/ResultDialog.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { apiFetch } from \"@/lib/api\";\r\nimport { formatDateTime } from \"@/lib/datetime\";\r\nimport type { Tenant } from \"@/lib/types\";\r\nimport { RequireAuth } from \"@/components/RequireAuth\";\r\nimport { Alert } from \"@/components/ui/Alert\";\r\nimport { Badge } from \"@/components/ui/Badge\";\r\nimport { Button } from \"@/components/ui/Button\";\r\nimport { Card, CardContent } from \"@/components/ui/Card\";\r\nimport { ConfirmDialog } from \"@/components/ui/ConfirmDialog\";\r\nimport { DataTable } from \"@/components/ui/DataTable\";\r\nimport { DropdownMenu, DropdownMenuItem, DropdownMenuSeparator } from \"@/components/ui/DropdownMenu\";\r\nimport { Input } from \"@/components/ui/Input\";\r\nimport { PageHeader } from \"@/components/ui/PageHeader\";\r\nimport { ResultDialog, type ResultDialogStatus } from \"@/components/ui/ResultDialog\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport React, { useEffect, useMemo, useState } from \"react\";\r\n\r\nexport default function AdminTenantsPage() {\r\n  const router = useRouter();\r\n\r\n  const [loading, setLoading] = useState(true);\r\n  const [tenants, setTenants] = useState<Tenant[]>([]);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  const [actionError, setActionError] = useState<string | null>(null);\r\n  const [rowActionBusy, setRowActionBusy] = useState<Record<number, string | null>>({});\r\n\r\n  const [confirmOpen, setConfirmOpen] = useState(false);\r\n  const [confirmTenant, setConfirmTenant] = useState<Tenant | null>(null);\r\n  const [confirmAction, setConfirmAction] = useState<\"suspend\" | \"unsuspend\" | null>(null);\r\n  const [confirmReason, setConfirmReason] = useState<string>(\"\");\r\n\r\n  const [confirmCloseOpen, setConfirmCloseOpen] = useState(false);\r\n  const [confirmCloseTenant, setConfirmCloseTenant] = useState<Tenant | null>(null);\r\n  const [confirmCloseReason, setConfirmCloseReason] = useState<string>(\"\");\r\n  const [confirmCloseRetentionDays, setConfirmCloseRetentionDays] = useState<string>(\"\");\r\n\r\n  const [resultOpen, setResultOpen] = useState(false);\r\n  const [resultStatus, setResultStatus] = useState<ResultDialogStatus>(\"info\");\r\n  const [resultTitle, setResultTitle] = useState<string>(\"\");\r\n  const [resultMessage, setResultMessage] = useState<React.ReactNode | null>(null);\r\n\r\n  const [statsLoading, setStatsLoading] = useState(true);\r\n  const [statsError, setStatsError] = useState<string | null>(null);\r\n  const [stats, setStats] = useState<{ total: number; by_status: Record<string, number> } | null>(null);\r\n\r\n  const [reloadNonce, setReloadNonce] = useState(0);\r\n\r\n  const [q, setQ] = useState<string>(\"\");\r\n\r\n  const [statusFilter, setStatusFilter] = useState<string>(\"all\");\r\n  const [pageIndex, setPageIndex] = useState<number>(0);\r\n  const [pageSize, setPageSize] = useState<number>(10);\r\n  const [totalTenants, setTotalTenants] = useState<number>(0);\r\n  const [sort, setSort] = useState<{ id: string; dir: \"asc\" | \"desc\" } | null>(null);\r\n\r\n  const statusOptions = useMemo(() => {\r\n    return [\r\n      { label: \"All statuses\", value: \"all\" },\r\n      { label: \"Trial\", value: \"trial\" },\r\n      { label: \"Active\", value: \"active\" },\r\n      { label: \"Past due\", value: \"past_due\" },\r\n      { label: \"Suspended\", value: \"suspended\" },\r\n      { label: \"Closed\", value: \"closed\" },\r\n    ];\r\n  }, []);\r\n\r\n  const statusVariant = useMemo(() => {\r\n    return (status: Tenant[\"status\"]) => {\r\n      if (status === \"active\") return \"success\" as const;\r\n      if (status === \"trial\") return \"info\" as const;\r\n      if (status === \"past_due\") return \"warning\" as const;\r\n      if (status === \"suspended\") return \"danger\" as const;\r\n      return \"default\" as const;\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    let alive = true;\r\n\r\n    async function load() {\r\n      try {\r\n        setError(null);\r\n        setLoading(true);\r\n\r\n        const qs = new URLSearchParams();\r\n        if (q.trim().length > 0) qs.set(\"q\", q.trim());\r\n        if (statusFilter && statusFilter !== \"all\") qs.set(\"status\", statusFilter);\r\n        if (sort?.id && sort?.dir) {\r\n          qs.set(\"sort\", sort.id);\r\n          qs.set(\"dir\", sort.dir);\r\n        }\r\n        qs.set(\"page\", String(pageIndex + 1));\r\n        qs.set(\"per_page\", String(pageSize));\r\n\r\n        const res = await apiFetch<{\r\n          tenants: Tenant[];\r\n          meta?: { current_page: number; per_page: number; total: number; last_page: number };\r\n        }>(`/api/admin/businesses?${qs.toString()}`);\r\n\r\n        if (!alive) return;\r\n        setTenants(Array.isArray(res.tenants) ? res.tenants : []);\r\n        setTotalTenants(typeof res.meta?.total === \"number\" ? res.meta.total : 0);\r\n        setPageSize(typeof res.meta?.per_page === \"number\" ? res.meta.per_page : pageSize);\r\n      } catch (e) {\r\n        if (!alive) return;\r\n        setError(e instanceof Error ? e.message : \"Failed to load tenants.\");\r\n      } finally {\r\n        if (!alive) return;\r\n        setLoading(false);\r\n      }\r\n    }\r\n\r\n    void load();\r\n\r\n    return () => {\r\n      alive = false;\r\n    };\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [q, statusFilter, pageIndex, pageSize, sort?.id, sort?.dir, reloadNonce]);\r\n\r\n  useEffect(() => {\r\n    let alive = true;\r\n\r\n    async function loadStats() {\r\n      try {\r\n        setStatsError(null);\r\n        setStatsLoading(true);\r\n\r\n        const qs = new URLSearchParams();\r\n        if (q.trim().length > 0) qs.set(\"q\", q.trim());\r\n        if (statusFilter && statusFilter !== \"all\") qs.set(\"status\", statusFilter);\r\n\r\n        const res = await apiFetch<{ total: number; by_status: Record<string, number> }>(`/api/admin/businesses/stats?${qs.toString()}`);\r\n        if (!alive) return;\r\n        setStats(res);\r\n      } catch (e) {\r\n        if (!alive) return;\r\n        setStatsError(e instanceof Error ? e.message : \"Failed to load stats.\");\r\n        setStats(null);\r\n      } finally {\r\n        if (!alive) return;\r\n        setStatsLoading(false);\r\n      }\r\n    }\r\n\r\n    void loadStats();\r\n\r\n    return () => {\r\n      alive = false;\r\n    };\r\n  }, [q, statusFilter, reloadNonce]);\r\n\r\n  function StatCard({\r\n    label,\r\n    value,\r\n    badge,\r\n    badgeVariant,\r\n    glowClassName,\r\n  }: {\r\n    label: string;\r\n    value: string;\r\n    badge: string;\r\n    badgeVariant: Parameters<typeof Badge>[0][\"variant\"];\r\n    glowClassName: string;\r\n  }) {\r\n    return (\r\n      <Card className=\"relative overflow-hidden\">\r\n        <div className={\"pointer-events-none absolute -right-10 -top-10 h-28 w-28 rounded-full blur-2xl opacity-70 \" + glowClassName} />\r\n        <CardContent className=\"pt-5\">\r\n          <div className=\"flex items-start justify-between gap-3\">\r\n            <div className=\"min-w-0\">\r\n              <div className=\"text-xs font-medium tracking-wide text-zinc-500\">{label}</div>\r\n              <div className=\"mt-1 truncate text-2xl font-semibold text-[var(--rb-text)]\">{value}</div>\r\n            </div>\r\n            <Badge variant={badgeVariant}>{badge}</Badge>\r\n          </div>\r\n          <div className=\"mt-3 h-px w-full bg-[var(--rb-border)]\" />\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  async function runRowAction(\r\n    tenantId: number,\r\n    name: string,\r\n    fn: () => Promise<void>,\r\n  ): Promise<{ ok: true } | { ok: false; error: string } | null> {\r\n    if (!Number.isFinite(tenantId) || tenantId <= 0) return null;\r\n    if (rowActionBusy[tenantId]) return null;\r\n\r\n    setActionError(null);\r\n    setRowActionBusy((m) => ({ ...m, [tenantId]: name }));\r\n    try {\r\n      await fn();\r\n      setReloadNonce((n) => n + 1);\r\n      return { ok: true };\r\n    } catch (e) {\r\n      const msg = e instanceof Error ? e.message : \"Action failed.\";\r\n      setActionError(msg);\r\n      return { ok: false, error: msg };\r\n    } finally {\r\n      setRowActionBusy((m) => ({ ...m, [tenantId]: null }));\r\n    }\r\n  }\r\n\r\n  async function onSuspend(t: Tenant) {\r\n    setConfirmTenant(t);\r\n    setConfirmAction(\"suspend\");\r\n    setConfirmReason(\"\");\r\n    setConfirmOpen(true);\r\n  }\r\n\r\n  async function onUnsuspend(t: Tenant) {\r\n    setConfirmTenant(t);\r\n    setConfirmAction(\"unsuspend\");\r\n    setConfirmReason(\"\");\r\n    setConfirmOpen(true);\r\n  }\r\n\r\n  async function onClose(t: Tenant) {\r\n    setConfirmCloseTenant(t);\r\n    setConfirmCloseReason(\"\");\r\n    setConfirmCloseRetentionDays(\"\");\r\n    setConfirmCloseOpen(true);\r\n  }\r\n\r\n  const confirmBusy = !!confirmTenant && !!confirmAction && rowActionBusy[confirmTenant.id] === confirmAction;\r\n  const confirmCloseBusy = !!confirmCloseTenant && rowActionBusy[confirmCloseTenant.id] === \"close\";\r\n\r\n  async function onConfirmSuspendOrUnsuspend() {\r\n    if (!confirmTenant || !confirmAction) return;\r\n\r\n    const t = confirmTenant;\r\n    const action = confirmAction;\r\n    const reason = confirmReason.trim();\r\n\r\n    const endpoint = action === \"suspend\" ? \"suspend\" : \"unsuspend\";\r\n    const res = await runRowAction(t.id, action, async () => {\r\n      await apiFetch(`/api/admin/businesses/${t.id}/${endpoint}`, {\r\n        method: \"PATCH\",\r\n        body: { reason: reason || undefined },\r\n      });\r\n    });\r\n\r\n    setConfirmOpen(false);\r\n    setConfirmTenant(null);\r\n    setConfirmAction(null);\r\n    setConfirmReason(\"\");\r\n\r\n    if (!res) return;\r\n\r\n    if (res?.ok) {\r\n      setResultStatus(\"success\");\r\n      setResultTitle(action === \"suspend\" ? \"Business suspended\" : \"Business unsuspended\");\r\n      setResultMessage(<div>“{t.name}” was updated successfully.</div>);\r\n      setResultOpen(true);\r\n    } else if (res && !res.ok) {\r\n      setResultStatus(\"error\");\r\n      setResultTitle(\"Action failed\");\r\n      setResultMessage(res.error);\r\n      setResultOpen(true);\r\n    }\r\n  }\r\n\r\n  async function onConfirmClose() {\r\n    if (!confirmCloseTenant) return;\r\n\r\n    const t = confirmCloseTenant;\r\n    const reason = confirmCloseReason.trim();\r\n    const retentionDays = confirmCloseRetentionDays.trim();\r\n    const parsedRetention = retentionDays.length > 0 ? Number(retentionDays) : null;\r\n\r\n    const res = await runRowAction(t.id, \"close\", async () => {\r\n      await apiFetch(`/api/admin/businesses/${t.id}/close`, {\r\n        method: \"PATCH\",\r\n        body: {\r\n          reason: reason || undefined,\r\n          data_retention_days: parsedRetention && Number.isFinite(parsedRetention) ? parsedRetention : undefined,\r\n        },\r\n      });\r\n    });\r\n\r\n    setConfirmCloseOpen(false);\r\n    setConfirmCloseTenant(null);\r\n    setConfirmCloseReason(\"\");\r\n    setConfirmCloseRetentionDays(\"\");\r\n\r\n    if (!res) return;\r\n\r\n    if (res.ok) {\r\n      setResultStatus(\"success\");\r\n      setResultTitle(\"Business closed\");\r\n      setResultMessage(<div>“{t.name}” was closed successfully.</div>);\r\n      setResultOpen(true);\r\n    } else {\r\n      setResultStatus(\"error\");\r\n      setResultTitle(\"Action failed\");\r\n      setResultMessage(res.error);\r\n      setResultOpen(true);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <RequireAuth requiredPermission=\"admin.tenants.read\">\r\n      <div className=\"space-y-6\">\r\n        <PageHeader\r\n          title=\"Businesses\"\r\n          description=\"Manage businesses (admin).\"\r\n          actions={\r\n            <Button\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={() => setReloadNonce((n) => n + 1)}\r\n              disabled={loading}\r\n            >\r\n              Refresh\r\n            </Button>\r\n          }\r\n        />\r\n\r\n        {error ? (\r\n          <Alert variant=\"danger\" title=\"Could not load businesses\">\r\n            {error}\r\n          </Alert>\r\n        ) : null}\r\n\r\n        {actionError ? (\r\n          <Alert variant=\"danger\" title=\"Action failed\">\r\n            {actionError}\r\n          </Alert>\r\n        ) : null}\r\n\r\n        {statsError ? (\r\n          <Alert variant=\"danger\" title=\"Could not load stats\">\r\n            {statsError}\r\n          </Alert>\r\n        ) : null}\r\n\r\n        <div className=\"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-6\">\r\n          <StatCard\r\n            label=\"Total businesses\"\r\n            value={statsLoading ? \"—\" : String(stats?.total ?? 0)}\r\n            badge=\"all\"\r\n            badgeVariant=\"default\"\r\n            glowClassName=\"bg-[color:color-mix(in_srgb,var(--rb-text),white_88%)]\"\r\n          />\r\n          <StatCard\r\n            label=\"Active\"\r\n            value={statsLoading ? \"—\" : String(stats?.by_status?.active ?? 0)}\r\n            badge=\"active\"\r\n            badgeVariant=\"success\"\r\n            glowClassName=\"bg-[color:color-mix(in_srgb,#16a34a,white_75%)]\"\r\n          />\r\n          <StatCard\r\n            label=\"Trial\"\r\n            value={statsLoading ? \"—\" : String(stats?.by_status?.trial ?? 0)}\r\n            badge=\"trial\"\r\n            badgeVariant=\"info\"\r\n            glowClassName=\"bg-[color:color-mix(in_srgb,var(--rb-blue),white_80%)]\"\r\n          />\r\n          <StatCard\r\n            label=\"Past due\"\r\n            value={statsLoading ? \"—\" : String(stats?.by_status?.past_due ?? 0)}\r\n            badge=\"past due\"\r\n            badgeVariant=\"warning\"\r\n            glowClassName=\"bg-[color:color-mix(in_srgb,var(--rb-orange),white_78%)]\"\r\n          />\r\n          <StatCard\r\n            label=\"Suspended\"\r\n            value={statsLoading ? \"—\" : String(stats?.by_status?.suspended ?? 0)}\r\n            badge=\"suspended\"\r\n            badgeVariant=\"danger\"\r\n            glowClassName=\"bg-[color:color-mix(in_srgb,#dc2626,white_78%)]\"\r\n          />\r\n          <StatCard\r\n            label=\"Closed\"\r\n            value={statsLoading ? \"—\" : String(stats?.by_status?.closed ?? 0)}\r\n            badge=\"closed\"\r\n            badgeVariant=\"default\"\r\n            glowClassName=\"bg-[color:color-mix(in_srgb,var(--rb-border),white_55%)]\"\r\n          />\r\n        </div>\r\n\r\n        <Card>\r\n          <CardContent className=\"pt-5\">\r\n            <DataTable\r\n              title=\"Businesses\"\r\n              data={tenants}\r\n              loading={loading}\r\n              emptyMessage=\"No businesses found.\"\r\n              getRowId={(t) => t.id}\r\n              onRowClick={(t) => {\r\n                router.push(`/admin/businesses/${t.id}`);\r\n              }}\r\n              search={{\r\n                placeholder: \"Search name, slug, or email...\",\r\n              }}\r\n              server={{\r\n                query: q,\r\n                onQueryChange: (value) => {\r\n                  setQ(value);\r\n                  setPageIndex(0);\r\n                },\r\n                pageIndex,\r\n                onPageIndexChange: setPageIndex,\r\n                pageSize,\r\n                onPageSizeChange: (value) => {\r\n                  setPageSize(value);\r\n                  setPageIndex(0);\r\n                },\r\n                totalRows: totalTenants,\r\n                sort,\r\n                onSortChange: (next) => {\r\n                  setSort(next);\r\n                  setPageIndex(0);\r\n                },\r\n              }}\r\n              exportConfig={{\r\n                url: \"/api/admin/businesses/export\",\r\n                formats: [\"csv\", \"xlsx\", \"pdf\"],\r\n                filename: ({ format }) => `tenants_export.${format}`,\r\n              }}\r\n              columnVisibilityKey=\"rb:datatable:admin:tenants\"\r\n              filters={[\r\n                {\r\n                  id: \"status\",\r\n                  label: \"Status\",\r\n                  value: statusFilter,\r\n                  options: statusOptions,\r\n                  onChange: (value) => {\r\n                    setStatusFilter(String(value));\r\n                    setPageIndex(0);\r\n                  },\r\n                },\r\n              ]}\r\n              columns={[\r\n                {\r\n                  id: \"id\",\r\n                  header: \"ID\",\r\n                  sortId: \"id\",\r\n                  cell: (t) => <div className=\"text-sm text-zinc-700\">{t.id}</div>,\r\n                  className: \"whitespace-nowrap\",\r\n                },\r\n                {\r\n                  id: \"name\",\r\n                  header: \"Name\",\r\n                  sortId: \"name\",\r\n                  cell: (t) => (\r\n                    <div className=\"min-w-0\">\r\n                      <div className=\"truncate font-semibold text-[var(--rb-text)]\">{t.name}</div>\r\n                      {t.contact_email ? <div className=\"truncate text-xs text-zinc-600\">{t.contact_email}</div> : null}\r\n                    </div>\r\n                  ),\r\n                  className: \"max-w-[420px]\",\r\n                },\r\n                {\r\n                  id: \"slug\",\r\n                  header: \"Slug\",\r\n                  sortId: \"slug\",\r\n                  cell: (t) => <div className=\"text-sm text-zinc-700\">{t.slug}</div>,\r\n                  className: \"whitespace-nowrap\",\r\n                },\r\n                {\r\n                  id: \"status\",\r\n                  header: \"Status\",\r\n                  sortId: \"status\",\r\n                  cell: (t) => <Badge variant={statusVariant(t.status)}>{t.status}</Badge>,\r\n                  className: \"whitespace-nowrap\",\r\n                },\r\n                {\r\n                  id: \"contact_email\",\r\n                  header: \"Contact Email\",\r\n                  sortId: \"contact_email\",\r\n                  hiddenByDefault: true,\r\n                  cell: (t) => <div className=\"text-sm text-zinc-700\">{t.contact_email ?? \"\"}</div>,\r\n                  className: \"whitespace-nowrap\",\r\n                },\r\n                {\r\n                  id: \"created_at\",\r\n                  header: \"Created\",\r\n                  sortId: \"created_at\",\r\n                  hiddenByDefault: true,\r\n                  cell: (t) => <div className=\"text-sm text-zinc-700\">{formatDateTime(t.created_at ?? null)}</div>,\r\n                  className: \"whitespace-nowrap\",\r\n                },\r\n                {\r\n                  id: \"actions\",\r\n                  header: \"\",\r\n                  cell: (t) => {\r\n                    const busy = rowActionBusy[t.id];\r\n                    const canSuspend = t.status !== \"closed\";\r\n                    const canUnsuspend = t.status === \"suspended\";\r\n                    const canClose = t.status !== \"closed\";\r\n\r\n                    return (\r\n                      <div className=\"flex items-center justify-end\">\r\n                        <DropdownMenu\r\n                          align=\"right\"\r\n                          trigger={({ toggle }) => (\r\n                            <Button\r\n                              variant=\"ghost\"\r\n                              size=\"sm\"\r\n                              aria-label=\"Actions\"\r\n                              title=\"Actions\"\r\n                              className=\"px-2\"\r\n                              onClick={(e) => {\r\n                                e.stopPropagation();\r\n                                toggle();\r\n                              }}\r\n                            >\r\n                              <svg viewBox=\"0 0 24 24\" className=\"h-4 w-4\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" aria-hidden=\"true\">\r\n                                <circle cx=\"12\" cy=\"5\" r=\"1.5\" />\r\n                                <circle cx=\"12\" cy=\"12\" r=\"1.5\" />\r\n                                <circle cx=\"12\" cy=\"19\" r=\"1.5\" />\r\n                              </svg>\r\n                            </Button>\r\n                          )}\r\n                        >\r\n                          {({ close }) => (\r\n                            <>\r\n                              <DropdownMenuItem\r\n                                onSelect={() => {\r\n                                  close();\r\n                                  router.push(`/admin/businesses/${t.id}`);\r\n                                }}\r\n                              >\r\n                                View\r\n                              </DropdownMenuItem>\r\n                              <DropdownMenuSeparator />\r\n                              <DropdownMenuItem\r\n                                onSelect={() => {\r\n                                  close();\r\n                                  void onSuspend(t);\r\n                                }}\r\n                                disabled={!!busy || !canSuspend}\r\n                              >\r\n                                {busy === \"suspend\" ? \"…\" : \"Suspend\"}\r\n                              </DropdownMenuItem>\r\n                              <DropdownMenuItem\r\n                                onSelect={() => {\r\n                                  close();\r\n                                  void onUnsuspend(t);\r\n                                }}\r\n                                disabled={!!busy || !canUnsuspend}\r\n                              >\r\n                                {busy === \"unsuspend\" ? \"…\" : \"Unsuspend\"}\r\n                              </DropdownMenuItem>\r\n                              <DropdownMenuItem\r\n                                onSelect={() => {\r\n                                  close();\r\n                                  void onClose(t);\r\n                                }}\r\n                                disabled={!!busy || !canClose}\r\n                                destructive\r\n                              >\r\n                                {busy === \"close\" ? \"…\" : \"Close\"}\r\n                              </DropdownMenuItem>\r\n                            </>\r\n                          )}\r\n                        </DropdownMenu>\r\n                      </div>\r\n                    );\r\n                  },\r\n                  className: \"whitespace-nowrap text-right\",\r\n                  headerClassName: \"text-right\",\r\n                },\r\n              ]}\r\n            />\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <ConfirmDialog\r\n          open={confirmOpen}\r\n          title={confirmAction === \"suspend\" ? \"Suspend business\" : \"Unsuspend business\"}\r\n          message={\r\n            <div className=\"space-y-3\">\r\n              <div>\r\n                {confirmAction === \"suspend\"\r\n                  ? \"This will suspend the business and prevent normal access.\"\r\n                  : \"This will restore access for the business.\"}\r\n              </div>\r\n              <div className=\"space-y-1\">\r\n                <div className=\"text-xs font-medium text-zinc-600\">Reason (optional)</div>\r\n                <Input\r\n                  value={confirmReason}\r\n                  onChange={(e) => setConfirmReason(e.target.value)}\r\n                  placeholder=\"e.g. Non-payment, abuse, user request\"\r\n                />\r\n              </div>\r\n            </div>\r\n          }\r\n          confirmText={confirmAction === \"suspend\" ? \"Suspend\" : \"Unsuspend\"}\r\n          confirmVariant=\"secondary\"\r\n          busy={confirmBusy}\r\n          onCancel={() => {\r\n            setConfirmOpen(false);\r\n            setConfirmTenant(null);\r\n            setConfirmAction(null);\r\n            setConfirmReason(\"\");\r\n          }}\r\n          onConfirm={() => void onConfirmSuspendOrUnsuspend()}\r\n        />\r\n\r\n        <ConfirmDialog\r\n          open={confirmCloseOpen}\r\n          title=\"Close business\"\r\n          message={\r\n            <div className=\"space-y-3\">\r\n              <div>This is a destructive action. The business will be closed.</div>\r\n              <div className=\"space-y-1\">\r\n                <div className=\"text-xs font-medium text-zinc-600\">Reason (optional)</div>\r\n                <Input\r\n                  value={confirmCloseReason}\r\n                  onChange={(e) => setConfirmCloseReason(e.target.value)}\r\n                  placeholder=\"e.g. customer request, duplicate tenant\"\r\n                />\r\n              </div>\r\n              <div className=\"space-y-1\">\r\n                <div className=\"text-xs font-medium text-zinc-600\">Data retention days override (optional)</div>\r\n                <Input\r\n                  type=\"number\"\r\n                  inputMode=\"numeric\"\r\n                  value={confirmCloseRetentionDays}\r\n                  onChange={(e) => setConfirmCloseRetentionDays(e.target.value)}\r\n                  placeholder=\"e.g. 30\"\r\n                />\r\n              </div>\r\n            </div>\r\n          }\r\n          confirmText=\"Close\"\r\n          confirmVariant=\"secondary\"\r\n          busy={confirmCloseBusy}\r\n          onCancel={() => {\r\n            setConfirmCloseOpen(false);\r\n            setConfirmCloseTenant(null);\r\n            setConfirmCloseReason(\"\");\r\n            setConfirmCloseRetentionDays(\"\");\r\n          }}\r\n          onConfirm={() => void onConfirmClose()}\r\n        />\r\n\r\n        <ResultDialog\r\n          open={resultOpen}\r\n          status={resultStatus}\r\n          title={resultTitle}\r\n          message={resultMessage}\r\n          onClose={() => {\r\n            setResultOpen(false);\r\n            setResultMessage(null);\r\n            setResultTitle(\"\");\r\n            setResultStatus(\"info\");\r\n          }}\r\n        />\r\n      </div>\r\n    </RequireAuth>\r\n  );\r\n}\r\n","\"use client\";\r\n\r\nimport React from \"react\";\r\nimport { Modal } from \"@/components/ui/Modal\";\r\nimport { Button } from \"@/components/ui/Button\";\r\nimport { cn } from \"@/lib/cn\";\r\n\r\nexport type ResultDialogStatus = \"info\" | \"success\" | \"warning\" | \"error\";\r\n\r\nfunction ResultIcon({ status, className }: { status: ResultDialogStatus; className?: string }) {\r\n  const common = \"h-5 w-5 shrink-0\";\r\n\r\n  if (status === \"success\") {\r\n    return (\r\n      <svg viewBox=\"0 0 24 24\" className={cn(common, className)} fill=\"none\" stroke=\"currentColor\" strokeWidth={2} strokeLinecap=\"round\" strokeLinejoin=\"round\" aria-hidden=\"true\">\r\n        <path d=\"M20 6L9 17l-5-5\" />\r\n      </svg>\r\n    );\r\n  }\r\n\r\n  if (status === \"warning\") {\r\n    return (\r\n      <svg viewBox=\"0 0 24 24\" className={cn(common, className)} fill=\"none\" stroke=\"currentColor\" strokeWidth={2} strokeLinecap=\"round\" strokeLinejoin=\"round\" aria-hidden=\"true\">\r\n        <path d=\"M12 9v4\" />\r\n        <path d=\"M12 17h.01\" />\r\n        <path d=\"M10.3 3.6l-8.3 14.3A2 2 0 0 0 3.7 21h16.6a2 2 0 0 0 1.7-3.1L13.7 3.6a2 2 0 0 0-3.4 0z\" />\r\n      </svg>\r\n    );\r\n  }\r\n\r\n  if (status === \"error\") {\r\n    return (\r\n      <svg viewBox=\"0 0 24 24\" className={cn(common, className)} fill=\"none\" stroke=\"currentColor\" strokeWidth={2} strokeLinecap=\"round\" strokeLinejoin=\"round\" aria-hidden=\"true\">\r\n        <path d=\"M18 6L6 18\" />\r\n        <path d=\"M6 6l12 12\" />\r\n      </svg>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <svg viewBox=\"0 0 24 24\" className={cn(common, className)} fill=\"none\" stroke=\"currentColor\" strokeWidth={2} strokeLinecap=\"round\" strokeLinejoin=\"round\" aria-hidden=\"true\">\r\n      <path d=\"M12 16v-4\" />\r\n      <path d=\"M12 8h.01\" />\r\n      <path d=\"M12 22a10 10 0 1 0-10-10 10 10 0 0 0 10 10z\" />\r\n    </svg>\r\n  );\r\n}\r\n\r\nexport function ResultDialog({\r\n  open,\r\n  status,\r\n  title,\r\n  message,\r\n  actionText = \"OK\",\r\n  onClose,\r\n}: {\r\n  open: boolean;\r\n  status: ResultDialogStatus;\r\n  title: string;\r\n  message?: React.ReactNode;\r\n  actionText?: string;\r\n  onClose: () => void;\r\n}) {\r\n  const variants: Record<ResultDialogStatus, { icon: string; title: string }> = {\r\n    info: { icon: \"text-[var(--rb-blue)]\", title: \"text-[var(--rb-blue)]\" },\r\n    success: { icon: \"text-[#166534]\", title: \"text-[#166534]\" },\r\n    warning: { icon: \"text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)]\", title: \"text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)]\" },\r\n    error: { icon: \"text-[#991b1b]\", title: \"text-[#991b1b]\" },\r\n  };\r\n\r\n  const v = variants[status];\r\n\r\n  return (\r\n    <Modal\r\n      open={open}\r\n      onClose={onClose}\r\n      position=\"top-center\"\r\n      variant=\"solid\"\r\n      title={\r\n        <div className=\"flex items-center gap-2\">\r\n          <ResultIcon status={status} className={v.icon} />\r\n          <div className={cn(\"text-sm font-semibold\", v.title)}>{title}</div>\r\n        </div>\r\n      }\r\n      footer={\r\n        <div className=\"flex items-center justify-end\">\r\n          <Button variant=\"outline\" onClick={onClose}>\r\n            {actionText}\r\n          </Button>\r\n        </div>\r\n      }\r\n    >\r\n      {message ? <div className=\"text-sm text-zinc-700\">{message}</div> : null}\r\n    </Modal>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}