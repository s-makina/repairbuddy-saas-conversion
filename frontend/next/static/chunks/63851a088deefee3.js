(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,19463,e=>{"use strict";var s=e.i(48277),r=e.i(14575);function i({title:e,description:i,actions:t,className:a}){return(0,s.jsxs)("div",{className:(0,r.cn)("flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between",a),children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-xl font-semibold text-[var(--rb-text)]",children:e}),i?(0,s.jsx)("p",{className:"mt-1 text-sm text-zinc-600",children:i}):null]}),t?(0,s.jsx)("div",{className:"flex items-center gap-2",children:t}):null]})}e.s(["PageHeader",()=>i])},63571,e=>{"use strict";var s=e.i(48277),r=e.i(14575);function i({variant:e,className:i}){let t="h-4 w-4 shrink-0";return"success"===e?(0,s.jsx)("svg",{viewBox:"0 0 24 24",className:(0,r.cn)(t,i),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:(0,s.jsx)("path",{d:"M20 6L9 17l-5-5"})}):"warning"===e?(0,s.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,r.cn)(t,i),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,s.jsx)("path",{d:"M12 9v4"}),(0,s.jsx)("path",{d:"M12 17h.01"}),(0,s.jsx)("path",{d:"M10.3 3.6l-8.3 14.3A2 2 0 0 0 3.7 21h16.6a2 2 0 0 0 1.7-3.1L13.7 3.6a2 2 0 0 0-3.4 0z"})]}):"danger"===e?(0,s.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,r.cn)(t,i),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,s.jsx)("path",{d:"M18 6L6 18"}),(0,s.jsx)("path",{d:"M6 6l12 12"})]}):(0,s.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,r.cn)(t,i),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,s.jsx)("path",{d:"M12 16v-4"}),(0,s.jsx)("path",{d:"M12 8h.01"}),(0,s.jsx)("path",{d:"M12 22a10 10 0 1 0-10-10 10 10 0 0 0 10 10z"})]})}function t({className:e,variant:t="info",title:a,children:l,...n}){let d={info:{wrapper:"border-[color:color-mix(in_srgb,var(--rb-blue),white_75%)] bg-[color:color-mix(in_srgb,var(--rb-blue),white_92%)] text-[var(--rb-text)]",icon:"text-[var(--rb-blue)]",title:"text-[var(--rb-blue)]"},success:{wrapper:"border-[color:color-mix(in_srgb,#16a34a,white_75%)] bg-[color:color-mix(in_srgb,#16a34a,white_92%)] text-[var(--rb-text)]",icon:"text-[#166534]",title:"text-[#166534]"},warning:{wrapper:"border-[color:color-mix(in_srgb,var(--rb-orange),white_70%)] bg-[color:color-mix(in_srgb,var(--rb-orange),white_92%)] text-[var(--rb-text)]",icon:"text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)]",title:"text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)]"},danger:{wrapper:"border-[color:color-mix(in_srgb,#dc2626,white_75%)] bg-[color:color-mix(in_srgb,#dc2626,white_92%)] text-[var(--rb-text)]",icon:"text-[#991b1b]",title:"text-[#991b1b]"}}[t];return(0,s.jsx)("div",{role:"alert",className:(0,r.cn)("rounded-[var(--rb-radius-md)] border px-4 py-3",d.wrapper,e),...n,children:(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)(i,{variant:t,className:(0,r.cn)("mt-0.5",d.icon)}),(0,s.jsxs)("div",{className:"min-w-0",children:[a?(0,s.jsx)("div",{className:(0,r.cn)("text-sm font-semibold",d.title),children:a}):null,l?(0,s.jsx)("div",{className:(0,r.cn)("text-sm text-zinc-700",a?"mt-1":""),children:l}):null]})]})})}e.s(["Alert",()=>t])},68501,e=>{"use strict";var s=e.i(48277),r=e.i(14575);function i({className:e,variant:i="default",...t}){return(0,s.jsx)("span",{className:(0,r.cn)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-medium",{default:"bg-[var(--rb-surface-muted)] text-[var(--rb-text)] border-[var(--rb-border)]",info:"bg-[color:color-mix(in_srgb,var(--rb-blue),white_85%)] text-[var(--rb-blue)] border-[color:color-mix(in_srgb,var(--rb-blue),white_70%)]",success:"bg-[color:color-mix(in_srgb,#16a34a,white_85%)] text-[#166534] border-[color:color-mix(in_srgb,#16a34a,white_70%)]",warning:"bg-[color:color-mix(in_srgb,var(--rb-orange),white_85%)] text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)] border-[color:color-mix(in_srgb,var(--rb-orange),white_70%)]",danger:"bg-[color:color-mix(in_srgb,#dc2626,white_85%)] text-[#991b1b] border-[color:color-mix(in_srgb,#dc2626,white_70%)]"}[i],e),...t})}e.s(["Badge",()=>i])},26550,e=>{"use strict";var s=e.i(48277),r=e.i(14575);function i({className:e,type:i,...t}){return(0,s.jsx)("input",{type:i,className:(0,r.cn)("w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)] outline-none transition","placeholder:text-zinc-400","focus-visible:ring-2 focus-visible:ring-[color:color-mix(in_srgb,var(--rb-orange),white_65%)] focus-visible:ring-offset-2 focus-visible:ring-offset-white","disabled:cursor-not-allowed disabled:bg-[var(--rb-surface-muted)] disabled:opacity-70",e),...t})}e.s(["Input",()=>i])},90256,e=>{"use strict";var s=e.i(48277),r=e.i(30668),i=e.i(1831),t=e.i(1314),a=e.i(77252),l=e.i(63571),n=e.i(63451),d=e.i(68501),o=e.i(9693),c=e.i(72015),m=e.i(26550),u=e.i(19463);function x(){let e=(0,t.useAuth)(),x=e.user,h=e.isImpersonating,p=x?.name??"",b=x?.email??"",v=x?.phone??"",g=x?.address_line1??"",f=x?.address_line2??"",j=x?.address_city??"",_=x?.address_state??"",w=x?.address_postal_code??"",N=x?.address_country??"",[y,C]=(0,r.useState)(p),[k,S]=(0,r.useState)(v),[U,A]=(0,r.useState)(g),[B,F]=(0,r.useState)(f),[z,E]=(0,r.useState)(j),[L,P]=(0,r.useState)(_),[I,T]=(0,r.useState)(w),[M,R]=(0,r.useState)(N),[O,D]=(0,r.useState)(!1),[H,W]=(0,r.useState)(!1),[q,V]=(0,r.useState)(!1),K=(0,r.useRef)(null),[$,Y]=(0,r.useState)(null),[G,J]=(0,r.useState)(null),[Q,X]=(0,r.useState)(!1),[Z,ee]=(0,r.useState)(!1),[es,er]=(0,r.useState)(null),[ei,et]=(0,r.useState)(null);(0,r.useEffect)(()=>{C(x?.name??""),S(x?.phone??""),A(x?.address_line1??""),F(x?.address_line2??""),E(x?.address_city??""),P(x?.address_state??""),T(x?.address_postal_code??""),R(x?.address_country??"")},[x?.address_city,x?.address_country,x?.address_line1,x?.address_line2,x?.address_postal_code,x?.address_state,x?.name,x?.phone]);let ea=!!x?.email_verified_at,el=(0,r.useMemo)(()=>x?x.is_admin?"Admin":x.role??"User":"—",[x]),en=(0,r.useMemo)(()=>{let e=(x?.name??"").trim();if(e){let s=e.split(/\s+/).filter(Boolean),r=s[0]?.[0]??"",i=s.length>1?s[s.length-1]?.[0]??"":"";return`${r}${i}`.toUpperCase().slice(0,2)||"U"}let s=(x?.email??"").trim();return s?s.slice(0,2).toUpperCase():"U"},[x?.email,x?.name]),ed=x?.avatar_url??null,eo=G??ed,ec=!!y.trim()&&!O&&!h,em=y.trim()!==(p??"").trim()||(k.trim()||"")!==(v??"").trim()||(U.trim()||"")!==(g??"").trim()||(B.trim()||"")!==(f??"").trim()||(z.trim()||"")!==(j??"").trim()||(L.trim()||"")!==(_??"").trim()||(I.trim()||"")!==(w??"").trim()||M.trim().toUpperCase()!==(N??"").trim().toUpperCase();async function eu(s){if(s.preventDefault(),er(null),et(null),!x)return void er("Not signed in.");if(h)return void er("Profile updates are disabled during impersonation.");if(!y.trim())return void er("Name is required.");D(!0);try{await (0,i.apiFetch)("/api/auth/me",{method:"PATCH",body:{name:y.trim(),phone:k.trim()||null,address_line1:U.trim()||null,address_line2:B.trim()||null,address_city:z.trim()||null,address_state:L.trim()||null,address_postal_code:I.trim()||null,address_country:M.trim()?M.trim().toUpperCase().slice(0,2):null}}),await e.refresh(),et("Profile updated.")}catch(e){e instanceof i.ApiError?er(e.message):er("Failed to update profile.")}finally{D(!1)}}async function ex(){if(er(null),et(null),!x)return void er("Not signed in.");if(h)return void er("This action is disabled during impersonation.");if(!$)return void er("Please choose a photo first.");X(!0);try{let s=new FormData;s.append("avatar",$),await (0,i.apiFetch)("/api/auth/me/avatar",{method:"POST",body:s}),await e.refresh(),et("Profile photo updated."),Y(null),J(null),K.current&&(K.current.value="")}catch(e){e instanceof i.ApiError?er(e.message):er("Failed to update profile photo.")}finally{X(!1)}}async function eh(){if(er(null),et(null),!x)return void er("Not signed in.");if(h)return void er("This action is disabled during impersonation.");ee(!0);try{await (0,i.apiFetch)("/api/auth/me/avatar",{method:"DELETE"}),await e.refresh(),et("Profile photo removed."),Y(null),J(null),K.current&&(K.current.value="")}catch(e){e instanceof i.ApiError?er(e.message):er("Failed to remove profile photo.")}finally{ee(!1)}}async function ep(){if(er(null),et(null),!b)return void er("Email is missing.");if(h)return void er("This action is disabled during impersonation.");W(!0);try{await (0,i.apiFetch)("/api/auth/password/email",{method:"POST",body:{email:b}}),et("If that email exists, we sent a reset link.")}catch(e){e instanceof i.ApiError?er(e.message):er("Failed to send reset link.")}finally{W(!1)}}async function eb(){if(er(null),et(null),!b)return void er("Email is missing.");if(h)return void er("This action is disabled during impersonation.");V(!0);try{await e.resendVerificationEmail(b),et("Verification email sent. Check your inbox.")}catch(e){e instanceof i.ApiError?er(e.message):er("Failed to resend verification email.")}finally{V(!1)}}return(0,r.useEffect)(()=>()=>{G&&URL.revokeObjectURL(G)},[G]),(0,s.jsx)(a.RequireAuth,{children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)(u.PageHeader,{title:"Profile",description:"Manage your account."}),h?(0,s.jsx)(l.Alert,{variant:"warning",title:"Impersonation active",children:"Editing profile details is disabled while impersonating another user."}):null,es?(0,s.jsx)(l.Alert,{variant:"danger",title:"Could not update profile",children:es}):null,ei?(0,s.jsx)(l.Alert,{variant:"success",title:"Success",children:ei}):null,(0,s.jsxs)(c.Card,{className:"overflow-hidden",children:[(0,s.jsx)("div",{className:"h-20 w-full bg-[var(--rb-surface-muted)]"}),(0,s.jsx)(c.CardContent,{className:"-mt-10",children:(0,s.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-end sm:justify-between",children:[(0,s.jsxs)("div",{className:"flex items-end gap-4",children:[(0,s.jsx)(n.Avatar,{alt:x?.name||b||"User",fallback:en,src:eo,size:72,className:"ring-2 ring-white shadow-sm"}),(0,s.jsxs)("div",{className:"min-w-0",children:[(0,s.jsx)("div",{className:"truncate text-lg font-semibold text-[var(--rb-text)]",children:x?.name||"—"}),(0,s.jsx)("div",{className:"truncate text-sm text-zinc-600",children:b||"—"}),(0,s.jsxs)("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[(0,s.jsx)(d.Badge,{variant:ea?"success":"warning",children:ea?"Email verified":"Email unverified"}),(0,s.jsx)(d.Badge,{children:el}),"number"==typeof x?.id?(0,s.jsxs)(d.Badge,{children:["ID #",x.id]}):null]}),(0,s.jsxs)("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[(0,s.jsx)("input",{ref:K,type:"file",accept:"image/png,image/jpeg,image/webp",className:"hidden",onChange:function(e){let s=e.target.files?.[0]??null;s&&((er(null),et(null),s.type.startsWith("image/"))?s.size>5242880?er("Image must be 5MB or smaller."):(Y(s),J(URL.createObjectURL(s))):er("Please select an image file."))},disabled:h||Q||Z}),(0,s.jsx)(o.Button,{variant:"outline",size:"sm",onClick:()=>K.current?.click(),disabled:h||Q||Z,children:$?"Change selected photo":"Change photo"}),$?(0,s.jsx)(o.Button,{size:"sm",onClick:()=>void ex(),disabled:h||Q||Z,children:Q?"Uploading...":"Upload"}):null,ed?(0,s.jsx)(o.Button,{variant:"ghost",size:"sm",onClick:()=>void eh(),disabled:h||Q||Z,className:"text-zinc-600",children:Z?"Removing...":"Remove"}):null]})]})]}),(0,s.jsxs)("div",{className:"flex flex-col items-start gap-1 text-xs text-zinc-600 sm:items-end",children:[(0,s.jsxs)("div",{children:["Signed in as ",b||"—"]}),(0,s.jsx)("div",{className:"text-[var(--rb-text)]",children:"Changes apply to your current session after saving."})]})]})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-2",children:[(0,s.jsxs)(c.Card,{children:[(0,s.jsx)(c.CardHeader,{children:(0,s.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(c.CardTitle,{children:"Profile details"}),(0,s.jsx)(c.CardDescription,{children:"Update how your name appears across the app."})]}),em?(0,s.jsx)(d.Badge,{variant:"info",children:"Unsaved changes"}):null]})}),(0,s.jsx)(c.CardContent,{children:(0,s.jsxs)("form",{className:"space-y-4",onSubmit:eu,children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("label",{className:"text-sm font-medium",htmlFor:"name",children:"Display name"}),(0,s.jsx)(m.Input,{id:"name",value:y,onChange:e=>C(e.target.value),disabled:O||h,autoComplete:"name",placeholder:"Your name",required:!0})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("label",{className:"text-sm font-medium",htmlFor:"phone",children:"Phone"}),(0,s.jsx)(m.Input,{id:"phone",value:k,onChange:e=>S(e.target.value),disabled:O||h,autoComplete:"tel",placeholder:"Optional"})]}),(0,s.jsxs)("div",{className:"space-y-1 sm:col-span-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium",htmlFor:"address_line1",children:"Address line 1"}),(0,s.jsx)(m.Input,{id:"address_line1",value:U,onChange:e=>A(e.target.value),disabled:O||h,autoComplete:"address-line1",placeholder:"Optional"})]}),(0,s.jsxs)("div",{className:"space-y-1 sm:col-span-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium",htmlFor:"address_line2",children:"Address line 2"}),(0,s.jsx)(m.Input,{id:"address_line2",value:B,onChange:e=>F(e.target.value),disabled:O||h,autoComplete:"address-line2",placeholder:"Optional"})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("label",{className:"text-sm font-medium",htmlFor:"address_city",children:"City"}),(0,s.jsx)(m.Input,{id:"address_city",value:z,onChange:e=>E(e.target.value),disabled:O||h,autoComplete:"address-level2",placeholder:"Optional"})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("label",{className:"text-sm font-medium",htmlFor:"address_state",children:"State / Region"}),(0,s.jsx)(m.Input,{id:"address_state",value:L,onChange:e=>P(e.target.value),disabled:O||h,autoComplete:"address-level1",placeholder:"Optional"})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("label",{className:"text-sm font-medium",htmlFor:"address_postal_code",children:"Postal code"}),(0,s.jsx)(m.Input,{id:"address_postal_code",value:I,onChange:e=>T(e.target.value),disabled:O||h,autoComplete:"postal-code",placeholder:"Optional"})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("label",{className:"text-sm font-medium",htmlFor:"address_country",children:"Country"}),(0,s.jsx)(m.Input,{id:"address_country",value:M,onChange:e=>R(e.target.value.toUpperCase().slice(0,2)),disabled:O||h,autoComplete:"country",placeholder:"US",maxLength:2})]})]}),(0,s.jsx)("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-end",children:(0,s.jsx)(o.Button,{type:"submit",disabled:!ec||!em,children:O?"Saving...":"Save changes"})})]})})]}),(0,s.jsxs)(c.Card,{children:[(0,s.jsxs)(c.CardHeader,{children:[(0,s.jsx)(c.CardTitle,{children:"Account"}),(0,s.jsx)(c.CardDescription,{children:"Security and login-related actions."})]}),(0,s.jsxs)(c.CardContent,{children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[(0,s.jsxs)("div",{className:"rounded-[var(--rb-radius-md)] border border-[var(--rb-border)] bg-[var(--rb-surface-muted)] px-4 py-3",children:[(0,s.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wider text-zinc-500",children:"Email"}),(0,s.jsx)("div",{className:"mt-1 truncate text-sm font-semibold text-[var(--rb-text)]",children:b||"—"}),(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsx)(d.Badge,{variant:ea?"success":"warning",children:ea?"Verified":"Not verified"})})]}),(0,s.jsxs)("div",{className:"rounded-[var(--rb-radius-md)] border border-[var(--rb-border)] bg-[var(--rb-surface-muted)] px-4 py-3",children:[(0,s.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wider text-zinc-500",children:"Role"}),(0,s.jsx)("div",{className:"mt-1 text-sm font-semibold text-[var(--rb-text)]",children:el}),(0,s.jsxs)("div",{className:"mt-1 text-xs text-zinc-600",children:["User ID: ",x?.id??"—"]})]})]}),(0,s.jsx)("div",{className:"mt-4 border-t border-[var(--rb-border)] pt-4",children:(0,s.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row",children:[ea?null:(0,s.jsx)(o.Button,{variant:"outline",onClick:()=>void eb(),disabled:q||h||!b,children:q?"Sending...":"Resend verification email"}),(0,s.jsx)(o.Button,{variant:"outline",onClick:()=>void ep(),disabled:H||h||!b,children:H?"Sending...":"Send password reset email"})]})})]})]})]})]})})}e.s(["default",()=>x])}]);