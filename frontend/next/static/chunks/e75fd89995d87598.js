(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,26550,e=>{"use strict";var i=e.i(48277),r=e.i(14575);function n({className:e,type:n,...a}){return(0,i.jsx)("input",{type:n,className:(0,r.cn)("w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)] outline-none transition","placeholder:text-zinc-400","focus-visible:ring-2 focus-visible:ring-[color:color-mix(in_srgb,var(--rb-orange),white_65%)] focus-visible:ring-offset-2 focus-visible:ring-offset-white","disabled:cursor-not-allowed disabled:bg-[var(--rb-surface-muted)] disabled:opacity-70",e),...a})}e.s(["Input",()=>n])},63571,e=>{"use strict";var i=e.i(48277),r=e.i(14575);function n({variant:e,className:n}){let a="h-4 w-4 shrink-0";return"success"===e?(0,i.jsx)("svg",{viewBox:"0 0 24 24",className:(0,r.cn)(a,n),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:(0,i.jsx)("path",{d:"M20 6L9 17l-5-5"})}):"warning"===e?(0,i.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,r.cn)(a,n),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,i.jsx)("path",{d:"M12 9v4"}),(0,i.jsx)("path",{d:"M12 17h.01"}),(0,i.jsx)("path",{d:"M10.3 3.6l-8.3 14.3A2 2 0 0 0 3.7 21h16.6a2 2 0 0 0 1.7-3.1L13.7 3.6a2 2 0 0 0-3.4 0z"})]}):"danger"===e?(0,i.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,r.cn)(a,n),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,i.jsx)("path",{d:"M18 6L6 18"}),(0,i.jsx)("path",{d:"M6 6l12 12"})]}):(0,i.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,r.cn)(a,n),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,i.jsx)("path",{d:"M12 16v-4"}),(0,i.jsx)("path",{d:"M12 8h.01"}),(0,i.jsx)("path",{d:"M12 22a10 10 0 1 0-10-10 10 10 0 0 0 10 10z"})]})}function a({className:e,variant:a="info",title:s,children:t,...l}){let o={info:{wrapper:"border-[color:color-mix(in_srgb,var(--rb-blue),white_75%)] bg-[color:color-mix(in_srgb,var(--rb-blue),white_92%)] text-[var(--rb-text)]",icon:"text-[var(--rb-blue)]",title:"text-[var(--rb-blue)]"},success:{wrapper:"border-[color:color-mix(in_srgb,#16a34a,white_75%)] bg-[color:color-mix(in_srgb,#16a34a,white_92%)] text-[var(--rb-text)]",icon:"text-[#166534]",title:"text-[#166534]"},warning:{wrapper:"border-[color:color-mix(in_srgb,var(--rb-orange),white_70%)] bg-[color:color-mix(in_srgb,var(--rb-orange),white_92%)] text-[var(--rb-text)]",icon:"text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)]",title:"text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)]"},danger:{wrapper:"border-[color:color-mix(in_srgb,#dc2626,white_75%)] bg-[color:color-mix(in_srgb,#dc2626,white_92%)] text-[var(--rb-text)]",icon:"text-[#991b1b]",title:"text-[#991b1b]"}}[a];return(0,i.jsx)("div",{role:"alert",className:(0,r.cn)("rounded-[var(--rb-radius-md)] border px-4 py-3",o.wrapper,e),...l,children:(0,i.jsxs)("div",{className:"flex gap-3",children:[(0,i.jsx)(n,{variant:a,className:(0,r.cn)("mt-0.5",o.icon)}),(0,i.jsxs)("div",{className:"min-w-0",children:[s?(0,i.jsx)("div",{className:(0,r.cn)("text-sm font-semibold",o.title),children:s}):null,t?(0,i.jsx)("div",{className:(0,r.cn)("text-sm text-zinc-700",s?"mt-1":""),children:t}):null]})]})})}e.s(["Alert",()=>a])},68501,e=>{"use strict";var i=e.i(48277),r=e.i(14575);function n({className:e,variant:n="default",...a}){return(0,i.jsx)("span",{className:(0,r.cn)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-medium",{default:"bg-[var(--rb-surface-muted)] text-[var(--rb-text)] border-[var(--rb-border)]",info:"bg-[color:color-mix(in_srgb,var(--rb-blue),white_85%)] text-[var(--rb-blue)] border-[color:color-mix(in_srgb,var(--rb-blue),white_70%)]",success:"bg-[color:color-mix(in_srgb,#16a34a,white_85%)] text-[#166534] border-[color:color-mix(in_srgb,#16a34a,white_70%)]",warning:"bg-[color:color-mix(in_srgb,var(--rb-orange),white_85%)] text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)] border-[color:color-mix(in_srgb,var(--rb-orange),white_70%)]",danger:"bg-[color:color-mix(in_srgb,#dc2626,white_85%)] text-[#991b1b] border-[color:color-mix(in_srgb,#dc2626,white_70%)]"}[n],e),...a})}e.s(["Badge",()=>n])},43901,e=>{"use strict";var i=e.i(48277),r=e.i(14575),n=e.i(72015);function a({className:e,"aria-hidden":n=!0,...a}){return(0,i.jsx)("div",{"aria-hidden":n,className:(0,r.cn)("rb-skeleton",e),...a})}function s({lines:e=3,className:s}){let t=Math.max(1,Math.min(e,12));return(0,i.jsx)(n.Card,{className:(0,r.cn)("overflow-hidden",s),children:(0,i.jsxs)(n.CardContent,{className:"space-y-3 pt-5",children:[(0,i.jsx)(a,{className:"h-4 w-32 rounded-[var(--rb-radius-sm)]"}),Array.from({length:t}).map((e,n)=>(0,i.jsx)(a,{className:(0,r.cn)("h-3 rounded-[var(--rb-radius-sm)]",n===t-1?"w-3/5":"w-full")},n))]})})}function t({rows:e=6,columns:n=5,className:s}){let t=Math.max(1,Math.min(e,20)),l=Math.max(1,Math.min(n,10));return(0,i.jsxs)("div",{className:(0,r.cn)("overflow-hidden rounded-[var(--rb-radius-lg)] border border-[var(--rb-border)] bg-white shadow-[var(--rb-shadow)]",s),children:[(0,i.jsx)("div",{className:"border-b border-[var(--rb-border)] px-5 py-4",children:(0,i.jsx)("div",{className:"grid gap-3",style:{gridTemplateColumns:`repeat(${l}, minmax(0, 1fr))`},children:Array.from({length:l}).map((e,r)=>(0,i.jsx)(a,{className:"h-3 w-full rounded-[var(--rb-radius-sm)]"},r))})}),(0,i.jsx)("div",{className:"px-5 pb-5 pt-4",children:(0,i.jsx)("div",{className:"space-y-3",children:Array.from({length:t}).map((e,n)=>(0,i.jsx)("div",{className:"grid gap-3",style:{gridTemplateColumns:`repeat(${l}, minmax(0, 1fr))`},children:Array.from({length:l}).map((e,n)=>(0,i.jsx)(a,{className:(0,r.cn)("h-3 rounded-[var(--rb-radius-sm)]",0===n?"w-3/4":"w-full")},n))},n))})})]})}e.s(["CardSkeleton",()=>s,"Skeleton",()=>a,"TableSkeleton",()=>t])},66474,e=>{"use strict";var i=e.i(48277),r=e.i(30668),n=e.i(14575);function a({open:e,onClose:a,title:s,children:t,footer:l,position:o="center",variant:d="glass",className:c}){if((0,r.useEffect)(()=>{function i(i){e&&"Escape"===i.key&&a()}return document.addEventListener("keydown",i),()=>document.removeEventListener("keydown",i)},[a,e]),!e)return null;let m="solid"===d?(0,n.cn)("relative w-full max-w-lg overflow-hidden rounded-[var(--rb-radius-lg)]","border border-[var(--rb-border)]","bg-white","shadow-[var(--rb-shadow)]"):(0,n.cn)("relative w-full max-w-lg overflow-hidden rounded-[var(--rb-radius-lg)]","border border-[color:color-mix(in_srgb,var(--rb-border),white_55%)]","bg-white/75 backdrop-blur-xl","shadow-[0_18px_55px_-18px_rgba(0,0,0,0.55)]","ring-1 ring-white/25");return(0,i.jsxs)("div",{className:"top-center"===o?"fixed inset-0 z-50 flex items-start justify-center px-4 pt-8":"fixed inset-0 z-50 flex items-center justify-center px-4",children:[(0,i.jsx)("button",{type:"button",className:(0,n.cn)("absolute inset-0","bg-black/35 backdrop-blur-md","bg-[radial-gradient(900px_600px_at_20%_20%,color-mix(in_srgb,#16a34a,transparent_82%)_0%,transparent_60%),radial-gradient(900px_600px_at_80%_30%,color-mix(in_srgb,var(--rb-blue),transparent_82%)_0%,transparent_60%),radial-gradient(900px_600px_at_50%_85%,color-mix(in_srgb,var(--rb-orange),transparent_85%)_0%,transparent_65%)]"),"aria-label":"Close",onClick:a}),(0,i.jsxs)("div",{role:"dialog","aria-modal":"true",className:(0,n.cn)(m,c),children:["glass"===d?(0,i.jsx)("div",{className:"pointer-events-none absolute inset-0 bg-[radial-gradient(650px_420px_at_20%_15%,color-mix(in_srgb,#16a34a,transparent_88%)_0%,transparent_60%),radial-gradient(650px_420px_at_80%_5%,color-mix(in_srgb,var(--rb-blue),transparent_90%)_0%,transparent_60%)]"}):null,s?(0,i.jsx)("div",{className:(0,n.cn)("relative px-5 py-4","solid"===d?"border-b border-[var(--rb-border)]":"border-b border-[color:color-mix(in_srgb,var(--rb-border),white_60%)]"),children:(0,i.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:s})}):null,(0,i.jsx)("div",{className:"relative px-5 py-4",children:t}),l?(0,i.jsx)("div",{className:(0,n.cn)("relative px-5 py-4","solid"===d?"border-t border-[var(--rb-border)]":"border-t border-[color:color-mix(in_srgb,var(--rb-border),white_60%)]"),children:l}):null]})]})}e.s(["Modal",()=>a])},21190,e=>{"use strict";var i=e.i(1831);async function r(e){let r=new URLSearchParams;return"boolean"==typeof e?.includeInactive&&r.set("include_inactive",e.includeInactive?"1":"0"),(0,i.apiFetch)(`/api/admin/billing/catalog${r.toString()?`?${r.toString()}`:""}`)}async function n(e){let r=new URLSearchParams;return"boolean"==typeof e?.includeInactive&&r.set("include_inactive",e.includeInactive?"1":"0"),(0,i.apiFetch)(`/api/admin/billing/intervals${r.toString()?`?${r.toString()}`:""}`)}async function a(e){return(0,i.apiFetch)("/api/admin/billing/intervals",{method:"POST",body:{code:e.code?.trim()||void 0,name:e.name,months:e.months,is_active:"boolean"==typeof e.isActive?e.isActive:void 0}})}async function s(e){return(0,i.apiFetch)(`/api/admin/billing/intervals/${e.intervalId}`,{method:"PUT",body:{code:e.code,name:e.name,months:e.months,is_active:"boolean"==typeof e.isActive?e.isActive:void 0,reason:e.reason}})}async function t(e){return(0,i.apiFetch)(`/api/admin/billing/intervals/${e.intervalId}/active`,{method:"PATCH",body:{is_active:e.isActive,reason:e.reason}})}async function l(e){return(0,i.apiFetch)("/api/admin/billing/plans",{method:"POST",body:{name:e.name,code:e.code?.trim()||void 0,description:e.description?.trim()||void 0,is_active:"boolean"==typeof e.isActive?e.isActive:void 0}})}async function o(e){return(0,i.apiFetch)(`/api/admin/billing/plans/${e.planId}`,{method:"PUT",body:{name:e.name,code:e.code,description:e.description?.trim()||void 0,is_active:"boolean"==typeof e.isActive?e.isActive:void 0,reason:e.reason}})}async function d(e){return(0,i.apiFetch)(`/api/admin/billing/plans/${e.planId}/versions/draft-from-active`,{method:"POST",body:{reason:e.reason}})}async function c(e){try{return await (0,i.apiFetch)(`/api/admin/billing/versions/${e.versionId}/validate`,{method:"POST",body:{reason:e.reason}})}catch(e){if(e instanceof i.ApiError){let i=e.data;if(i&&"object"==typeof i){if("ok"===i.status)return{status:"ok"};if("string"==typeof i.message)return{message:i.message,errors:Array.isArray(i.errors)?i.errors.map(String):void 0}}}throw e}}async function m(e){return(0,i.apiFetch)(`/api/admin/billing/versions/${e.versionId}/entitlements/sync`,{method:"POST",body:{entitlements:e.entitlements,reason:e.reason}})}async function u(e){return(0,i.apiFetch)(`/api/admin/billing/versions/${e.versionId}/prices`,{method:"POST",body:{currency:e.currency,billing_interval_id:"number"==typeof e.billingIntervalId?e.billingIntervalId:void 0,interval:e.interval,amount_cents:e.amountCents,trial_days:"number"==typeof e.trialDays?e.trialDays:void 0,is_default:"boolean"==typeof e.isDefault?e.isDefault:void 0,reason:e.reason}})}async function b(e){return(0,i.apiFetch)(`/api/admin/billing/prices/${e.priceId}`,{method:"PATCH",body:{amount_cents:e.amountCents,trial_days:"number"==typeof e.trialDays?e.trialDays:void 0,is_default:"boolean"==typeof e.isDefault?e.isDefault:void 0,reason:e.reason}})}async function x(e){return(0,i.apiFetch)(`/api/admin/billing/prices/${e.priceId}`,{method:"DELETE",body:{reason:e.reason}})}async function v(e){return(0,i.apiFetch)(`/api/admin/billing/versions/${e.versionId}/activate`,{method:"POST",body:{confirm:e.confirm,reason:e.reason}})}async function p(e){return(0,i.apiFetch)("/api/admin/billing/entitlement-definitions",{method:"POST",body:{code:e.code?.trim()||void 0,name:e.name,value_type:e.valueType,description:e.description?.trim()||void 0,is_premium:"boolean"==typeof e.isPremium?e.isPremium:void 0}})}async function h(e){return(0,i.apiFetch)(`/api/admin/billing/entitlement-definitions/${e.id}`,{method:"PUT",body:{code:e.code,name:e.name,value_type:e.valueType,description:e.description?.trim()||void 0,is_premium:"boolean"==typeof e.isPremium?e.isPremium:void 0,reason:e.reason}})}async function g(e){return(0,i.apiFetch)(`/api/admin/billing/entitlement-definitions/${e.id}`,{method:"DELETE",body:{reason:e.reason}})}async function f(e){return(0,i.apiFetch)(`/api/admin/businesses/${e}/subscriptions`)}async function j(e){return(0,i.apiFetch)(`/api/admin/businesses/${e.tenantId}/subscriptions`,{method:"POST",body:{billing_plan_version_id:e.billingPlanVersionId,billing_price_id:e.billingPriceId,reason:e.reason}})}async function y(e){return(0,i.apiFetch)(`/api/admin/businesses/${e.tenantId}/subscriptions/${e.subscriptionId}/cancel`,{method:"POST",body:{at_period_end:"boolean"==typeof e.atPeriodEnd?e.atPeriodEnd:void 0,reason:e.reason}})}async function N(e){let r=new URLSearchParams;return e.status&&e.status.trim().length>0&&r.set("status",e.status.trim()),"number"==typeof e.limit&&Number.isFinite(e.limit)&&r.set("limit",String(e.limit)),(0,i.apiFetch)(`/api/admin/businesses/${e.tenantId}/invoices${r.toString()?`?${r.toString()}`:""}`)}async function w(e){return(0,i.apiFetch)(`/api/admin/businesses/${e.tenantId}/invoices/${e.invoiceId}`)}async function _(e){return(0,i.apiFetch)(`/api/admin/businesses/${e.tenantId}/invoices`,{method:"POST",body:{tenant_subscription_id:e.tenantSubscriptionId,reason:e.reason}})}async function S(e){return(0,i.apiFetch)(`/api/admin/businesses/${e.tenantId}/invoices/${e.invoiceId}/issue`,{method:"POST",body:{reason:e.reason}})}async function k(e){return(0,i.apiFetch)(`/api/admin/businesses/${e.tenantId}/invoices/${e.invoiceId}/paid`,{method:"POST",body:{paid_at:e.paidAt,paid_method:e.paidMethod,paid_note:e.paidNote,reason:e.reason}})}async function C(e){let r=e.invoiceNumber?`invoice_${e.invoiceNumber}.pdf`:"invoice.pdf";await (0,i.apiDownload)(`/api/admin/businesses/${e.tenantId}/invoices/${e.invoiceId}/pdf`,{filename:r})}e.s(["activateBillingPlanVersion",()=>v,"assignTenantSubscription",()=>j,"cancelTenantSubscription",()=>y,"createBillingInterval",()=>a,"createBillingPlan",()=>l,"createBillingPrice",()=>u,"createDraftBillingPlanVersionFromActive",()=>d,"createEntitlementDefinition",()=>p,"createInvoiceFromSubscription",()=>_,"deleteBillingPrice",()=>x,"deleteEntitlementDefinition",()=>g,"downloadInvoicePdf",()=>C,"getBillingCatalog",()=>r,"getTenantInvoice",()=>w,"getTenantInvoices",()=>N,"getTenantSubscriptions",()=>f,"issueInvoice",()=>S,"listBillingIntervals",()=>n,"markInvoicePaid",()=>k,"setBillingIntervalActive",()=>t,"syncBillingPlanVersionEntitlements",()=>m,"updateBillingInterval",()=>s,"updateBillingPlan",()=>o,"updateBillingPrice",()=>b,"updateEntitlementDefinition",()=>h,"validateBillingPlanVersionDraft",()=>c])},4234,e=>{"use strict";var i=e.i(48277),r=e.i(30668),n=e.i(16506),a=e.i(77252),s=e.i(24273),t=e.i(63571),l=e.i(68501),o=e.i(9693),d=e.i(72015),c=e.i(43901),m=e.i(66474),u=e.i(26550),b=e.i(21190),x=e.i(1314);function v(e){let i=Array.isArray(e.versions)?e.versions:[],r=i.find(e=>"active"===e.status)??null;return r||(i.slice().sort((e,i)=>(i.version??0)-(e.version??0))[0]??null)}function p({className:e}){return(0,i.jsx)("svg",{viewBox:"0 0 24 24",className:e,fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:(0,i.jsx)("path",{d:"M20 6L9 17l-5-5"})})}function h(){return(0,i.jsxs)(d.Card,{className:"relative overflow-hidden",children:[(0,i.jsx)("div",{className:"h-1.5 w-full bg-[var(--rb-border)]"}),(0,i.jsx)(d.CardHeader,{className:"pb-3",children:(0,i.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,i.jsxs)("div",{className:"min-w-0",children:[(0,i.jsx)(c.Skeleton,{className:"h-5 w-40 rounded-[var(--rb-radius-sm)]"}),(0,i.jsxs)("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[(0,i.jsx)(c.Skeleton,{className:"h-3 w-16 rounded-[var(--rb-radius-sm)]"}),(0,i.jsx)(c.Skeleton,{className:"h-5 w-24 rounded-full"})]})]}),(0,i.jsxs)("div",{className:"text-right",children:[(0,i.jsx)(c.Skeleton,{className:"ml-auto h-8 w-28 rounded-[var(--rb-radius-sm)]"}),(0,i.jsx)("div",{className:"mt-2 flex items-center justify-end gap-2",children:(0,i.jsx)(c.Skeleton,{className:"h-5 w-16 rounded-full"})})]})]})}),(0,i.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(c.Skeleton,{className:"h-3 w-full rounded-[var(--rb-radius-sm)]"}),(0,i.jsx)(c.Skeleton,{className:"h-3 w-4/5 rounded-[var(--rb-radius-sm)]"})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(c.Skeleton,{className:"h-3 w-44 rounded-[var(--rb-radius-sm)]"}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(c.Skeleton,{className:"h-4 w-4 rounded-[var(--rb-radius-sm)]"}),(0,i.jsx)(c.Skeleton,{className:"h-3 w-2/3 rounded-[var(--rb-radius-sm)]"})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(c.Skeleton,{className:"h-4 w-4 rounded-[var(--rb-radius-sm)]"}),(0,i.jsx)(c.Skeleton,{className:"h-3 w-1/2 rounded-[var(--rb-radius-sm)]"})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(c.Skeleton,{className:"h-4 w-4 rounded-[var(--rb-radius-sm)]"}),(0,i.jsx)(c.Skeleton,{className:"h-3 w-3/5 rounded-[var(--rb-radius-sm)]"})]})]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-3 border-t border-[var(--rb-border)] pt-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(c.Skeleton,{className:"h-3 w-24 rounded-[var(--rb-radius-sm)]"}),(0,i.jsx)("div",{className:"mt-2",children:(0,i.jsx)(c.Skeleton,{className:"h-4 w-28 rounded-[var(--rb-radius-sm)]"})})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(c.Skeleton,{className:"h-3 w-20 rounded-[var(--rb-radius-sm)]"}),(0,i.jsx)("div",{className:"mt-2",children:(0,i.jsx)(c.Skeleton,{className:"h-4 w-24 rounded-[var(--rb-radius-sm)]"})})]})]}),(0,i.jsx)("div",{className:"flex items-center justify-end gap-2 pt-1",children:(0,i.jsx)(c.Skeleton,{className:"h-9 w-24 rounded-[var(--rb-radius-sm)]"})})]})]})}function g(){let e=(0,x.useAuth)(),c=(0,s.useDashboardHeader)(),[g,f]=(0,r.useState)(!0),[j,y]=(0,r.useState)(null),[N,w]=(0,r.useState)([]),[_,S]=(0,r.useState)(0),[k,C]=(0,r.useState)(""),[I,A]=(0,r.useState)(!1),[P,$]=(0,r.useState)(!1),[B,T]=(0,r.useState)(null),[F,z]=(0,r.useState)(""),[L,E]=(0,r.useState)(""),[M,D]=(0,r.useState)(""),[O,U]=(0,r.useState)(!0),H=e.can("admin.billing.write");async function R(){let e=F.trim();if(!e)return void T("Name is required.");$(!0),T(null);try{await (0,b.createBillingPlan)({name:e,code:L,description:M,isActive:O}),A(!1),S(e=>e+1)}catch(e){T(e instanceof Error?e.message:"Failed to create billing plan.")}finally{$(!1)}}(0,r.useEffect)(()=>(c.setHeader({breadcrumb:"Admin / Billing",title:"Billing plans",subtitle:"View billing catalog (plans, versions, prices)",actions:(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[H?(0,i.jsx)(n.default,{href:"/admin/billing/builder",children:(0,i.jsx)(o.Button,{variant:"outline",size:"sm",disabled:g,children:"New plan"})}):null,(0,i.jsx)(o.Button,{variant:"outline",size:"sm",onClick:()=>S(e=>e+1),disabled:g,children:"Refresh"})]})}),()=>c.setHeader(null)),[H,c,g]),(0,r.useEffect)(()=>{let e=!0;return async function(){try{f(!0),y(null);let i=await (0,b.getBillingCatalog)({includeInactive:!0});if(!e)return;w(Array.isArray(i.billing_plans)?i.billing_plans:[])}catch(i){if(!e)return;y(i instanceof Error?i.message:"Failed to load billing catalog."),w([])}finally{if(!e)return;f(!1)}}(),()=>{e=!1}},[_]);let V=(0,r.useMemo)(()=>{let e=k.trim().toLowerCase();return e?N.filter(i=>`${i.name} ${i.code}`.toLowerCase().includes(e)):N},[N,k]);return(0,i.jsx)(a.RequireAuth,{requiredPermission:"admin.billing.read",children:(0,i.jsxs)("div",{className:"space-y-6",children:[j?(0,i.jsx)(t.Alert,{variant:"danger",title:"Could not load billing plans",children:j}):null,(0,i.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between",children:[(0,i.jsxs)("div",{className:"min-w-0",children:[(0,i.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:"Plans"}),(0,i.jsx)("div",{className:"mt-1 text-sm text-zinc-600",children:"Browse plans, pricing and current versions."})]}),(0,i.jsx)("div",{className:"w-full sm:w-[360px]",children:(0,i.jsx)(u.Input,{value:k,onChange:e=>C(e.target.value),placeholder:"Search by name or code…"})})]}),g?(0,i.jsx)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 xl:grid-cols-3",children:Array.from({length:6}).map((e,r)=>(0,i.jsx)(h,{},r))}):null,g||0!==V.length?null:(0,i.jsx)("div",{className:"text-sm text-zinc-500",children:"No billing plans found."}),!g&&V.length>0?(0,i.jsx)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 xl:grid-cols-3",children:V.map(e=>{let r,a,s=v(e),t=function(e){if(!e)return null;let i=Array.isArray(e.prices)?e.prices:[];return i.find(e=>e.is_default)??null??i[0]??null}(s),c=Array.from(new Set((Array.isArray(e.versions)?e.versions:[]).flatMap(e=>Array.isArray(e.prices)?e.prices:[]).map(e=>e.currency).filter(Boolean))).map(e=>String(e).toUpperCase()).sort(),m="pro"===String(e.code||"").toLowerCase(),u=(r=v(e),Array.from(new Set((Array.isArray(r?.entitlements)?r?.entitlements:[]).map(e=>e&&"object"==typeof e&&"definition"in e?e.definition?.name:void 0).filter(Boolean).map(e=>String(e)))));return(0,i.jsxs)(d.Card,{className:"relative overflow-hidden transition-all hover:-translate-y-0.5 hover:shadow-[var(--rb-shadow)] "+(m?"border-[color:color-mix(in_srgb,var(--rb-orange),white_35%)] shadow-[var(--rb-shadow)]":""),children:[(0,i.jsx)("div",{className:"h-1.5 w-full "+(m?"bg-[var(--rb-orange)]":e.is_active?"bg-[var(--rb-blue)]":"bg-[var(--rb-border)]")}),(0,i.jsx)(d.CardHeader,{className:"pb-3",children:(0,i.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,i.jsxs)("div",{className:"min-w-0",children:[(0,i.jsx)(d.CardTitle,{className:"truncate",children:e.name}),(0,i.jsxs)("div",{className:"mt-1 flex flex-wrap items-center gap-2",children:[(0,i.jsx)("div",{className:"truncate text-xs text-zinc-500",children:e.code}),m?(0,i.jsx)(l.Badge,{variant:"warning",children:"Most popular"}):null]})]}),(0,i.jsxs)("div",{className:"text-right",children:[(0,i.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,i.jsx)("div",{className:"text-2xl font-semibold tracking-tight text-[var(--rb-text)]",children:t?function(e){let i=(e.currency||"usd").toUpperCase(),r=("number"==typeof e.amountCents?e.amountCents:0)/100;try{return new Intl.NumberFormat(void 0,{style:"currency",currency:i,maximumFractionDigits:2}).format(r)}catch{return`${i} ${r.toFixed(2)}`}}({currency:t.currency,amountCents:t.amount_cents}):"—"}),(0,i.jsx)("div",{className:"pt-1 text-sm text-zinc-600",children:t&&(a=String(t.interval||"").toLowerCase())?"month"===a||"monthly"===a?"/mo":"year"===a||"yearly"===a||"annual"===a?"/yr":`/${a}`:""})]}),(0,i.jsx)("div",{className:"mt-1 flex items-center justify-end gap-2",children:(0,i.jsx)(l.Badge,{variant:e.is_active?"success":"default",children:e.is_active?"active":"inactive"})})]})]})}),(0,i.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,i.jsx)("div",{className:"text-sm text-zinc-700",children:e.description??"—"}),(0,i.jsxs)("div",{className:"space-y-2",children:[t?.trial_days?(0,i.jsxs)("div",{className:"text-xs text-zinc-500",children:[t.trial_days," day trial included"]}):null,(0,i.jsx)("ul",{className:"space-y-1",children:u.length>0?u.map(e=>(0,i.jsxs)("li",{className:"flex items-start gap-2 text-sm text-zinc-700",children:[(0,i.jsx)(p,{className:"mt-0.5 h-4 w-4 shrink-0 text-[var(--rb-blue)]"}),(0,i.jsx)("span",{className:"min-w-0",children:e})]},e)):(0,i.jsx)("li",{className:"text-sm text-zinc-500",children:"No entitlements configured."})})]}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-3 border-t border-[var(--rb-border)] pt-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"text-xs text-zinc-500",children:"Current version"}),(0,i.jsx)("div",{className:"mt-1 text-sm font-medium text-zinc-800",children:s?`v${s.version} (${s.status})`:"—"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"text-xs text-zinc-500",children:"Currencies"}),(0,i.jsx)("div",{className:"mt-1 text-sm font-medium text-zinc-800",children:c.length>0?c.join(", "):"—"})]})]}),(0,i.jsx)("div",{className:"flex items-center justify-end gap-2 pt-1",children:(0,i.jsx)(n.default,{href:`/admin/billing/plans/${e.id}`,children:(0,i.jsx)(o.Button,{variant:m?"secondary":"outline",size:"sm",children:"View plan"})})})]})]},e.id)})}):null,(0,i.jsxs)("div",{className:"text-sm text-zinc-500",children:["Entitlements definitions are available under"," ",(0,i.jsx)(n.default,{className:"underline",href:"/admin/billing/entitlements",children:"Billing / Entitlements"}),"."]}),(0,i.jsx)(m.Modal,{open:I,onClose:()=>{P||A(!1)},title:"Create billing plan",footer:(0,i.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,i.jsx)(o.Button,{variant:"outline",onClick:()=>{P||A(!1)},disabled:P,children:"Cancel"}),(0,i.jsx)(o.Button,{variant:"primary",onClick:()=>void R(),disabled:P,children:P?"Creating…":"Create"})]}),children:(0,i.jsxs)("div",{className:"space-y-4",children:[B?(0,i.jsx)(t.Alert,{variant:"danger",title:"Cannot create plan",children:B}):null,(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsx)("label",{className:"text-sm font-medium",children:"Name"}),(0,i.jsx)(u.Input,{value:F,onChange:e=>z(e.target.value),placeholder:"e.g. Starter"})]}),(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsx)("label",{className:"text-sm font-medium",children:"Code (optional)"}),(0,i.jsx)(u.Input,{value:L,onChange:e=>E(e.target.value),placeholder:"e.g. starter"}),(0,i.jsx)("div",{className:"text-xs text-zinc-500",children:"If empty, it will be generated from the name."})]}),(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsx)("label",{className:"text-sm font-medium",children:"Description (optional)"}),(0,i.jsx)("textarea",{className:"min-h-[90px] w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:M,onChange:e=>D(e.target.value),placeholder:"Short description shown to admins…"})]}),(0,i.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,i.jsx)("input",{type:"checkbox",checked:O,onChange:e=>U(e.target.checked)}),"Active"]}),(0,i.jsx)("div",{className:"text-xs text-zinc-500",children:"A draft version v1 will be created automatically."})]})})]})})}e.s(["default",()=>g])}]);