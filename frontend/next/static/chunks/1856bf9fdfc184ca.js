(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,68501,e=>{"use strict";var t=e.i(48277),r=e.i(14575);function s({className:e,variant:s="default",...a}){return(0,t.jsx)("span",{className:(0,r.cn)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-medium",{default:"bg-[var(--rb-surface-muted)] text-[var(--rb-text)] border-[var(--rb-border)]",info:"bg-[color:color-mix(in_srgb,var(--rb-blue),white_85%)] text-[var(--rb-blue)] border-[color:color-mix(in_srgb,var(--rb-blue),white_70%)]",success:"bg-[color:color-mix(in_srgb,#16a34a,white_85%)] text-[#166534] border-[color:color-mix(in_srgb,#16a34a,white_70%)]",warning:"bg-[color:color-mix(in_srgb,var(--rb-orange),white_85%)] text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)] border-[color:color-mix(in_srgb,var(--rb-orange),white_70%)]",danger:"bg-[color:color-mix(in_srgb,#dc2626,white_85%)] text-[#991b1b] border-[color:color-mix(in_srgb,#dc2626,white_70%)]"}[s],e),...a})}e.s(["Badge",()=>s])},19463,e=>{"use strict";var t=e.i(48277),r=e.i(14575);function s({title:e,description:s,actions:a,className:i}){return(0,t.jsxs)("div",{className:(0,r.cn)("flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between",i),children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-xl font-semibold text-[var(--rb-text)]",children:e}),s?(0,t.jsx)("p",{className:"mt-1 text-sm text-zinc-600",children:s}):null]}),a?(0,t.jsx)("div",{className:"flex items-center gap-2",children:a}):null]})}e.s(["PageHeader",()=>s])},43901,e=>{"use strict";var t=e.i(48277),r=e.i(14575),s=e.i(72015);function a({className:e,"aria-hidden":s=!0,...a}){return(0,t.jsx)("div",{"aria-hidden":s,className:(0,r.cn)("rb-skeleton",e),...a})}function i({lines:e=3,className:i}){let l=Math.max(1,Math.min(e,12));return(0,t.jsx)(s.Card,{className:(0,r.cn)("overflow-hidden",i),children:(0,t.jsxs)(s.CardContent,{className:"space-y-3 pt-5",children:[(0,t.jsx)(a,{className:"h-4 w-32 rounded-[var(--rb-radius-sm)]"}),Array.from({length:l}).map((e,s)=>(0,t.jsx)(a,{className:(0,r.cn)("h-3 rounded-[var(--rb-radius-sm)]",s===l-1?"w-3/5":"w-full")},s))]})})}function l({rows:e=6,columns:s=5,className:i}){let l=Math.max(1,Math.min(e,20)),n=Math.max(1,Math.min(s,10));return(0,t.jsxs)("div",{className:(0,r.cn)("overflow-hidden rounded-[var(--rb-radius-lg)] border border-[var(--rb-border)] bg-white shadow-[var(--rb-shadow)]",i),children:[(0,t.jsx)("div",{className:"border-b border-[var(--rb-border)] px-5 py-4",children:(0,t.jsx)("div",{className:"grid gap-3",style:{gridTemplateColumns:`repeat(${n}, minmax(0, 1fr))`},children:Array.from({length:n}).map((e,r)=>(0,t.jsx)(a,{className:"h-3 w-full rounded-[var(--rb-radius-sm)]"},r))})}),(0,t.jsx)("div",{className:"px-5 pb-5 pt-4",children:(0,t.jsx)("div",{className:"space-y-3",children:Array.from({length:l}).map((e,s)=>(0,t.jsx)("div",{className:"grid gap-3",style:{gridTemplateColumns:`repeat(${n}, minmax(0, 1fr))`},children:Array.from({length:n}).map((e,s)=>(0,t.jsx)(a,{className:(0,r.cn)("h-3 rounded-[var(--rb-radius-sm)]",0===s?"w-3/4":"w-full")},s))},s))})})]})}e.s(["CardSkeleton",()=>i,"Skeleton",()=>a,"TableSkeleton",()=>l])},37574,e=>{"use strict";var t=e.i(48277),r=e.i(30668),s=e.i(14575),a=e.i(9693),i=e.i(33441),l=e.i(43901),n=e.i(1831);function d({title:e,data:d,columns:c,getRowId:o,loading:m=!1,emptyMessage:u="No data.",search:x,filters:h=[],pageSizeOptions:b=[10,25,50],initialPageSize:g=10,server:p,exportConfig:v,columnVisibilityKey:f,onRowClick:j,className:N}){let[y,w]=(0,r.useState)(""),[_,S]=(0,r.useState)(0),[C,k]=(0,r.useState)(g),[M,D]=(0,r.useState)(null),[z,A]=(0,r.useState)(null),[T,$]=(0,r.useState)(0),B=(0,r.useId)(),I=!!p,F=I?p.query:y,J=I?p.onQueryChange:w,R=I?p.pageIndex:_,U=I?p.onPageIndexChange:S,E=I?p.pageSize:C,P=I?p.onPageSizeChange:k,L=I?p.sort??null:null,O=I?p.onSortChange:void 0,H=(0,r.useMemo)(()=>{let e=Array.isArray(c)?c:[];if(!f){let t=e.filter(e=>!e.hiddenByDefault);return t.length>0?t:e.slice(0,1)}try{let t=window.localStorage.getItem(f);if(!t){let t=e.filter(e=>!e.hiddenByDefault);return t.length>0?t:e.slice(0,1)}let r=JSON.parse(t),s=e.filter(e=>{let t=r[e.id];return"boolean"==typeof t?t:!e.hiddenByDefault});return s.length>0?s:e.slice(0,1)}catch{let t=e.filter(e=>!e.hiddenByDefault);return t.length>0?t:e.slice(0,1)}},[f,c,T]),K=(0,r.useMemo)(()=>{if(I)return Array.isArray(d)?d:[];let e=F.trim().toLowerCase();return(Array.isArray(d)?d:[]).filter(t=>{if(x&&x.getSearchText&&e.length>0&&!x.getSearchText(t).toLowerCase().includes(e))return!1;for(let e of h)if(e.predicate&&!e.predicate(t,e.value))return!1;return!0})},[d,h,I,F,x]),Q=I?p.totalRows:K.length,q=Math.max(1,Math.ceil(Q/E)),Y=Math.min(R,q-1),V=Math.max(1,Math.min(8,E||10)),W=(0,r.useMemo)(()=>{if(I)return K;let e=Y*E,t=e+E;return K.slice(e,t)},[Y,K,I,E]),G=Y>0,X=Y<q-1,Z=!!x||h.length>0||!!v||!!f;function ee(e,t){if(f&&(t||!(H.length<=1)))try{let r=window.localStorage.getItem(f),s=(r?JSON.parse(r):{})??{};s[e]=t,window.localStorage.setItem(f,JSON.stringify(s)),$(e=>e+1)}catch{}}async function et(e){if(v&&!M){A(null),D(e);try{let t=new URLSearchParams;for(let e of(F.trim().length>0&&t.set("q",F.trim()),h)){let r=e.value;null!=r&&0!==String(r).length&&t.set(e.id,String(r))}if(I&&L?.id&&L?.dir&&(t.set("sort",L.id),t.set("dir",L.dir)),t.set("format",e),v.extraQuery)for(let[e,r]of Object.entries(v.extraQuery))null!=r&&t.set(e,String(r));let r=`${v.url}${v.url.includes("?")?"&":"?"}${t.toString()}`,s=v.filename?.({format:e});await (0,n.apiDownload)(r,{filename:s})}catch(e){A(e instanceof Error?e.message:"Export failed.")}finally{D(null)}}}return(0,t.jsxs)("div",{className:(0,s.cn)("space-y-3",N),children:[e?(0,t.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:e}):null,Z?(0,t.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-end md:justify-between",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-end",children:[x?(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("label",{className:"text-sm font-medium",htmlFor:`${B}_datatable_search`,children:"Search"}),(0,t.jsx)("input",{id:`${B}_datatable_search`,className:"w-full min-w-[220px] rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:F,onChange:e=>{J(e.target.value),U(0)},placeholder:x.placeholder??"Search..."})]}):null,h.map(e=>(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("label",{className:"text-sm font-medium",htmlFor:`${B}_datatable_filter_${e.id}`,children:e.label}),(0,t.jsx)("select",{id:`${B}_datatable_filter_${e.id}`,className:"w-full min-w-[180px] rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:String(e.value),onChange:t=>{let r=e.options.find(e=>String(e.value)===t.target.value),s=r?r.value:t.target.value;e.onChange(s),U(0)},children:e.options.map(e=>(0,t.jsx)("option",{value:String(e.value),children:e.label},String(e.value)))})]},e.id))]}),(0,t.jsxs)("div",{className:"flex flex-col items-start gap-2 md:items-end",children:[(0,t.jsxs)("div",{className:"text-sm text-zinc-600",children:[Q," result(s)"]}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[v?(0,t.jsx)(i.DropdownMenu,{align:"right",trigger:({toggle:e})=>(0,t.jsx)(a.Button,{variant:"outline",size:"sm",onClick:e,disabled:!!M,children:M?"Exporting...":"Export"}),children:({close:e})=>{let r=v.formats??["csv","xlsx","pdf"];return(0,t.jsx)(t.Fragment,{children:r.map(r=>(0,t.jsxs)(i.DropdownMenuItem,{onSelect:()=>{e(),et(r)},disabled:!!M,children:["Export ",r.toUpperCase()]},r))})}}):null,f?(0,t.jsx)(i.DropdownMenu,{align:"right",trigger:({toggle:e})=>(0,t.jsx)(a.Button,{variant:"outline",size:"sm",onClick:e,children:"Columns"}),children:({close:e})=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.DropdownMenuItem,{onSelect:()=>{for(let t of(e(),c))ee(t.id,!0)},children:"Show all"}),(0,t.jsx)(i.DropdownMenuItem,{onSelect:()=>{for(let t of(e(),c))ee(t.id,!t.hiddenByDefault)},children:"Reset defaults"}),(0,t.jsx)(i.DropdownMenuSeparator,{}),c.map(e=>{let r=H.some(t=>t.id===e.id);return(0,t.jsxs)(i.DropdownMenuItem,{onSelect:()=>{ee(e.id,!r)},children:[(0,t.jsx)("span",{className:"mr-2 inline-block w-4",children:r?"✓":""}),"string"==typeof e.header?e.header:e.id]},e.id)})]})}):null]})]})]}):null,z?(0,t.jsx)("div",{className:"text-sm text-red-600",children:z}):null,(0,t.jsx)("div",{className:"overflow-x-auto rounded-[var(--rb-radius-md)] border border-[var(--rb-border)] bg-white",children:(0,t.jsxs)("table",{className:"min-w-full border-collapse text-left text-sm",children:[(0,t.jsx)("thead",{className:"bg-[var(--rb-surface-muted)]",children:(0,t.jsx)("tr",{children:H.map(e=>(0,t.jsx)("th",{className:(0,s.cn)("whitespace-nowrap border-b border-[var(--rb-border)] px-3 py-2 text-xs font-semibold uppercase tracking-wide text-zinc-600",e.headerClassName),children:I&&e.sortId&&O?(0,t.jsxs)("button",{type:"button",onClick:()=>(function(e){if(I&&e.sortId&&O){if(!L||L.id!==e.sortId){O({id:e.sortId,dir:"asc"}),U(0);return}if("asc"===L.dir){O({id:e.sortId,dir:"desc"}),U(0);return}O(null),U(0)}})(e),className:"inline-flex items-center gap-1 hover:text-zinc-900",children:[(0,t.jsx)("span",{children:e.header}),I&&e.sortId?L&&L.id===e.sortId?"asc"===L.dir?(0,t.jsx)("span",{className:"ml-1 text-zinc-700",children:"↑"}):(0,t.jsx)("span",{className:"ml-1 text-zinc-700",children:"↓"}):(0,t.jsx)("span",{className:"ml-1 text-zinc-400",children:"↕"}):null]}):e.header},e.id))})}),(0,t.jsx)("tbody",{children:m?Array.from({length:V}).map((e,r)=>(0,t.jsx)("tr",{className:"border-t border-[var(--rb-border)]",children:H.map((e,r)=>(0,t.jsx)("td",{className:(0,s.cn)("px-3 py-2 align-middle",e.className),children:(0,t.jsx)(l.Skeleton,{className:(0,s.cn)("h-3 rounded-[var(--rb-radius-sm)]",0===r?"w-3/4":r===H.length-1?"w-16":"w-full")})},e.id))},`loading_${r}`)):0===W.length?(0,t.jsx)("tr",{children:(0,t.jsx)("td",{className:"px-3 py-3 text-sm text-zinc-600",colSpan:Math.max(1,H.length),children:u})}):W.map(e=>(0,t.jsx)("tr",{className:(0,s.cn)("border-t border-[var(--rb-border)]",j?"cursor-pointer hover:bg-[var(--rb-surface-muted)]":null),tabIndex:j?0:void 0,role:j?"button":void 0,onClick:j?()=>{j(e)}:void 0,onKeyDown:j?t=>{("Enter"===t.key||" "===t.key)&&(t.preventDefault(),j(e))}:void 0,children:H.map(r=>(0,t.jsx)("td",{className:(0,s.cn)("px-3 py-2 align-middle",r.className),children:r.cell(e)},r.id))},String(o(e))))})]})}),(0,t.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(a.Button,{variant:"outline",size:"sm",onClick:function(){U(Math.max(0,Y-1))},disabled:!G,children:"Prev"}),(0,t.jsx)(a.Button,{variant:"outline",size:"sm",onClick:function(){U(Math.min(q-1,Y+1))},disabled:!X,children:"Next"}),(0,t.jsxs)("div",{className:"text-sm text-zinc-600",children:["Page ",Y+1," / ",q]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"text-sm text-zinc-600",children:"Rows per page"}),(0,t.jsx)("select",{className:"rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:String(E),onChange:e=>{P(Number(e.target.value)),U(0)},children:b.map(e=>(0,t.jsx)("option",{value:e,children:e},e))})]})]})]})}e.s(["DataTable",()=>d])},60728,e=>{"use strict";var t=e.i(48277),r=e.i(1831),s=e.i(68501),a=e.i(9693),i=e.i(72015),l=e.i(37574),n=e.i(19463),d=e.i(43901),c=e.i(96086),o=e.i(30668);function m(e,t){let r="string"==typeof t&&t.trim().length>0?t.toUpperCase():"USD",s=Number.isFinite(e)?e:0;try{return new Intl.NumberFormat(void 0,{style:"currency",currency:r,maximumFractionDigits:2}).format(s/100)}catch{return`${r} ${(s/100).toFixed(2)}`}}function u({title:e,subtitle:r}){return(0,t.jsx)(i.Card,{className:"shadow-none",children:(0,t.jsxs)(i.CardContent,{className:"pt-5",children:[(0,t.jsxs)("div",{className:"flex flex-wrap items-baseline justify-between gap-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:e}),(0,t.jsx)("div",{className:"mt-1 text-sm text-zinc-600",children:r})]}),(0,t.jsx)(s.Badge,{variant:"default",children:"Mock"})]}),(0,t.jsx)("div",{className:"mt-4 h-40 w-full rounded-[var(--rb-radius-lg)] border border-[var(--rb-border)] bg-[var(--rb-surface-muted)]"})]})})}function x(e){if(!e)return"—";let t=new Date(e);if(Number.isNaN(t.getTime()))return"—";try{return t.toLocaleDateString(void 0,{month:"short",day:"numeric"})}catch{return"—"}}function h(){return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:Array.from({length:4}).map((e,r)=>(0,t.jsx)(i.Card,{className:"relative overflow-hidden shadow-none",children:(0,t.jsx)(i.CardContent,{className:"pt-5",children:(0,t.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsx)(d.Skeleton,{className:"h-3 w-24 rounded-[var(--rb-radius-sm)]"}),(0,t.jsx)("div",{className:"mt-2",children:(0,t.jsx)(d.Skeleton,{className:"h-8 w-28 rounded-[var(--rb-radius-sm)]"})})]}),(0,t.jsx)(d.Skeleton,{className:"h-5 w-16 rounded-full"})]})})},r))}),(0,t.jsxs)("div",{className:"grid gap-4 lg:grid-cols-3",children:[(0,t.jsx)(i.Card,{className:"shadow-none lg:col-span-2",children:(0,t.jsxs)(i.CardContent,{className:"pt-5",children:[(0,t.jsxs)("div",{className:"flex flex-wrap items-baseline justify-between gap-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(d.Skeleton,{className:"h-4 w-36 rounded-[var(--rb-radius-sm)]"}),(0,t.jsx)(d.Skeleton,{className:"mt-2 h-4 w-56 rounded-[var(--rb-radius-sm)]"})]}),(0,t.jsx)(d.Skeleton,{className:"h-5 w-14 rounded-full"})]}),(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)(d.Skeleton,{className:"h-40 w-full rounded-[var(--rb-radius-lg)] border border-[var(--rb-border)]"})})]})}),(0,t.jsx)(i.Card,{className:"shadow-none",children:(0,t.jsxs)(i.CardContent,{className:"pt-5",children:[(0,t.jsxs)("div",{className:"flex flex-wrap items-baseline justify-between gap-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(d.Skeleton,{className:"h-4 w-32 rounded-[var(--rb-radius-sm)]"}),(0,t.jsx)(d.Skeleton,{className:"mt-2 h-4 w-48 rounded-[var(--rb-radius-sm)]"})]}),(0,t.jsx)(d.Skeleton,{className:"h-5 w-14 rounded-full"})]}),(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)(d.Skeleton,{className:"h-40 w-full rounded-[var(--rb-radius-lg)] border border-[var(--rb-border)]"})})]})})]}),(0,t.jsxs)("div",{className:"grid gap-4 lg:grid-cols-3",children:[(0,t.jsxs)("div",{className:"lg:col-span-2 space-y-4",children:[(0,t.jsx)(d.TableSkeleton,{rows:6,columns:5}),(0,t.jsx)(d.TableSkeleton,{rows:6,columns:5})]}),(0,t.jsx)(i.Card,{className:"shadow-none",children:(0,t.jsxs)(i.CardContent,{className:"pt-5",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(d.Skeleton,{className:"h-4 w-36 rounded-[var(--rb-radius-sm)]"}),(0,t.jsx)(d.Skeleton,{className:"mt-2 h-4 w-44 rounded-[var(--rb-radius-sm)]"})]}),(0,t.jsx)(d.Skeleton,{className:"h-9 w-20 rounded-[var(--rb-radius-sm)]"})]}),(0,t.jsx)("div",{className:"mt-4 space-y-3",children:Array.from({length:5}).map((e,r)=>(0,t.jsx)("div",{className:"rounded-[var(--rb-radius-md)] border border-[var(--rb-border)] bg-white p-3",children:(0,t.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsx)(d.Skeleton,{className:"h-4 w-3/4 rounded-[var(--rb-radius-sm)]"}),(0,t.jsx)(d.Skeleton,{className:"mt-2 h-4 w-full rounded-[var(--rb-radius-sm)]"}),(0,t.jsx)(d.Skeleton,{className:"mt-2 h-3 w-24 rounded-[var(--rb-radius-sm)]"})]}),(0,t.jsx)(d.Skeleton,{className:"h-5 w-16 rounded-full"})]})},r))})]})})]})]})}function b(){let e=(0,c.useParams)(),d=e.business??e.tenant,[b,g]=(0,o.useState)(!0),[p,v]=(0,o.useState)(null),[f,j]=(0,o.useState)(null);(0,o.useEffect)(()=>{let e=!0;async function t(){try{g(!0);let t=await (0,r.apiFetch)(`/api/${d}/app/dashboard`);if(!e)return;v(t)}catch(t){if(!e)return;j(t instanceof Error?t.message:"Failed to load dashboard.")}finally{if(!e)return;g(!1)}}return"string"==typeof d&&d.length>0?t():(g(!1),j("Tenant is missing.")),()=>{e=!1}},[d]);let N=p?.user?.role==="customer",y=o.default.useMemo(()=>{let e=p?.metrics,t=Number.isFinite(e?.active_jobs_count)?e?.active_jobs_count??0:0,r=Number.isFinite(e?.completed_jobs_count)?e?.completed_jobs_count??0:0,s=Number.isFinite(e?.pending_estimates_count)?e?.pending_estimates_count??0:0,a=Number.isFinite(e?.revenue_last_30d?.amount_cents)?e?.revenue_last_30d?.amount_cents??0:0,i=e?.revenue_last_30d?.currency??p?.tenant?.currency??"USD";return{activeJobs:Math.max(0,t),completedJobs:Math.max(0,r),pendingEstimates:Math.max(0,s),revenue:m(a,i),revenueCurrency:"string"==typeof i?i.toUpperCase():(p?.tenant?.currency??"USD").toUpperCase()}},[p?.metrics,p?.tenant?.currency]),w=o.default.useMemo(()=>{let e=p?.recent?.jobs;return Array.isArray(e)?e.filter(e=>e&&"number"==typeof e.id).map(e=>{let t="string"==typeof e.currency&&e.currency?e.currency:p?.tenant?.currency??"USD",r="number"==typeof e.total_cents&&Number.isFinite(e.total_cents)?e.total_cents:0;return{id:"string"==typeof e.case_number&&e.case_number?e.case_number:`#${e.id}`,title:"string"==typeof e.title?e.title:"",status:"string"==typeof e.status?e.status:"",total:m(r,t),date:x(e.updated_at)}}):[]},[p?.recent?.jobs,p?.tenant?.currency]),_=o.default.useMemo(()=>{let e=p?.recent?.estimates;return Array.isArray(e)?e.filter(e=>e&&"number"==typeof e.id).map(e=>{let t="string"==typeof e.currency&&e.currency?e.currency:p?.tenant?.currency??"USD",r="number"==typeof e.total_cents&&Number.isFinite(e.total_cents)?e.total_cents:0;return{id:"string"==typeof e.case_number&&e.case_number?e.case_number:`#${e.id}`,title:"string"==typeof e.title?e.title:"",status:"string"==typeof e.status?e.status:"",total:m(r,t),date:x(e.updated_at)}}):[]},[p?.recent?.estimates,p?.tenant?.currency]),S=o.default.useMemo(()=>{let e=p?.activity;if(!Array.isArray(e))return[];let t=e.filter(e=>e&&"number"==typeof e.id).map(e=>{let t=("string"==typeof e.summary&&e.summary.trim().length>0?e.summary.trim():null)??("string"==typeof e.event_type&&e.event_type.trim().length>0?e.event_type.trim():"Activity"),r=("string"==typeof e.description&&e.description.trim().length>0?e.description.trim():null)??("string"==typeof e.entity_type&&e.entity_type.trim().length>0?`${e.entity_type} #${e.entity_id}`:null),s="string"==typeof e.visibility&&e.visibility?e.visibility:"public";return{id:String(e.id),type:"private"===s?"private":"public",title:t,description:r??"",occurred_at:function(e){if(!e)return"—";let t=new Date(e);if(Number.isNaN(t.getTime()))return"—";let r=Math.floor((Date.now()-t.getTime())/1e3);if(r<60)return"Just now";let s=Math.floor(r/60);if(s<60)return`${s} min ago`;let a=Math.floor(s/60);if(a<24)return`${a} hr ago`;let i=Math.floor(a/24);return i<7?`${i} day${1===i?"":"s"} ago`:x(e)}(e.created_at)}});return N?t.filter(e=>"public"===e.type):t},[p?.activity,N]),C=o.default.useMemo(()=>[{id:"id",header:"Job",cell:e=>(0,t.jsx)("span",{className:"font-medium text-[var(--rb-text)]",children:e.id})},{id:"title",header:"Title",cell:e=>(0,t.jsx)("span",{className:"text-zinc-700",children:e.title})},{id:"status",header:"Status",cell:e=>(0,t.jsx)(s.Badge,{variant:e.status.toLowerCase().includes("deliver")?"success":e.status.toLowerCase().includes("diagn")?"info":"default",children:e.status})},{id:"total",header:"Total",cell:e=>(0,t.jsx)("span",{className:"text-zinc-700",children:e.total}),className:"text-right"},{id:"date",header:"Date",cell:e=>(0,t.jsx)("span",{className:"text-zinc-500",children:e.date})}],[]),k=o.default.useMemo(()=>[{id:"id",header:"Estimate",cell:e=>(0,t.jsx)("span",{className:"font-medium text-[var(--rb-text)]",children:e.id})},{id:"title",header:"Title",cell:e=>(0,t.jsx)("span",{className:"text-zinc-700",children:e.title})},{id:"status",header:"Status",cell:e=>(0,t.jsx)(s.Badge,{variant:"approved"===e.status.toLowerCase()?"success":"rejected"===e.status.toLowerCase()?"danger":"default",children:e.status})},{id:"total",header:"Total",cell:e=>(0,t.jsx)("span",{className:"text-zinc-700",children:e.total}),className:"text-right"},{id:"date",header:"Date",cell:e=>(0,t.jsx)("span",{className:"text-zinc-500",children:e.date})}],[]);function M({label:e,value:r,badge:a,variant:l}){let n={default:{card:"bg-white border-t-4 border-t-[var(--rb-border)]",dot:"bg-[var(--rb-border)]"},info:{card:"bg-[color:color-mix(in_srgb,var(--rb-blue),white_92%)] border-t-4 border-t-[color:color-mix(in_srgb,var(--rb-blue),white_20%)]",dot:"bg-[var(--rb-blue)]"},success:{card:"bg-[color:color-mix(in_srgb,#16a34a,white_92%)] border-t-4 border-t-[color:color-mix(in_srgb,#16a34a,white_20%)]",dot:"bg-[#16a34a]"},warning:{card:"bg-[color:color-mix(in_srgb,var(--rb-orange),white_92%)] border-t-4 border-t-[color:color-mix(in_srgb,var(--rb-orange),white_20%)]",dot:"bg-[var(--rb-orange)]"},danger:{card:"bg-[color:color-mix(in_srgb,#dc2626,white_92%)] border-t-4 border-t-[color:color-mix(in_srgb,#dc2626,white_20%)]",dot:"bg-[#dc2626]"}};return(0,t.jsx)(i.Card,{className:`relative overflow-hidden shadow-none ${n[l].card}`,children:(0,t.jsx)(i.CardContent,{className:"pt-5",children:(0,t.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs font-semibold text-zinc-600 uppercase tracking-wider",children:[(0,t.jsx)("span",{className:`h-2 w-2 rounded-full ${n[l].dot}`}),(0,t.jsx)("span",{children:e})]}),(0,t.jsx)("div",{className:"mt-2 truncate text-2xl font-bold text-[var(--rb-text)]",children:r})]}),(0,t.jsx)(s.Badge,{variant:l,children:a})]})})})}return!b||p||f?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(n.PageHeader,{title:"Dashboard",description:N?"Your repairs, estimates and updates.":"Business overview (mocked widgets).",actions:(0,t.jsx)(a.Button,{variant:"outline",size:"sm",onClick:()=>void window.location.reload(),disabled:b,children:"Refresh"})}),f?(0,t.jsx)("div",{className:"text-sm text-red-600",children:f}):null,p?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[(0,t.jsx)(M,{label:"Active Jobs",value:String(y.activeJobs),badge:"jobs",variant:"info"}),(0,t.jsx)(M,{label:"Completed",value:String(y.completedJobs),badge:"done",variant:"success"}),(0,t.jsx)(M,{label:"Pending Estimates",value:String(y.pendingEstimates),badge:"est",variant:"warning"}),(0,t.jsx)(M,{label:"Revenue",value:y.revenue,badge:(p.tenant.currency??"USD").toUpperCase(),variant:"default"})]}),(0,t.jsxs)("div",{className:"grid gap-4 lg:grid-cols-3",children:[(0,t.jsx)("div",{className:"lg:col-span-2",children:(0,t.jsx)(u,{title:N?"My Jobs Overview":"Revenue Analytics",subtitle:N?"Recent activity trend (mock).":"Weekly / Monthly / Yearly (mock)."})}),(0,t.jsx)("div",{children:(0,t.jsx)(u,{title:N?"My Active Jobs":"Job Status",subtitle:"Distribution (mock)."})})]}),(0,t.jsxs)("div",{className:"grid gap-4 lg:grid-cols-3",children:[(0,t.jsx)("div",{className:"lg:col-span-2 space-y-4",children:N?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.DataTable,{title:"My Jobs",data:w,columns:C,getRowId:e=>e.id,emptyMessage:"No jobs found."}),(0,t.jsx)(l.DataTable,{title:"My Estimates",data:_,columns:k,getRowId:e=>e.id,emptyMessage:"No estimates found."})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u,{title:"Device Types",subtitle:"Top devices (mock)."}),(0,t.jsx)(u,{title:"Performance",subtitle:"Average repair time (mock)."})]})}),(0,t.jsx)(i.Card,{className:"shadow-none",children:(0,t.jsxs)(i.CardContent,{className:"pt-5",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:"Recent Activity"}),(0,t.jsx)("div",{className:"mt-1 text-sm text-zinc-600",children:"Latest updates (mock)."})]}),(0,t.jsx)(a.Button,{variant:"outline",size:"sm",disabled:!0,children:"View All"})]}),(0,t.jsxs)("div",{className:"mt-4 space-y-3",children:[0===S.length?(0,t.jsx)("div",{className:"text-sm text-zinc-600",children:"—"}):null,S.map(e=>(0,t.jsx)("div",{className:"rounded-[var(--rb-radius-md)] border border-[var(--rb-border)] bg-white p-3",children:(0,t.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsx)("div",{className:"truncate text-sm font-semibold text-[var(--rb-text)]",children:e.title}),(0,t.jsx)("div",{className:"mt-1 text-sm text-zinc-600",children:e.description}),(0,t.jsx)("div",{className:"mt-2 text-xs text-zinc-500",children:e.occurred_at})]}),(0,t.jsx)(s.Badge,{variant:"private"===e.type?"warning":"info",children:e.type})]})},e.id))]}),(0,t.jsxs)("div",{className:"mt-5 text-xs text-zinc-500",children:["Tenant: ",p.tenant.slug," · Signed in as: ",p.user.email]})]})})]})]}):null]}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(n.PageHeader,{title:"Dashboard",description:"Loading dashboard...",actions:(0,t.jsx)(a.Button,{variant:"outline",size:"sm",disabled:!0,children:"Refresh"})}),(0,t.jsx)(h,{})]})}e.s(["default",()=>b])}]);