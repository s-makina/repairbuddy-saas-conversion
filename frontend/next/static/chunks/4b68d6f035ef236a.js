(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,63571,e=>{"use strict";var r=e.i(48277),a=e.i(14575);function t({variant:e,className:t}){let i="h-4 w-4 shrink-0";return"success"===e?(0,r.jsx)("svg",{viewBox:"0 0 24 24",className:(0,a.cn)(i,t),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:(0,r.jsx)("path",{d:"M20 6L9 17l-5-5"})}):"warning"===e?(0,r.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,a.cn)(i,t),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,r.jsx)("path",{d:"M12 9v4"}),(0,r.jsx)("path",{d:"M12 17h.01"}),(0,r.jsx)("path",{d:"M10.3 3.6l-8.3 14.3A2 2 0 0 0 3.7 21h16.6a2 2 0 0 0 1.7-3.1L13.7 3.6a2 2 0 0 0-3.4 0z"})]}):"danger"===e?(0,r.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,a.cn)(i,t),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,r.jsx)("path",{d:"M18 6L6 18"}),(0,r.jsx)("path",{d:"M6 6l12 12"})]}):(0,r.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,a.cn)(i,t),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,r.jsx)("path",{d:"M12 16v-4"}),(0,r.jsx)("path",{d:"M12 8h.01"}),(0,r.jsx)("path",{d:"M12 22a10 10 0 1 0-10-10 10 10 0 0 0 10 10z"})]})}function i({className:e,variant:i="info",title:s,children:n,...l}){let d={info:{wrapper:"border-[color:color-mix(in_srgb,var(--rb-blue),white_75%)] bg-[color:color-mix(in_srgb,var(--rb-blue),white_92%)] text-[var(--rb-text)]",icon:"text-[var(--rb-blue)]",title:"text-[var(--rb-blue)]"},success:{wrapper:"border-[color:color-mix(in_srgb,#16a34a,white_75%)] bg-[color:color-mix(in_srgb,#16a34a,white_92%)] text-[var(--rb-text)]",icon:"text-[#166534]",title:"text-[#166534]"},warning:{wrapper:"border-[color:color-mix(in_srgb,var(--rb-orange),white_70%)] bg-[color:color-mix(in_srgb,var(--rb-orange),white_92%)] text-[var(--rb-text)]",icon:"text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)]",title:"text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)]"},danger:{wrapper:"border-[color:color-mix(in_srgb,#dc2626,white_75%)] bg-[color:color-mix(in_srgb,#dc2626,white_92%)] text-[var(--rb-text)]",icon:"text-[#991b1b]",title:"text-[#991b1b]"}}[i];return(0,r.jsx)("div",{role:"alert",className:(0,a.cn)("rounded-[var(--rb-radius-md)] border px-4 py-3",d.wrapper,e),...l,children:(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)(t,{variant:i,className:(0,a.cn)("mt-0.5",d.icon)}),(0,r.jsxs)("div",{className:"min-w-0",children:[s?(0,r.jsx)("div",{className:(0,a.cn)("text-sm font-semibold",d.title),children:s}):null,n?(0,r.jsx)("div",{className:(0,a.cn)("text-sm text-zinc-700",s?"mt-1":""),children:n}):null]})]})})}e.s(["Alert",()=>i])},68501,e=>{"use strict";var r=e.i(48277),a=e.i(14575);function t({className:e,variant:t="default",...i}){return(0,r.jsx)("span",{className:(0,a.cn)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-medium",{default:"bg-[var(--rb-surface-muted)] text-[var(--rb-text)] border-[var(--rb-border)]",info:"bg-[color:color-mix(in_srgb,var(--rb-blue),white_85%)] text-[var(--rb-blue)] border-[color:color-mix(in_srgb,var(--rb-blue),white_70%)]",success:"bg-[color:color-mix(in_srgb,#16a34a,white_85%)] text-[#166534] border-[color:color-mix(in_srgb,#16a34a,white_70%)]",warning:"bg-[color:color-mix(in_srgb,var(--rb-orange),white_85%)] text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)] border-[color:color-mix(in_srgb,var(--rb-orange),white_70%)]",danger:"bg-[color:color-mix(in_srgb,#dc2626,white_85%)] text-[#991b1b] border-[color:color-mix(in_srgb,#dc2626,white_70%)]"}[t],e),...i})}e.s(["Badge",()=>t])},66474,e=>{"use strict";var r=e.i(48277),a=e.i(30668),t=e.i(14575);function i({open:e,onClose:i,title:s,children:n,footer:l,position:d="center",variant:o="glass",className:c}){if((0,a.useEffect)(()=>{function r(r){e&&"Escape"===r.key&&i()}return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[i,e]),!e)return null;let u="solid"===o?(0,t.cn)("relative w-full max-w-lg overflow-hidden rounded-[var(--rb-radius-lg)]","border border-[var(--rb-border)]","bg-white","shadow-[var(--rb-shadow)]"):(0,t.cn)("relative w-full max-w-lg overflow-hidden rounded-[var(--rb-radius-lg)]","border border-[color:color-mix(in_srgb,var(--rb-border),white_55%)]","bg-white/75 backdrop-blur-xl","shadow-[0_18px_55px_-18px_rgba(0,0,0,0.55)]","ring-1 ring-white/25");return(0,r.jsxs)("div",{className:"top-center"===d?"fixed inset-0 z-50 flex items-start justify-center px-4 pt-8":"fixed inset-0 z-50 flex items-center justify-center px-4",children:[(0,r.jsx)("button",{type:"button",className:(0,t.cn)("absolute inset-0","bg-black/35 backdrop-blur-md","bg-[radial-gradient(900px_600px_at_20%_20%,color-mix(in_srgb,#16a34a,transparent_82%)_0%,transparent_60%),radial-gradient(900px_600px_at_80%_30%,color-mix(in_srgb,var(--rb-blue),transparent_82%)_0%,transparent_60%),radial-gradient(900px_600px_at_50%_85%,color-mix(in_srgb,var(--rb-orange),transparent_85%)_0%,transparent_65%)]"),"aria-label":"Close",onClick:i}),(0,r.jsxs)("div",{role:"dialog","aria-modal":"true",className:(0,t.cn)(u,c),children:["glass"===o?(0,r.jsx)("div",{className:"pointer-events-none absolute inset-0 bg-[radial-gradient(650px_420px_at_20%_15%,color-mix(in_srgb,#16a34a,transparent_88%)_0%,transparent_60%),radial-gradient(650px_420px_at_80%_5%,color-mix(in_srgb,var(--rb-blue),transparent_90%)_0%,transparent_60%)]"}):null,s?(0,r.jsx)("div",{className:(0,t.cn)("relative px-5 py-4","solid"===o?"border-b border-[var(--rb-border)]":"border-b border-[color:color-mix(in_srgb,var(--rb-border),white_60%)]"),children:(0,r.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:s})}):null,(0,r.jsx)("div",{className:"relative px-5 py-4",children:n}),l?(0,r.jsx)("div",{className:(0,t.cn)("relative px-5 py-4","solid"===o?"border-t border-[var(--rb-border)]":"border-t border-[color:color-mix(in_srgb,var(--rb-border),white_60%)]"),children:l}):null]})]})}e.s(["Modal",()=>i])},64998,e=>{"use strict";var r=e.i(48277),a=e.i(66474),t=e.i(9693);function i({open:e,title:i,message:s,confirmText:n="Confirm",confirmVariant:l="primary",cancelText:d="Cancel",busy:o=!1,onCancel:c,onConfirm:u}){return(0,r.jsx)(a.Modal,{open:e,onClose:()=>{o||c()},title:i,footer:(0,r.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,r.jsx)(t.Button,{variant:"outline",onClick:c,disabled:o,children:d}),(0,r.jsx)(t.Button,{variant:l,onClick:u,disabled:o,children:o?"Working...":n})]}),children:(0,r.jsx)("div",{className:"text-sm text-zinc-700",children:s})})}e.s(["ConfirmDialog",()=>i])},19463,e=>{"use strict";var r=e.i(48277),a=e.i(14575);function t({title:e,description:t,actions:i,className:s}){return(0,r.jsxs)("div",{className:(0,a.cn)("flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between",s),children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-xl font-semibold text-[var(--rb-text)]",children:e}),t?(0,r.jsx)("p",{className:"mt-1 text-sm text-zinc-600",children:t}):null]}),i?(0,r.jsx)("div",{className:"flex items-center gap-2",children:i}):null]})}e.s(["PageHeader",()=>t])},43901,e=>{"use strict";var r=e.i(48277),a=e.i(14575),t=e.i(72015);function i({className:e,"aria-hidden":t=!0,...i}){return(0,r.jsx)("div",{"aria-hidden":t,className:(0,a.cn)("rb-skeleton",e),...i})}function s({lines:e=3,className:s}){let n=Math.max(1,Math.min(e,12));return(0,r.jsx)(t.Card,{className:(0,a.cn)("overflow-hidden",s),children:(0,r.jsxs)(t.CardContent,{className:"space-y-3 pt-5",children:[(0,r.jsx)(i,{className:"h-4 w-32 rounded-[var(--rb-radius-sm)]"}),Array.from({length:n}).map((e,t)=>(0,r.jsx)(i,{className:(0,a.cn)("h-3 rounded-[var(--rb-radius-sm)]",t===n-1?"w-3/5":"w-full")},t))]})})}function n({rows:e=6,columns:t=5,className:s}){let n=Math.max(1,Math.min(e,20)),l=Math.max(1,Math.min(t,10));return(0,r.jsxs)("div",{className:(0,a.cn)("overflow-hidden rounded-[var(--rb-radius-lg)] border border-[var(--rb-border)] bg-white shadow-[var(--rb-shadow)]",s),children:[(0,r.jsx)("div",{className:"border-b border-[var(--rb-border)] px-5 py-4",children:(0,r.jsx)("div",{className:"grid gap-3",style:{gridTemplateColumns:`repeat(${l}, minmax(0, 1fr))`},children:Array.from({length:l}).map((e,a)=>(0,r.jsx)(i,{className:"h-3 w-full rounded-[var(--rb-radius-sm)]"},a))})}),(0,r.jsx)("div",{className:"px-5 pb-5 pt-4",children:(0,r.jsx)("div",{className:"space-y-3",children:Array.from({length:n}).map((e,t)=>(0,r.jsx)("div",{className:"grid gap-3",style:{gridTemplateColumns:`repeat(${l}, minmax(0, 1fr))`},children:Array.from({length:l}).map((e,t)=>(0,r.jsx)(i,{className:(0,a.cn)("h-3 rounded-[var(--rb-radius-sm)]",0===t?"w-3/4":"w-full")},t))},t))})})]})}e.s(["CardSkeleton",()=>s,"Skeleton",()=>i,"TableSkeleton",()=>n])},48650,e=>{"use strict";var r=e.i(48277),a=e.i(19463),t=e.i(63571),i=e.i(72015);function s({title:e,description:s,actions:n,filters:l,loading:d,loadingFallback:o,error:c,empty:u,emptyTitle:m="Nothing here yet",emptyDescription:x="No items to display.",children:b}){return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)(a.PageHeader,{title:e,description:s,actions:n}),l?(0,r.jsx)(i.Card,{className:"shadow-none",children:(0,r.jsx)(i.CardContent,{className:"pt-5",children:l})}):null,c?(0,r.jsx)(t.Alert,{variant:"danger",title:"Something went wrong",children:c}):null,d?o??(0,r.jsx)("div",{className:"text-sm text-zinc-500",children:"Loading..."}):null,d||c||!u?null:(0,r.jsx)(i.Card,{className:"shadow-none",children:(0,r.jsxs)(i.CardContent,{className:"pt-5",children:[(0,r.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:m}),(0,r.jsx)("div",{className:"mt-1 text-sm text-zinc-600",children:x})]})}),d||c||u?null:b]})}e.s(["ListPageShell",()=>s])},37949,e=>{"use strict";var r=e.i(48277),a=e.i(30668),t=e.i(9693);function i({className:e}){return(0,r.jsxs)("svg",{viewBox:"0 0 24 24",width:"16",height:"16","aria-hidden":"true",className:e,fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("path",{d:"M18 6 6 18"}),(0,r.jsx)("path",{d:"M6 6l12 12"})]})}function s({label:e="Image",file:s,existingUrl:n,disabled:l,accept:d="image/png,image/jpeg,image/webp",maxBytes:o=5242880,onFileChange:c,onRemoveExisting:u,onError:m}){let x=a.default.useRef(null),[b,h]=a.default.useState(null);a.default.useEffect(()=>{if(!s){h(null),x.current&&(x.current.value="");return}let e=URL.createObjectURL(s);return h(e),()=>{URL.revokeObjectURL(e)}},[s]);let g=b??n??null,v=!b&&!!n,p=!!s||v&&!!u;return(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"text-sm font-medium",children:e}),(0,r.jsx)("input",{ref:x,type:"file",accept:d,className:"hidden",onChange:function(e){let r=e.target.files?.[0]??null;if(r){if(!function(e){if(!e.type.startsWith("image/"))return m?.("Please select an image file."),!1;if(e.size>o){let e=Math.floor(o/1048576);return m?.(`Image must be ${e}MB or smaller.`),!1}return!0}(r)){x.current&&(x.current.value="");return}c(r)}},disabled:l}),(0,r.jsx)("div",{className:"flex flex-wrap items-center gap-2",children:(0,r.jsx)(t.Button,{variant:"outline",size:"sm",type:"button",onClick:()=>x.current?.click(),disabled:l,children:s?"Change selected image":"Choose image"})}),g?(0,r.jsxs)("div",{className:"relative inline-block",children:[(0,r.jsx)("img",{src:g,alt:"Selected image",className:"max-h-40 rounded border border-[var(--rb-border)]"}),p?(0,r.jsx)("button",{type:"button",onClick:()=>{s?c(null):u?.()},disabled:l,"aria-label":s?"Remove selected image":"Remove image",className:"absolute right-2 top-2 inline-flex h-7 w-7 items-center justify-center rounded-full border border-[var(--rb-border)] bg-white/90 text-zinc-700 shadow-sm transition hover:bg-white disabled:pointer-events-none disabled:opacity-50",children:(0,r.jsx)(i,{})}):null]}):null]})}e.s(["ImagePickerWithPreview",()=>s])},38143,24325,e=>{"use strict";var r=e.i(48277),a=e.i(30668),t=e.i(14575),i=e.i(9693),s=e.i(43901);function n({title:e,data:n,renderItem:l,getItemId:d,loading:o=!1,emptyMessage:c="No data.",search:u,filters:m=[],pageSizeOptions:x=[10,25,50],initialPageSize:b=10,server:h,onItemClick:g,className:v,gridClassName:p}){let[f,j]=(0,a.useState)(""),[_,w]=(0,a.useState)(0),[N,y]=(0,a.useState)(b),C=(0,a.useId)(),S=!!h,k=S?h.query:f,M=S?h.onQueryChange:j,P=S?h.pageIndex:_,z=S?h.onPageIndexChange:w,A=S?h.pageSize:N,I=S?h.onPageSizeChange:y,L=(0,a.useMemo)(()=>{if(S)return Array.isArray(n)?n:[];let e=k.trim().toLowerCase();return(Array.isArray(n)?n:[]).filter(r=>{if(u&&u.getSearchText&&e.length>0&&!u.getSearchText(r).toLowerCase().includes(e))return!1;for(let e of m)if(e.predicate&&!e.predicate(r,e.value))return!1;return!0})},[n,m,S,k,u]),D=S?h.totalRows:L.length,$=Math.max(1,Math.ceil(D/A)),B=Math.min(P,$-1),F=(0,a.useMemo)(()=>{if(S)return L;let e=B*A,r=e+A;return L.slice(e,r)},[B,L,S,A]),E=B>0,R=B<$-1,T=!!u||m.length>0,q=Math.max(1,Math.min(12,A||10));return(0,r.jsxs)("div",{className:(0,t.cn)("space-y-3",v),children:[e?(0,r.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:e}):null,T?(0,r.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-end md:justify-between",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-end",children:[u?(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm font-medium",htmlFor:`${C}_datagrid_search`,children:"Search"}),(0,r.jsx)("input",{id:`${C}_datagrid_search`,className:"w-full min-w-[220px] rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:k,onChange:e=>{M(e.target.value),z(0)},placeholder:u.placeholder??"Search..."})]}):null,m.map(e=>(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm font-medium",htmlFor:`${C}_datagrid_filter_${e.id}`,children:e.label}),(0,r.jsx)("select",{id:`${C}_datagrid_filter_${e.id}`,className:"w-full min-w-[180px] rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:String(e.value),onChange:r=>{let a=e.options.find(e=>String(e.value)===r.target.value),t=a?a.value:r.target.value;e.onChange(t),z(0)},children:e.options.map(e=>(0,r.jsx)("option",{value:String(e.value),children:e.label},String(e.value)))})]},e.id))]}),(0,r.jsxs)("div",{className:"text-sm text-zinc-600",children:[D," result(s)"]})]}):null,o?(0,r.jsx)("div",{className:(0,t.cn)("grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",p),children:Array.from({length:q}).map((e,a)=>(0,r.jsx)(s.CardSkeleton,{lines:3,className:"shadow-none"},a))}):0===F.length?(0,r.jsx)("div",{className:"text-sm text-zinc-600",children:c}):(0,r.jsx)("div",{className:(0,t.cn)("grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",p),children:F.map(e=>{let a=!!g;return(0,r.jsx)("div",{className:(0,t.cn)(a?"cursor-pointer":null),tabIndex:a?0:void 0,role:a?"button":void 0,onClick:a?()=>{g?.(e)}:void 0,onKeyDown:a?r=>{("Enter"===r.key||" "===r.key)&&(r.preventDefault(),g?.(e))}:void 0,children:l(e)},String(d(e)))})}),(0,r.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(i.Button,{variant:"outline",size:"sm",onClick:function(){z(Math.max(0,B-1))},disabled:!E,children:"Prev"}),(0,r.jsx)(i.Button,{variant:"outline",size:"sm",onClick:function(){z(Math.min($-1,B+1))},disabled:!R,children:"Next"}),(0,r.jsxs)("div",{className:"text-sm text-zinc-600",children:["Page ",B+1," / ",$]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"text-sm text-zinc-600",children:"Items per page"}),(0,r.jsx)("select",{className:"rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:String(A),onChange:e=>{I(Number(e.target.value)),z(0)},children:x.map(e=>(0,r.jsx)("option",{value:e,children:e},e))})]})]})]})}e.s(["DataGrid",()=>n],38143);var l=e.i(96086);function d(e,r){if(!e)return r;let a=Number(e);if(!Number.isFinite(a))return r;let t=Math.floor(a);return t<=0?r:t}function o({queryKey:e="q",pageKey:r="page",pageSizeKey:t="per_page",defaultPageSize:i=10}={}){let s=(0,l.useRouter)(),n=(0,l.usePathname)(),c=(0,l.useSearchParams)(),u=c.get(e)??"",m=d(c.get(r),1),x=d(c.get(t),i),b=Math.max(0,m-1),h=a.default.useCallback(e=>{let r=e.toString(),a=r.length>0?`${n}?${r}`:n;s.replace(a,{scroll:!1})},[n,s]),g=a.default.useCallback((e,a={})=>{let t=new URLSearchParams(c.toString());for(let[r,a]of Object.entries(e)){let e=function(e){if(null==e)return null;if("boolean"==typeof e)return e?"1":"0";let r=String(e);return 0===r.trim().length?null:r}(a);null===e?t.delete(r):t.set(r,e)}a.resetPage&&t.set(r,"1"),c.toString()!==t.toString()&&h(t)},[r,h,c]),v=a.default.useCallback(r=>{g({[e]:r})},[e,g]),p=a.default.useCallback(e=>{g({[r]:String((Number.isFinite(e)?Math.max(0,Math.floor(e)):0)+1)})},[r,g]),f=a.default.useCallback(e=>{g({[t]:String(Number.isFinite(e)?Math.max(1,Math.floor(e)):i)})},[i,t,g]),j=a.default.useCallback((e,r,a={})=>{g({[e]:r},a)},[g]);return{query:u,onQueryChange:v,pageIndex:b,onPageIndexChange:p,pageSize:x,onPageSizeChange:f,getParam:a.default.useCallback(e=>c.get(e),[c]),setParam:j,updateParams:g}}e.s(["useUrlDataGridState",()=>o],24325)},94558,e=>{"use strict";var r=e.i(48277),a=e.i(30668),t=e.i(96086),i=e.i(77252),s=e.i(1314),n=e.i(9693),l=e.i(68501),d=e.i(72015),o=e.i(64998),c=e.i(38143),u=e.i(33441),m=e.i(37949),x=e.i(66474),b=e.i(43901),h=e.i(48650),g=e.i(24325),v=e.i(1831);function p(){let e=(0,s.useAuth)(),p=(0,t.useRouter)(),f=(0,t.useParams)(),j=f.business??f.tenant,_=(0,g.useUrlDataGridState)({defaultPageSize:12}),w=_.getParam("is_active")??"all",[N,y]=a.default.useState(!0),[C,S]=a.default.useState(null),[k,M]=a.default.useState(null),[P,z]=a.default.useState(!1),[A,I]=a.default.useState([]),[L,D]=a.default.useState(0),[$,B]=a.default.useState(!1),[F,E]=a.default.useState(null),[R,T]=a.default.useState(""),[q,U]=a.default.useState(!0),[W,O]=a.default.useState(null),[G,H]=a.default.useState(null),[K,Q]=a.default.useState(!1),[V,J]=a.default.useState(""),[X,Y]=a.default.useState(""),[Z,ee]=a.default.useState(null),[er,ea]=a.default.useState(0),et=e.can("device_brands.manage"),ei=a.default.useCallback(async()=>{try{if(y(!0),S(null),"string"!=typeof j||0===j.length)throw Error("Business is missing.");let e=new URLSearchParams;_.query.trim().length>0&&e.set("q",_.query.trim()),e.set("page",String(_.pageIndex+1)),e.set("per_page",String(_.pageSize)),"all"!==w&&e.set("is_active",w);let r=await (0,v.apiFetch)(`/api/${j}/app/repairbuddy/device-brands?${e.toString()}`);I(Array.isArray(r.device_brands)?r.device_brands:[]),ea("number"==typeof r.meta?.total?r.meta.total:0)}catch(e){if(e instanceof v.ApiError&&428===e.status&&"string"==typeof j&&j.length>0){let e=`/app/${j}/device-brands`;p.replace(`/app/${j}/branches/select?next=${encodeURIComponent(e)}`);return}S(e instanceof Error?e.message:"Failed to load device brands.")}finally{y(!1)}},[_.pageIndex,_.pageSize,_.query,L,p,w,j]);async function es(e){if((e.preventDefault(),!P)&&"string"==typeof j&&0!==j.length){if(!et)return void S("Forbidden.");z(!0),S(null),M(null);try{let e=R.trim();if(0===e.length)return void S("Name is required.");let r={name:e,is_active:q},a=null;F?(a=(await (0,v.apiFetch)(`/api/${j}/app/repairbuddy/device-brands/${F}`,{method:"PATCH",body:r})).device_brand??null,M("Device brand updated.")):(a=(await (0,v.apiFetch)(`/api/${j}/app/repairbuddy/device-brands`,{method:"POST",body:r})).device_brand??null,M("Device brand created."));let t=a?.id??F;if(t&&G){let e=new FormData;e.append("image",G);let r=await (0,v.apiFetch)(`/api/${j}/app/repairbuddy/device-brands/${t}/image`,{method:"POST",body:e});O(r.device_brand?.image_url??null)}B(!1),_.onPageIndexChange(0),D(e=>e+1)}catch(e){e instanceof v.ApiError?S(e.message):S(F?"Failed to update device brand.":"Failed to create device brand.")}finally{z(!1)}}}async function en(){if(!P&&F&&"string"==typeof j&&0!==j.length&&et){z(!0),S(null),M(null);try{let e=await (0,v.apiFetch)(`/api/${j}/app/repairbuddy/device-brands/${F}/image`,{method:"DELETE"});O(e.device_brand?.image_url??null),M("Image removed."),H(null),_.onPageIndexChange(0),D(e=>e+1)}catch(e){e instanceof v.ApiError?S(e.message):S("Failed to remove image.")}finally{z(!1)}}}async function el(e){if(!P&&"string"==typeof j&&0!==j.length){var a;if(!et)return void S("Forbidden.");a={title:"Delete device brand",message:(0,r.jsxs)("div",{children:["Delete ",(0,r.jsx)("span",{className:"font-semibold",children:e.name}),"?"]}),action:async()=>{z(!0),S(null),M(null);try{await (0,v.apiFetch)(`/api/${j}/app/repairbuddy/device-brands/${e.id}`,{method:"DELETE"}),M("Device brand deleted."),_.onPageIndexChange(0),D(e=>e+1)}catch(e){e instanceof v.ApiError?S(e.message):S("Failed to delete device brand.")}finally{z(!1)}}},J(a.title),Y(a.message),ee(()=>a.action),Q(!0)}}return a.default.useEffect(()=>{ei()},[ei]),(0,r.jsx)(i.RequireAuth,{requiredPermission:"device_brands.view",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)(o.ConfirmDialog,{open:K,title:V,message:X,busy:P,confirmText:"Delete",confirmVariant:"secondary",onCancel:()=>{P||(Q(!1),ee(null))},onConfirm:()=>{Z&&(async()=>{await Z(),Q(!1),ee(null)})()}}),(0,r.jsx)(x.Modal,{open:$,onClose:()=>{P||B(!1)},title:F?"Edit device brand":"New device brand",footer:(0,r.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,r.jsx)(n.Button,{variant:"outline",onClick:()=>B(!1),disabled:P,children:"Cancel"}),(0,r.jsx)(n.Button,{disabled:P,type:"submit",form:"rb_device_brand_form",children:P?"Saving...":"Save"})]}),children:(0,r.jsxs)("form",{id:"rb_device_brand_form",className:"space-y-3",onSubmit:es,children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm font-medium",htmlFor:"device_brand_name",children:"Name"}),(0,r.jsx)("input",{id:"device_brand_name",className:"w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:R,onChange:e=>T(e.target.value),required:!0,disabled:P})]}),(0,r.jsx)(m.ImagePickerWithPreview,{label:"Image",file:G,existingUrl:W,disabled:P,onFileChange:e=>{S(null),M(null),H(e)},onRemoveExisting:F?()=>void en():void 0,onError:e=>{S(e),M(null)}}),(0,r.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,r.jsx)("input",{type:"checkbox",checked:q,onChange:e=>U(e.target.checked),disabled:P}),"Active"]})]})}),k?(0,r.jsx)("div",{className:"text-sm text-green-700",children:k}):null,C?(0,r.jsx)("div",{className:"text-sm text-red-600",children:C}):null,(0,r.jsx)(h.ListPageShell,{title:"Device Brands",description:"Brand taxonomy for devices.",actions:(0,r.jsx)(n.Button,{variant:"primary",size:"sm",onClick:function(){et&&(E(null),T(""),U(!0),O(null),H(null),B(!0),S(null),M(null))},disabled:!et||N||P,children:"New brand"}),filters:(0,r.jsx)("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm font-medium",htmlFor:"rb_device_brand_status",children:"Status"}),(0,r.jsxs)("select",{id:"rb_device_brand_status",className:"w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:w,onChange:e=>{let r=e.target.value;_.setParam("is_active","all"===r?null:r,{resetPage:!0})},disabled:N||P,children:[(0,r.jsx)("option",{value:"all",children:"All"}),(0,r.jsx)("option",{value:"1",children:"Active"}),(0,r.jsx)("option",{value:"0",children:"Inactive"})]})]})}),loading:N,loadingFallback:(0,r.jsx)(d.Card,{className:"shadow-none",children:(0,r.jsx)(d.CardContent,{className:"pt-5",children:(0,r.jsx)(b.TableSkeleton,{rows:8,columns:4,className:"shadow-none"})})}),error:null,empty:!N&&!C&&0===A.length,emptyTitle:"No brands",emptyDescription:"Add brands to organize your devices.",children:(0,r.jsx)(d.Card,{className:"shadow-none",children:(0,r.jsx)(d.CardContent,{className:"pt-5",children:(0,r.jsx)(c.DataGrid,{title:"string"==typeof j?`Device Brands \xb7 ${j}`:"Device Brands",data:A,loading:N,emptyMessage:"No brands.",getItemId:e=>e.id,search:{placeholder:"Search brands..."},filters:[],server:{query:_.query,onQueryChange:_.onQueryChange,pageIndex:_.pageIndex,onPageIndexChange:_.onPageIndexChange,pageSize:_.pageSize,onPageSizeChange:_.onPageSizeChange,totalRows:er},renderItem:e=>(0,r.jsxs)(d.Card,{className:"overflow-hidden shadow-none",children:[(0,r.jsx)("div",{className:"flex h-32 items-center justify-center bg-[var(--rb-surface-muted)]",children:e.image_url?(0,r.jsx)("img",{src:e.image_url,alt:e.name,className:"h-full w-full object-contain"}):(0,r.jsx)("div",{className:"text-xs text-zinc-500",children:"No image"})}),(0,r.jsxs)(d.CardContent,{className:"pt-4",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsx)("div",{className:"truncate text-sm font-semibold text-[var(--rb-text)]",children:e.name}),(0,r.jsx)("div",{className:"truncate text-xs text-zinc-600",children:e.id})]}),et?(0,r.jsx)(u.DropdownMenu,{align:"right",trigger:({toggle:e})=>(0,r.jsx)(n.Button,{variant:"ghost",size:"sm",onClick:e,disabled:P,className:"px-2",children:"Actions"}),children:({close:a})=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.DropdownMenuItem,{onSelect:()=>{a(),et&&(E(e.id),T(e.name),U(!!e.is_active),O(e.image_url??null),H(null),B(!0),S(null),M(null))},disabled:P,children:"Edit"}),(0,r.jsx)(u.DropdownMenuSeparator,{}),(0,r.jsx)(u.DropdownMenuItem,{destructive:!0,onSelect:()=>{a(),el(e)},disabled:P,children:"Delete"})]})}):null]}),(0,r.jsx)("div",{className:"mt-3 flex items-center justify-between",children:(0,r.jsx)(l.Badge,{variant:e.is_active?"success":"default",children:e.is_active?"Active":"Inactive"})})]})]})})})})})]})})}e.s(["default",()=>p])}]);