(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,63571,e=>{"use strict";var t=e.i(48277),i=e.i(14575);function n({variant:e,className:n}){let r="h-4 w-4 shrink-0";return"success"===e?(0,t.jsx)("svg",{viewBox:"0 0 24 24",className:(0,i.cn)(r,n),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:(0,t.jsx)("path",{d:"M20 6L9 17l-5-5"})}):"warning"===e?(0,t.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,i.cn)(r,n),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,t.jsx)("path",{d:"M12 9v4"}),(0,t.jsx)("path",{d:"M12 17h.01"}),(0,t.jsx)("path",{d:"M10.3 3.6l-8.3 14.3A2 2 0 0 0 3.7 21h16.6a2 2 0 0 0 1.7-3.1L13.7 3.6a2 2 0 0 0-3.4 0z"})]}):"danger"===e?(0,t.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,i.cn)(r,n),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,t.jsx)("path",{d:"M18 6L6 18"}),(0,t.jsx)("path",{d:"M6 6l12 12"})]}):(0,t.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,i.cn)(r,n),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,t.jsx)("path",{d:"M12 16v-4"}),(0,t.jsx)("path",{d:"M12 8h.01"}),(0,t.jsx)("path",{d:"M12 22a10 10 0 1 0-10-10 10 10 0 0 0 10 10z"})]})}function r({className:e,variant:r="info",title:a,children:s,...l}){let o={info:{wrapper:"border-[color:color-mix(in_srgb,var(--rb-blue),white_75%)] bg-[color:color-mix(in_srgb,var(--rb-blue),white_92%)] text-[var(--rb-text)]",icon:"text-[var(--rb-blue)]",title:"text-[var(--rb-blue)]"},success:{wrapper:"border-[color:color-mix(in_srgb,#16a34a,white_75%)] bg-[color:color-mix(in_srgb,#16a34a,white_92%)] text-[var(--rb-text)]",icon:"text-[#166534]",title:"text-[#166534]"},warning:{wrapper:"border-[color:color-mix(in_srgb,var(--rb-orange),white_70%)] bg-[color:color-mix(in_srgb,var(--rb-orange),white_92%)] text-[var(--rb-text)]",icon:"text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)]",title:"text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)]"},danger:{wrapper:"border-[color:color-mix(in_srgb,#dc2626,white_75%)] bg-[color:color-mix(in_srgb,#dc2626,white_92%)] text-[var(--rb-text)]",icon:"text-[#991b1b]",title:"text-[#991b1b]"}}[r];return(0,t.jsx)("div",{role:"alert",className:(0,i.cn)("rounded-[var(--rb-radius-md)] border px-4 py-3",o.wrapper,e),...l,children:(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)(n,{variant:r,className:(0,i.cn)("mt-0.5",o.icon)}),(0,t.jsxs)("div",{className:"min-w-0",children:[a?(0,t.jsx)("div",{className:(0,i.cn)("text-sm font-semibold",o.title),children:a}):null,s?(0,t.jsx)("div",{className:(0,i.cn)("text-sm text-zinc-700",a?"mt-1":""),children:s}):null]})]})})}e.s(["Alert",()=>r])},68501,e=>{"use strict";var t=e.i(48277),i=e.i(14575);function n({className:e,variant:n="default",...r}){return(0,t.jsx)("span",{className:(0,i.cn)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-medium",{default:"bg-[var(--rb-surface-muted)] text-[var(--rb-text)] border-[var(--rb-border)]",info:"bg-[color:color-mix(in_srgb,var(--rb-blue),white_85%)] text-[var(--rb-blue)] border-[color:color-mix(in_srgb,var(--rb-blue),white_70%)]",success:"bg-[color:color-mix(in_srgb,#16a34a,white_85%)] text-[#166534] border-[color:color-mix(in_srgb,#16a34a,white_70%)]",warning:"bg-[color:color-mix(in_srgb,var(--rb-orange),white_85%)] text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)] border-[color:color-mix(in_srgb,var(--rb-orange),white_70%)]",danger:"bg-[color:color-mix(in_srgb,#dc2626,white_85%)] text-[#991b1b] border-[color:color-mix(in_srgb,#dc2626,white_70%)]"}[n],e),...r})}e.s(["Badge",()=>n])},43901,e=>{"use strict";var t=e.i(48277),i=e.i(14575),n=e.i(72015);function r({className:e,"aria-hidden":n=!0,...r}){return(0,t.jsx)("div",{"aria-hidden":n,className:(0,i.cn)("rb-skeleton",e),...r})}function a({lines:e=3,className:a}){let s=Math.max(1,Math.min(e,12));return(0,t.jsx)(n.Card,{className:(0,i.cn)("overflow-hidden",a),children:(0,t.jsxs)(n.CardContent,{className:"space-y-3 pt-5",children:[(0,t.jsx)(r,{className:"h-4 w-32 rounded-[var(--rb-radius-sm)]"}),Array.from({length:s}).map((e,n)=>(0,t.jsx)(r,{className:(0,i.cn)("h-3 rounded-[var(--rb-radius-sm)]",n===s-1?"w-3/5":"w-full")},n))]})})}function s({rows:e=6,columns:n=5,className:a}){let s=Math.max(1,Math.min(e,20)),l=Math.max(1,Math.min(n,10));return(0,t.jsxs)("div",{className:(0,i.cn)("overflow-hidden rounded-[var(--rb-radius-lg)] border border-[var(--rb-border)] bg-white shadow-[var(--rb-shadow)]",a),children:[(0,t.jsx)("div",{className:"border-b border-[var(--rb-border)] px-5 py-4",children:(0,t.jsx)("div",{className:"grid gap-3",style:{gridTemplateColumns:`repeat(${l}, minmax(0, 1fr))`},children:Array.from({length:l}).map((e,i)=>(0,t.jsx)(r,{className:"h-3 w-full rounded-[var(--rb-radius-sm)]"},i))})}),(0,t.jsx)("div",{className:"px-5 pb-5 pt-4",children:(0,t.jsx)("div",{className:"space-y-3",children:Array.from({length:s}).map((e,n)=>(0,t.jsx)("div",{className:"grid gap-3",style:{gridTemplateColumns:`repeat(${l}, minmax(0, 1fr))`},children:Array.from({length:l}).map((e,n)=>(0,t.jsx)(r,{className:(0,i.cn)("h-3 rounded-[var(--rb-radius-sm)]",0===n?"w-3/4":"w-full")},n))},n))})})]})}e.s(["CardSkeleton",()=>a,"Skeleton",()=>r,"TableSkeleton",()=>s])},37574,e=>{"use strict";var t=e.i(48277),i=e.i(30668),n=e.i(14575),r=e.i(9693),a=e.i(33441),s=e.i(43901),l=e.i(1831);function o({title:e,data:o,columns:c,getRowId:d,loading:m=!1,emptyMessage:u="No data.",search:x,filters:h=[],pageSizeOptions:v=[10,25,50],initialPageSize:b=10,server:p,exportConfig:f,columnVisibilityKey:g,onRowClick:y,className:j}){let[N,w]=(0,i.useState)(""),[_,S]=(0,i.useState)(0),[I,C]=(0,i.useState)(b),[T,z]=(0,i.useState)(null),[P,$]=(0,i.useState)(null),[D,F]=(0,i.useState)(0),M=(0,i.useId)(),k=!!p,A=k?p.query:N,B=k?p.onQueryChange:w,E=k?p.pageIndex:_,L=k?p.onPageIndexChange:S,O=k?p.pageSize:I,R=k?p.onPageSizeChange:C,U=k?p.sort??null:null,V=k?p.onSortChange:void 0,H=(0,i.useMemo)(()=>{let e=Array.isArray(c)?c:[];if(!g){let t=e.filter(e=>!e.hiddenByDefault);return t.length>0?t:e.slice(0,1)}try{let t=window.localStorage.getItem(g);if(!t){let t=e.filter(e=>!e.hiddenByDefault);return t.length>0?t:e.slice(0,1)}let i=JSON.parse(t),n=e.filter(e=>{let t=i[e.id];return"boolean"==typeof t?t:!e.hiddenByDefault});return n.length>0?n:e.slice(0,1)}catch{let t=e.filter(e=>!e.hiddenByDefault);return t.length>0?t:e.slice(0,1)}},[g,c,D]),q=(0,i.useMemo)(()=>{if(k)return Array.isArray(o)?o:[];let e=A.trim().toLowerCase();return(Array.isArray(o)?o:[]).filter(t=>{if(x&&x.getSearchText&&e.length>0&&!x.getSearchText(t).toLowerCase().includes(e))return!1;for(let e of h)if(e.predicate&&!e.predicate(t,e.value))return!1;return!0})},[o,h,k,A,x]),J=k?p.totalRows:q.length,Q=Math.max(1,Math.ceil(J/O)),W=Math.min(E,Q-1),K=Math.max(1,Math.min(8,O||10)),G=(0,i.useMemo)(()=>{if(k)return q;let e=W*O,t=e+O;return q.slice(e,t)},[W,q,k,O]),Y=W>0,X=W<Q-1,Z=!!x||h.length>0||!!f||!!g;function ee(e,t){if(g&&(t||!(H.length<=1)))try{let i=window.localStorage.getItem(g),n=(i?JSON.parse(i):{})??{};n[e]=t,window.localStorage.setItem(g,JSON.stringify(n)),F(e=>e+1)}catch{}}async function et(e){if(f&&!T){$(null),z(e);try{let t=new URLSearchParams;for(let e of(A.trim().length>0&&t.set("q",A.trim()),h)){let i=e.value;null!=i&&0!==String(i).length&&t.set(e.id,String(i))}if(k&&U?.id&&U?.dir&&(t.set("sort",U.id),t.set("dir",U.dir)),t.set("format",e),f.extraQuery)for(let[e,i]of Object.entries(f.extraQuery))null!=i&&t.set(e,String(i));let i=`${f.url}${f.url.includes("?")?"&":"?"}${t.toString()}`,n=f.filename?.({format:e});await (0,l.apiDownload)(i,{filename:n})}catch(e){$(e instanceof Error?e.message:"Export failed.")}finally{z(null)}}}return(0,t.jsxs)("div",{className:(0,n.cn)("space-y-3",j),children:[e?(0,t.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:e}):null,Z?(0,t.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-end md:justify-between",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-end",children:[x?(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("label",{className:"text-sm font-medium",htmlFor:`${M}_datatable_search`,children:"Search"}),(0,t.jsx)("input",{id:`${M}_datatable_search`,className:"w-full min-w-[220px] rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:A,onChange:e=>{B(e.target.value),L(0)},placeholder:x.placeholder??"Search..."})]}):null,h.map(e=>(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("label",{className:"text-sm font-medium",htmlFor:`${M}_datatable_filter_${e.id}`,children:e.label}),(0,t.jsx)("select",{id:`${M}_datatable_filter_${e.id}`,className:"w-full min-w-[180px] rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:String(e.value),onChange:t=>{let i=e.options.find(e=>String(e.value)===t.target.value),n=i?i.value:t.target.value;e.onChange(n),L(0)},children:e.options.map(e=>(0,t.jsx)("option",{value:String(e.value),children:e.label},String(e.value)))})]},e.id))]}),(0,t.jsxs)("div",{className:"flex flex-col items-start gap-2 md:items-end",children:[(0,t.jsxs)("div",{className:"text-sm text-zinc-600",children:[J," result(s)"]}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[f?(0,t.jsx)(a.DropdownMenu,{align:"right",trigger:({toggle:e})=>(0,t.jsx)(r.Button,{variant:"outline",size:"sm",onClick:e,disabled:!!T,children:T?"Exporting...":"Export"}),children:({close:e})=>{let i=f.formats??["csv","xlsx","pdf"];return(0,t.jsx)(t.Fragment,{children:i.map(i=>(0,t.jsxs)(a.DropdownMenuItem,{onSelect:()=>{e(),et(i)},disabled:!!T,children:["Export ",i.toUpperCase()]},i))})}}):null,g?(0,t.jsx)(a.DropdownMenu,{align:"right",trigger:({toggle:e})=>(0,t.jsx)(r.Button,{variant:"outline",size:"sm",onClick:e,children:"Columns"}),children:({close:e})=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.DropdownMenuItem,{onSelect:()=>{for(let t of(e(),c))ee(t.id,!0)},children:"Show all"}),(0,t.jsx)(a.DropdownMenuItem,{onSelect:()=>{for(let t of(e(),c))ee(t.id,!t.hiddenByDefault)},children:"Reset defaults"}),(0,t.jsx)(a.DropdownMenuSeparator,{}),c.map(e=>{let i=H.some(t=>t.id===e.id);return(0,t.jsxs)(a.DropdownMenuItem,{onSelect:()=>{ee(e.id,!i)},children:[(0,t.jsx)("span",{className:"mr-2 inline-block w-4",children:i?"✓":""}),"string"==typeof e.header?e.header:e.id]},e.id)})]})}):null]})]})]}):null,P?(0,t.jsx)("div",{className:"text-sm text-red-600",children:P}):null,(0,t.jsx)("div",{className:"overflow-x-auto rounded-[var(--rb-radius-md)] border border-[var(--rb-border)] bg-white",children:(0,t.jsxs)("table",{className:"min-w-full border-collapse text-left text-sm",children:[(0,t.jsx)("thead",{className:"bg-[var(--rb-surface-muted)]",children:(0,t.jsx)("tr",{children:H.map(e=>(0,t.jsx)("th",{className:(0,n.cn)("whitespace-nowrap border-b border-[var(--rb-border)] px-3 py-2 text-xs font-semibold uppercase tracking-wide text-zinc-600",e.headerClassName),children:k&&e.sortId&&V?(0,t.jsxs)("button",{type:"button",onClick:()=>(function(e){if(k&&e.sortId&&V){if(!U||U.id!==e.sortId){V({id:e.sortId,dir:"asc"}),L(0);return}if("asc"===U.dir){V({id:e.sortId,dir:"desc"}),L(0);return}V(null),L(0)}})(e),className:"inline-flex items-center gap-1 hover:text-zinc-900",children:[(0,t.jsx)("span",{children:e.header}),k&&e.sortId?U&&U.id===e.sortId?"asc"===U.dir?(0,t.jsx)("span",{className:"ml-1 text-zinc-700",children:"↑"}):(0,t.jsx)("span",{className:"ml-1 text-zinc-700",children:"↓"}):(0,t.jsx)("span",{className:"ml-1 text-zinc-400",children:"↕"}):null]}):e.header},e.id))})}),(0,t.jsx)("tbody",{children:m?Array.from({length:K}).map((e,i)=>(0,t.jsx)("tr",{className:"border-t border-[var(--rb-border)]",children:H.map((e,i)=>(0,t.jsx)("td",{className:(0,n.cn)("px-3 py-2 align-middle",e.className),children:(0,t.jsx)(s.Skeleton,{className:(0,n.cn)("h-3 rounded-[var(--rb-radius-sm)]",0===i?"w-3/4":i===H.length-1?"w-16":"w-full")})},e.id))},`loading_${i}`)):0===G.length?(0,t.jsx)("tr",{children:(0,t.jsx)("td",{className:"px-3 py-3 text-sm text-zinc-600",colSpan:Math.max(1,H.length),children:u})}):G.map(e=>(0,t.jsx)("tr",{className:(0,n.cn)("border-t border-[var(--rb-border)]",y?"cursor-pointer hover:bg-[var(--rb-surface-muted)]":null),tabIndex:y?0:void 0,role:y?"button":void 0,onClick:y?()=>{y(e)}:void 0,onKeyDown:y?t=>{("Enter"===t.key||" "===t.key)&&(t.preventDefault(),y(e))}:void 0,children:H.map(i=>(0,t.jsx)("td",{className:(0,n.cn)("px-3 py-2 align-middle",i.className),children:i.cell(e)},i.id))},String(d(e))))})]})}),(0,t.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(r.Button,{variant:"outline",size:"sm",onClick:function(){L(Math.max(0,W-1))},disabled:!Y,children:"Prev"}),(0,t.jsx)(r.Button,{variant:"outline",size:"sm",onClick:function(){L(Math.min(Q-1,W+1))},disabled:!X,children:"Next"}),(0,t.jsxs)("div",{className:"text-sm text-zinc-600",children:["Page ",W+1," / ",Q]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"text-sm text-zinc-600",children:"Rows per page"}),(0,t.jsx)("select",{className:"rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:String(O),onChange:e=>{R(Number(e.target.value)),L(0)},children:v.map(e=>(0,t.jsx)("option",{value:e,children:e},e))})]})]})]})}e.s(["DataTable",()=>o])},30765,e=>{"use strict";function t(e){let t=e.amountCents,i=e.currency?.toUpperCase()??null;if("number"!=typeof t||!Number.isFinite(t))return e.fallback??"—";let n=t/100;if(!i||3!==i.length)return`${n.toFixed(2)}`;try{return new Intl.NumberFormat(void 0,{style:"currency",currency:i,minimumFractionDigits:2,maximumFractionDigits:2}).format(n)}catch{return`${i} ${n.toFixed(2)}`}}e.s(["formatMoney",()=>t])},69965,e=>{"use strict";let t={locale:"en-GB",dateStyle:"medium",timeStyle:"short",hour12:!1};function i(e){if(!e)return null;if(e instanceof Date)return Number.isFinite(e.getTime())?e:null;let t=new Date(e);return Number.isFinite(t.getTime())?t:null}function n(e,n){let r=i(e);if(!r)return"—";let a={...t,...n??{}};return new Intl.DateTimeFormat(a.locale,{dateStyle:a.dateStyle}).format(r)}function r(e,n){let r=i(e);if(!r)return"—";let a={...t,...n??{}};return new Intl.DateTimeFormat(a.locale,{dateStyle:a.dateStyle,timeStyle:a.timeStyle,hour12:a.hour12}).format(r)}e.s(["formatDate",()=>n,"formatDateTime",()=>r])},21190,e=>{"use strict";var t=e.i(1831);async function i(e){let i=new URLSearchParams;return"boolean"==typeof e?.includeInactive&&i.set("include_inactive",e.includeInactive?"1":"0"),(0,t.apiFetch)(`/api/admin/billing/catalog${i.toString()?`?${i.toString()}`:""}`)}async function n(e){let i=new URLSearchParams;return"boolean"==typeof e?.includeInactive&&i.set("include_inactive",e.includeInactive?"1":"0"),(0,t.apiFetch)(`/api/admin/billing/intervals${i.toString()?`?${i.toString()}`:""}`)}async function r(e){return(0,t.apiFetch)("/api/admin/billing/intervals",{method:"POST",body:{code:e.code?.trim()||void 0,name:e.name,months:e.months,is_active:"boolean"==typeof e.isActive?e.isActive:void 0}})}async function a(e){return(0,t.apiFetch)(`/api/admin/billing/intervals/${e.intervalId}`,{method:"PUT",body:{code:e.code,name:e.name,months:e.months,is_active:"boolean"==typeof e.isActive?e.isActive:void 0,reason:e.reason}})}async function s(e){return(0,t.apiFetch)(`/api/admin/billing/intervals/${e.intervalId}/active`,{method:"PATCH",body:{is_active:e.isActive,reason:e.reason}})}async function l(e){return(0,t.apiFetch)("/api/admin/billing/plans",{method:"POST",body:{name:e.name,code:e.code?.trim()||void 0,description:e.description?.trim()||void 0,is_active:"boolean"==typeof e.isActive?e.isActive:void 0}})}async function o(e){return(0,t.apiFetch)(`/api/admin/billing/plans/${e.planId}`,{method:"PUT",body:{name:e.name,code:e.code,description:e.description?.trim()||void 0,is_active:"boolean"==typeof e.isActive?e.isActive:void 0,reason:e.reason}})}async function c(e){return(0,t.apiFetch)(`/api/admin/billing/plans/${e.planId}/versions/draft-from-active`,{method:"POST",body:{reason:e.reason}})}async function d(e){try{return await (0,t.apiFetch)(`/api/admin/billing/versions/${e.versionId}/validate`,{method:"POST",body:{reason:e.reason}})}catch(e){if(e instanceof t.ApiError){let t=e.data;if(t&&"object"==typeof t){if("ok"===t.status)return{status:"ok"};if("string"==typeof t.message)return{message:t.message,errors:Array.isArray(t.errors)?t.errors.map(String):void 0}}}throw e}}async function m(e){return(0,t.apiFetch)(`/api/admin/billing/versions/${e.versionId}/entitlements/sync`,{method:"POST",body:{entitlements:e.entitlements,reason:e.reason}})}async function u(e){return(0,t.apiFetch)(`/api/admin/billing/versions/${e.versionId}/prices`,{method:"POST",body:{currency:e.currency,billing_interval_id:"number"==typeof e.billingIntervalId?e.billingIntervalId:void 0,interval:e.interval,amount_cents:e.amountCents,trial_days:"number"==typeof e.trialDays?e.trialDays:void 0,is_default:"boolean"==typeof e.isDefault?e.isDefault:void 0,reason:e.reason}})}async function x(e){return(0,t.apiFetch)(`/api/admin/billing/prices/${e.priceId}`,{method:"PATCH",body:{amount_cents:e.amountCents,trial_days:"number"==typeof e.trialDays?e.trialDays:void 0,is_default:"boolean"==typeof e.isDefault?e.isDefault:void 0,reason:e.reason}})}async function h(e){return(0,t.apiFetch)(`/api/admin/billing/prices/${e.priceId}`,{method:"DELETE",body:{reason:e.reason}})}async function v(e){return(0,t.apiFetch)(`/api/admin/billing/versions/${e.versionId}/activate`,{method:"POST",body:{confirm:e.confirm,reason:e.reason}})}async function b(e){return(0,t.apiFetch)("/api/admin/billing/entitlement-definitions",{method:"POST",body:{code:e.code?.trim()||void 0,name:e.name,value_type:e.valueType,description:e.description?.trim()||void 0,is_premium:"boolean"==typeof e.isPremium?e.isPremium:void 0}})}async function p(e){return(0,t.apiFetch)(`/api/admin/billing/entitlement-definitions/${e.id}`,{method:"PUT",body:{code:e.code,name:e.name,value_type:e.valueType,description:e.description?.trim()||void 0,is_premium:"boolean"==typeof e.isPremium?e.isPremium:void 0,reason:e.reason}})}async function f(e){return(0,t.apiFetch)(`/api/admin/billing/entitlement-definitions/${e.id}`,{method:"DELETE",body:{reason:e.reason}})}async function g(e){return(0,t.apiFetch)(`/api/admin/businesses/${e}/subscriptions`)}async function y(e){return(0,t.apiFetch)(`/api/admin/businesses/${e.tenantId}/subscriptions`,{method:"POST",body:{billing_plan_version_id:e.billingPlanVersionId,billing_price_id:e.billingPriceId,reason:e.reason}})}async function j(e){return(0,t.apiFetch)(`/api/admin/businesses/${e.tenantId}/subscriptions/${e.subscriptionId}/cancel`,{method:"POST",body:{at_period_end:"boolean"==typeof e.atPeriodEnd?e.atPeriodEnd:void 0,reason:e.reason}})}async function N(e){let i=new URLSearchParams;return e.status&&e.status.trim().length>0&&i.set("status",e.status.trim()),"number"==typeof e.limit&&Number.isFinite(e.limit)&&i.set("limit",String(e.limit)),(0,t.apiFetch)(`/api/admin/businesses/${e.tenantId}/invoices${i.toString()?`?${i.toString()}`:""}`)}async function w(e){return(0,t.apiFetch)(`/api/admin/businesses/${e.tenantId}/invoices/${e.invoiceId}`)}async function _(e){return(0,t.apiFetch)(`/api/admin/businesses/${e.tenantId}/invoices`,{method:"POST",body:{tenant_subscription_id:e.tenantSubscriptionId,reason:e.reason}})}async function S(e){return(0,t.apiFetch)(`/api/admin/businesses/${e.tenantId}/invoices/${e.invoiceId}/issue`,{method:"POST",body:{reason:e.reason}})}async function I(e){return(0,t.apiFetch)(`/api/admin/businesses/${e.tenantId}/invoices/${e.invoiceId}/paid`,{method:"POST",body:{paid_at:e.paidAt,paid_method:e.paidMethod,paid_note:e.paidNote,reason:e.reason}})}async function C(e){let i=e.invoiceNumber?`invoice_${e.invoiceNumber}.pdf`:"invoice.pdf";await (0,t.apiDownload)(`/api/admin/businesses/${e.tenantId}/invoices/${e.invoiceId}/pdf`,{filename:i})}e.s(["activateBillingPlanVersion",()=>v,"assignTenantSubscription",()=>y,"cancelTenantSubscription",()=>j,"createBillingInterval",()=>r,"createBillingPlan",()=>l,"createBillingPrice",()=>u,"createDraftBillingPlanVersionFromActive",()=>c,"createEntitlementDefinition",()=>b,"createInvoiceFromSubscription",()=>_,"deleteBillingPrice",()=>h,"deleteEntitlementDefinition",()=>f,"downloadInvoicePdf",()=>C,"getBillingCatalog",()=>i,"getTenantInvoice",()=>w,"getTenantInvoices",()=>N,"getTenantSubscriptions",()=>g,"issueInvoice",()=>S,"listBillingIntervals",()=>n,"markInvoicePaid",()=>I,"setBillingIntervalActive",()=>s,"syncBillingPlanVersionEntitlements",()=>m,"updateBillingInterval",()=>a,"updateBillingPlan",()=>o,"updateBillingPrice",()=>x,"updateEntitlementDefinition",()=>p,"validateBillingPlanVersionDraft",()=>d])},81311,e=>{"use strict";var t=e.i(48277),i=e.i(30668),n=e.i(16506),r=e.i(96086),a=e.i(77252),s=e.i(24273),l=e.i(63571),o=e.i(68501),c=e.i(9693),d=e.i(72015),m=e.i(37574),u=e.i(21190),x=e.i(69965),h=e.i(30765);function v(){var e;let v=(0,r.useParams)(),b=Number(v.business),p=Number(v.invoiceId),f=(0,s.useDashboardHeader)(),[g,y]=(0,i.useState)(!0),[j,N]=(0,i.useState)(null),[w,_]=(0,i.useState)(null),[S,I]=(0,i.useState)(null),[C,T]=(0,i.useState)(!1),[z,P]=(0,i.useState)(0);(0,i.useEffect)(()=>(f.setHeader({breadcrumb:"Admin / Businesses",title:S?S.invoice_number:`Invoice ${p}`,subtitle:w?`${w.name} • ${w.slug}`:void 0,actions:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(n.default,{href:`/admin/businesses/${b}/billing/invoices`,children:(0,t.jsx)(c.Button,{variant:"outline",size:"sm",children:"Back"})}),(0,t.jsx)(c.Button,{variant:"outline",size:"sm",onClick:()=>P(e=>e+1),disabled:g,children:"Refresh"}),(0,t.jsx)(c.Button,{variant:"secondary",size:"sm",onClick:async()=>{if(S){T(!0);try{await (0,u.downloadInvoicePdf)({tenantId:b,invoiceId:S.id,invoiceNumber:S.invoice_number})}finally{T(!1)}}},disabled:C||!S,children:C?"Downloading…":"Download PDF"})]})}),()=>f.setHeader(null)),[f,C,S,p,g,w,b]),(0,i.useEffect)(()=>{let e=!0;return async function(){if(!Number.isFinite(b)||b<=0||!Number.isFinite(p)||p<=0){N("Invalid business/invoice id."),y(!1);return}try{y(!0),N(null);let t=await (0,u.getTenantInvoice)({tenantId:b,invoiceId:p});if(!e)return;_(t.tenant),I(t.invoice)}catch(t){if(!e)return;N(t instanceof Error?t.message:"Failed to load invoice."),_(null),I(null)}finally{if(!e)return;y(!1)}}(),()=>{e=!1}},[p,z,b]);let $=(0,i.useMemo)(()=>Array.isArray(S?.lines)?S?.lines:[],[S]),D=S?.tax_details_json&&"object"==typeof S.tax_details_json&&!Array.isArray(S.tax_details_json)?S.tax_details_json:null,F="string"==typeof D?.scenario?D.scenario:null,M="string"==typeof D?.reason?D.reason:null,k="number"==typeof D?.rate_percent||"string"==typeof D?.rate_percent?String(D.rate_percent):null;return(0,t.jsx)(a.RequireAuth,{requiredPermission:"admin.billing.read",children:(0,t.jsxs)("div",{className:"space-y-6",children:[j?(0,t.jsx)(l.Alert,{variant:"danger",title:"Could not load invoice",children:j}):null,S?(0,t.jsxs)(d.Card,{children:[(0,t.jsxs)(d.CardHeader,{className:"flex flex-row items-start justify-between gap-4",children:[(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsx)(d.CardTitle,{className:"truncate",children:"Invoice summary"}),(0,t.jsxs)("div",{className:"mt-1 text-sm text-zinc-600",children:["Tenant: ",w?.name??"—"]})]}),(0,t.jsx)(o.Badge,{variant:"paid"===(e=S.status)?"success":"issued"===e?"info":"default",children:S.status})]}),(0,t.jsx)(d.CardContent,{children:(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs text-zinc-500",children:"Subtotal"}),(0,t.jsx)("div",{className:"mt-1 text-sm text-zinc-800",children:(0,h.formatMoney)({amountCents:S.subtotal_cents,currency:S.currency})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs text-zinc-500",children:"Tax"}),(0,t.jsx)("div",{className:"mt-1 text-sm text-zinc-800",children:(0,h.formatMoney)({amountCents:S.tax_cents,currency:S.currency})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs text-zinc-500",children:"Total"}),(0,t.jsx)("div",{className:"mt-1 text-sm font-semibold text-zinc-900",children:(0,h.formatMoney)({amountCents:S.total_cents,currency:S.currency})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs text-zinc-500",children:"Issued"}),(0,t.jsx)("div",{className:"mt-1 text-sm text-zinc-800",children:(0,x.formatDateTime)(S.issued_at??null)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs text-zinc-500",children:"Paid"}),(0,t.jsx)("div",{className:"mt-1 text-sm text-zinc-800",children:(0,x.formatDateTime)(S.paid_at??null)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs text-zinc-500",children:"Paid method"}),(0,t.jsx)("div",{className:"mt-1 text-sm text-zinc-800",children:S.paid_method??"—"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs text-zinc-500",children:"Paid note"}),(0,t.jsx)("div",{className:"mt-1 text-sm text-zinc-800",children:S.paid_note??"—"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs text-zinc-500",children:"Seller → Buyer"}),(0,t.jsxs)("div",{className:"mt-1 text-sm text-zinc-800",children:[S.seller_country," → ",S.billing_country??"—"]})]})]})})]}):null,(0,t.jsx)(m.DataTable,{title:"Line items",data:$,loading:g,emptyMessage:"No line items found.",getRowId:e=>e.id,columns:[{id:"desc",header:"Description",cell:e=>(0,t.jsx)("div",{className:"text-sm text-zinc-800",children:e.description}),className:"min-w-[260px]"},{id:"qty",header:"Qty",cell:e=>(0,t.jsx)("div",{className:"text-sm text-zinc-700",children:e.quantity}),className:"whitespace-nowrap"},{id:"unit",header:"Unit",cell:e=>(0,t.jsx)("div",{className:"text-sm text-zinc-700",children:(0,h.formatMoney)({amountCents:e.unit_amount_cents,currency:S?.currency??null})}),className:"whitespace-nowrap"},{id:"tax_rate",header:"Tax %",cell:e=>(0,t.jsx)("div",{className:"text-sm text-zinc-700",children:e.tax_rate_percent??"—"}),className:"whitespace-nowrap"},{id:"tax",header:"Tax",cell:e=>(0,t.jsx)("div",{className:"text-sm text-zinc-700",children:(0,h.formatMoney)({amountCents:e.tax_cents,currency:S?.currency??null})}),className:"whitespace-nowrap"},{id:"total",header:"Total",cell:e=>(0,t.jsx)("div",{className:"text-sm text-zinc-700",children:(0,h.formatMoney)({amountCents:e.total_cents,currency:S?.currency??null})}),className:"whitespace-nowrap"}]}),(0,t.jsxs)(d.Card,{children:[(0,t.jsx)(d.CardHeader,{children:(0,t.jsx)(d.CardTitle,{children:"VAT / tax evidence"})}),(0,t.jsxs)(d.CardContent,{children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs text-zinc-500",children:"Scenario"}),(0,t.jsx)("div",{className:"mt-1 text-sm text-zinc-800",children:F??"—"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs text-zinc-500",children:"Reason"}),(0,t.jsx)("div",{className:"mt-1 text-sm text-zinc-800",children:M??"—"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs text-zinc-500",children:"Rate"}),(0,t.jsx)("div",{className:"mt-1 text-sm text-zinc-800",children:null!==k?`${k}%`:"—"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs text-zinc-500",children:"VAT number present?"}),(0,t.jsx)("div",{className:"mt-1 text-sm text-zinc-800",children:S?.billing_vat_number?"Yes":"No"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs text-zinc-500",children:"Buyer VAT number"}),(0,t.jsx)("div",{className:"mt-1 text-sm text-zinc-800",children:S?.billing_vat_number??"—"})]})]}),(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("div",{className:"text-xs font-semibold text-zinc-600",children:"Raw snapshot"}),(0,t.jsx)("pre",{className:"mt-2 max-h-[320px] overflow-auto rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-[var(--rb-surface-muted)] p-3 text-xs text-zinc-700",children:JSON.stringify(S?.tax_details_json??null,null,2)})]})]})]})]})})}e.s(["default",()=>v])}]);