(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,66474,e=>{"use strict";var t=e.i(48277),r=e.i(30668),a=e.i(14575);function s({open:e,onClose:s,title:i,children:l,footer:n,position:d="center",variant:o="glass",className:c}){if((0,r.useEffect)(()=>{function t(t){e&&"Escape"===t.key&&s()}return document.addEventListener("keydown",t),()=>document.removeEventListener("keydown",t)},[s,e]),!e)return null;let u="solid"===o?(0,a.cn)("relative w-full max-w-lg overflow-hidden rounded-[var(--rb-radius-lg)]","border border-[var(--rb-border)]","bg-white","shadow-[var(--rb-shadow)]"):(0,a.cn)("relative w-full max-w-lg overflow-hidden rounded-[var(--rb-radius-lg)]","border border-[color:color-mix(in_srgb,var(--rb-border),white_55%)]","bg-white/75 backdrop-blur-xl","shadow-[0_18px_55px_-18px_rgba(0,0,0,0.55)]","ring-1 ring-white/25");return(0,t.jsxs)("div",{className:"top-center"===d?"fixed inset-0 z-50 flex items-start justify-center px-4 pt-8":"fixed inset-0 z-50 flex items-center justify-center px-4",children:[(0,t.jsx)("button",{type:"button",className:(0,a.cn)("absolute inset-0","bg-black/35 backdrop-blur-md","bg-[radial-gradient(900px_600px_at_20%_20%,color-mix(in_srgb,#16a34a,transparent_82%)_0%,transparent_60%),radial-gradient(900px_600px_at_80%_30%,color-mix(in_srgb,var(--rb-blue),transparent_82%)_0%,transparent_60%),radial-gradient(900px_600px_at_50%_85%,color-mix(in_srgb,var(--rb-orange),transparent_85%)_0%,transparent_65%)]"),"aria-label":"Close",onClick:s}),(0,t.jsxs)("div",{role:"dialog","aria-modal":"true",className:(0,a.cn)(u,c),children:["glass"===o?(0,t.jsx)("div",{className:"pointer-events-none absolute inset-0 bg-[radial-gradient(650px_420px_at_20%_15%,color-mix(in_srgb,#16a34a,transparent_88%)_0%,transparent_60%),radial-gradient(650px_420px_at_80%_5%,color-mix(in_srgb,var(--rb-blue),transparent_90%)_0%,transparent_60%)]"}):null,i?(0,t.jsx)("div",{className:(0,a.cn)("relative px-5 py-4","solid"===o?"border-b border-[var(--rb-border)]":"border-b border-[color:color-mix(in_srgb,var(--rb-border),white_60%)]"),children:(0,t.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:i})}):null,(0,t.jsx)("div",{className:"relative px-5 py-4",children:l}),n?(0,t.jsx)("div",{className:(0,a.cn)("relative px-5 py-4","solid"===o?"border-t border-[var(--rb-border)]":"border-t border-[color:color-mix(in_srgb,var(--rb-border),white_60%)]"),children:n}):null]})]})}e.s(["Modal",()=>s])},64998,e=>{"use strict";var t=e.i(48277),r=e.i(66474),a=e.i(9693);function s({open:e,title:s,message:i,confirmText:l="Confirm",confirmVariant:n="primary",cancelText:d="Cancel",busy:o=!1,onCancel:c,onConfirm:u}){return(0,t.jsx)(r.Modal,{open:e,onClose:()=>{o||c()},title:s,footer:(0,t.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,t.jsx)(a.Button,{variant:"outline",onClick:c,disabled:o,children:d}),(0,t.jsx)(a.Button,{variant:n,onClick:u,disabled:o,children:o?"Working...":l})]}),children:(0,t.jsx)("div",{className:"text-sm text-zinc-700",children:i})})}e.s(["ConfirmDialog",()=>s])},19463,e=>{"use strict";var t=e.i(48277),r=e.i(14575);function a({title:e,description:a,actions:s,className:i}){return(0,t.jsxs)("div",{className:(0,r.cn)("flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between",i),children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-xl font-semibold text-[var(--rb-text)]",children:e}),a?(0,t.jsx)("p",{className:"mt-1 text-sm text-zinc-600",children:a}):null]}),s?(0,t.jsx)("div",{className:"flex items-center gap-2",children:s}):null]})}e.s(["PageHeader",()=>a])},63571,e=>{"use strict";var t=e.i(48277),r=e.i(14575);function a({variant:e,className:a}){let s="h-4 w-4 shrink-0";return"success"===e?(0,t.jsx)("svg",{viewBox:"0 0 24 24",className:(0,r.cn)(s,a),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:(0,t.jsx)("path",{d:"M20 6L9 17l-5-5"})}):"warning"===e?(0,t.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,r.cn)(s,a),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,t.jsx)("path",{d:"M12 9v4"}),(0,t.jsx)("path",{d:"M12 17h.01"}),(0,t.jsx)("path",{d:"M10.3 3.6l-8.3 14.3A2 2 0 0 0 3.7 21h16.6a2 2 0 0 0 1.7-3.1L13.7 3.6a2 2 0 0 0-3.4 0z"})]}):"danger"===e?(0,t.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,r.cn)(s,a),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,t.jsx)("path",{d:"M18 6L6 18"}),(0,t.jsx)("path",{d:"M6 6l12 12"})]}):(0,t.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,r.cn)(s,a),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,t.jsx)("path",{d:"M12 16v-4"}),(0,t.jsx)("path",{d:"M12 8h.01"}),(0,t.jsx)("path",{d:"M12 22a10 10 0 1 0-10-10 10 10 0 0 0 10 10z"})]})}function s({className:e,variant:s="info",title:i,children:l,...n}){let d={info:{wrapper:"border-[color:color-mix(in_srgb,var(--rb-blue),white_75%)] bg-[color:color-mix(in_srgb,var(--rb-blue),white_92%)] text-[var(--rb-text)]",icon:"text-[var(--rb-blue)]",title:"text-[var(--rb-blue)]"},success:{wrapper:"border-[color:color-mix(in_srgb,#16a34a,white_75%)] bg-[color:color-mix(in_srgb,#16a34a,white_92%)] text-[var(--rb-text)]",icon:"text-[#166534]",title:"text-[#166534]"},warning:{wrapper:"border-[color:color-mix(in_srgb,var(--rb-orange),white_70%)] bg-[color:color-mix(in_srgb,var(--rb-orange),white_92%)] text-[var(--rb-text)]",icon:"text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)]",title:"text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)]"},danger:{wrapper:"border-[color:color-mix(in_srgb,#dc2626,white_75%)] bg-[color:color-mix(in_srgb,#dc2626,white_92%)] text-[var(--rb-text)]",icon:"text-[#991b1b]",title:"text-[#991b1b]"}}[s];return(0,t.jsx)("div",{role:"alert",className:(0,r.cn)("rounded-[var(--rb-radius-md)] border px-4 py-3",d.wrapper,e),...n,children:(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)(a,{variant:s,className:(0,r.cn)("mt-0.5",d.icon)}),(0,t.jsxs)("div",{className:"min-w-0",children:[i?(0,t.jsx)("div",{className:(0,r.cn)("text-sm font-semibold",d.title),children:i}):null,l?(0,t.jsx)("div",{className:(0,r.cn)("text-sm text-zinc-700",i?"mt-1":""),children:l}):null]})]})})}e.s(["Alert",()=>s])},43901,e=>{"use strict";var t=e.i(48277),r=e.i(14575),a=e.i(72015);function s({className:e,"aria-hidden":a=!0,...s}){return(0,t.jsx)("div",{"aria-hidden":a,className:(0,r.cn)("rb-skeleton",e),...s})}function i({lines:e=3,className:i}){let l=Math.max(1,Math.min(e,12));return(0,t.jsx)(a.Card,{className:(0,r.cn)("overflow-hidden",i),children:(0,t.jsxs)(a.CardContent,{className:"space-y-3 pt-5",children:[(0,t.jsx)(s,{className:"h-4 w-32 rounded-[var(--rb-radius-sm)]"}),Array.from({length:l}).map((e,a)=>(0,t.jsx)(s,{className:(0,r.cn)("h-3 rounded-[var(--rb-radius-sm)]",a===l-1?"w-3/5":"w-full")},a))]})})}function l({rows:e=6,columns:a=5,className:i}){let l=Math.max(1,Math.min(e,20)),n=Math.max(1,Math.min(a,10));return(0,t.jsxs)("div",{className:(0,r.cn)("overflow-hidden rounded-[var(--rb-radius-lg)] border border-[var(--rb-border)] bg-white shadow-[var(--rb-shadow)]",i),children:[(0,t.jsx)("div",{className:"border-b border-[var(--rb-border)] px-5 py-4",children:(0,t.jsx)("div",{className:"grid gap-3",style:{gridTemplateColumns:`repeat(${n}, minmax(0, 1fr))`},children:Array.from({length:n}).map((e,r)=>(0,t.jsx)(s,{className:"h-3 w-full rounded-[var(--rb-radius-sm)]"},r))})}),(0,t.jsx)("div",{className:"px-5 pb-5 pt-4",children:(0,t.jsx)("div",{className:"space-y-3",children:Array.from({length:l}).map((e,a)=>(0,t.jsx)("div",{className:"grid gap-3",style:{gridTemplateColumns:`repeat(${n}, minmax(0, 1fr))`},children:Array.from({length:n}).map((e,a)=>(0,t.jsx)(s,{className:(0,r.cn)("h-3 rounded-[var(--rb-radius-sm)]",0===a?"w-3/4":"w-full")},a))},a))})})]})}e.s(["CardSkeleton",()=>i,"Skeleton",()=>s,"TableSkeleton",()=>l])},37574,e=>{"use strict";var t=e.i(48277),r=e.i(30668),a=e.i(14575),s=e.i(9693),i=e.i(33441),l=e.i(43901),n=e.i(1831);function d({title:e,data:d,columns:o,getRowId:c,loading:u=!1,emptyMessage:m="No data.",search:p,filters:x=[],pageSizeOptions:h=[10,25,50],initialPageSize:b=10,server:g,exportConfig:f,columnVisibilityKey:v,onRowClick:j,className:y}){let[w,N]=(0,r.useState)(""),[_,S]=(0,r.useState)(0),[C,k]=(0,r.useState)(b),[M,z]=(0,r.useState)(null),[D,I]=(0,r.useState)(null),[P,A]=(0,r.useState)(0),E=(0,r.useId)(),L=!!g,$=L?g.query:w,B=L?g.onQueryChange:N,F=L?g.pageIndex:_,T=L?g.onPageIndexChange:S,R=L?g.pageSize:C,U=L?g.onPageSizeChange:k,O=L?g.sort??null:null,W=L?g.onSortChange:void 0,q=(0,r.useMemo)(()=>{let e=Array.isArray(o)?o:[];if(!v){let t=e.filter(e=>!e.hiddenByDefault);return t.length>0?t:e.slice(0,1)}try{let t=window.localStorage.getItem(v);if(!t){let t=e.filter(e=>!e.hiddenByDefault);return t.length>0?t:e.slice(0,1)}let r=JSON.parse(t),a=e.filter(e=>{let t=r[e.id];return"boolean"==typeof t?t:!e.hiddenByDefault});return a.length>0?a:e.slice(0,1)}catch{let t=e.filter(e=>!e.hiddenByDefault);return t.length>0?t:e.slice(0,1)}},[v,o,P]),Q=(0,r.useMemo)(()=>{if(L)return Array.isArray(d)?d:[];let e=$.trim().toLowerCase();return(Array.isArray(d)?d:[]).filter(t=>{if(p&&p.getSearchText&&e.length>0&&!p.getSearchText(t).toLowerCase().includes(e))return!1;for(let e of x)if(e.predicate&&!e.predicate(t,e.value))return!1;return!0})},[d,x,L,$,p]),H=L?g.totalRows:Q.length,J=Math.max(1,Math.ceil(H/R)),K=Math.min(F,J-1),Y=Math.max(1,Math.min(8,R||10)),V=(0,r.useMemo)(()=>{if(L)return Q;let e=K*R,t=e+R;return Q.slice(e,t)},[K,Q,L,R]),G=K>0,X=K<J-1,Z=!!p||x.length>0||!!f||!!v;function ee(e,t){if(v&&(t||!(q.length<=1)))try{let r=window.localStorage.getItem(v),a=(r?JSON.parse(r):{})??{};a[e]=t,window.localStorage.setItem(v,JSON.stringify(a)),A(e=>e+1)}catch{}}async function et(e){if(f&&!M){I(null),z(e);try{let t=new URLSearchParams;for(let e of($.trim().length>0&&t.set("q",$.trim()),x)){let r=e.value;null!=r&&0!==String(r).length&&t.set(e.id,String(r))}if(L&&O?.id&&O?.dir&&(t.set("sort",O.id),t.set("dir",O.dir)),t.set("format",e),f.extraQuery)for(let[e,r]of Object.entries(f.extraQuery))null!=r&&t.set(e,String(r));let r=`${f.url}${f.url.includes("?")?"&":"?"}${t.toString()}`,a=f.filename?.({format:e});await (0,n.apiDownload)(r,{filename:a})}catch(e){I(e instanceof Error?e.message:"Export failed.")}finally{z(null)}}}return(0,t.jsxs)("div",{className:(0,a.cn)("space-y-3",y),children:[e?(0,t.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:e}):null,Z?(0,t.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-end md:justify-between",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-end",children:[p?(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("label",{className:"text-sm font-medium",htmlFor:`${E}_datatable_search`,children:"Search"}),(0,t.jsx)("input",{id:`${E}_datatable_search`,className:"w-full min-w-[220px] rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:$,onChange:e=>{B(e.target.value),T(0)},placeholder:p.placeholder??"Search..."})]}):null,x.map(e=>(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("label",{className:"text-sm font-medium",htmlFor:`${E}_datatable_filter_${e.id}`,children:e.label}),(0,t.jsx)("select",{id:`${E}_datatable_filter_${e.id}`,className:"w-full min-w-[180px] rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:String(e.value),onChange:t=>{let r=e.options.find(e=>String(e.value)===t.target.value),a=r?r.value:t.target.value;e.onChange(a),T(0)},children:e.options.map(e=>(0,t.jsx)("option",{value:String(e.value),children:e.label},String(e.value)))})]},e.id))]}),(0,t.jsxs)("div",{className:"flex flex-col items-start gap-2 md:items-end",children:[(0,t.jsxs)("div",{className:"text-sm text-zinc-600",children:[H," result(s)"]}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[f?(0,t.jsx)(i.DropdownMenu,{align:"right",trigger:({toggle:e})=>(0,t.jsx)(s.Button,{variant:"outline",size:"sm",onClick:e,disabled:!!M,children:M?"Exporting...":"Export"}),children:({close:e})=>{let r=f.formats??["csv","xlsx","pdf"];return(0,t.jsx)(t.Fragment,{children:r.map(r=>(0,t.jsxs)(i.DropdownMenuItem,{onSelect:()=>{e(),et(r)},disabled:!!M,children:["Export ",r.toUpperCase()]},r))})}}):null,v?(0,t.jsx)(i.DropdownMenu,{align:"right",trigger:({toggle:e})=>(0,t.jsx)(s.Button,{variant:"outline",size:"sm",onClick:e,children:"Columns"}),children:({close:e})=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.DropdownMenuItem,{onSelect:()=>{for(let t of(e(),o))ee(t.id,!0)},children:"Show all"}),(0,t.jsx)(i.DropdownMenuItem,{onSelect:()=>{for(let t of(e(),o))ee(t.id,!t.hiddenByDefault)},children:"Reset defaults"}),(0,t.jsx)(i.DropdownMenuSeparator,{}),o.map(e=>{let r=q.some(t=>t.id===e.id);return(0,t.jsxs)(i.DropdownMenuItem,{onSelect:()=>{ee(e.id,!r)},children:[(0,t.jsx)("span",{className:"mr-2 inline-block w-4",children:r?"✓":""}),"string"==typeof e.header?e.header:e.id]},e.id)})]})}):null]})]})]}):null,D?(0,t.jsx)("div",{className:"text-sm text-red-600",children:D}):null,(0,t.jsx)("div",{className:"overflow-x-auto rounded-[var(--rb-radius-md)] border border-[var(--rb-border)] bg-white",children:(0,t.jsxs)("table",{className:"min-w-full border-collapse text-left text-sm",children:[(0,t.jsx)("thead",{className:"bg-[var(--rb-surface-muted)]",children:(0,t.jsx)("tr",{children:q.map(e=>(0,t.jsx)("th",{className:(0,a.cn)("whitespace-nowrap border-b border-[var(--rb-border)] px-3 py-2 text-xs font-semibold uppercase tracking-wide text-zinc-600",e.headerClassName),children:L&&e.sortId&&W?(0,t.jsxs)("button",{type:"button",onClick:()=>(function(e){if(L&&e.sortId&&W){if(!O||O.id!==e.sortId){W({id:e.sortId,dir:"asc"}),T(0);return}if("asc"===O.dir){W({id:e.sortId,dir:"desc"}),T(0);return}W(null),T(0)}})(e),className:"inline-flex items-center gap-1 hover:text-zinc-900",children:[(0,t.jsx)("span",{children:e.header}),L&&e.sortId?O&&O.id===e.sortId?"asc"===O.dir?(0,t.jsx)("span",{className:"ml-1 text-zinc-700",children:"↑"}):(0,t.jsx)("span",{className:"ml-1 text-zinc-700",children:"↓"}):(0,t.jsx)("span",{className:"ml-1 text-zinc-400",children:"↕"}):null]}):e.header},e.id))})}),(0,t.jsx)("tbody",{children:u?Array.from({length:Y}).map((e,r)=>(0,t.jsx)("tr",{className:"border-t border-[var(--rb-border)]",children:q.map((e,r)=>(0,t.jsx)("td",{className:(0,a.cn)("px-3 py-2 align-middle",e.className),children:(0,t.jsx)(l.Skeleton,{className:(0,a.cn)("h-3 rounded-[var(--rb-radius-sm)]",0===r?"w-3/4":r===q.length-1?"w-16":"w-full")})},e.id))},`loading_${r}`)):0===V.length?(0,t.jsx)("tr",{children:(0,t.jsx)("td",{className:"px-3 py-3 text-sm text-zinc-600",colSpan:Math.max(1,q.length),children:m})}):V.map(e=>(0,t.jsx)("tr",{className:(0,a.cn)("border-t border-[var(--rb-border)]",j?"cursor-pointer hover:bg-[var(--rb-surface-muted)]":null),tabIndex:j?0:void 0,role:j?"button":void 0,onClick:j?()=>{j(e)}:void 0,onKeyDown:j?t=>{("Enter"===t.key||" "===t.key)&&(t.preventDefault(),j(e))}:void 0,children:q.map(r=>(0,t.jsx)("td",{className:(0,a.cn)("px-3 py-2 align-middle",r.className),children:r.cell(e)},r.id))},String(c(e))))})]})}),(0,t.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(s.Button,{variant:"outline",size:"sm",onClick:function(){T(Math.max(0,K-1))},disabled:!G,children:"Prev"}),(0,t.jsx)(s.Button,{variant:"outline",size:"sm",onClick:function(){T(Math.min(J-1,K+1))},disabled:!X,children:"Next"}),(0,t.jsxs)("div",{className:"text-sm text-zinc-600",children:["Page ",K+1," / ",J]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"text-sm text-zinc-600",children:"Rows per page"}),(0,t.jsx)("select",{className:"rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:String(R),onChange:e=>{U(Number(e.target.value)),T(0)},children:h.map(e=>(0,t.jsx)("option",{value:e,children:e},e))})]})]})]})}e.s(["DataTable",()=>d])},48650,e=>{"use strict";var t=e.i(48277),r=e.i(19463),a=e.i(63571),s=e.i(72015);function i({title:e,description:i,actions:l,filters:n,loading:d,loadingFallback:o,error:c,empty:u,emptyTitle:m="Nothing here yet",emptyDescription:p="No items to display.",children:x}){return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(r.PageHeader,{title:e,description:i,actions:l}),n?(0,t.jsx)(s.Card,{className:"shadow-none",children:(0,t.jsx)(s.CardContent,{className:"pt-5",children:n})}):null,c?(0,t.jsx)(a.Alert,{variant:"danger",title:"Something went wrong",children:c}):null,d?o??(0,t.jsx)("div",{className:"text-sm text-zinc-500",children:"Loading..."}):null,d||c||!u?null:(0,t.jsx)(s.Card,{className:"shadow-none",children:(0,t.jsxs)(s.CardContent,{className:"pt-5",children:[(0,t.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:m}),(0,t.jsx)("div",{className:"mt-1 text-sm text-zinc-600",children:p})]})}),d||c||u?null:x]})}e.s(["ListPageShell",()=>i])},37949,e=>{"use strict";var t=e.i(48277),r=e.i(30668),a=e.i(9693);function s({className:e}){return(0,t.jsxs)("svg",{viewBox:"0 0 24 24",width:"16",height:"16","aria-hidden":"true",className:e,fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("path",{d:"M18 6 6 18"}),(0,t.jsx)("path",{d:"M6 6l12 12"})]})}function i({label:e="Image",file:i,existingUrl:l,disabled:n,accept:d="image/png,image/jpeg,image/webp",maxBytes:o=5242880,onFileChange:c,onRemoveExisting:u,onError:m}){let p=r.default.useRef(null),[x,h]=r.default.useState(null);r.default.useEffect(()=>{if(!i){h(null),p.current&&(p.current.value="");return}let e=URL.createObjectURL(i);return h(e),()=>{URL.revokeObjectURL(e)}},[i]);let b=x??l??null,g=!x&&!!l,f=!!i||g&&!!u;return(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("div",{className:"text-sm font-medium",children:e}),(0,t.jsx)("input",{ref:p,type:"file",accept:d,className:"hidden",onChange:function(e){let t=e.target.files?.[0]??null;if(t){if(!function(e){if(!e.type.startsWith("image/"))return m?.("Please select an image file."),!1;if(e.size>o){let e=Math.floor(o/1048576);return m?.(`Image must be ${e}MB or smaller.`),!1}return!0}(t)){p.current&&(p.current.value="");return}c(t)}},disabled:n}),(0,t.jsx)("div",{className:"flex flex-wrap items-center gap-2",children:(0,t.jsx)(a.Button,{variant:"outline",size:"sm",type:"button",onClick:()=>p.current?.click(),disabled:n,children:i?"Change selected image":"Choose image"})}),b?(0,t.jsxs)("div",{className:"relative inline-block",children:[(0,t.jsx)("img",{src:b,alt:"Selected image",className:"max-h-40 rounded border border-[var(--rb-border)]"}),f?(0,t.jsx)("button",{type:"button",onClick:()=>{i?c(null):u?.()},disabled:n,"aria-label":i?"Remove selected image":"Remove image",className:"absolute right-2 top-2 inline-flex h-7 w-7 items-center justify-center rounded-full border border-[var(--rb-border)] bg-white/90 text-zinc-700 shadow-sm transition hover:bg-white disabled:pointer-events-none disabled:opacity-50",children:(0,t.jsx)(s,{})}):null]}):null]})}e.s(["ImagePickerWithPreview",()=>i])},40795,e=>{"use strict";var t=e.i(48277),r=e.i(30668),a=e.i(96086),s=e.i(77252),i=e.i(1314),l=e.i(9693),n=e.i(72015),d=e.i(64998),o=e.i(37574),c=e.i(33441),u=e.i(37949),m=e.i(66474),p=e.i(43901),x=e.i(48650),h=e.i(1831);function b(){let e=(0,i.useAuth)(),b=(0,a.useRouter)(),g=(0,a.useParams)(),f=g.business??g.tenant,[v,j]=r.default.useState(!0),[y,w]=r.default.useState(null),[N,_]=r.default.useState(null),[S,C]=r.default.useState(!1),[k,M]=r.default.useState([]),[z,D]=r.default.useState(!1),[I,P]=r.default.useState(null),[A,E]=r.default.useState(""),[L,$]=r.default.useState(""),[B,F]=r.default.useState(!0),[T,R]=r.default.useState(null),[U,O]=r.default.useState(null),[W,q]=r.default.useState(!1),[Q,H]=r.default.useState(""),[J,K]=r.default.useState(""),[Y,V]=r.default.useState(null),[G,X]=r.default.useState(""),[Z,ee]=r.default.useState(0),[et,er]=r.default.useState(10),[ea,es]=r.default.useState(0),[ei,el]=r.default.useState(null),en=e.can("parts.manage"),ed=r.default.useCallback(async()=>{try{if(j(!0),w(null),"string"!=typeof f||0===f.length)throw Error("Business is missing.");let e=new URLSearchParams;G.trim().length>0&&e.set("q",G.trim()),e.set("page",String(Z+1)),e.set("per_page",String(et)),ei?.id&&ei?.dir&&(e.set("sort",ei.id),e.set("dir",ei.dir));let t=await (0,h.apiFetch)(`/api/${f}/app/repairbuddy/part-types?${e.toString()}`);M(Array.isArray(t.part_types)?t.part_types:[]),es("number"==typeof t.meta?.total?t.meta.total:0),er("number"==typeof t.meta?.per_page?t.meta.per_page:et)}catch(e){if(e instanceof h.ApiError&&428===e.status&&"string"==typeof f&&f.length>0){let e=`/app/${f}/part-types`;b.replace(`/app/${f}/branches/select?next=${encodeURIComponent(e)}`);return}w(e instanceof Error?e.message:"Failed to load part types.")}finally{j(!1)}},[Z,et,G,b,ei?.dir,ei?.id,f]);r.default.useEffect(()=>{ed()},[ed]);let eo=r.default.useCallback(async()=>{if(!S&&I&&"string"==typeof f&&0!==f.length&&en){C(!0),w(null),_(null);try{let e=await (0,h.apiFetch)(`/api/${f}/app/repairbuddy/part-types/${I}/image`,{method:"DELETE"});R(e.part_type?.image_url??null),_("Image removed."),O(null),ee(0),await ed()}catch(e){e instanceof h.ApiError?w(e.message):w("Failed to remove image.")}finally{C(!1)}}},[S,en,I,ed,f]);async function ec(e){if((e.preventDefault(),!S)&&"string"==typeof f&&0!==f.length){if(!en)return void w("Forbidden.");C(!0),w(null),_(null);try{let e=A.trim();if(0===e.length)return void w("Name is required.");let t={...{name:e,is_active:B},description:L.trim().length>0?L.trim():null},r=null;I?(r=(await (0,h.apiFetch)(`/api/${f}/app/repairbuddy/part-types/${I}`,{method:"PATCH",body:t})).part_type??null,_("Part type updated.")):(r=(await (0,h.apiFetch)(`/api/${f}/app/repairbuddy/part-types`,{method:"POST",body:t})).part_type??null,_("Part type created."));let a=r?.id??I;if(a&&U){let e=new FormData;e.append("image",U);let t=await (0,h.apiFetch)(`/api/${f}/app/repairbuddy/part-types/${a}/image`,{method:"POST",body:e});R(t.part_type?.image_url??null)}D(!1),ee(0),await ed()}catch(e){e instanceof h.ApiError?w(e.message):w(I?"Failed to update part type.":"Failed to create part type.")}finally{C(!1)}}}async function eu(e){if(!S&&"string"==typeof f&&0!==f.length){var r;if(!en)return void w("Forbidden.");r={title:"Delete part type",message:(0,t.jsxs)("div",{children:["Delete ",(0,t.jsx)("span",{className:"font-semibold",children:e.name}),"?"]}),action:async()=>{C(!0),w(null),_(null);try{await (0,h.apiFetch)(`/api/${f}/app/repairbuddy/part-types/${e.id}`,{method:"DELETE"}),_("Part type deleted."),ee(0),await ed()}catch(e){e instanceof h.ApiError?w(e.message):w("Failed to delete part type.")}finally{C(!1)}}},H(r.title),K(r.message),V(()=>r.action),q(!0)}}let em=r.default.useMemo(()=>[{id:"name",header:"Part type",sortId:"name",cell:e=>(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsx)("div",{className:"truncate font-semibold text-[var(--rb-text)]",children:e.name}),(0,t.jsx)("div",{className:"truncate text-xs text-zinc-600",children:e.id})]}),className:"min-w-[260px]"},{id:"active",header:"Active",sortId:"is_active",className:"whitespace-nowrap",cell:e=>(0,t.jsx)("div",{className:"text-sm text-zinc-700",children:e.is_active?"Yes":"No"})},{id:"description",header:"Description",cell:e=>(0,t.jsx)("div",{className:"text-sm text-zinc-700",children:e.description??"—"}),className:"min-w-[320px]"},{id:"image",header:"Image",cell:e=>(0,t.jsx)("div",{className:"text-sm text-zinc-700",children:e.image_url?"Yes":"—"}),className:"whitespace-nowrap"},{id:"actions",header:"",headerClassName:"text-right",className:"whitespace-nowrap text-right",cell:e=>en?(0,t.jsx)(c.DropdownMenu,{align:"right",trigger:({toggle:e})=>(0,t.jsx)(l.Button,{variant:"ghost",size:"sm",onClick:e,disabled:S,className:"px-2",children:"Actions"}),children:({close:r})=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.DropdownMenuItem,{onSelect:()=>{r(),en&&(P(e.id),E(e.name),$(e.description??""),F(!!e.is_active),R(e.image_url??null),O(null),D(!0),w(null),_(null))},disabled:S,children:"Edit"}),(0,t.jsx)(c.DropdownMenuSeparator,{}),(0,t.jsx)(c.DropdownMenuItem,{destructive:!0,onSelect:()=>{r(),eu(e)},disabled:S,children:"Delete"})]})}):null}],[S,en]);return(0,t.jsx)(s.RequireAuth,{requiredPermission:"parts.view",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(d.ConfirmDialog,{open:W,title:Q,message:J,busy:S,confirmText:"Delete",confirmVariant:"secondary",onCancel:()=>{S||(q(!1),V(null))},onConfirm:()=>{Y&&(async()=>{await Y(),q(!1),V(null)})()}}),(0,t.jsx)(m.Modal,{open:z,onClose:()=>{S||D(!1)},title:I?"Edit part type":"New part type",footer:(0,t.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,t.jsx)(l.Button,{variant:"outline",onClick:()=>D(!1),disabled:S,children:"Cancel"}),(0,t.jsx)(l.Button,{disabled:S,type:"submit",form:"rb_part_type_form",children:S?"Saving...":"Save"})]}),children:(0,t.jsxs)("form",{id:"rb_part_type_form",className:"space-y-3",onSubmit:ec,children:[(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("label",{className:"text-sm font-medium",htmlFor:"part_type_name",children:"Name"}),(0,t.jsx)("input",{id:"part_type_name",className:"w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:A,onChange:e=>E(e.target.value),required:!0,disabled:S})]}),(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("label",{className:"text-sm font-medium",htmlFor:"part_type_description",children:"Description"}),(0,t.jsx)("textarea",{id:"part_type_description",className:"w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:L,onChange:e=>$(e.target.value),disabled:S,rows:3})]}),(0,t.jsx)(u.ImagePickerWithPreview,{label:"Image",file:U,existingUrl:T,disabled:S,onFileChange:e=>{w(null),_(null),O(e)},onRemoveExisting:I?()=>void eo():void 0,onError:e=>{w(e),_(null)}}),(0,t.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,t.jsx)("input",{type:"checkbox",checked:B,onChange:e=>F(e.target.checked),disabled:S}),"Active"]})]})}),N?(0,t.jsx)("div",{className:"text-sm text-green-700",children:N}):null,y?(0,t.jsx)("div",{className:"text-sm text-red-600",children:y}):null,(0,t.jsx)(x.ListPageShell,{title:"Part Types",description:"Categories for parts (battery, screen, charger, etc.).",actions:(0,t.jsx)(l.Button,{variant:"primary",size:"sm",onClick:function(){en&&(P(null),E(""),$(""),F(!0),R(null),O(null),D(!0),w(null),_(null))},disabled:!en||v||S,children:"New part type"}),loading:v,loadingFallback:(0,t.jsx)(n.Card,{className:"shadow-none",children:(0,t.jsx)(n.CardContent,{className:"pt-5",children:(0,t.jsx)(p.TableSkeleton,{rows:8,columns:6,className:"shadow-none"})})}),error:null,empty:!v&&!y&&0===k.length,emptyTitle:"No part types",emptyDescription:"Add part types to organize your inventory.",children:(0,t.jsx)(n.Card,{className:"shadow-none",children:(0,t.jsx)(n.CardContent,{className:"pt-5",children:(0,t.jsx)(o.DataTable,{title:"string"==typeof f?`Part Types \xb7 ${f}`:"Part Types",data:k,loading:v,emptyMessage:"No part types.",columns:em,getRowId:e=>e.id,search:{placeholder:"Search part types..."},server:{query:G,onQueryChange:e=>{X(e),ee(0)},pageIndex:Z,onPageIndexChange:ee,pageSize:et,onPageSizeChange:e=>{er(e),ee(0)},totalRows:ea,sort:ei,onSortChange:e=>{el(e),ee(0)}}})})})})]})})}e.s(["default",()=>b])}]);