(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,63571,e=>{"use strict";var t=e.i(48277),a=e.i(14575);function r({variant:e,className:r}){let s="h-4 w-4 shrink-0";return"success"===e?(0,t.jsx)("svg",{viewBox:"0 0 24 24",className:(0,a.cn)(s,r),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:(0,t.jsx)("path",{d:"M20 6L9 17l-5-5"})}):"warning"===e?(0,t.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,a.cn)(s,r),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,t.jsx)("path",{d:"M12 9v4"}),(0,t.jsx)("path",{d:"M12 17h.01"}),(0,t.jsx)("path",{d:"M10.3 3.6l-8.3 14.3A2 2 0 0 0 3.7 21h16.6a2 2 0 0 0 1.7-3.1L13.7 3.6a2 2 0 0 0-3.4 0z"})]}):"danger"===e?(0,t.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,a.cn)(s,r),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,t.jsx)("path",{d:"M18 6L6 18"}),(0,t.jsx)("path",{d:"M6 6l12 12"})]}):(0,t.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,a.cn)(s,r),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,t.jsx)("path",{d:"M12 16v-4"}),(0,t.jsx)("path",{d:"M12 8h.01"}),(0,t.jsx)("path",{d:"M12 22a10 10 0 1 0-10-10 10 10 0 0 0 10 10z"})]})}function s({className:e,variant:s="info",title:l,children:n,...i}){let d={info:{wrapper:"border-[color:color-mix(in_srgb,var(--rb-blue),white_75%)] bg-[color:color-mix(in_srgb,var(--rb-blue),white_92%)] text-[var(--rb-text)]",icon:"text-[var(--rb-blue)]",title:"text-[var(--rb-blue)]"},success:{wrapper:"border-[color:color-mix(in_srgb,#16a34a,white_75%)] bg-[color:color-mix(in_srgb,#16a34a,white_92%)] text-[var(--rb-text)]",icon:"text-[#166534]",title:"text-[#166534]"},warning:{wrapper:"border-[color:color-mix(in_srgb,var(--rb-orange),white_70%)] bg-[color:color-mix(in_srgb,var(--rb-orange),white_92%)] text-[var(--rb-text)]",icon:"text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)]",title:"text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)]"},danger:{wrapper:"border-[color:color-mix(in_srgb,#dc2626,white_75%)] bg-[color:color-mix(in_srgb,#dc2626,white_92%)] text-[var(--rb-text)]",icon:"text-[#991b1b]",title:"text-[#991b1b]"}}[s];return(0,t.jsx)("div",{role:"alert",className:(0,a.cn)("rounded-[var(--rb-radius-md)] border px-4 py-3",d.wrapper,e),...i,children:(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)(r,{variant:s,className:(0,a.cn)("mt-0.5",d.icon)}),(0,t.jsxs)("div",{className:"min-w-0",children:[l?(0,t.jsx)("div",{className:(0,a.cn)("text-sm font-semibold",d.title),children:l}):null,n?(0,t.jsx)("div",{className:(0,a.cn)("text-sm text-zinc-700",l?"mt-1":""),children:n}):null]})]})})}e.s(["Alert",()=>s])},68501,e=>{"use strict";var t=e.i(48277),a=e.i(14575);function r({className:e,variant:r="default",...s}){return(0,t.jsx)("span",{className:(0,a.cn)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-medium",{default:"bg-[var(--rb-surface-muted)] text-[var(--rb-text)] border-[var(--rb-border)]",info:"bg-[color:color-mix(in_srgb,var(--rb-blue),white_85%)] text-[var(--rb-blue)] border-[color:color-mix(in_srgb,var(--rb-blue),white_70%)]",success:"bg-[color:color-mix(in_srgb,#16a34a,white_85%)] text-[#166534] border-[color:color-mix(in_srgb,#16a34a,white_70%)]",warning:"bg-[color:color-mix(in_srgb,var(--rb-orange),white_85%)] text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)] border-[color:color-mix(in_srgb,var(--rb-orange),white_70%)]",danger:"bg-[color:color-mix(in_srgb,#dc2626,white_85%)] text-[#991b1b] border-[color:color-mix(in_srgb,#dc2626,white_70%)]"}[r],e),...s})}e.s(["Badge",()=>r])},30765,e=>{"use strict";function t(e){let t=e.amountCents,a=e.currency?.toUpperCase()??null;if("number"!=typeof t||!Number.isFinite(t))return e.fallback??"—";let r=t/100;if(!a||3!==a.length)return`${r.toFixed(2)}`;try{return new Intl.NumberFormat(void 0,{style:"currency",currency:a,minimumFractionDigits:2,maximumFractionDigits:2}).format(r)}catch{return`${a} ${r.toFixed(2)}`}}e.s(["formatMoney",()=>t])},19463,e=>{"use strict";var t=e.i(48277),a=e.i(14575);function r({title:e,description:r,actions:s,className:l}){return(0,t.jsxs)("div",{className:(0,a.cn)("flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between",l),children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-xl font-semibold text-[var(--rb-text)]",children:e}),r?(0,t.jsx)("p",{className:"mt-1 text-sm text-zinc-600",children:r}):null]}),s?(0,t.jsx)("div",{className:"flex items-center gap-2",children:s}):null]})}e.s(["PageHeader",()=>r])},43901,e=>{"use strict";var t=e.i(48277),a=e.i(14575),r=e.i(72015);function s({className:e,"aria-hidden":r=!0,...s}){return(0,t.jsx)("div",{"aria-hidden":r,className:(0,a.cn)("rb-skeleton",e),...s})}function l({lines:e=3,className:l}){let n=Math.max(1,Math.min(e,12));return(0,t.jsx)(r.Card,{className:(0,a.cn)("overflow-hidden",l),children:(0,t.jsxs)(r.CardContent,{className:"space-y-3 pt-5",children:[(0,t.jsx)(s,{className:"h-4 w-32 rounded-[var(--rb-radius-sm)]"}),Array.from({length:n}).map((e,r)=>(0,t.jsx)(s,{className:(0,a.cn)("h-3 rounded-[var(--rb-radius-sm)]",r===n-1?"w-3/5":"w-full")},r))]})})}function n({rows:e=6,columns:r=5,className:l}){let n=Math.max(1,Math.min(e,20)),i=Math.max(1,Math.min(r,10));return(0,t.jsxs)("div",{className:(0,a.cn)("overflow-hidden rounded-[var(--rb-radius-lg)] border border-[var(--rb-border)] bg-white shadow-[var(--rb-shadow)]",l),children:[(0,t.jsx)("div",{className:"border-b border-[var(--rb-border)] px-5 py-4",children:(0,t.jsx)("div",{className:"grid gap-3",style:{gridTemplateColumns:`repeat(${i}, minmax(0, 1fr))`},children:Array.from({length:i}).map((e,a)=>(0,t.jsx)(s,{className:"h-3 w-full rounded-[var(--rb-radius-sm)]"},a))})}),(0,t.jsx)("div",{className:"px-5 pb-5 pt-4",children:(0,t.jsx)("div",{className:"space-y-3",children:Array.from({length:n}).map((e,r)=>(0,t.jsx)("div",{className:"grid gap-3",style:{gridTemplateColumns:`repeat(${i}, minmax(0, 1fr))`},children:Array.from({length:i}).map((e,r)=>(0,t.jsx)(s,{className:(0,a.cn)("h-3 rounded-[var(--rb-radius-sm)]",0===r?"w-3/4":"w-full")},r))},r))})})]})}e.s(["CardSkeleton",()=>l,"Skeleton",()=>s,"TableSkeleton",()=>n])},37574,e=>{"use strict";var t=e.i(48277),a=e.i(30668),r=e.i(14575),s=e.i(9693),l=e.i(33441),n=e.i(43901),i=e.i(1831);function d({title:e,data:d,columns:o,getRowId:c,loading:u=!1,emptyMessage:m="No data.",search:x,filters:h=[],pageSizeOptions:p=[10,25,50],initialPageSize:b=10,server:g,exportConfig:f,columnVisibilityKey:v,onRowClick:j,className:y}){let[w,N]=(0,a.useState)(""),[S,_]=(0,a.useState)(0),[M,k]=(0,a.useState)(b),[C,z]=(0,a.useState)(null),[D,$]=(0,a.useState)(null),[I,A]=(0,a.useState)(0),P=(0,a.useId)(),B=!!g,L=B?g.query:w,F=B?g.onQueryChange:N,T=B?g.pageIndex:S,E=B?g.onPageIndexChange:_,R=B?g.pageSize:M,O=B?g.onPageSizeChange:k,q=B?g.sort??null:null,U=B?g.onSortChange:void 0,H=(0,a.useMemo)(()=>{let e=Array.isArray(o)?o:[];if(!v){let t=e.filter(e=>!e.hiddenByDefault);return t.length>0?t:e.slice(0,1)}try{let t=window.localStorage.getItem(v);if(!t){let t=e.filter(e=>!e.hiddenByDefault);return t.length>0?t:e.slice(0,1)}let a=JSON.parse(t),r=e.filter(e=>{let t=a[e.id];return"boolean"==typeof t?t:!e.hiddenByDefault});return r.length>0?r:e.slice(0,1)}catch{let t=e.filter(e=>!e.hiddenByDefault);return t.length>0?t:e.slice(0,1)}},[v,o,I]),J=(0,a.useMemo)(()=>{if(B)return Array.isArray(d)?d:[];let e=L.trim().toLowerCase();return(Array.isArray(d)?d:[]).filter(t=>{if(x&&x.getSearchText&&e.length>0&&!x.getSearchText(t).toLowerCase().includes(e))return!1;for(let e of h)if(e.predicate&&!e.predicate(t,e.value))return!1;return!0})},[d,h,B,L,x]),V=B?g.totalRows:J.length,K=Math.max(1,Math.ceil(V/R)),Q=Math.min(T,K-1),W=Math.max(1,Math.min(8,R||10)),G=(0,a.useMemo)(()=>{if(B)return J;let e=Q*R,t=e+R;return J.slice(e,t)},[Q,J,B,R]),X=Q>0,Y=Q<K-1,Z=!!x||h.length>0||!!f||!!v;function ee(e,t){if(v&&(t||!(H.length<=1)))try{let a=window.localStorage.getItem(v),r=(a?JSON.parse(a):{})??{};r[e]=t,window.localStorage.setItem(v,JSON.stringify(r)),A(e=>e+1)}catch{}}async function et(e){if(f&&!C){$(null),z(e);try{let t=new URLSearchParams;for(let e of(L.trim().length>0&&t.set("q",L.trim()),h)){let a=e.value;null!=a&&0!==String(a).length&&t.set(e.id,String(a))}if(B&&q?.id&&q?.dir&&(t.set("sort",q.id),t.set("dir",q.dir)),t.set("format",e),f.extraQuery)for(let[e,a]of Object.entries(f.extraQuery))null!=a&&t.set(e,String(a));let a=`${f.url}${f.url.includes("?")?"&":"?"}${t.toString()}`,r=f.filename?.({format:e});await (0,i.apiDownload)(a,{filename:r})}catch(e){$(e instanceof Error?e.message:"Export failed.")}finally{z(null)}}}return(0,t.jsxs)("div",{className:(0,r.cn)("space-y-3",y),children:[e?(0,t.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:e}):null,Z?(0,t.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-end md:justify-between",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-end",children:[x?(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("label",{className:"text-sm font-medium",htmlFor:`${P}_datatable_search`,children:"Search"}),(0,t.jsx)("input",{id:`${P}_datatable_search`,className:"w-full min-w-[220px] rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:L,onChange:e=>{F(e.target.value),E(0)},placeholder:x.placeholder??"Search..."})]}):null,h.map(e=>(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("label",{className:"text-sm font-medium",htmlFor:`${P}_datatable_filter_${e.id}`,children:e.label}),(0,t.jsx)("select",{id:`${P}_datatable_filter_${e.id}`,className:"w-full min-w-[180px] rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:String(e.value),onChange:t=>{let a=e.options.find(e=>String(e.value)===t.target.value),r=a?a.value:t.target.value;e.onChange(r),E(0)},children:e.options.map(e=>(0,t.jsx)("option",{value:String(e.value),children:e.label},String(e.value)))})]},e.id))]}),(0,t.jsxs)("div",{className:"flex flex-col items-start gap-2 md:items-end",children:[(0,t.jsxs)("div",{className:"text-sm text-zinc-600",children:[V," result(s)"]}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[f?(0,t.jsx)(l.DropdownMenu,{align:"right",trigger:({toggle:e})=>(0,t.jsx)(s.Button,{variant:"outline",size:"sm",onClick:e,disabled:!!C,children:C?"Exporting...":"Export"}),children:({close:e})=>{let a=f.formats??["csv","xlsx","pdf"];return(0,t.jsx)(t.Fragment,{children:a.map(a=>(0,t.jsxs)(l.DropdownMenuItem,{onSelect:()=>{e(),et(a)},disabled:!!C,children:["Export ",a.toUpperCase()]},a))})}}):null,v?(0,t.jsx)(l.DropdownMenu,{align:"right",trigger:({toggle:e})=>(0,t.jsx)(s.Button,{variant:"outline",size:"sm",onClick:e,children:"Columns"}),children:({close:e})=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.DropdownMenuItem,{onSelect:()=>{for(let t of(e(),o))ee(t.id,!0)},children:"Show all"}),(0,t.jsx)(l.DropdownMenuItem,{onSelect:()=>{for(let t of(e(),o))ee(t.id,!t.hiddenByDefault)},children:"Reset defaults"}),(0,t.jsx)(l.DropdownMenuSeparator,{}),o.map(e=>{let a=H.some(t=>t.id===e.id);return(0,t.jsxs)(l.DropdownMenuItem,{onSelect:()=>{ee(e.id,!a)},children:[(0,t.jsx)("span",{className:"mr-2 inline-block w-4",children:a?"✓":""}),"string"==typeof e.header?e.header:e.id]},e.id)})]})}):null]})]})]}):null,D?(0,t.jsx)("div",{className:"text-sm text-red-600",children:D}):null,(0,t.jsx)("div",{className:"overflow-x-auto rounded-[var(--rb-radius-md)] border border-[var(--rb-border)] bg-white",children:(0,t.jsxs)("table",{className:"min-w-full border-collapse text-left text-sm",children:[(0,t.jsx)("thead",{className:"bg-[var(--rb-surface-muted)]",children:(0,t.jsx)("tr",{children:H.map(e=>(0,t.jsx)("th",{className:(0,r.cn)("whitespace-nowrap border-b border-[var(--rb-border)] px-3 py-2 text-xs font-semibold uppercase tracking-wide text-zinc-600",e.headerClassName),children:B&&e.sortId&&U?(0,t.jsxs)("button",{type:"button",onClick:()=>(function(e){if(B&&e.sortId&&U){if(!q||q.id!==e.sortId){U({id:e.sortId,dir:"asc"}),E(0);return}if("asc"===q.dir){U({id:e.sortId,dir:"desc"}),E(0);return}U(null),E(0)}})(e),className:"inline-flex items-center gap-1 hover:text-zinc-900",children:[(0,t.jsx)("span",{children:e.header}),B&&e.sortId?q&&q.id===e.sortId?"asc"===q.dir?(0,t.jsx)("span",{className:"ml-1 text-zinc-700",children:"↑"}):(0,t.jsx)("span",{className:"ml-1 text-zinc-700",children:"↓"}):(0,t.jsx)("span",{className:"ml-1 text-zinc-400",children:"↕"}):null]}):e.header},e.id))})}),(0,t.jsx)("tbody",{children:u?Array.from({length:W}).map((e,a)=>(0,t.jsx)("tr",{className:"border-t border-[var(--rb-border)]",children:H.map((e,a)=>(0,t.jsx)("td",{className:(0,r.cn)("px-3 py-2 align-middle",e.className),children:(0,t.jsx)(n.Skeleton,{className:(0,r.cn)("h-3 rounded-[var(--rb-radius-sm)]",0===a?"w-3/4":a===H.length-1?"w-16":"w-full")})},e.id))},`loading_${a}`)):0===G.length?(0,t.jsx)("tr",{children:(0,t.jsx)("td",{className:"px-3 py-3 text-sm text-zinc-600",colSpan:Math.max(1,H.length),children:m})}):G.map(e=>(0,t.jsx)("tr",{className:(0,r.cn)("border-t border-[var(--rb-border)]",j?"cursor-pointer hover:bg-[var(--rb-surface-muted)]":null),tabIndex:j?0:void 0,role:j?"button":void 0,onClick:j?()=>{j(e)}:void 0,onKeyDown:j?t=>{("Enter"===t.key||" "===t.key)&&(t.preventDefault(),j(e))}:void 0,children:H.map(a=>(0,t.jsx)("td",{className:(0,r.cn)("px-3 py-2 align-middle",a.className),children:a.cell(e)},a.id))},String(c(e))))})]})}),(0,t.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(s.Button,{variant:"outline",size:"sm",onClick:function(){E(Math.max(0,Q-1))},disabled:!X,children:"Prev"}),(0,t.jsx)(s.Button,{variant:"outline",size:"sm",onClick:function(){E(Math.min(K-1,Q+1))},disabled:!Y,children:"Next"}),(0,t.jsxs)("div",{className:"text-sm text-zinc-600",children:["Page ",Q+1," / ",K]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"text-sm text-zinc-600",children:"Rows per page"}),(0,t.jsx)("select",{className:"rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:String(R),onChange:e=>{O(Number(e.target.value)),E(0)},children:p.map(e=>(0,t.jsx)("option",{value:e,children:e},e))})]})]})]})}e.s(["DataTable",()=>d])},48650,e=>{"use strict";var t=e.i(48277),a=e.i(19463),r=e.i(63571),s=e.i(72015);function l({title:e,description:l,actions:n,filters:i,loading:d,loadingFallback:o,error:c,empty:u,emptyTitle:m="Nothing here yet",emptyDescription:x="No items to display.",children:h}){return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(a.PageHeader,{title:e,description:l,actions:n}),i?(0,t.jsx)(s.Card,{className:"shadow-none",children:(0,t.jsx)(s.CardContent,{className:"pt-5",children:i})}):null,c?(0,t.jsx)(r.Alert,{variant:"danger",title:"Something went wrong",children:c}):null,d?o??(0,t.jsx)("div",{className:"text-sm text-zinc-500",children:"Loading..."}):null,d||c||!u?null:(0,t.jsx)(s.Card,{className:"shadow-none",children:(0,t.jsxs)(s.CardContent,{className:"pt-5",children:[(0,t.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:m}),(0,t.jsx)("div",{className:"mt-1 text-sm text-zinc-600",children:x})]})}),d||c||u?null:h]})}e.s(["ListPageShell",()=>l])},34606,e=>{"use strict";let t=(0,e.i(35884).default)("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);e.s(["MoreHorizontal",()=>t],34606)},76053,e=>{"use strict";let t=(0,e.i(35884).default)("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]]);e.s(["MessageSquare",()=>t],76053)},63753,82087,e=>{"use strict";var t=e.i(35884);let a=(0,t.default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>a],63753);let r=(0,t.default)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]);e.s(["Mail",()=>r],82087)},89664,e=>{"use strict";var t=e.i(48277),a=e.i(30668),r=e.i(96086),s=e.i(17296),l=e.i(35884);let n=(0,l.default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);var i=e.i(63753),d=e.i(82087),o=e.i(76053),c=e.i(34606);let u=(0,l.default)("piggy-bank",[["path",{d:"M11 17h3v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-3a3.16 3.16 0 0 0 2-2h1a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1h-1a5 5 0 0 0-2-4V3a4 4 0 0 0-3.2 1.6l-.3.4H11a6 6 0 0 0-6 6v1a5 5 0 0 0 2 4v3a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1z",key:"1piglc"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M2 8v1a2 2 0 0 0 2 2h1",key:"1env43"}]]);var m=e.i(13221);let x=(0,l.default)("repeat-2",[["path",{d:"m2 9 3-3 3 3",key:"1ltn5i"}],["path",{d:"M13 18H7a2 2 0 0 1-2-2V6",key:"1r6tfw"}],["path",{d:"m22 15-3 3-3-3",key:"4rnwn2"}],["path",{d:"M11 6h6a2 2 0 0 1 2 2v10",key:"2f72bc"}]]);var h=e.i(9693),p=e.i(68501),b=e.i(72015),g=e.i(37574),f=e.i(33441),v=e.i(48650),j=e.i(1831),y=e.i(30765);function w(e){if(!e)return"";let t=new Date(e);return Number.isNaN(t.getTime())?"":t.toLocaleDateString()}function N(){let e=(0,r.useRouter)(),l=(0,r.useParams)(),N=l.business??l.tenant,[S,_]=a.default.useState(!0),[M,k]=a.default.useState(null),[C,z]=a.default.useState([]),[D,$]=a.default.useState(""),[I,A]=a.default.useState({}),[P,B]=a.default.useState({}),[L,F]=a.default.useState("all"),[T,E]=a.default.useState("all"),[R,O]=a.default.useState("all"),[q,U]=a.default.useState(!1),[H,J]=a.default.useState(null),[V,K]=a.default.useState(0),[Q,W]=a.default.useState(!0),[G,X]=a.default.useState(null),[Y,Z]=a.default.useState(0),[ee,et]=a.default.useState(0),[ea,er]=a.default.useState(0),[es,el]=a.default.useState(0),[en,ei]=a.default.useState(0),[ed,eo]=a.default.useState(10);a.default.useEffect(()=>{let t=!0;return async function(){try{if(_(!0),k(null),"string"!=typeof N||0===N.length)throw Error("Business is missing.");let e=new URLSearchParams,a=D.trim();""!==a&&e.set("q",a),"all"!==L&&e.set("status",L),"all"!==T&&e.set("payment_status",T),"all"!==R&&e.set("priority",R),q&&e.set("overdue","1"),e.set("page",String(en+1)),e.set("per_page",String(ed)),H?.id&&H?.dir&&(e.set("sort",H.id),e.set("dir",H.dir));let[r,s,l]=await Promise.all([(0,j.apiFetch)(`/api/${N}/app/repairbuddy/jobs?${e.toString()}`),(0,j.apiFetch)(`/api/${N}/app/repairbuddy/job-statuses`),(0,j.apiFetch)(`/api/${N}/app/repairbuddy/payment-statuses`)]);if(!t)return;z(Array.isArray(r.jobs)?r.jobs:[]),K("number"==typeof r.meta?.total?r.meta.total:0);let n={};for(let e of Array.isArray(s.job_statuses)?s.job_statuses:[])n[e.slug]=e.label;A(n);let i={};for(let e of Array.isArray(l.payment_statuses)?l.payment_statuses:[])i[e.slug]=e.label;B(i)}catch(a){if(!t)return;if(a instanceof j.ApiError&&428===a.status&&"string"==typeof N&&N.length>0){let t=`/app/${N}/jobs`;e.replace(`/app/${N}/branches/select?next=${encodeURIComponent(t)}`);return}k(a instanceof Error?a.message:"Failed to load jobs.")}finally{if(!t)return;_(!1)}}(),()=>{t=!1}},[e,N,D,en,ed,H,L,T,R,q]),a.default.useEffect(()=>{let e=!0;return async function(){try{if(W(!0),X(null),"string"!=typeof N||0===N.length)throw Error("Business is missing.");let t=new URLSearchParams,a=D.trim();""!==a&&t.set("q",a),"all"!==T&&t.set("payment_status",T),"all"!==R&&t.set("priority",R);let r=await (0,j.apiFetch)(`/api/${N}/app/repairbuddy/jobs/stats?${t.toString()}`);if(!e)return;Z("number"==typeof r.open?r.open:0),et("number"==typeof r.urgent?r.urgent:0),er("number"==typeof r.overdue?r.overdue:0),el("number"==typeof r.payment_due?r.payment_due:0)}catch(t){if(!e)return;X(t instanceof Error?t.message:"Failed to load stats."),Z(0),et(0),er(0),el(0)}finally{if(!e)return;W(!1)}}(),()=>{e=!1}},[N,D,T,R]);let ec=a.default.useMemo(()=>[{id:"id",header:"ID",sortId:"id",cell:e=>(0,t.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:e.id}),className:"whitespace-nowrap"},{id:"case_tech",header:"Case/Tech",sortId:"case_number",cell:e=>{let a=Array.isArray(e.assigned_technicians)?e.assigned_technicians.map(e=>"string"==typeof e?.name?e.name:"").map(e=>e.trim()).filter(e=>e.length>0):[];return(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsx)("div",{className:"truncate font-semibold text-[var(--rb-text)]",children:e.case_number}),(0,t.jsx)("div",{className:"truncate text-xs text-zinc-600",children:a.length>0?`Tech: ${a.join(", ")}`:"—"})]})},className:"min-w-[200px] max-w-[260px]"},{id:"customer",header:"Customer",cell:e=>(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsx)("div",{className:"truncate text-sm font-semibold text-[var(--rb-text)]",children:e.customer?.name??"—"}),(0,t.jsx)("div",{className:"truncate text-xs text-zinc-600",children:e.customer?.email??""})]}),className:"min-w-[220px] max-w-[320px]"},{id:"devices",header:"Devices",cell:e=>{let a=Array.isArray(e.job_devices)?e.job_devices:[];if(0===a.length)return(0,t.jsx)("div",{className:"text-sm text-zinc-600",children:"—"});let r=a.map(e=>{let t="string"==typeof e?.label?e.label.trim():"",a="string"==typeof e?.serial?e.serial.trim():"";return t&&a?`${t} (${a})`:t||a}).filter(e=>e.length>0),s=r.slice(0,2),l=r.length-s.length;return(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsx)("div",{className:"truncate text-sm text-zinc-700",children:s.join(", ")||"—"}),l>0?(0,t.jsxs)("div",{className:"truncate text-xs text-zinc-600",children:["+",l," more"]}):null]})},className:"min-w-[220px] max-w-[360px]"},{id:"dates",header:"Dates",cell:e=>{let a=w(e.pickup_date),r=w(e.delivery_date),s=w(e.next_service_date);return a||r||s?(0,t.jsxs)("div",{className:"text-xs text-zinc-700",children:[a?(0,t.jsxs)("div",{className:"truncate",children:[(0,t.jsx)("span",{className:"font-semibold",children:"P"}),": ",a]}):null,r?(0,t.jsxs)("div",{className:"truncate",children:[(0,t.jsx)("span",{className:"font-semibold",children:"D"}),": ",r]}):null,s?(0,t.jsxs)("div",{className:"truncate",children:[(0,t.jsx)("span",{className:"font-semibold",children:"N"}),": ",s]}):null]}):(0,t.jsx)("div",{className:"text-sm text-zinc-600",children:"—"})},className:"whitespace-nowrap min-w-[140px]"},{id:"total",header:"Total",cell:e=>(0,t.jsx)("div",{className:"text-sm text-zinc-700",children:(0,y.formatMoney)({amountCents:e.totals?.total_cents,currency:e.totals?.currency})}),className:"whitespace-nowrap"},{id:"balance",header:"Balance",cell:e=>{let a="number"==typeof e.totals?.total_cents?e.totals.total_cents:null,r=e.totals?.currency;if(null===a||!r)return(0,t.jsx)("div",{className:"text-sm text-zinc-600",children:"—"});let s="paid"===e.payment_status?0:a;return(0,t.jsx)("div",{className:"text-sm text-zinc-700",children:(0,y.formatMoney)({amountCents:s,currency:r})})},className:"whitespace-nowrap"},{id:"payment",header:"Payment",sortId:"payment_status",cell:e=>{var a;return(0,t.jsx)(p.Badge,{variant:(a=e.payment_status)?"paid"===a?"success":"partial"===a?"warning":"unpaid"===a||"due"===a?"danger":"default":"default",children:e.payment_status?P[e.payment_status]??e.payment_status.replace(/_/g," "):"—"})},className:"whitespace-nowrap"},{id:"status",header:"Status",sortId:"status",cell:e=>{var a;return(0,t.jsx)(p.Badge,{variant:"delivered"===(a=e.status)||"completed"===a?"success":"ready"===a?"warning":"cancelled"===a?"danger":"in_process"===a?"info":"default",children:I[e.status]??e.status.replace(/_/g," ")})},className:"whitespace-nowrap"},{id:"priority",header:"Priority",sortId:"priority",cell:e=>(0,t.jsx)("div",{className:"text-sm text-zinc-600",children:e.priority?e.priority.replace(/_/g," "):"—"}),className:"whitespace-nowrap"},{id:"actions",header:(0,t.jsx)("div",{className:"text-right",children:"Actions"}),cell:a=>(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsx)(f.DropdownMenu,{align:"right",trigger:({toggle:e})=>(0,t.jsx)(h.Button,{variant:"outline",size:"sm",className:"px-2","aria-label":"Actions",onClick:t=>{t.preventDefault(),t.stopPropagation(),e()},children:(0,t.jsx)(c.MoreHorizontal,{className:"h-4 w-4"})}),children:({close:r})=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f.DropdownMenuItem,{onSelect:()=>{"string"==typeof N&&0!==N.length&&(r(),e.push(`/app/${N}/jobs/${a.id}`))},children:(0,t.jsxs)("span",{className:"flex items-center gap-2",children:[(0,t.jsx)(i.Eye,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"View"})]})}),(0,t.jsx)(f.DropdownMenuItem,{onSelect:()=>{"string"==typeof N&&0!==N.length&&(r(),e.push(`/app/${N}/jobs/${a.id}?tab=financial`))},children:(0,t.jsxs)("span",{className:"flex items-center gap-2",children:[(0,t.jsx)(u,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Financial"})]})}),(0,t.jsx)(f.DropdownMenuItem,{onSelect:()=>{"string"==typeof N&&0!==N.length&&(r(),e.push(`/app/${N}/jobs/${a.id}?tab=messages`))},children:(0,t.jsxs)("span",{className:"flex items-center gap-2",children:[(0,t.jsx)(o.MessageSquare,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Messages"})]})}),(0,t.jsx)(f.DropdownMenuSeparator,{}),(0,t.jsx)(f.DropdownMenuItem,{onSelect:()=>{},disabled:!0,children:(0,t.jsxs)("span",{className:"flex items-center gap-2",children:[(0,t.jsx)(m.Printer,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Print invoice"})]})}),(0,t.jsx)(f.DropdownMenuItem,{onSelect:()=>{},disabled:!0,children:(0,t.jsxs)("span",{className:"flex items-center gap-2",children:[(0,t.jsx)(n,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Download PDF"})]})}),(0,t.jsx)(f.DropdownMenuItem,{onSelect:()=>{},disabled:!0,children:(0,t.jsxs)("span",{className:"flex items-center gap-2",children:[(0,t.jsx)(d.Mail,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Email customer"})]})}),(0,t.jsx)(f.DropdownMenuSeparator,{}),(0,t.jsx)(f.DropdownMenuItem,{onSelect:()=>{},disabled:!0,children:(0,t.jsxs)("span",{className:"flex items-center gap-2",children:[(0,t.jsx)(x,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Duplicate job"})]})}),(0,t.jsx)(f.DropdownMenuItem,{onSelect:()=>{},disabled:!0,children:(0,t.jsxs)("span",{className:"flex items-center gap-2",children:[(0,t.jsx)(s.CreditCard,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Take payment"})]})})]})})}),className:"whitespace-nowrap"}],[P,e,I,N]),eu=a.default.useMemo(()=>{let e=[{label:"All",value:"all"},{label:"Open",value:"open"}],t=Object.entries(I);for(let[a,r]of(t.sort((e,t)=>e[1].localeCompare(t[1])),t))e.push({label:r,value:a});return e},[I]),em=a.default.useMemo(()=>[{id:"open",label:"Open",value:Y,dot:"bg-sky-500"},{id:"urgent",label:"Urgent",value:ee,dot:"bg-rose-500"},{id:"overdue",label:"Overdue",value:ea,dot:"bg-amber-500"},{id:"payment_due",label:"Needs payment",value:es,dot:"bg-violet-500"}],[Y,ea,es,ee]),ex=a.default.useMemo(()=>{let e=[{label:"All",value:"all"},{label:"Needs payment",value:"needs_payment"}],t=Object.entries(P);for(let[a,r]of(t.sort((e,t)=>e[1].localeCompare(t[1])),t))e.push({label:r,value:a});return e},[P]),eh=a.default.useMemo(()=>[{label:"All",value:"all"},{label:"Low",value:"low"},{label:"Normal",value:"normal"},{label:"High",value:"high"},{label:"Urgent",value:"urgent"}],[]),ep=a.default.useMemo(()=>[{label:"All",value:"all"},{label:"Overdue",value:"overdue"}],[]);return(0,t.jsxs)(v.ListPageShell,{title:"Jobs",description:"Track, update, and communicate on repair jobs.",actions:(0,t.jsx)(h.Button,{variant:"outline",size:"sm",onClick:()=>{"string"==typeof N&&0!==N.length&&e.push(`/app/${N}/jobs/new`)},children:"New job"}),loading:S,error:M,empty:!S&&!M&&0===C.length,emptyTitle:"No jobs found",emptyDescription:"Try adjusting your search.",children:[(0,t.jsx)("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2 lg:grid-cols-4",children:em.map(e=>(0,t.jsxs)("div",{className:"rounded-[var(--rb-radius-md)] border border-[var(--rb-border)] bg-white p-4 text-left shadow-none",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,t.jsx)("div",{className:"min-w-0",children:(0,t.jsx)("div",{className:"text-xs font-medium text-zinc-600",children:e.label})}),(0,t.jsx)("div",{className:`mt-1 h-2.5 w-2.5 shrink-0 rounded-full ${e.dot}`,"aria-hidden":"true"})]}),(0,t.jsx)("div",{className:"mt-1 text-2xl font-semibold text-[var(--rb-text)]",children:Q?"—":String(e.value)})]},e.id))}),G?(0,t.jsx)("div",{className:"mt-2 text-sm text-red-600",children:G}):null,(0,t.jsx)(b.Card,{className:"shadow-none",children:(0,t.jsx)(b.CardContent,{className:"pt-5",children:(0,t.jsx)(g.DataTable,{title:"string"==typeof N?`Jobs \xb7 ${N}`:"Jobs",data:C,loading:S,emptyMessage:"No jobs.",columns:ec,getRowId:e=>e.id,search:{placeholder:"Search by case number, title, device, or ID..."},columnVisibilityKey:"string"==typeof N?`rb:datatable:${N}:jobs`:"rb:datatable:jobs",filters:[{id:"status",label:"Status",value:L,options:eu,onChange:e=>{F(String(e)),U(!1),ei(0)}},{id:"overdue",label:"Due",value:q?"overdue":"all",options:ep,onChange:e=>{U("overdue"===String(e)),ei(0)}},{id:"payment_status",label:"Payment",value:T,options:ex,onChange:e=>{E(String(e)),U(!1),ei(0)}},{id:"priority",label:"Priority",value:R,options:eh,onChange:e=>{O(String(e)),U(!1),ei(0)}}],server:{query:D,onQueryChange:e=>{$(e),ei(0)},pageIndex:en,onPageIndexChange:ei,pageSize:ed,onPageSizeChange:e=>{eo(e),ei(0)},totalRows:V,sort:H,onSortChange:e=>{J(e),ei(0)}},onRowClick:t=>{"string"==typeof N&&0!==N.length&&e.push(`/app/${N}/jobs/${t.id}`)}})})})]})}e.s(["default",()=>N],89664)}]);