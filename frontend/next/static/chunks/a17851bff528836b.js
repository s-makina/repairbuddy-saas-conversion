(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,26550,e=>{"use strict";var r=e.i(48277),i=e.i(14575);function s({className:e,type:s,...a}){return(0,r.jsx)("input",{type:s,className:(0,i.cn)("w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)] outline-none transition","placeholder:text-zinc-400","focus-visible:ring-2 focus-visible:ring-[color:color-mix(in_srgb,var(--rb-orange),white_65%)] focus-visible:ring-offset-2 focus-visible:ring-offset-white","disabled:cursor-not-allowed disabled:bg-[var(--rb-surface-muted)] disabled:opacity-70",e),...a})}e.s(["Input",()=>s])},63571,e=>{"use strict";var r=e.i(48277),i=e.i(14575);function s({variant:e,className:s}){let a="h-4 w-4 shrink-0";return"success"===e?(0,r.jsx)("svg",{viewBox:"0 0 24 24",className:(0,i.cn)(a,s),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:(0,r.jsx)("path",{d:"M20 6L9 17l-5-5"})}):"warning"===e?(0,r.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,i.cn)(a,s),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,r.jsx)("path",{d:"M12 9v4"}),(0,r.jsx)("path",{d:"M12 17h.01"}),(0,r.jsx)("path",{d:"M10.3 3.6l-8.3 14.3A2 2 0 0 0 3.7 21h16.6a2 2 0 0 0 1.7-3.1L13.7 3.6a2 2 0 0 0-3.4 0z"})]}):"danger"===e?(0,r.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,i.cn)(a,s),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,r.jsx)("path",{d:"M18 6L6 18"}),(0,r.jsx)("path",{d:"M6 6l12 12"})]}):(0,r.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,i.cn)(a,s),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,r.jsx)("path",{d:"M12 16v-4"}),(0,r.jsx)("path",{d:"M12 8h.01"}),(0,r.jsx)("path",{d:"M12 22a10 10 0 1 0-10-10 10 10 0 0 0 10 10z"})]})}function a({className:e,variant:a="info",title:t,children:n,...l}){let d={info:{wrapper:"border-[color:color-mix(in_srgb,var(--rb-blue),white_75%)] bg-[color:color-mix(in_srgb,var(--rb-blue),white_92%)] text-[var(--rb-text)]",icon:"text-[var(--rb-blue)]",title:"text-[var(--rb-blue)]"},success:{wrapper:"border-[color:color-mix(in_srgb,#16a34a,white_75%)] bg-[color:color-mix(in_srgb,#16a34a,white_92%)] text-[var(--rb-text)]",icon:"text-[#166534]",title:"text-[#166534]"},warning:{wrapper:"border-[color:color-mix(in_srgb,var(--rb-orange),white_70%)] bg-[color:color-mix(in_srgb,var(--rb-orange),white_92%)] text-[var(--rb-text)]",icon:"text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)]",title:"text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)]"},danger:{wrapper:"border-[color:color-mix(in_srgb,#dc2626,white_75%)] bg-[color:color-mix(in_srgb,#dc2626,white_92%)] text-[var(--rb-text)]",icon:"text-[#991b1b]",title:"text-[#991b1b]"}}[a];return(0,r.jsx)("div",{role:"alert",className:(0,i.cn)("rounded-[var(--rb-radius-md)] border px-4 py-3",d.wrapper,e),...l,children:(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)(s,{variant:a,className:(0,i.cn)("mt-0.5",d.icon)}),(0,r.jsxs)("div",{className:"min-w-0",children:[t?(0,r.jsx)("div",{className:(0,i.cn)("text-sm font-semibold",d.title),children:t}):null,n?(0,r.jsx)("div",{className:(0,i.cn)("text-sm text-zinc-700",t?"mt-1":""),children:n}):null]})]})})}e.s(["Alert",()=>a])},68501,e=>{"use strict";var r=e.i(48277),i=e.i(14575);function s({className:e,variant:s="default",...a}){return(0,r.jsx)("span",{className:(0,i.cn)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-medium",{default:"bg-[var(--rb-surface-muted)] text-[var(--rb-text)] border-[var(--rb-border)]",info:"bg-[color:color-mix(in_srgb,var(--rb-blue),white_85%)] text-[var(--rb-blue)] border-[color:color-mix(in_srgb,var(--rb-blue),white_70%)]",success:"bg-[color:color-mix(in_srgb,#16a34a,white_85%)] text-[#166534] border-[color:color-mix(in_srgb,#16a34a,white_70%)]",warning:"bg-[color:color-mix(in_srgb,var(--rb-orange),white_85%)] text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)] border-[color:color-mix(in_srgb,var(--rb-orange),white_70%)]",danger:"bg-[color:color-mix(in_srgb,#dc2626,white_85%)] text-[#991b1b] border-[color:color-mix(in_srgb,#dc2626,white_70%)]"}[s],e),...a})}e.s(["Badge",()=>s])},43901,e=>{"use strict";var r=e.i(48277),i=e.i(14575),s=e.i(72015);function a({className:e,"aria-hidden":s=!0,...a}){return(0,r.jsx)("div",{"aria-hidden":s,className:(0,i.cn)("rb-skeleton",e),...a})}function t({lines:e=3,className:t}){let n=Math.max(1,Math.min(e,12));return(0,r.jsx)(s.Card,{className:(0,i.cn)("overflow-hidden",t),children:(0,r.jsxs)(s.CardContent,{className:"space-y-3 pt-5",children:[(0,r.jsx)(a,{className:"h-4 w-32 rounded-[var(--rb-radius-sm)]"}),Array.from({length:n}).map((e,s)=>(0,r.jsx)(a,{className:(0,i.cn)("h-3 rounded-[var(--rb-radius-sm)]",s===n-1?"w-3/5":"w-full")},s))]})})}function n({rows:e=6,columns:s=5,className:t}){let n=Math.max(1,Math.min(e,20)),l=Math.max(1,Math.min(s,10));return(0,r.jsxs)("div",{className:(0,i.cn)("overflow-hidden rounded-[var(--rb-radius-lg)] border border-[var(--rb-border)] bg-white shadow-[var(--rb-shadow)]",t),children:[(0,r.jsx)("div",{className:"border-b border-[var(--rb-border)] px-5 py-4",children:(0,r.jsx)("div",{className:"grid gap-3",style:{gridTemplateColumns:`repeat(${l}, minmax(0, 1fr))`},children:Array.from({length:l}).map((e,i)=>(0,r.jsx)(a,{className:"h-3 w-full rounded-[var(--rb-radius-sm)]"},i))})}),(0,r.jsx)("div",{className:"px-5 pb-5 pt-4",children:(0,r.jsx)("div",{className:"space-y-3",children:Array.from({length:n}).map((e,s)=>(0,r.jsx)("div",{className:"grid gap-3",style:{gridTemplateColumns:`repeat(${l}, minmax(0, 1fr))`},children:Array.from({length:l}).map((e,s)=>(0,r.jsx)(a,{className:(0,i.cn)("h-3 rounded-[var(--rb-radius-sm)]",0===s?"w-3/4":"w-full")},s))},s))})})]})}e.s(["CardSkeleton",()=>t,"Skeleton",()=>a,"TableSkeleton",()=>n])},66474,e=>{"use strict";var r=e.i(48277),i=e.i(30668),s=e.i(14575);function a({open:e,onClose:a,title:t,children:n,footer:l,position:d="center",variant:c="glass",className:o}){if((0,i.useEffect)(()=>{function r(r){e&&"Escape"===r.key&&a()}return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[a,e]),!e)return null;let m="solid"===c?(0,s.cn)("relative w-full max-w-lg overflow-hidden rounded-[var(--rb-radius-lg)]","border border-[var(--rb-border)]","bg-white","shadow-[var(--rb-shadow)]"):(0,s.cn)("relative w-full max-w-lg overflow-hidden rounded-[var(--rb-radius-lg)]","border border-[color:color-mix(in_srgb,var(--rb-border),white_55%)]","bg-white/75 backdrop-blur-xl","shadow-[0_18px_55px_-18px_rgba(0,0,0,0.55)]","ring-1 ring-white/25");return(0,r.jsxs)("div",{className:"top-center"===d?"fixed inset-0 z-50 flex items-start justify-center px-4 pt-8":"fixed inset-0 z-50 flex items-center justify-center px-4",children:[(0,r.jsx)("button",{type:"button",className:(0,s.cn)("absolute inset-0","bg-black/35 backdrop-blur-md","bg-[radial-gradient(900px_600px_at_20%_20%,color-mix(in_srgb,#16a34a,transparent_82%)_0%,transparent_60%),radial-gradient(900px_600px_at_80%_30%,color-mix(in_srgb,var(--rb-blue),transparent_82%)_0%,transparent_60%),radial-gradient(900px_600px_at_50%_85%,color-mix(in_srgb,var(--rb-orange),transparent_85%)_0%,transparent_65%)]"),"aria-label":"Close",onClick:a}),(0,r.jsxs)("div",{role:"dialog","aria-modal":"true",className:(0,s.cn)(m,o),children:["glass"===c?(0,r.jsx)("div",{className:"pointer-events-none absolute inset-0 bg-[radial-gradient(650px_420px_at_20%_15%,color-mix(in_srgb,#16a34a,transparent_88%)_0%,transparent_60%),radial-gradient(650px_420px_at_80%_5%,color-mix(in_srgb,var(--rb-blue),transparent_90%)_0%,transparent_60%)]"}):null,t?(0,r.jsx)("div",{className:(0,s.cn)("relative px-5 py-4","solid"===c?"border-b border-[var(--rb-border)]":"border-b border-[color:color-mix(in_srgb,var(--rb-border),white_60%)]"),children:(0,r.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:t})}):null,(0,r.jsx)("div",{className:"relative px-5 py-4",children:n}),l?(0,r.jsx)("div",{className:(0,s.cn)("relative px-5 py-4","solid"===c?"border-t border-[var(--rb-border)]":"border-t border-[color:color-mix(in_srgb,var(--rb-border),white_60%)]"),children:l}):null]})]})}e.s(["Modal",()=>a])},21190,e=>{"use strict";var r=e.i(1831);async function i(e){let i=new URLSearchParams;return"boolean"==typeof e?.includeInactive&&i.set("include_inactive",e.includeInactive?"1":"0"),(0,r.apiFetch)(`/api/admin/billing/catalog${i.toString()?`?${i.toString()}`:""}`)}async function s(e){let i=new URLSearchParams;return"boolean"==typeof e?.includeInactive&&i.set("include_inactive",e.includeInactive?"1":"0"),(0,r.apiFetch)(`/api/admin/billing/intervals${i.toString()?`?${i.toString()}`:""}`)}async function a(e){return(0,r.apiFetch)("/api/admin/billing/intervals",{method:"POST",body:{code:e.code?.trim()||void 0,name:e.name,months:e.months,is_active:"boolean"==typeof e.isActive?e.isActive:void 0}})}async function t(e){return(0,r.apiFetch)(`/api/admin/billing/intervals/${e.intervalId}`,{method:"PUT",body:{code:e.code,name:e.name,months:e.months,is_active:"boolean"==typeof e.isActive?e.isActive:void 0,reason:e.reason}})}async function n(e){return(0,r.apiFetch)(`/api/admin/billing/intervals/${e.intervalId}/active`,{method:"PATCH",body:{is_active:e.isActive,reason:e.reason}})}async function l(e){return(0,r.apiFetch)("/api/admin/billing/plans",{method:"POST",body:{name:e.name,code:e.code?.trim()||void 0,description:e.description?.trim()||void 0,is_active:"boolean"==typeof e.isActive?e.isActive:void 0}})}async function d(e){return(0,r.apiFetch)(`/api/admin/billing/plans/${e.planId}`,{method:"PUT",body:{name:e.name,code:e.code,description:e.description?.trim()||void 0,is_active:"boolean"==typeof e.isActive?e.isActive:void 0,reason:e.reason}})}async function c(e){return(0,r.apiFetch)(`/api/admin/billing/plans/${e.planId}/versions/draft-from-active`,{method:"POST",body:{reason:e.reason}})}async function o(e){try{return await (0,r.apiFetch)(`/api/admin/billing/versions/${e.versionId}/validate`,{method:"POST",body:{reason:e.reason}})}catch(e){if(e instanceof r.ApiError){let r=e.data;if(r&&"object"==typeof r){if("ok"===r.status)return{status:"ok"};if("string"==typeof r.message)return{message:r.message,errors:Array.isArray(r.errors)?r.errors.map(String):void 0}}}throw e}}async function m(e){return(0,r.apiFetch)(`/api/admin/billing/versions/${e.versionId}/entitlements/sync`,{method:"POST",body:{entitlements:e.entitlements,reason:e.reason}})}async function u(e){return(0,r.apiFetch)(`/api/admin/billing/versions/${e.versionId}/prices`,{method:"POST",body:{currency:e.currency,billing_interval_id:"number"==typeof e.billingIntervalId?e.billingIntervalId:void 0,interval:e.interval,amount_cents:e.amountCents,trial_days:"number"==typeof e.trialDays?e.trialDays:void 0,is_default:"boolean"==typeof e.isDefault?e.isDefault:void 0,reason:e.reason}})}async function x(e){return(0,r.apiFetch)(`/api/admin/billing/prices/${e.priceId}`,{method:"PATCH",body:{amount_cents:e.amountCents,trial_days:"number"==typeof e.trialDays?e.trialDays:void 0,is_default:"boolean"==typeof e.isDefault?e.isDefault:void 0,reason:e.reason}})}async function v(e){return(0,r.apiFetch)(`/api/admin/billing/prices/${e.priceId}`,{method:"DELETE",body:{reason:e.reason}})}async function b(e){return(0,r.apiFetch)(`/api/admin/billing/versions/${e.versionId}/activate`,{method:"POST",body:{confirm:e.confirm,reason:e.reason}})}async function h(e){return(0,r.apiFetch)("/api/admin/billing/entitlement-definitions",{method:"POST",body:{code:e.code?.trim()||void 0,name:e.name,value_type:e.valueType,description:e.description?.trim()||void 0,is_premium:"boolean"==typeof e.isPremium?e.isPremium:void 0}})}async function p(e){return(0,r.apiFetch)(`/api/admin/billing/entitlement-definitions/${e.id}`,{method:"PUT",body:{code:e.code,name:e.name,value_type:e.valueType,description:e.description?.trim()||void 0,is_premium:"boolean"==typeof e.isPremium?e.isPremium:void 0,reason:e.reason}})}async function f(e){return(0,r.apiFetch)(`/api/admin/billing/entitlement-definitions/${e.id}`,{method:"DELETE",body:{reason:e.reason}})}async function g(e){return(0,r.apiFetch)(`/api/admin/businesses/${e}/subscriptions`)}async function j(e){return(0,r.apiFetch)(`/api/admin/businesses/${e.tenantId}/subscriptions`,{method:"POST",body:{billing_plan_version_id:e.billingPlanVersionId,billing_price_id:e.billingPriceId,reason:e.reason}})}async function y(e){return(0,r.apiFetch)(`/api/admin/businesses/${e.tenantId}/subscriptions/${e.subscriptionId}/cancel`,{method:"POST",body:{at_period_end:"boolean"==typeof e.atPeriodEnd?e.atPeriodEnd:void 0,reason:e.reason}})}async function N(e){let i=new URLSearchParams;return e.status&&e.status.trim().length>0&&i.set("status",e.status.trim()),"number"==typeof e.limit&&Number.isFinite(e.limit)&&i.set("limit",String(e.limit)),(0,r.apiFetch)(`/api/admin/businesses/${e.tenantId}/invoices${i.toString()?`?${i.toString()}`:""}`)}async function w(e){return(0,r.apiFetch)(`/api/admin/businesses/${e.tenantId}/invoices/${e.invoiceId}`)}async function _(e){return(0,r.apiFetch)(`/api/admin/businesses/${e.tenantId}/invoices`,{method:"POST",body:{tenant_subscription_id:e.tenantSubscriptionId,reason:e.reason}})}async function S(e){return(0,r.apiFetch)(`/api/admin/businesses/${e.tenantId}/invoices/${e.invoiceId}/issue`,{method:"POST",body:{reason:e.reason}})}async function k(e){return(0,r.apiFetch)(`/api/admin/businesses/${e.tenantId}/invoices/${e.invoiceId}/paid`,{method:"POST",body:{paid_at:e.paidAt,paid_method:e.paidMethod,paid_note:e.paidNote,reason:e.reason}})}async function C(e){let i=e.invoiceNumber?`invoice_${e.invoiceNumber}.pdf`:"invoice.pdf";await (0,r.apiDownload)(`/api/admin/businesses/${e.tenantId}/invoices/${e.invoiceId}/pdf`,{filename:i})}e.s(["activateBillingPlanVersion",()=>b,"assignTenantSubscription",()=>j,"cancelTenantSubscription",()=>y,"createBillingInterval",()=>a,"createBillingPlan",()=>l,"createBillingPrice",()=>u,"createDraftBillingPlanVersionFromActive",()=>c,"createEntitlementDefinition",()=>h,"createInvoiceFromSubscription",()=>_,"deleteBillingPrice",()=>v,"deleteEntitlementDefinition",()=>f,"downloadInvoicePdf",()=>C,"getBillingCatalog",()=>i,"getTenantInvoice",()=>w,"getTenantInvoices",()=>N,"getTenantSubscriptions",()=>g,"issueInvoice",()=>S,"listBillingIntervals",()=>s,"markInvoicePaid",()=>k,"setBillingIntervalActive",()=>n,"syncBillingPlanVersionEntitlements",()=>m,"updateBillingInterval",()=>t,"updateBillingPlan",()=>d,"updateBillingPrice",()=>x,"updateEntitlementDefinition",()=>p,"validateBillingPlanVersionDraft",()=>o])},63223,e=>{"use strict";var r=e.i(48277),i=e.i(30668),s=e.i(16506),a=e.i(96086),t=e.i(77252),n=e.i(24273),l=e.i(63571),d=e.i(68501),c=e.i(9693),o=e.i(72015),m=e.i(26550),u=e.i(66474),x=e.i(43901),v=e.i(21190),b=e.i(1314);function h(e){let r=(e.currency||"usd").toUpperCase(),i=("number"==typeof e.amountCents?e.amountCents:0)/100;try{return new Intl.NumberFormat(void 0,{style:"currency",currency:r,maximumFractionDigits:2}).format(i)}catch{return`${r} ${i.toFixed(2)}`}}function p(e){let r=String(e||"").toLowerCase();return r?"month"===r||"monthly"===r?"/mo":"year"===r||"yearly"===r||"annual"===r?"/yr":`/${r}`:""}function f(e){if(!e)return null;let r=Array.isArray(e.prices)?e.prices:[];return r.find(e=>e.is_default)??null??r[0]??null}function g(e){if(!e)return"—";let r=new Date(e);if(Number.isNaN(r.getTime()))return"—";try{return new Intl.DateTimeFormat(void 0,{year:"numeric",month:"short",day:"2-digit"}).format(r)}catch{return r.toISOString().slice(0,10)}}function j(){return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)(o.Card,{className:"overflow-hidden",children:[(0,r.jsx)("div",{className:"h-1.5 w-full bg-[var(--rb-border)]"}),(0,r.jsx)(o.CardHeader,{className:"space-y-3",children:(0,r.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between",children:[(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsx)(x.Skeleton,{className:"h-3 w-24 rounded-[var(--rb-radius-sm)]"}),(0,r.jsxs)("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[(0,r.jsx)(x.Skeleton,{className:"h-7 w-56 rounded-[var(--rb-radius-sm)]"}),(0,r.jsx)(x.Skeleton,{className:"h-5 w-20 rounded-full"})]}),(0,r.jsx)(x.Skeleton,{className:"mt-2 h-4 w-80 rounded-[var(--rb-radius-sm)]"})]}),(0,r.jsxs)("div",{className:"sm:text-right",children:[(0,r.jsx)(x.Skeleton,{className:"ml-auto h-3 w-20 rounded-[var(--rb-radius-sm)]"}),(0,r.jsxs)("div",{className:"mt-2 flex items-baseline gap-2 sm:justify-end",children:[(0,r.jsx)(x.Skeleton,{className:"h-8 w-28 rounded-[var(--rb-radius-sm)]"}),(0,r.jsx)(x.Skeleton,{className:"h-4 w-12 rounded-[var(--rb-radius-sm)]"})]}),(0,r.jsx)(x.Skeleton,{className:"mt-2 ml-auto h-3 w-24 rounded-[var(--rb-radius-sm)]"})]})]})}),(0,r.jsx)(o.CardContent,{children:(0,r.jsx)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:Array.from({length:3}).map((e,i)=>(0,r.jsxs)("div",{className:"rounded-[var(--rb-radius-lg)] border border-[var(--rb-border)] bg-[var(--rb-surface-muted)] p-4",children:[(0,r.jsx)(x.Skeleton,{className:"h-3 w-24 rounded-[var(--rb-radius-sm)]"}),(0,r.jsxs)("div",{className:"mt-4 space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(x.Skeleton,{className:"h-3 w-16 rounded-[var(--rb-radius-sm)]"}),(0,r.jsx)(x.Skeleton,{className:"mt-2 h-4 w-28 rounded-[var(--rb-radius-sm)]"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(x.Skeleton,{className:"h-3 w-20 rounded-[var(--rb-radius-sm)]"}),(0,r.jsx)(x.Skeleton,{className:"mt-2 h-4 w-24 rounded-[var(--rb-radius-sm)]"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(x.Skeleton,{className:"h-3 w-24 rounded-[var(--rb-radius-sm)]"}),(0,r.jsx)(x.Skeleton,{className:"mt-2 h-4 w-20 rounded-[var(--rb-radius-sm)]"})]})]})]},i))})})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-end md:justify-between",children:[(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsx)(x.Skeleton,{className:"h-5 w-40 rounded-[var(--rb-radius-sm)]"}),(0,r.jsx)(x.Skeleton,{className:"mt-2 h-4 w-72 rounded-[var(--rb-radius-sm)]"})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-end",children:[(0,r.jsx)(x.Skeleton,{className:"h-9 w-full rounded-[var(--rb-radius-sm)] sm:w-[260px]"}),(0,r.jsx)("div",{className:"flex flex-wrap items-center gap-2",children:Array.from({length:4}).map((e,i)=>(0,r.jsx)(x.Skeleton,{className:"h-8 w-20 rounded-[var(--rb-radius-sm)]"},i))})]})]}),(0,r.jsx)("div",{className:"rounded-[var(--rb-radius-lg)] border border-[var(--rb-border)] bg-white p-5",children:(0,r.jsx)("div",{className:"space-y-4",children:Array.from({length:3}).map((e,i)=>(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsxs)("div",{className:"relative flex w-5 flex-col items-center",children:[(0,r.jsx)("div",{className:"mt-1 h-3 w-3 rounded-full bg-[var(--rb-border)]"}),i<2?(0,r.jsx)("div",{className:"mt-2 w-px flex-1 bg-[var(--rb-border)]"}):null]}),(0,r.jsx)("div",{className:"min-w-0 flex-1 rounded-[var(--rb-radius-lg)] border border-[var(--rb-border)] bg-[var(--rb-surface-muted)] px-4 py-4",children:(0,r.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between",children:[(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,r.jsx)(x.Skeleton,{className:"h-5 w-12 rounded-[var(--rb-radius-sm)]"}),(0,r.jsx)(x.Skeleton,{className:"h-5 w-16 rounded-full"}),(0,r.jsx)(x.Skeleton,{className:"h-3 w-14 rounded-[var(--rb-radius-sm)]"})]}),(0,r.jsx)(x.Skeleton,{className:"mt-2 h-3 w-40 rounded-[var(--rb-radius-sm)]"}),(0,r.jsxs)("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[(0,r.jsx)(x.Skeleton,{className:"h-5 w-28 rounded-[var(--rb-radius-sm)]"}),(0,r.jsx)(x.Skeleton,{className:"h-5 w-16 rounded-[var(--rb-radius-sm)]"}),(0,r.jsx)(x.Skeleton,{className:"h-5 w-24 rounded-[var(--rb-radius-sm)]"})]})]}),(0,r.jsx)(x.Skeleton,{className:"h-8 w-16 rounded-[var(--rb-radius-sm)]"})]})})]},i))})})]})]})}function y(){let e=(0,a.useParams)(),x=(0,n.useDashboardHeader)(),y=(0,a.useRouter)(),N=(0,b.useAuth)(),w=Number(e.planId),[_,S]=(0,i.useState)(!0),[k,C]=(0,i.useState)(null),[A,I]=(0,i.useState)(null),[z,P]=(0,i.useState)(!1),[$,B]=(0,i.useState)(null),[F,T]=(0,i.useState)(0),[D,L]=(0,i.useState)(""),[M,E]=(0,i.useState)("all"),[O,U]=(0,i.useState)(!1),[R,V]=(0,i.useState)(!1),[H,q]=(0,i.useState)(null),[W,K]=(0,i.useState)(""),[G,J]=(0,i.useState)(""),[Q,X]=(0,i.useState)(""),[Y,Z]=(0,i.useState)(!0),ee=N.can("admin.billing.write");async function er(){if(!$)return;let e=W.trim(),r=G.trim();if(!e)return void q("Name is required.");if(!r)return void q("Code is required.");V(!0),q(null);try{await (0,v.updateBillingPlan)({planId:$.id,name:e,code:r,description:Q,isActive:Y}),U(!1),T(e=>e+1)}catch(e){q(e instanceof Error?e.message:"Failed to update plan.")}finally{V(!1)}}(0,i.useEffect)(()=>(x.setHeader({breadcrumb:"Admin / Billing / Plans",title:$?$.name:Number.isFinite(w)?`Plan ${w}`:"Plan",subtitle:$?$.code:void 0,actions:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(s.default,{href:"/admin/billing/plans",children:(0,r.jsx)(c.Button,{variant:"outline",size:"sm",children:"Back"})}),ee?(0,r.jsx)(c.Button,{variant:"outline",size:"sm",disabled:_||R||!$,onClick:()=>{$&&(q(null),K($.name??""),J($.code??""),X($.description??""),Z(!!$.is_active),U(!0))},children:"Edit plan"}):null,ee?(0,r.jsx)(c.Button,{variant:"secondary",size:"sm",disabled:_||z||!Number.isFinite(w)||w<=0,onClick:async()=>{if(!z)try{P(!0),I(null);let e=await (0,v.createDraftBillingPlanVersionFromActive)({planId:w});y.push(`/admin/billing/plans/${w}/versions/${e.version.id}`)}catch(e){I(e instanceof Error?e.message:"Failed to create draft version.")}finally{P(!1)}},children:z?"Creating…":"Create draft"}):null,(0,r.jsx)(c.Button,{variant:"outline",size:"sm",onClick:()=>T(e=>e+1),disabled:_,children:"Refresh"})]})}),()=>x.setHeader(null)),[ee,x,z,_,$,w,y]),(0,i.useEffect)(()=>{let e=!0;return async function(){if(!Number.isFinite(w)||w<=0){C("Invalid plan id."),S(!1);return}try{S(!0),C(null);let r=await (0,v.getBillingCatalog)({includeInactive:!0});if(!e)return;let i=(Array.isArray(r.billing_plans)?r.billing_plans:[]).find(e=>e.id===w)??null;B(i),i||C("Plan not found.")}catch(r){if(!e)return;B(null),C(r instanceof Error?r.message:"Failed to load plan.")}finally{if(!e)return;S(!1)}}(),()=>{e=!1}},[w,F]);let ei=(0,i.useMemo)(()=>Array.isArray($?.versions)?$?.versions:[],[$]),es=(0,i.useMemo)(()=>{let e,r;return $?(r=(e=Array.isArray($.versions)?$.versions:[]).find(e=>"active"===e.status)??null)||(e.slice().sort((e,r)=>(r.version??0)-(e.version??0))[0]??null):null},[$]),ea=(0,i.useMemo)(()=>f(es),[es]),et=(0,i.useMemo)(()=>Array.from(new Set(ei.flatMap(e=>Array.isArray(e.prices)?e.prices:[]).map(e=>e.currency).filter(Boolean))).map(e=>String(e).toUpperCase()).sort(),[ei]),en=(0,i.useMemo)(()=>{let e={all:0,active:0,draft:0,retired:0,other:0};for(let r of ei){e.all+=1;let i=String(r.status||"").toLowerCase();"active"===i?e.active+=1:"draft"===i?e.draft+=1:"retired"===i?e.retired+=1:e.other+=1}return e},[ei]),el=(0,i.useMemo)(()=>{let e=D.trim().toLowerCase();return ei.slice().sort((e,r)=>(r.version??0)-(e.version??0)).filter(r=>{let i=String(r.status||"").toLowerCase();if("active"===M&&"active"!==i||"draft"===M&&"draft"!==i||"retired"===M&&"retired"!==i||"other"===M&&("active"===i||"draft"===i||"retired"===i))return!1;if(!e)return!0;let s=(Array.isArray(r.prices)?r.prices:[]).map(e=>`${e.currency} ${e.interval} ${e.amount_cents}`).join(" ").toLowerCase();return`v${r.version} ${r.status} ${r.id}`.toLowerCase().includes(e)||s.includes(e)})},[M,D,ei]);return(0,r.jsx)(t.RequireAuth,{requiredPermission:"admin.billing.read",children:(0,r.jsxs)("div",{className:"space-y-6",children:[k?(0,r.jsx)(l.Alert,{variant:"danger",title:"Could not load plan",children:k}):null,A?(0,r.jsx)(l.Alert,{variant:"danger",title:"Action failed",children:A}):null,!_||$||k?null:(0,r.jsx)(j,{}),$?(0,r.jsxs)(o.Card,{className:"overflow-hidden",children:[(0,r.jsx)("div",{className:"h-1.5 w-full "+($.is_active?"bg-[var(--rb-blue)]":"bg-[var(--rb-border)]")}),(0,r.jsx)(o.CardHeader,{className:"space-y-3",children:(0,r.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between",children:[(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsx)("div",{className:"text-xs font-medium uppercase tracking-wide text-zinc-500",children:"Billing plan"}),(0,r.jsxs)("div",{className:"mt-1 flex flex-wrap items-center gap-2",children:[(0,r.jsx)("div",{className:"truncate text-xl font-semibold tracking-tight text-[var(--rb-text)]",children:$.name}),(0,r.jsx)(d.Badge,{variant:$.is_active?"success":"default",children:$.is_active?"active":"inactive"})]}),(0,r.jsx)("div",{className:"mt-1 text-sm text-zinc-600",children:$.description??"—"})]}),(0,r.jsxs)("div",{className:"sm:text-right",children:[(0,r.jsx)("div",{className:"text-xs text-zinc-500",children:"Starting at"}),(0,r.jsxs)("div",{className:"mt-1 flex items-baseline gap-2 sm:justify-end",children:[(0,r.jsx)("div",{className:"text-2xl font-semibold tracking-tight text-[var(--rb-text)]",children:ea?h({currency:ea.currency,amountCents:ea.amount_cents}):"—"}),(0,r.jsx)("div",{className:"text-sm text-zinc-600",children:ea?p(ea.interval):""})]}),ea?.trial_days?(0,r.jsxs)("div",{className:"mt-1 text-xs text-zinc-500",children:[ea.trial_days," day trial"]}):null]})]})}),(0,r.jsx)(o.CardContent,{children:(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[(0,r.jsxs)("div",{className:"rounded-[var(--rb-radius-lg)] border border-[var(--rb-border)] bg-[var(--rb-surface-muted)] p-4",children:[(0,r.jsx)("div",{className:"text-xs font-medium uppercase tracking-wide text-zinc-500",children:"Overview"}),(0,r.jsxs)("div",{className:"mt-3 space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-xs text-zinc-500",children:"Code"}),(0,r.jsx)("div",{className:"mt-1 text-sm font-medium text-zinc-800",children:$.code})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-xs text-zinc-500",children:"Plan ID"}),(0,r.jsx)("div",{className:"mt-1 text-sm font-medium text-zinc-800",children:$.id})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-xs text-zinc-500",children:"Last updated"}),(0,r.jsx)("div",{className:"mt-1 text-sm font-medium text-zinc-800",children:g($.updated_at)})]})]})]}),(0,r.jsxs)("div",{className:"rounded-[var(--rb-radius-lg)] border border-[var(--rb-border)] bg-[var(--rb-surface-muted)] p-4",children:[(0,r.jsx)("div",{className:"text-xs font-medium uppercase tracking-wide text-zinc-500",children:"Current version"}),(0,r.jsxs)("div",{className:"mt-3 space-y-2",children:[(0,r.jsx)("div",{className:"text-sm text-zinc-700",children:es?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("span",{className:"font-medium text-zinc-900",children:["v",es.version]}),(0,r.jsx)("span",{className:"ml-2",children:(0,r.jsx)(d.Badge,{variant:"active"===es.status?"success":"draft"===es.status?"info":"default",children:es.status})})]}):"—"}),(0,r.jsxs)("div",{className:"text-xs text-zinc-500",children:["Total versions: ",ei.length]}),es?(0,r.jsx)("div",{className:"pt-1",children:(0,r.jsx)(s.default,{href:`/admin/billing/plans/${w}/versions/${es.id}`,children:(0,r.jsx)(c.Button,{variant:"outline",size:"sm",children:"View current version"})})}):null]})]}),(0,r.jsxs)("div",{className:"rounded-[var(--rb-radius-lg)] border border-[var(--rb-border)] bg-[var(--rb-surface-muted)] p-4",children:[(0,r.jsx)("div",{className:"text-xs font-medium uppercase tracking-wide text-zinc-500",children:"Coverage"}),(0,r.jsxs)("div",{className:"mt-3 space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-xs text-zinc-500",children:"Currencies"}),(0,r.jsx)("div",{className:"mt-1 text-sm font-medium text-zinc-800",children:et.length>0?et.join(", "):"—"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-xs text-zinc-500",children:"Default currency"}),(0,r.jsx)("div",{className:"mt-1 text-sm font-medium text-zinc-800",children:ea?.currency?String(ea.currency).toUpperCase():"—"})]})]})]})]})})]}):null,(0,r.jsx)(u.Modal,{open:O,onClose:()=>{R||U(!1)},title:"Edit billing plan",footer:(0,r.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,r.jsx)(c.Button,{variant:"outline",onClick:()=>{R||U(!1)},disabled:R,children:"Cancel"}),(0,r.jsx)(c.Button,{variant:"primary",onClick:()=>void er(),disabled:R,children:R?"Saving…":"Save"})]}),children:(0,r.jsxs)("div",{className:"space-y-4",children:[H?(0,r.jsx)(l.Alert,{variant:"danger",title:"Cannot save",children:H}):null,(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm font-medium",children:"Name"}),(0,r.jsx)(m.Input,{value:W,onChange:e=>K(e.target.value),disabled:R})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm font-medium",children:"Code"}),(0,r.jsx)(m.Input,{value:G,onChange:e=>J(e.target.value),disabled:R})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm font-medium",children:"Description"}),(0,r.jsx)("textarea",{className:"min-h-[90px] w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:Q,onChange:e=>X(e.target.value),disabled:R})]}),(0,r.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,r.jsx)("input",{type:"checkbox",checked:Y,onChange:e=>Z(e.target.checked),disabled:R}),"Active"]})]})}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-end md:justify-between",children:[(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:"Version history"}),(0,r.jsx)("div",{className:"mt-1 text-sm text-zinc-600",children:"Track changes over time and inspect each version."})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-end",children:[(0,r.jsx)("div",{className:"w-full sm:w-[260px]",children:(0,r.jsx)(m.Input,{value:D,onChange:e=>L(e.target.value),placeholder:"Search versions…"})}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,r.jsxs)(c.Button,{variant:"all"===M?"secondary":"outline",size:"sm",onClick:()=>E("all"),children:["All (",en.all,")"]}),(0,r.jsxs)(c.Button,{variant:"active"===M?"secondary":"outline",size:"sm",onClick:()=>E("active"),children:["Active (",en.active,")"]}),(0,r.jsxs)(c.Button,{variant:"draft"===M?"secondary":"outline",size:"sm",onClick:()=>E("draft"),children:["Draft (",en.draft,")"]}),(0,r.jsxs)(c.Button,{variant:"retired"===M?"secondary":"outline",size:"sm",onClick:()=>E("retired"),children:["Retired (",en.retired,")"]}),"all"!==M||D.trim().length>0?(0,r.jsx)(c.Button,{variant:"ghost",size:"sm",onClick:()=>{E("all"),L("")},children:"Clear"}):null]})]})]}),null,_||0!==el.length?null:(0,r.jsx)("div",{className:"text-sm text-zinc-500",children:"No versions found."}),!_&&el.length>0?(0,r.jsxs)("div",{className:"rounded-[var(--rb-radius-lg)] border border-[var(--rb-border)] bg-white p-5",children:[(0,r.jsx)("div",{className:"mb-4 flex items-center justify-between gap-3",children:(0,r.jsxs)("div",{className:"text-sm text-zinc-600",children:["Showing ",(0,r.jsx)("span",{className:"font-medium text-zinc-900",children:el.length})," of ",ei.length]})}),(0,r.jsx)("div",{className:"space-y-0",children:el.map((e,i)=>{let a=Array.isArray(e.prices)?e.prices:[],t=Array.isArray(e.entitlements)?e.entitlements:[],n=f(e),l=i===el.length-1,o=String(e.status||"").toLowerCase();return(0,r.jsxs)("div",{className:"relative flex gap-4 "+(l?"":"pb-6"),children:[(0,r.jsxs)("div",{className:"relative flex w-5 flex-col items-center",children:[(0,r.jsx)("div",{className:"mt-1 h-3 w-3 rounded-full ring-4 "+("active"===o?"bg-[var(--rb-blue)]":"draft"===o?"bg-[var(--rb-orange)]":"bg-zinc-400")+" "+("active"===o?"ring-[color:color-mix(in_srgb,var(--rb-blue),white_70%)]":"draft"===o?"ring-[color:color-mix(in_srgb,var(--rb-orange),white_70%)]":"ring-[color:color-mix(in_srgb,var(--rb-border),white_70%)]")}),l?null:(0,r.jsx)("div",{className:"mt-2 w-px flex-1 bg-[var(--rb-border)]"})]}),(0,r.jsx)("div",{className:"min-w-0 flex-1",children:(0,r.jsxs)("div",{className:"rounded-[var(--rb-radius-lg)] border border-[var(--rb-border)] bg-[var(--rb-surface-muted)] px-4 py-4",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between",children:[(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,r.jsxs)("div",{className:"text-base font-semibold text-[var(--rb-text)]",children:["v",e.version]}),(0,r.jsx)(d.Badge,{variant:"active"===o?"success":"draft"===o?"info":"default",children:e.status}),(0,r.jsxs)("div",{className:"text-xs text-zinc-500",children:["ID ",e.id]})]}),(0,r.jsx)("div",{className:"mt-1 text-xs text-zinc-500",children:"active"===o?(0,r.jsxs)(r.Fragment,{children:["Activated: ",g(e.activated_at??e.created_at)]}):"retired"===o?(0,r.jsxs)(r.Fragment,{children:["Retired: ",g(e.retired_at??e.created_at)]}):(0,r.jsxs)(r.Fragment,{children:["Created: ",g(e.created_at)]})}),(0,r.jsxs)("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[n?(0,r.jsxs)("div",{className:"text-sm font-medium text-zinc-900",children:[h({currency:n.currency,amountCents:n.amount_cents}),(0,r.jsx)("span",{className:"ml-1 text-sm font-normal text-zinc-600",children:p(n.interval)})]}):(0,r.jsx)("div",{className:"text-sm text-zinc-600",children:"—"}),(0,r.jsx)("div",{className:"text-xs text-zinc-500",children:"•"}),(0,r.jsxs)("div",{className:"text-sm text-zinc-700",children:[a.length," price(s)"]}),(0,r.jsx)("div",{className:"text-xs text-zinc-500",children:"•"}),(0,r.jsxs)("div",{className:"text-sm text-zinc-700",children:[t.length," entitlements"]})]})]}),(0,r.jsx)("div",{className:"flex items-center justify-between gap-3 sm:flex-col sm:items-end sm:justify-start",children:(0,r.jsx)(s.default,{href:`/admin/billing/plans/${w}/versions/${e.id}`,children:(0,r.jsx)(c.Button,{variant:"outline",size:"sm",children:"View"})})})]}),a.length>0?(0,r.jsxs)("div",{className:"mt-3 flex flex-wrap gap-2",children:[a.slice(0,4).map(e=>(0,r.jsxs)("span",{className:"inline-flex items-center gap-2 rounded-full border px-2.5 py-1 text-xs font-medium "+(e.is_default?"border-[color:color-mix(in_srgb,var(--rb-blue),white_60%)] bg-[color:color-mix(in_srgb,var(--rb-blue),white_92%)] text-[var(--rb-blue)]":"border-[var(--rb-border)] bg-white text-[var(--rb-text)]"),children:[(0,r.jsx)("span",{children:String(e.currency).toUpperCase()}),(0,r.jsxs)("span",{children:[h({currency:e.currency,amountCents:e.amount_cents}),p(e.interval)]}),e.is_default?(0,r.jsx)("span",{className:"text-[10px] uppercase tracking-wide",children:"default"}):null]},e.id)),a.length>4?(0,r.jsxs)("span",{className:"inline-flex items-center rounded-full border border-[var(--rb-border)] bg-white px-2.5 py-1 text-xs font-medium text-zinc-600",children:["+",a.length-4," more"]}):null]}):null]})})]},e.id)})})]}):null]})]})})}e.s(["default",()=>y])}]);