(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,63571,e=>{"use strict";var r=e.i(48277),t=e.i(14575);function a({variant:e,className:a}){let s="h-4 w-4 shrink-0";return"success"===e?(0,r.jsx)("svg",{viewBox:"0 0 24 24",className:(0,t.cn)(s,a),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:(0,r.jsx)("path",{d:"M20 6L9 17l-5-5"})}):"warning"===e?(0,r.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,t.cn)(s,a),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,r.jsx)("path",{d:"M12 9v4"}),(0,r.jsx)("path",{d:"M12 17h.01"}),(0,r.jsx)("path",{d:"M10.3 3.6l-8.3 14.3A2 2 0 0 0 3.7 21h16.6a2 2 0 0 0 1.7-3.1L13.7 3.6a2 2 0 0 0-3.4 0z"})]}):"danger"===e?(0,r.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,t.cn)(s,a),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,r.jsx)("path",{d:"M18 6L6 18"}),(0,r.jsx)("path",{d:"M6 6l12 12"})]}):(0,r.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,t.cn)(s,a),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,r.jsx)("path",{d:"M12 16v-4"}),(0,r.jsx)("path",{d:"M12 8h.01"}),(0,r.jsx)("path",{d:"M12 22a10 10 0 1 0-10-10 10 10 0 0 0 10 10z"})]})}function s({className:e,variant:s="info",title:i,children:l,...n}){let o={info:{wrapper:"border-[color:color-mix(in_srgb,var(--rb-blue),white_75%)] bg-[color:color-mix(in_srgb,var(--rb-blue),white_92%)] text-[var(--rb-text)]",icon:"text-[var(--rb-blue)]",title:"text-[var(--rb-blue)]"},success:{wrapper:"border-[color:color-mix(in_srgb,#16a34a,white_75%)] bg-[color:color-mix(in_srgb,#16a34a,white_92%)] text-[var(--rb-text)]",icon:"text-[#166534]",title:"text-[#166534]"},warning:{wrapper:"border-[color:color-mix(in_srgb,var(--rb-orange),white_70%)] bg-[color:color-mix(in_srgb,var(--rb-orange),white_92%)] text-[var(--rb-text)]",icon:"text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)]",title:"text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)]"},danger:{wrapper:"border-[color:color-mix(in_srgb,#dc2626,white_75%)] bg-[color:color-mix(in_srgb,#dc2626,white_92%)] text-[var(--rb-text)]",icon:"text-[#991b1b]",title:"text-[#991b1b]"}}[s];return(0,r.jsx)("div",{role:"alert",className:(0,t.cn)("rounded-[var(--rb-radius-md)] border px-4 py-3",o.wrapper,e),...n,children:(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)(a,{variant:s,className:(0,t.cn)("mt-0.5",o.icon)}),(0,r.jsxs)("div",{className:"min-w-0",children:[i?(0,r.jsx)("div",{className:(0,t.cn)("text-sm font-semibold",o.title),children:i}):null,l?(0,r.jsx)("div",{className:(0,t.cn)("text-sm text-zinc-700",i?"mt-1":""),children:l}):null]})]})})}e.s(["Alert",()=>s])},68501,e=>{"use strict";var r=e.i(48277),t=e.i(14575);function a({className:e,variant:a="default",...s}){return(0,r.jsx)("span",{className:(0,t.cn)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-medium",{default:"bg-[var(--rb-surface-muted)] text-[var(--rb-text)] border-[var(--rb-border)]",info:"bg-[color:color-mix(in_srgb,var(--rb-blue),white_85%)] text-[var(--rb-blue)] border-[color:color-mix(in_srgb,var(--rb-blue),white_70%)]",success:"bg-[color:color-mix(in_srgb,#16a34a,white_85%)] text-[#166534] border-[color:color-mix(in_srgb,#16a34a,white_70%)]",warning:"bg-[color:color-mix(in_srgb,var(--rb-orange),white_85%)] text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)] border-[color:color-mix(in_srgb,var(--rb-orange),white_70%)]",danger:"bg-[color:color-mix(in_srgb,#dc2626,white_85%)] text-[#991b1b] border-[color:color-mix(in_srgb,#dc2626,white_70%)]"}[a],e),...s})}e.s(["Badge",()=>a])},26550,e=>{"use strict";var r=e.i(48277),t=e.i(14575);function a({className:e,type:a,...s}){return(0,r.jsx)("input",{type:a,className:(0,t.cn)("w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)] outline-none transition","placeholder:text-zinc-400","focus-visible:ring-2 focus-visible:ring-[color:color-mix(in_srgb,var(--rb-orange),white_65%)] focus-visible:ring-offset-2 focus-visible:ring-offset-white","disabled:cursor-not-allowed disabled:bg-[var(--rb-surface-muted)] disabled:opacity-70",e),...s})}e.s(["Input",()=>a])},43901,e=>{"use strict";var r=e.i(48277),t=e.i(14575),a=e.i(72015);function s({className:e,"aria-hidden":a=!0,...s}){return(0,r.jsx)("div",{"aria-hidden":a,className:(0,t.cn)("rb-skeleton",e),...s})}function i({lines:e=3,className:i}){let l=Math.max(1,Math.min(e,12));return(0,r.jsx)(a.Card,{className:(0,t.cn)("overflow-hidden",i),children:(0,r.jsxs)(a.CardContent,{className:"space-y-3 pt-5",children:[(0,r.jsx)(s,{className:"h-4 w-32 rounded-[var(--rb-radius-sm)]"}),Array.from({length:l}).map((e,a)=>(0,r.jsx)(s,{className:(0,t.cn)("h-3 rounded-[var(--rb-radius-sm)]",a===l-1?"w-3/5":"w-full")},a))]})})}function l({rows:e=6,columns:a=5,className:i}){let l=Math.max(1,Math.min(e,20)),n=Math.max(1,Math.min(a,10));return(0,r.jsxs)("div",{className:(0,t.cn)("overflow-hidden rounded-[var(--rb-radius-lg)] border border-[var(--rb-border)] bg-white shadow-[var(--rb-shadow)]",i),children:[(0,r.jsx)("div",{className:"border-b border-[var(--rb-border)] px-5 py-4",children:(0,r.jsx)("div",{className:"grid gap-3",style:{gridTemplateColumns:`repeat(${n}, minmax(0, 1fr))`},children:Array.from({length:n}).map((e,t)=>(0,r.jsx)(s,{className:"h-3 w-full rounded-[var(--rb-radius-sm)]"},t))})}),(0,r.jsx)("div",{className:"px-5 pb-5 pt-4",children:(0,r.jsx)("div",{className:"space-y-3",children:Array.from({length:l}).map((e,a)=>(0,r.jsx)("div",{className:"grid gap-3",style:{gridTemplateColumns:`repeat(${n}, minmax(0, 1fr))`},children:Array.from({length:n}).map((e,a)=>(0,r.jsx)(s,{className:(0,t.cn)("h-3 rounded-[var(--rb-radius-sm)]",0===a?"w-3/4":"w-full")},a))},a))})})]})}e.s(["CardSkeleton",()=>i,"Skeleton",()=>s,"TableSkeleton",()=>l])},37574,e=>{"use strict";var r=e.i(48277),t=e.i(30668),a=e.i(14575),s=e.i(9693),i=e.i(33441),l=e.i(43901),n=e.i(1831);function o({title:e,data:o,columns:d,getRowId:c,loading:m=!1,emptyMessage:u="No data.",search:x,filters:h=[],pageSizeOptions:b=[10,25,50],initialPageSize:p=10,server:g,exportConfig:v,columnVisibilityKey:f,onRowClick:j,className:y}){let[w,_]=(0,t.useState)(""),[N,C]=(0,t.useState)(0),[S,k]=(0,t.useState)(p),[M,A]=(0,t.useState)(null),[z,B]=(0,t.useState)(null),[I,D]=(0,t.useState)(0),L=(0,t.useId)(),$=!!g,E=$?g.query:w,T=$?g.onQueryChange:_,U=$?g.pageIndex:N,R=$?g.onPageIndexChange:C,F=$?g.pageSize:S,P=$?g.onPageSizeChange:k,O=$?g.sort??null:null,H=$?g.onSortChange:void 0,J=(0,t.useMemo)(()=>{let e=Array.isArray(d)?d:[];if(!f){let r=e.filter(e=>!e.hiddenByDefault);return r.length>0?r:e.slice(0,1)}try{let r=window.localStorage.getItem(f);if(!r){let r=e.filter(e=>!e.hiddenByDefault);return r.length>0?r:e.slice(0,1)}let t=JSON.parse(r),a=e.filter(e=>{let r=t[e.id];return"boolean"==typeof r?r:!e.hiddenByDefault});return a.length>0?a:e.slice(0,1)}catch{let r=e.filter(e=>!e.hiddenByDefault);return r.length>0?r:e.slice(0,1)}},[f,d,I]),W=(0,t.useMemo)(()=>{if($)return Array.isArray(o)?o:[];let e=E.trim().toLowerCase();return(Array.isArray(o)?o:[]).filter(r=>{if(x&&x.getSearchText&&e.length>0&&!x.getSearchText(r).toLowerCase().includes(e))return!1;for(let e of h)if(e.predicate&&!e.predicate(r,e.value))return!1;return!0})},[o,h,$,E,x]),q=$?g.totalRows:W.length,K=Math.max(1,Math.ceil(q/F)),Q=Math.min(U,K-1),Z=Math.max(1,Math.min(8,F||10)),V=(0,t.useMemo)(()=>{if($)return W;let e=Q*F,r=e+F;return W.slice(e,r)},[Q,W,$,F]),Y=Q>0,G=Q<K-1,X=!!x||h.length>0||!!v||!!f;function ee(e,r){if(f&&(r||!(J.length<=1)))try{let t=window.localStorage.getItem(f),a=(t?JSON.parse(t):{})??{};a[e]=r,window.localStorage.setItem(f,JSON.stringify(a)),D(e=>e+1)}catch{}}async function er(e){if(v&&!M){B(null),A(e);try{let r=new URLSearchParams;for(let e of(E.trim().length>0&&r.set("q",E.trim()),h)){let t=e.value;null!=t&&0!==String(t).length&&r.set(e.id,String(t))}if($&&O?.id&&O?.dir&&(r.set("sort",O.id),r.set("dir",O.dir)),r.set("format",e),v.extraQuery)for(let[e,t]of Object.entries(v.extraQuery))null!=t&&r.set(e,String(t));let t=`${v.url}${v.url.includes("?")?"&":"?"}${r.toString()}`,a=v.filename?.({format:e});await (0,n.apiDownload)(t,{filename:a})}catch(e){B(e instanceof Error?e.message:"Export failed.")}finally{A(null)}}}return(0,r.jsxs)("div",{className:(0,a.cn)("space-y-3",y),children:[e?(0,r.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:e}):null,X?(0,r.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-end md:justify-between",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-end",children:[x?(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm font-medium",htmlFor:`${L}_datatable_search`,children:"Search"}),(0,r.jsx)("input",{id:`${L}_datatable_search`,className:"w-full min-w-[220px] rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:E,onChange:e=>{T(e.target.value),R(0)},placeholder:x.placeholder??"Search..."})]}):null,h.map(e=>(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm font-medium",htmlFor:`${L}_datatable_filter_${e.id}`,children:e.label}),(0,r.jsx)("select",{id:`${L}_datatable_filter_${e.id}`,className:"w-full min-w-[180px] rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:String(e.value),onChange:r=>{let t=e.options.find(e=>String(e.value)===r.target.value),a=t?t.value:r.target.value;e.onChange(a),R(0)},children:e.options.map(e=>(0,r.jsx)("option",{value:String(e.value),children:e.label},String(e.value)))})]},e.id))]}),(0,r.jsxs)("div",{className:"flex flex-col items-start gap-2 md:items-end",children:[(0,r.jsxs)("div",{className:"text-sm text-zinc-600",children:[q," result(s)"]}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[v?(0,r.jsx)(i.DropdownMenu,{align:"right",trigger:({toggle:e})=>(0,r.jsx)(s.Button,{variant:"outline",size:"sm",onClick:e,disabled:!!M,children:M?"Exporting...":"Export"}),children:({close:e})=>{let t=v.formats??["csv","xlsx","pdf"];return(0,r.jsx)(r.Fragment,{children:t.map(t=>(0,r.jsxs)(i.DropdownMenuItem,{onSelect:()=>{e(),er(t)},disabled:!!M,children:["Export ",t.toUpperCase()]},t))})}}):null,f?(0,r.jsx)(i.DropdownMenu,{align:"right",trigger:({toggle:e})=>(0,r.jsx)(s.Button,{variant:"outline",size:"sm",onClick:e,children:"Columns"}),children:({close:e})=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.DropdownMenuItem,{onSelect:()=>{for(let r of(e(),d))ee(r.id,!0)},children:"Show all"}),(0,r.jsx)(i.DropdownMenuItem,{onSelect:()=>{for(let r of(e(),d))ee(r.id,!r.hiddenByDefault)},children:"Reset defaults"}),(0,r.jsx)(i.DropdownMenuSeparator,{}),d.map(e=>{let t=J.some(r=>r.id===e.id);return(0,r.jsxs)(i.DropdownMenuItem,{onSelect:()=>{ee(e.id,!t)},children:[(0,r.jsx)("span",{className:"mr-2 inline-block w-4",children:t?"✓":""}),"string"==typeof e.header?e.header:e.id]},e.id)})]})}):null]})]})]}):null,z?(0,r.jsx)("div",{className:"text-sm text-red-600",children:z}):null,(0,r.jsx)("div",{className:"overflow-x-auto rounded-[var(--rb-radius-md)] border border-[var(--rb-border)] bg-white",children:(0,r.jsxs)("table",{className:"min-w-full border-collapse text-left text-sm",children:[(0,r.jsx)("thead",{className:"bg-[var(--rb-surface-muted)]",children:(0,r.jsx)("tr",{children:J.map(e=>(0,r.jsx)("th",{className:(0,a.cn)("whitespace-nowrap border-b border-[var(--rb-border)] px-3 py-2 text-xs font-semibold uppercase tracking-wide text-zinc-600",e.headerClassName),children:$&&e.sortId&&H?(0,r.jsxs)("button",{type:"button",onClick:()=>(function(e){if($&&e.sortId&&H){if(!O||O.id!==e.sortId){H({id:e.sortId,dir:"asc"}),R(0);return}if("asc"===O.dir){H({id:e.sortId,dir:"desc"}),R(0);return}H(null),R(0)}})(e),className:"inline-flex items-center gap-1 hover:text-zinc-900",children:[(0,r.jsx)("span",{children:e.header}),$&&e.sortId?O&&O.id===e.sortId?"asc"===O.dir?(0,r.jsx)("span",{className:"ml-1 text-zinc-700",children:"↑"}):(0,r.jsx)("span",{className:"ml-1 text-zinc-700",children:"↓"}):(0,r.jsx)("span",{className:"ml-1 text-zinc-400",children:"↕"}):null]}):e.header},e.id))})}),(0,r.jsx)("tbody",{children:m?Array.from({length:Z}).map((e,t)=>(0,r.jsx)("tr",{className:"border-t border-[var(--rb-border)]",children:J.map((e,t)=>(0,r.jsx)("td",{className:(0,a.cn)("px-3 py-2 align-middle",e.className),children:(0,r.jsx)(l.Skeleton,{className:(0,a.cn)("h-3 rounded-[var(--rb-radius-sm)]",0===t?"w-3/4":t===J.length-1?"w-16":"w-full")})},e.id))},`loading_${t}`)):0===V.length?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{className:"px-3 py-3 text-sm text-zinc-600",colSpan:Math.max(1,J.length),children:u})}):V.map(e=>(0,r.jsx)("tr",{className:(0,a.cn)("border-t border-[var(--rb-border)]",j?"cursor-pointer hover:bg-[var(--rb-surface-muted)]":null),tabIndex:j?0:void 0,role:j?"button":void 0,onClick:j?()=>{j(e)}:void 0,onKeyDown:j?r=>{("Enter"===r.key||" "===r.key)&&(r.preventDefault(),j(e))}:void 0,children:J.map(t=>(0,r.jsx)("td",{className:(0,a.cn)("px-3 py-2 align-middle",t.className),children:t.cell(e)},t.id))},String(c(e))))})]})}),(0,r.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(s.Button,{variant:"outline",size:"sm",onClick:function(){R(Math.max(0,Q-1))},disabled:!Y,children:"Prev"}),(0,r.jsx)(s.Button,{variant:"outline",size:"sm",onClick:function(){R(Math.min(K-1,Q+1))},disabled:!G,children:"Next"}),(0,r.jsxs)("div",{className:"text-sm text-zinc-600",children:["Page ",Q+1," / ",K]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"text-sm text-zinc-600",children:"Rows per page"}),(0,r.jsx)("select",{className:"rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:String(F),onChange:e=>{P(Number(e.target.value)),R(0)},children:b.map(e=>(0,r.jsx)("option",{value:e,children:e},e))})]})]})]})}e.s(["DataTable",()=>o])},66474,e=>{"use strict";var r=e.i(48277),t=e.i(30668),a=e.i(14575);function s({open:e,onClose:s,title:i,children:l,footer:n,position:o="center",variant:d="glass",className:c}){if((0,t.useEffect)(()=>{function r(r){e&&"Escape"===r.key&&s()}return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[s,e]),!e)return null;let m="solid"===d?(0,a.cn)("relative w-full max-w-lg overflow-hidden rounded-[var(--rb-radius-lg)]","border border-[var(--rb-border)]","bg-white","shadow-[var(--rb-shadow)]"):(0,a.cn)("relative w-full max-w-lg overflow-hidden rounded-[var(--rb-radius-lg)]","border border-[color:color-mix(in_srgb,var(--rb-border),white_55%)]","bg-white/75 backdrop-blur-xl","shadow-[0_18px_55px_-18px_rgba(0,0,0,0.55)]","ring-1 ring-white/25");return(0,r.jsxs)("div",{className:"top-center"===o?"fixed inset-0 z-50 flex items-start justify-center px-4 pt-8":"fixed inset-0 z-50 flex items-center justify-center px-4",children:[(0,r.jsx)("button",{type:"button",className:(0,a.cn)("absolute inset-0","bg-black/35 backdrop-blur-md","bg-[radial-gradient(900px_600px_at_20%_20%,color-mix(in_srgb,#16a34a,transparent_82%)_0%,transparent_60%),radial-gradient(900px_600px_at_80%_30%,color-mix(in_srgb,var(--rb-blue),transparent_82%)_0%,transparent_60%),radial-gradient(900px_600px_at_50%_85%,color-mix(in_srgb,var(--rb-orange),transparent_85%)_0%,transparent_65%)]"),"aria-label":"Close",onClick:s}),(0,r.jsxs)("div",{role:"dialog","aria-modal":"true",className:(0,a.cn)(m,c),children:["glass"===d?(0,r.jsx)("div",{className:"pointer-events-none absolute inset-0 bg-[radial-gradient(650px_420px_at_20%_15%,color-mix(in_srgb,#16a34a,transparent_88%)_0%,transparent_60%),radial-gradient(650px_420px_at_80%_5%,color-mix(in_srgb,var(--rb-blue),transparent_90%)_0%,transparent_60%)]"}):null,i?(0,r.jsx)("div",{className:(0,a.cn)("relative px-5 py-4","solid"===d?"border-b border-[var(--rb-border)]":"border-b border-[color:color-mix(in_srgb,var(--rb-border),white_60%)]"),children:(0,r.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:i})}):null,(0,r.jsx)("div",{className:"relative px-5 py-4",children:l}),n?(0,r.jsx)("div",{className:(0,a.cn)("relative px-5 py-4","solid"===d?"border-t border-[var(--rb-border)]":"border-t border-[color:color-mix(in_srgb,var(--rb-border),white_60%)]"),children:n}):null]})]})}e.s(["Modal",()=>s])},64998,e=>{"use strict";var r=e.i(48277),t=e.i(66474),a=e.i(9693);function s({open:e,title:s,message:i,confirmText:l="Confirm",confirmVariant:n="primary",cancelText:o="Cancel",busy:d=!1,onCancel:c,onConfirm:m}){return(0,r.jsx)(t.Modal,{open:e,onClose:()=>{d||c()},title:s,footer:(0,r.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,r.jsx)(a.Button,{variant:"outline",onClick:c,disabled:d,children:o}),(0,r.jsx)(a.Button,{variant:n,onClick:m,disabled:d,children:d?"Working...":l})]}),children:(0,r.jsx)("div",{className:"text-sm text-zinc-700",children:i})})}e.s(["ConfirmDialog",()=>s])},55512,e=>{"use strict";var r=e.i(48277),t=e.i(30668),a=e.i(77252),s=e.i(24273),i=e.i(63571),l=e.i(68501),n=e.i(9693),o=e.i(72015),d=e.i(64998),c=e.i(37574),m=e.i(26550),u=e.i(66474),x=e.i(1831),h=e.i(1314);function b(){let e=(0,h.useAuth)(),b=(0,s.useDashboardHeader)(),[p,g]=(0,t.useState)(!0),[v,f]=(0,t.useState)(null),[j,y]=(0,t.useState)(null),[w,_]=(0,t.useState)(!1),[N,C]=(0,t.useState)(""),[S,k]=(0,t.useState)([]),[M,A]=(0,t.useState)([]),[z,B]=(0,t.useState)(!1),[I,D]=(0,t.useState)(""),[L,$]=(0,t.useState)(""),[E,T]=(0,t.useState)(""),[U,R]=(0,t.useState)(!0),[F,P]=(0,t.useState)(null),O=e.can("admin.billing.write");function H(e){return(Array.isArray(e)?e:[]).map(e=>({code:(e.code??"").trim().toUpperCase(),symbol:(e.symbol??"").trim(),name:(e.name??"").trim(),is_active:!!e.is_active})).filter(e=>e.code.length>0).sort((e,r)=>e.code.localeCompare(r.code))}let J=t.default.useCallback(async()=>{try{f(null),y(null),g(!0);let e=await (0,x.apiFetch)("/api/admin/settings"),r=Array.isArray(e.currencies)?e.currencies.map(e=>({code:(e.code??"").toUpperCase(),symbol:e.symbol??"",name:e.name??"",is_active:!!e.is_active})):[],t=H(r);k(t),A(t)}catch(e){f(e instanceof Error?e.message:"Failed to load currencies."),k([]),A([])}finally{g(!1)}},[]);(0,t.useEffect)(()=>(b.setHeader({breadcrumb:"Admin / Billing",title:"Currencies",subtitle:"Manage supported currencies (code, symbol, name, status)",actions:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[O?(0,r.jsx)(n.Button,{variant:"secondary",size:"sm",onClick:()=>{D(""),$(""),T(""),R(!0),B(!0)},disabled:p||w,children:"Add currency"}):null,(0,r.jsx)(n.Button,{variant:"outline",size:"sm",onClick:()=>void J(),disabled:p||w,children:"Refresh"})]})}),()=>b.setHeader(null)),[w,O,b,p,J]),(0,t.useEffect)(()=>{J()},[J]);let W=t.default.useCallback((e,r)=>{k(t=>t.map(t=>t.code===e?{...t,...r}:t))},[]),q=(0,t.useMemo)(()=>JSON.stringify(H(S))!==JSON.stringify(H(M)),[S,M]);async function K(){if(O&&q){f(null),y(null),_(!0);try{let e=await (0,x.apiFetch)("/api/admin/settings",{method:"PATCH",body:{currencies:H(S).map(e=>({code:e.code.trim().toUpperCase(),symbol:e.symbol.trim()?e.symbol.trim():null,name:e.name.trim(),is_active:!!e.is_active}))}}),r=Array.isArray(e.currencies)?e.currencies.map(e=>({code:(e.code??"").toUpperCase(),symbol:e.symbol??"",name:e.name??"",is_active:!!e.is_active})):[],t=H(r);k(t),A(t),y("Currencies updated.")}catch(e){e instanceof x.ApiError?f(e.message):f("Failed to update currencies.")}finally{_(!1)}}}let Q=(0,t.useMemo)(()=>/^[A-Z]{3}$/.test(I.trim().toUpperCase())&&!!E.trim(),[I,E]),Z=(0,t.useMemo)(()=>{let e=N.trim().toLowerCase();return e?S.filter(r=>`${r.code} ${r.symbol} ${r.name}`.toLowerCase().includes(e)):S},[S,N]),V=(0,t.useMemo)(()=>[{id:"code",header:"Code",cell:e=>(0,r.jsx)("span",{className:"font-mono text-sm",children:e.code})},{id:"name",header:"Name",cell:e=>(0,r.jsx)(m.Input,{value:e.name,onChange:r=>W(e.code,{name:r.target.value}),disabled:w||!O}),className:"min-w-[240px]"},{id:"symbol",header:"Symbol",cell:e=>(0,r.jsx)(m.Input,{value:e.symbol,onChange:r=>W(e.code,{symbol:r.target.value}),disabled:w||!O}),className:"min-w-[140px]"},{id:"status",header:"Status",cell:e=>(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(l.Badge,{variant:e.is_active?"success":"default",children:e.is_active?"Active":"Inactive"}),(0,r.jsx)("label",{className:"flex items-center gap-2 text-sm text-zinc-700",children:(0,r.jsx)("input",{type:"checkbox",checked:e.is_active,onChange:r=>W(e.code,{is_active:r.target.checked}),disabled:w||!O})})]}),className:"min-w-[200px]"},{id:"actions",header:"",cell:e=>(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)(n.Button,{type:"button",variant:"ghost",onClick:()=>P(e.code),disabled:w||!O,children:"Remove"})}),className:"w-[1%] whitespace-nowrap"}],[w,O,W]);return(0,r.jsx)(a.RequireAuth,{requiredPermission:"admin.billing.read",children:(0,r.jsxs)("div",{className:"space-y-6",children:[v?(0,r.jsx)(i.Alert,{variant:"danger",title:"Something went wrong",children:v}):null,j?(0,r.jsx)(i.Alert,{variant:"success",title:"Status",children:j}):null,p?(0,r.jsx)("div",{className:"text-sm text-zinc-500",children:"Loading currencies..."}):null,(0,r.jsx)("div",{className:"grid grid-cols-1 gap-4",children:(0,r.jsxs)(o.Card,{children:[(0,r.jsxs)(o.CardHeader,{children:[(0,r.jsx)(o.CardTitle,{children:"Currencies"}),(0,r.jsx)(o.CardDescription,{children:"Manage supported currencies (code, symbol, name, status)."})]}),(0,r.jsxs)(o.CardContent,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm font-medium",htmlFor:"currency_search",children:"Search"}),(0,r.jsx)(m.Input,{id:"currency_search",value:N,onChange:e=>C(e.target.value),placeholder:"Search by code, name, symbol...",disabled:p})]}),(0,r.jsxs)("div",{className:"text-sm text-zinc-600 sm:pt-6",children:[Z.length," currency(ies)"]})]}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[q?(0,r.jsx)(l.Badge,{variant:"warning",children:"Unsaved changes"}):(0,r.jsx)(l.Badge,{variant:"success",children:"Saved"}),(0,r.jsx)(n.Button,{type:"button",variant:"outline",onClick:()=>void J(),disabled:p||w,children:"Discard changes"}),(0,r.jsx)(n.Button,{type:"button",onClick:()=>void K(),disabled:w||p||!O||!q,children:w?"Saving...":"Save changes"})]})]}),O?null:(0,r.jsx)("div",{className:"text-sm text-zinc-600",children:"You have read-only access."}),(0,r.jsx)(c.DataTable,{data:Z,columns:V,getRowId:e=>e.code,loading:p,emptyMessage:N.trim().length>0?"No currencies match your search.":"No currencies configured.",className:"pt-1"})]})]})}),(0,r.jsx)(u.Modal,{open:z,onClose:()=>{w||B(!1)},title:"Add currency",footer:(0,r.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,r.jsx)(n.Button,{variant:"outline",onClick:()=>B(!1),disabled:w,children:"Cancel"}),(0,r.jsx)(n.Button,{variant:"secondary",onClick:()=>{!function(){let e=I.trim().toUpperCase();if(!/^[A-Z]{3}$/.test(e))return;let r=E.trim();if(!r)return;let t={code:e,symbol:L.trim(),name:r,is_active:!!U};k(r=>[...r.filter(r=>r.code!==e),t].sort((e,r)=>e.code.localeCompare(r.code))),D(""),$(""),T(""),R(!0)}(),B(!1)},disabled:w||!O||!Q,children:"Add"})]}),children:(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm font-medium",htmlFor:"currency_code_new",children:"Code"}),(0,r.jsx)(m.Input,{id:"currency_code_new",value:I,onChange:e=>D(e.target.value.toUpperCase().replace(/[^A-Z]/g,"").slice(0,3)),type:"text",placeholder:"USD",disabled:w||!O})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm font-medium",htmlFor:"currency_symbol_new",children:"Symbol"}),(0,r.jsx)(m.Input,{id:"currency_symbol_new",value:L,onChange:e=>$(e.target.value),type:"text",placeholder:"$",disabled:w||!O})]})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm font-medium",htmlFor:"currency_name_new",children:"Name"}),(0,r.jsx)(m.Input,{id:"currency_name_new",value:E,onChange:e=>T(e.target.value),type:"text",placeholder:"US Dollar",disabled:w||!O})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("div",{className:"text-sm font-medium",children:"Status"}),(0,r.jsxs)("label",{className:"flex h-10 items-center gap-2 rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 text-sm text-[var(--rb-text)]",children:[(0,r.jsx)("input",{type:"checkbox",checked:U,onChange:e=>R(e.target.checked),disabled:w||!O}),"Active"]})]})]})}),(0,r.jsx)(d.ConfirmDialog,{open:null!==F,title:"Remove currency",message:(0,r.jsxs)("span",{children:["Remove currency ",(0,r.jsx)("span",{className:"font-mono",children:F})," from the supported list?"]}),confirmText:"Remove",confirmVariant:"outline",busy:w,onCancel:()=>P(null),onConfirm:()=>{F&&k(e=>e.filter(e=>e.code!==F)),P(null)}})]})})}e.s(["default",()=>b])}]);