(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,19463,e=>{"use strict";var t=e.i(48277),a=e.i(14575);function r({title:e,description:r,actions:i,className:s}){return(0,t.jsxs)("div",{className:(0,a.cn)("flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between",s),children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-xl font-semibold text-[var(--rb-text)]",children:e}),r?(0,t.jsx)("p",{className:"mt-1 text-sm text-zinc-600",children:r}):null]}),i?(0,t.jsx)("div",{className:"flex items-center gap-2",children:i}):null]})}e.s(["PageHeader",()=>r])},26550,e=>{"use strict";var t=e.i(48277),a=e.i(14575);function r({className:e,type:r,...i}){return(0,t.jsx)("input",{type:r,className:(0,a.cn)("w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)] outline-none transition","placeholder:text-zinc-400","focus-visible:ring-2 focus-visible:ring-[color:color-mix(in_srgb,var(--rb-orange),white_65%)] focus-visible:ring-offset-2 focus-visible:ring-offset-white","disabled:cursor-not-allowed disabled:bg-[var(--rb-surface-muted)] disabled:opacity-70",e),...i})}e.s(["Input",()=>r])},44919,e=>{"use strict";var t=e.i(54976);e.s(["notify",0,{success:(e,a={})=>t.toast.success(e,a),error:(e,a={})=>t.toast.error(e,a),info:(e,a={})=>t.toast.info(e,a),warning:(e,a={})=>t.toast.warning(e,a),loading:(e,a={})=>t.toast.loading(e,a),dismiss(e){t.toast.dismiss(e)},message:(e,a,r={})=>"success"===e?t.toast.success(a,r):"error"===e?t.toast.error(a,r):"warning"===e?t.toast.warning(a,r):"loading"===e?t.toast.loading(a,r):t.toast.info(a,r)}])},59471,e=>{"use strict";var t=e.i(48277),a=e.i(14575);function r({label:e,fieldId:r,description:i,error:s,required:l,className:n,labelClassName:d,fieldClassName:o,children:c}){let u=i?`${r}__description`:void 0,m=s?`${r}__error`:void 0,p=[u,m].filter(Boolean).join(" ")||void 0,x="function"==typeof c?c({describedBy:p,descriptionId:u,errorId:m,invalid:!!s}):c;return(0,t.jsxs)("div",{className:(0,a.cn)("grid gap-1 sm:grid-cols-[220px_1fr] sm:gap-4",n),children:[(0,t.jsx)("div",{className:"sm:pt-2",children:(0,t.jsxs)("label",{className:(0,a.cn)("block text-sm font-medium text-[var(--rb-text)]",d),htmlFor:r,children:[e,l?(0,t.jsx)("span",{className:"text-red-600",children:" *"}):null]})}),(0,t.jsxs)("div",{className:(0,a.cn)("min-w-0",o),children:[x,i?(0,t.jsx)("div",{id:u,className:"mt-1 text-xs text-zinc-500",children:i}):null,s?(0,t.jsx)("div",{id:m,className:"mt-1 text-xs text-red-600",children:s}):null]})]})}e.s(["FormRow",()=>r])},69025,e=>{"use strict";var t=e.i(48277),a=e.i(30668),r=e.i(96086),i=e.i(1831),s=e.i(44919),l=e.i(77252),n=e.i(19463),d=e.i(72015),o=e.i(9693),c=e.i(26550),u=e.i(59471);function m(){let e=(0,r.useRouter)(),m=(0,r.useParams)(),p=m.business??m.tenant,[x,b]=(0,a.useState)(!0),[h,g]=(0,a.useState)(!1),[f,v]=(0,a.useState)(null),[_,j]=(0,a.useState)([]),[y,w]=(0,a.useState)([]),[N,S]=(0,a.useState)([]),[F,C]=(0,a.useState)(""),[I,R]=(0,a.useState)(""),[k,P]=(0,a.useState)(null),[A,z]=(0,a.useState)(null),[$,M]=(0,a.useState)(""),[T,B]=(0,a.useState)(""),[q,E]=(0,a.useState)(""),[K,O]=(0,a.useState)(null),[U,H]=(0,a.useState)(""),[D,W]=(0,a.useState)(""),[G,J]=(0,a.useState)(""),[L,Q]=(0,a.useState)(""),[V,X]=(0,a.useState)(""),[Y,Z]=(0,a.useState)(""),[ee,et]=(0,a.useState)(!0);async function ea(t){if(t.preventDefault(),"string"==typeof p&&0!==p.length){g(!0),v(null);try{let t=F.trim();if(0===t.length)return void v("Name is required.");let a=q.trim(),r=null;if(a.length>0){let e=Number(a);if(!Number.isFinite(e))return void v("Price is invalid.");r=Math.round(100*e)}let l=L.trim(),n=null;if(l.length>0){let e=Number(l);if(!Number.isFinite(e))return void v("Installation charges is invalid.");n=Math.round(100*e)}let d=Y.trim(),o=null;if(d.length>0){let e=Number(d);if(!Number.isFinite(e))return void v("Stock is invalid.");o=Math.trunc(e)}let c={name:t,sku:""!==I.trim()?I.trim():null,part_type_id:k,part_brand_id:A,manufacturing_code:""!==$.trim()?$.trim():null,stock_code:""!==T.trim()?T.trim():null,price_amount_cents:r,tax_id:K,warranty:""!==U.trim()?U.trim():null,core_features:""!==G.trim()?G.trim():null,capacity:""!==D.trim()?D.trim():null,installation_charges_amount_cents:n,installation_message:""!==V.trim()?V.trim():null,stock:o,is_active:ee};await (0,i.apiFetch)(`/api/${p}/app/repairbuddy/parts`,{method:"POST",body:c}),s.notify.success("Part created."),e.replace(`/app/${p}/parts`)}catch(e){e instanceof i.ApiError?v(e.message):v("Failed to create part.")}finally{g(!1)}}}(0,a.useEffect)(()=>{let e=!0;return async function(){if("string"==typeof p&&0!==p.length){b(!0),v(null);try{let[t,a,r]=await Promise.all([(0,i.apiFetch)(`/api/${p}/app/repairbuddy/part-types?limit=200`),(0,i.apiFetch)(`/api/${p}/app/repairbuddy/part-brands?limit=200`),(0,i.apiFetch)(`/api/${p}/app/repairbuddy/taxes?limit=200`)]);if(!e)return;j(Array.isArray(t.part_types)?t.part_types:[]),w(Array.isArray(a.part_brands)?a.part_brands:[]),S(Array.isArray(r.taxes)?r.taxes:[])}catch(t){if(!e)return;v(t instanceof Error?t.message:"Failed to load form data."),j([]),w([]),S([])}finally{if(!e)return;b(!1)}}}(),()=>{e=!1}},[p]);let er=h||x;return(0,t.jsx)(l.RequireAuth,{requiredPermission:"parts.manage",children:(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(n.PageHeader,{title:"New part",description:"Create a new inventory part.",actions:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.Button,{variant:"outline",size:"sm",onClick:()=>{"string"==typeof p&&0!==p.length&&e.push(`/app/${p}/parts`)},children:"Cancel"}),(0,t.jsx)(o.Button,{variant:"primary",size:"sm",type:"submit",form:"rb_part_new_form",disabled:er,children:h?"Saving...":"Save"})]})}),f?(0,t.jsx)("div",{className:"text-sm text-red-600",children:f}):null,(0,t.jsx)(d.Card,{className:"shadow-none",children:(0,t.jsx)(d.CardContent,{className:"pt-5",children:(0,t.jsxs)("form",{id:"rb_part_new_form",className:"space-y-4",onSubmit:ea,children:[(0,t.jsx)(u.FormRow,{label:"Name",fieldId:"part_name",required:!0,children:(0,t.jsx)(c.Input,{id:"part_name",value:F,onChange:e=>C(e.target.value),disabled:er})}),(0,t.jsx)(u.FormRow,{label:"SKU",fieldId:"part_sku",children:(0,t.jsx)(c.Input,{id:"part_sku",value:I,onChange:e=>R(e.target.value),disabled:er})}),(0,t.jsx)(u.FormRow,{label:"Manufacturing code",fieldId:"part_manufacturing_code",children:(0,t.jsx)(c.Input,{id:"part_manufacturing_code",value:$,onChange:e=>M(e.target.value),disabled:er})}),(0,t.jsx)(u.FormRow,{label:"Stock code",fieldId:"part_stock_code",children:(0,t.jsx)(c.Input,{id:"part_stock_code",value:T,onChange:e=>B(e.target.value),disabled:er})}),(0,t.jsx)(u.FormRow,{label:"Part type",fieldId:"part_type",children:(0,t.jsxs)("select",{id:"part_type",className:"w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)]",value:k??"",onChange:e=>{let t=e.target.value;if(!t)return void P(null);let a=Number(t);P(Number.isFinite(a)?a:null)},disabled:er,children:[(0,t.jsx)("option",{value:"",children:"(none)"}),_.slice().sort((e,t)=>e.name.localeCompare(t.name)).map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]})}),(0,t.jsx)(u.FormRow,{label:"Part brand",fieldId:"part_brand",children:(0,t.jsxs)("select",{id:"part_brand",className:"w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)]",value:A??"",onChange:e=>{let t=e.target.value;if(!t)return void z(null);let a=Number(t);z(Number.isFinite(a)?a:null)},disabled:er,children:[(0,t.jsx)("option",{value:"",children:"(none)"}),y.slice().sort((e,t)=>e.name.localeCompare(t.name)).map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]})}),(0,t.jsx)(u.FormRow,{label:"Price",fieldId:"part_price",children:(0,t.jsx)(c.Input,{id:"part_price",value:q,onChange:e=>E(e.target.value),disabled:er,inputMode:"decimal"})}),(0,t.jsx)(u.FormRow,{label:"Tax",fieldId:"part_tax",children:(0,t.jsxs)("select",{id:"part_tax",className:"w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)]",value:K??"",onChange:e=>{let t=e.target.value;if(!t)return void O(null);let a=Number(t);O(Number.isFinite(a)?a:null)},disabled:er,children:[(0,t.jsx)("option",{value:"",children:"(none)"}),N.slice().sort((e,t)=>e.name.localeCompare(t.name)).map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]})}),(0,t.jsx)(u.FormRow,{label:"Warranty",fieldId:"part_warranty",children:(0,t.jsx)(c.Input,{id:"part_warranty",value:U,onChange:e=>H(e.target.value),disabled:er})}),(0,t.jsx)(u.FormRow,{label:"Capacity",fieldId:"part_capacity",children:(0,t.jsx)(c.Input,{id:"part_capacity",value:D,onChange:e=>W(e.target.value),disabled:er})}),(0,t.jsx)(u.FormRow,{label:"Core features",fieldId:"part_core_features",children:(0,t.jsx)("textarea",{id:"part_core_features",className:"w-full min-h-[96px] rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)]",value:G,onChange:e=>J(e.target.value),disabled:er})}),(0,t.jsx)(u.FormRow,{label:"Installation charges",fieldId:"part_installation_charges",children:(0,t.jsx)(c.Input,{id:"part_installation_charges",value:L,onChange:e=>Q(e.target.value),disabled:er,inputMode:"decimal"})}),(0,t.jsx)(u.FormRow,{label:"Installation message",fieldId:"part_installation_message",children:(0,t.jsx)(c.Input,{id:"part_installation_message",value:V,onChange:e=>X(e.target.value),disabled:er})}),(0,t.jsx)(u.FormRow,{label:"Stock",fieldId:"part_stock",children:(0,t.jsx)(c.Input,{id:"part_stock",value:Y,onChange:e=>Z(e.target.value),disabled:er,inputMode:"numeric"})}),(0,t.jsxs)("div",{className:"grid gap-1 sm:grid-cols-[220px_1fr] sm:gap-4",children:[(0,t.jsx)("div",{className:"sm:pt-2",children:(0,t.jsx)("span",{className:"block text-sm font-medium text-[var(--rb-text)]",children:"Active"})}),(0,t.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,t.jsx)("input",{type:"checkbox",checked:ee,onChange:e=>et(e.target.checked),disabled:er}),"Enabled"]})]})]})})})]})})}e.s(["default",()=>m])}]);