(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,19463,e=>{"use strict";var t=e.i(48277),a=e.i(14575);function r({title:e,description:r,actions:i,className:s}){return(0,t.jsxs)("div",{className:(0,a.cn)("flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between",s),children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-xl font-semibold text-[var(--rb-text)]",children:e}),r?(0,t.jsx)("p",{className:"mt-1 text-sm text-zinc-600",children:r}):null]}),i?(0,t.jsx)("div",{className:"flex items-center gap-2",children:i}):null]})}e.s(["PageHeader",()=>r])},26550,e=>{"use strict";var t=e.i(48277),a=e.i(14575);function r({className:e,type:r,...i}){return(0,t.jsx)("input",{type:r,className:(0,a.cn)("w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)] outline-none transition","placeholder:text-zinc-400","focus-visible:ring-2 focus-visible:ring-[color:color-mix(in_srgb,var(--rb-orange),white_65%)] focus-visible:ring-offset-2 focus-visible:ring-offset-white","disabled:cursor-not-allowed disabled:bg-[var(--rb-surface-muted)] disabled:opacity-70",e),...i})}e.s(["Input",()=>r])},44919,e=>{"use strict";var t=e.i(54976);e.s(["notify",0,{success:(e,a={})=>t.toast.success(e,a),error:(e,a={})=>t.toast.error(e,a),info:(e,a={})=>t.toast.info(e,a),warning:(e,a={})=>t.toast.warning(e,a),loading:(e,a={})=>t.toast.loading(e,a),dismiss(e){t.toast.dismiss(e)},message:(e,a,r={})=>"success"===e?t.toast.success(a,r):"error"===e?t.toast.error(a,r):"warning"===e?t.toast.warning(a,r):"loading"===e?t.toast.loading(a,r):t.toast.info(a,r)}])},59471,e=>{"use strict";var t=e.i(48277),a=e.i(14575);function r({label:e,fieldId:r,description:i,error:s,required:l,className:n,labelClassName:d,fieldClassName:o,children:u}){let c=i?`${r}__description`:void 0,p=s?`${r}__error`:void 0,m=[c,p].filter(Boolean).join(" ")||void 0,x="function"==typeof u?u({describedBy:m,descriptionId:c,errorId:p,invalid:!!s}):u;return(0,t.jsxs)("div",{className:(0,a.cn)("grid gap-1 sm:grid-cols-[220px_1fr] sm:gap-4",n),children:[(0,t.jsx)("div",{className:"sm:pt-2",children:(0,t.jsxs)("label",{className:(0,a.cn)("block text-sm font-medium text-[var(--rb-text)]",d),htmlFor:r,children:[e,l?(0,t.jsx)("span",{className:"text-red-600",children:" *"}):null]})}),(0,t.jsxs)("div",{className:(0,a.cn)("min-w-0",o),children:[x,i?(0,t.jsx)("div",{id:c,className:"mt-1 text-xs text-zinc-500",children:i}):null,s?(0,t.jsx)("div",{id:p,className:"mt-1 text-xs text-red-600",children:s}):null]})]})}e.s(["FormRow",()=>r])},53235,e=>{"use strict";var t=e.i(48277),a=e.i(30668),r=e.i(96086),i=e.i(1831),s=e.i(44919),l=e.i(77252),n=e.i(19463),d=e.i(72015),o=e.i(9693),u=e.i(26550),c=e.i(59471);function p(){let e=(0,r.useRouter)(),p=(0,r.useParams)(),m=p.business??p.tenant,x=p.partId,b="string"==typeof x&&x.length>0?Number(x):null,[h,g]=(0,a.useState)(!0),[f,v]=(0,a.useState)(!1),[_,j]=(0,a.useState)(null),[y,N]=(0,a.useState)([]),[w,F]=(0,a.useState)([]),[I,S]=(0,a.useState)([]),[C,k]=(0,a.useState)(""),[R,P]=(0,a.useState)(""),[A,$]=(0,a.useState)(null),[z,M]=(0,a.useState)(null),[E,T]=(0,a.useState)(""),[B,q]=(0,a.useState)(""),[U,H]=(0,a.useState)(""),[K,O]=(0,a.useState)(null),[D,W]=(0,a.useState)(""),[G,J]=(0,a.useState)(""),[L,Q]=(0,a.useState)(""),[V,X]=(0,a.useState)(""),[Y,Z]=(0,a.useState)(""),[ee,et]=(0,a.useState)(""),[ea,er]=(0,a.useState)(!0);async function ei(t){if((t.preventDefault(),"string"==typeof m&&0!==m.length)&&b&&Number.isFinite(b)&&!(b<=0)){v(!0),j(null);try{let t=C.trim();if(0===t.length)return void j("Name is required.");let a=U.trim(),r=null;if(a.length>0){let e=Number(a);if(!Number.isFinite(e))return void j("Price is invalid.");r=Math.round(100*e)}let l=V.trim(),n=null;if(l.length>0){let e=Number(l);if(!Number.isFinite(e))return void j("Installation charges is invalid.");n=Math.round(100*e)}let d=ee.trim(),o=null;if(d.length>0){let e=Number(d);if(!Number.isFinite(e))return void j("Stock is invalid.");o=Math.trunc(e)}let u={name:t,sku:""!==R.trim()?R.trim():null,part_type_id:A,part_brand_id:z,manufacturing_code:""!==E.trim()?E.trim():null,stock_code:""!==B.trim()?B.trim():null,price_amount_cents:r,tax_id:K,warranty:""!==D.trim()?D.trim():null,core_features:""!==L.trim()?L.trim():null,capacity:""!==G.trim()?G.trim():null,installation_charges_amount_cents:n,installation_message:""!==Y.trim()?Y.trim():null,stock:o,is_active:ea};await (0,i.apiFetch)(`/api/${m}/app/repairbuddy/parts/${b}`,{method:"PATCH",body:u}),s.notify.success("Part updated."),e.replace(`/app/${m}/parts`)}catch(e){e instanceof i.ApiError?j(e.message):j("Failed to update part.")}finally{v(!1)}}}(0,a.useEffect)(()=>{let e=!0;return async function(){if("string"==typeof m&&0!==m.length&&b&&Number.isFinite(b)&&!(b<=0)){g(!0),j(null);try{let[t,a,r,s]=await Promise.all([(0,i.apiFetch)(`/api/${m}/app/repairbuddy/parts/${b}`),(0,i.apiFetch)(`/api/${m}/app/repairbuddy/part-types?limit=200`),(0,i.apiFetch)(`/api/${m}/app/repairbuddy/part-brands?limit=200`),(0,i.apiFetch)(`/api/${m}/app/repairbuddy/taxes?limit=200`)]);if(!e)return;let l=t.part;k(l?.name??""),P(l?.sku??""),$("number"==typeof l?.part_type_id?l.part_type_id:null),M("number"==typeof l?.part_brand_id?l.part_brand_id:null),T(l?.manufacturing_code??""),q(l?.stock_code??""),H(l?.price?(l.price.amount_cents/100).toFixed(2):""),O("number"==typeof l?.tax_id?l.tax_id:null),W(l?.warranty??""),J(l?.capacity??""),Q(l?.core_features??""),X(l?.installation_charges?(l.installation_charges.amount_cents/100).toFixed(2):""),Z(l?.installation_message??""),et("number"==typeof l?.stock?String(l.stock):""),er(!!l?.is_active),N(Array.isArray(a.part_types)?a.part_types:[]),F(Array.isArray(r.part_brands)?r.part_brands:[]),S(Array.isArray(s.taxes)?s.taxes:[])}catch(t){if(!e)return;j(t instanceof Error?t.message:"Failed to load part.")}finally{if(!e)return;g(!1)}}}(),()=>{e=!1}},[b,m]);let es=!b||!Number.isFinite(b)||b<=0,el=f||h;return(0,t.jsx)(l.RequireAuth,{requiredPermission:"parts.manage",children:(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(n.PageHeader,{title:es?"Edit part":`Edit part #${b}`,description:"Update part details.",actions:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.Button,{variant:"outline",size:"sm",onClick:()=>{"string"==typeof m&&0!==m.length&&e.push(`/app/${m}/parts`)},children:"Cancel"}),(0,t.jsx)(o.Button,{variant:"primary",size:"sm",type:"submit",form:"rb_part_edit_form",disabled:el||es,children:f?"Saving...":"Save"})]})}),es?(0,t.jsx)("div",{className:"text-sm text-red-600",children:"Invalid part id."}):null,_?(0,t.jsx)("div",{className:"text-sm text-red-600",children:_}):null,(0,t.jsx)(d.Card,{className:"shadow-none",children:(0,t.jsx)(d.CardContent,{className:"pt-5",children:(0,t.jsxs)("form",{id:"rb_part_edit_form",className:"space-y-4",onSubmit:ei,children:[(0,t.jsx)(c.FormRow,{label:"Name",fieldId:"part_name",required:!0,children:(0,t.jsx)(u.Input,{id:"part_name",value:C,onChange:e=>k(e.target.value),disabled:el||es})}),(0,t.jsx)(c.FormRow,{label:"SKU",fieldId:"part_sku",children:(0,t.jsx)(u.Input,{id:"part_sku",value:R,onChange:e=>P(e.target.value),disabled:el||es})}),(0,t.jsx)(c.FormRow,{label:"Manufacturing code",fieldId:"part_manufacturing_code",children:(0,t.jsx)(u.Input,{id:"part_manufacturing_code",value:E,onChange:e=>T(e.target.value),disabled:el||es})}),(0,t.jsx)(c.FormRow,{label:"Stock code",fieldId:"part_stock_code",children:(0,t.jsx)(u.Input,{id:"part_stock_code",value:B,onChange:e=>q(e.target.value),disabled:el||es})}),(0,t.jsx)(c.FormRow,{label:"Part type",fieldId:"part_type",children:(0,t.jsxs)("select",{id:"part_type",className:"w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)]",value:A??"",onChange:e=>{let t=e.target.value;if(!t)return void $(null);let a=Number(t);$(Number.isFinite(a)?a:null)},disabled:el||es,children:[(0,t.jsx)("option",{value:"",children:"(none)"}),y.slice().sort((e,t)=>e.name.localeCompare(t.name)).map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]})}),(0,t.jsx)(c.FormRow,{label:"Part brand",fieldId:"part_brand",children:(0,t.jsxs)("select",{id:"part_brand",className:"w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)]",value:z??"",onChange:e=>{let t=e.target.value;if(!t)return void M(null);let a=Number(t);M(Number.isFinite(a)?a:null)},disabled:el||es,children:[(0,t.jsx)("option",{value:"",children:"(none)"}),w.slice().sort((e,t)=>e.name.localeCompare(t.name)).map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]})}),(0,t.jsx)(c.FormRow,{label:"Price",fieldId:"part_price",children:(0,t.jsx)(u.Input,{id:"part_price",value:U,onChange:e=>H(e.target.value),disabled:el||es,inputMode:"decimal"})}),(0,t.jsx)(c.FormRow,{label:"Tax",fieldId:"part_tax",children:(0,t.jsxs)("select",{id:"part_tax",className:"w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)]",value:K??"",onChange:e=>{let t=e.target.value;if(!t)return void O(null);let a=Number(t);O(Number.isFinite(a)?a:null)},disabled:el||es,children:[(0,t.jsx)("option",{value:"",children:"(none)"}),I.slice().sort((e,t)=>e.name.localeCompare(t.name)).map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]})}),(0,t.jsx)(c.FormRow,{label:"Warranty",fieldId:"part_warranty",children:(0,t.jsx)(u.Input,{id:"part_warranty",value:D,onChange:e=>W(e.target.value),disabled:el||es})}),(0,t.jsx)(c.FormRow,{label:"Capacity",fieldId:"part_capacity",children:(0,t.jsx)(u.Input,{id:"part_capacity",value:G,onChange:e=>J(e.target.value),disabled:el||es})}),(0,t.jsx)(c.FormRow,{label:"Core features",fieldId:"part_core_features",children:(0,t.jsx)("textarea",{id:"part_core_features",className:"w-full min-h-[96px] rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)]",value:L,onChange:e=>Q(e.target.value),disabled:el||es})}),(0,t.jsx)(c.FormRow,{label:"Installation charges",fieldId:"part_installation_charges",children:(0,t.jsx)(u.Input,{id:"part_installation_charges",value:V,onChange:e=>X(e.target.value),disabled:el||es,inputMode:"decimal"})}),(0,t.jsx)(c.FormRow,{label:"Installation message",fieldId:"part_installation_message",children:(0,t.jsx)(u.Input,{id:"part_installation_message",value:Y,onChange:e=>Z(e.target.value),disabled:el||es})}),(0,t.jsx)(c.FormRow,{label:"Stock",fieldId:"part_stock",children:(0,t.jsx)(u.Input,{id:"part_stock",value:ee,onChange:e=>et(e.target.value),disabled:el||es,inputMode:"numeric"})}),(0,t.jsxs)("div",{className:"grid gap-1 sm:grid-cols-[220px_1fr] sm:gap-4",children:[(0,t.jsx)("div",{className:"sm:pt-2",children:(0,t.jsx)("span",{className:"block text-sm font-medium text-[var(--rb-text)]",children:"Active"})}),(0,t.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,t.jsx)("input",{type:"checkbox",checked:ea,onChange:e=>er(e.target.checked),disabled:el||es}),"Enabled"]})]})]})})})]})})}e.s(["default",()=>p])}]);