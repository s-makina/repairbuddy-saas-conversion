(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,96855,e=>{"use strict";var t=e.i(48277),i=e.i(30668),a=e.i(96086),s=e.i(63783),r=e.i(58094),l=e.i(77252),n=e.i(1314),d=e.i(19463),c=e.i(9693),o=e.i(26550),u=e.i(59471),m=e.i(66474),p=e.i(1831),x=e.i(44919),b=e.i(62498),v=e.i(24765),h=e.i(55075),y=e.i(45117),g=e.i(8041);function j(){let e=(0,n.useAuth)(),j=(0,a.useRouter)(),f=(0,a.useParams)(),S=f.business??f.tenant,N=(0,i.useMemo)(()=>{let e=new Date,t=String(e.getFullYear()),i=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0"),s=String(e.getHours()).padStart(2,"0"),r=String(e.getMinutes()).padStart(2,"0"),l=String(e.getSeconds()).padStart(2,"0");return`RB-${t}${i}${a}-${s}${r}${l}`},[]),[_,C]=(0,i.useState)(!0),[w,A]=(0,i.useState)(!1),[I,F]=(0,i.useState)(null),[$,z]=(0,i.useState)(1),[P,D]=(0,i.useState)(""),[M,T]=(0,i.useState)(""),[k,R]=(0,i.useState)(""),[B,O]=(0,i.useState)(""),[q,E]=(0,i.useState)(null),[U,L]=(0,i.useState)(null),[H,J]=(0,i.useState)("existing"),[K,Q]=(0,i.useState)(""),[V,Y]=(0,i.useState)(""),[W,G]=(0,i.useState)(""),[X,Z]=(0,i.useState)(""),[ee,et]=(0,i.useState)(""),[ei,ea]=(0,i.useState)(""),[es,er]=(0,i.useState)(""),[el,en]=(0,i.useState)(""),[ed,ec]=(0,i.useState)(""),[eo,eu]=(0,i.useState)(""),[em,ep]=(0,i.useState)(!1),[ex,eb]=(0,i.useState)(null),[ev,eh]=(0,i.useState)([{device_id:null,option:null,serial:"",pin:"",notes:"",extra_fields:[]}]),[ey,eg]=(0,i.useState)(""),[ej,ef]=(0,i.useState)(""),[eS,eN]=(0,i.useState)(""),[e_,eC]=(0,i.useState)(""),[ew,eA]=(0,i.useState)(""),[eI,eF]=(0,i.useState)(""),[e$,ez]=(0,i.useState)(null),[eP,eD]=(0,i.useState)([]),[eM,eT]=(0,i.useState)([]),[ek,eR]=(0,i.useState)(null),[eB,eO]=(0,i.useState)([]),[eq,eE]=(0,i.useState)(!1),[eU,eL]=(0,i.useState)(null),[eH,eJ]=(0,i.useState)(""),[eK,eQ]=(0,i.useState)(""),[eV,eY]=(0,i.useState)(""),[eW,eG]=(0,i.useState)(""),[eX,eZ]=(0,i.useState)("internal"),[e0,e1]=(0,i.useState)(null),[e2,e6]=(0,i.useState)([]),[e3,e4]=(0,i.useState)([]),[e5,e8]=(0,i.useState)([]),[e7,e9]=(0,i.useState)([]),[te,tt]=(0,i.useState)([]),[ti,ta]=(0,i.useState)(!1),[ts,tr]=(0,i.useState)(null),[tl,tn]=(0,i.useState)(""),[td,tc]=(0,i.useState)(""),[to,tu]=(0,i.useState)(""),[tm,tp]=(0,i.useState)(""),[tx,tb]=(0,i.useState)(""),[tv,th]=(0,i.useState)(""),[ty,tg]=(0,i.useState)(!1),[tj,tf]=(0,i.useState)(null),[tS,tN]=(0,i.useState)(""),[t_,tC]=(0,i.useState)(""),[tw,tA]=(0,i.useState)(""),[tI,tF]=(0,i.useState)(""),[t$,tz]=(0,i.useState)(!1),[tP,tD]=(0,i.useState)(!1),[tM,tT]=(0,i.useState)(null),[tk,tR]=(0,i.useState)(null),[tB,tO]=(0,i.useState)("1"),[tq,tE]=(0,i.useState)(""),[tU,tL]=(0,i.useState)(null),[tH,tJ]=(0,i.useState)(null),[tK,tQ]=(0,i.useState)(null),[tV,tY]=(0,i.useState)("1"),[tW,tG]=(0,i.useState)(""),[tX,tZ]=(0,i.useState)(null),[t0,t1]=(0,i.useState)([]),[t2,t6]=(0,i.useState)([]),[t3,t4]=(0,i.useState)([]),[t5,t8]=(0,i.useState)([]),[t7,t9]=(0,i.useState)([]),[ie,it]=(0,i.useState)([]),[ii,ia]=(0,i.useState)([]),[is,ir]=(0,i.useState)([]),[il,id]=(0,i.useState)(!1),[ic,io]=(0,i.useState)([]),[iu,im]=(0,i.useState)(!1),[ip,ix]=(0,i.useState)("Pin"),[ib,iv]=(0,i.useState)([]),[ih,iy]=(0,i.useState)(!1),[ig,ij]=(0,i.useState)(null),[iS,iN]=(0,i.useState)(""),[i_,iC]=(0,i.useState)(""),[iw,iA]=(0,i.useState)([]),[iI,iF]=(0,i.useState)(null),[i$,iz]=(0,i.useState)("existing"),[iP,iD]=(0,i.useState)([]);(0,i.useEffect)(()=>{let e=!0;return async function(){if("string"==typeof S&&0!==S.length){C(!0),F(null);try{let[t,i]=await Promise.all([(0,p.apiFetch)(`/api/${S}/app/repairbuddy/job-statuses`),(0,p.apiFetch)(`/api/${S}/app/repairbuddy/payment-statuses`)]);if(!e)return;let a=Array.isArray(t.job_statuses)?t.job_statuses:[],s=Array.isArray(i.payment_statuses)?i.payment_statuses:[];t8(a),t9(s);try{let t=await (0,p.apiFetch)(`/api/${S}/app/repairbuddy/devices?limit=10`);if(!e)return;iv(Array.isArray(t.devices)?t.devices:[])}catch{if(!e)return;iv([])}try{let t=await (0,p.apiFetch)(`/api/${S}/app/technicians?per_page=100&sort=name&dir=asc`);if(!e)return;ia(Array.isArray(t.users)?t.users:[])}catch{if(!e)return;ia([])}try{let t=await (0,p.apiFetch)(`/api/${S}/app/branches`);if(!e)return;iD(Array.isArray(t.branches)?t.branches:[])}catch{if(!e)return;iD([])}try{let t=await (0,b.getRepairBuddySettings)(String(S));if(!e)return;id(!!t.settings?.general?.nextServiceDateEnabled),im(!!t.settings?.devicesBrands?.enablePinCodeField);let i=t.settings?.devicesBrands?.labels,a=i&&"object"==typeof i&&"string"==typeof i.pin?String(i.pin).trim():"";ix(""!==a?a:"Pin");let s=t.settings?.devicesBrands?.additionalDeviceFields,r=(Array.isArray(s)?s:[]).map(e=>{let t="string"==typeof e.id?String(e.id):"",i="string"==typeof e.label?String(e.label):"";return t&&i?{key:t,label:i}:null}).filter(e=>!!e);io(r)}catch{if(!e)return;id(!1),io([]),im(!1),ix("Pin")}let r=a.find(e=>"new"===e.slug)?.slug??a.find(e=>"neworder"===e.slug)?.slug;T(r??(a.length>0?a[0].slug:"")),R("");try{let t=await (0,p.apiFetch)(`/api/${S}/app/clients?limit=200`);if(!e)return;it(Array.isArray(t.clients)?t.clients:[])}catch{if(!e)return;it([])}try{let t=await (0,p.apiFetch)(`/api/${S}/app/repairbuddy/parts?limit=200`);if(!e)return;let i=Array.isArray(t.parts)?t.parts:[];e6(i.map(e=>({id:e.id,name:e.name,code:e.manufacturing_code??"",capacity:e.capacity??""})))}catch{if(!e)return;e6([])}try{let t=await (0,p.apiFetch)(`/api/${S}/app/repairbuddy/part-types?limit=200`);if(!e)return;e9(Array.isArray(t.part_types)?t.part_types:[])}catch{if(!e)return;e9([])}try{let t=await (0,p.apiFetch)(`/api/${S}/app/repairbuddy/part-brands?limit=200`);if(!e)return;tt(Array.isArray(t.part_brands)?t.part_brands:[])}catch{if(!e)return;tt([])}try{let t=await (0,p.apiFetch)(`/api/${S}/app/repairbuddy/services?limit=200`);if(!e)return;let i=Array.isArray(t.services)?t.services:[];e4(i.map(e=>({id:e.id,name:e.name})))}catch{if(!e)return;e4([])}try{let t=await (0,p.apiFetch)(`/api/${S}/app/repairbuddy/service-types?limit=200`);if(!e)return;e8(Array.isArray(t.service_types)?t.service_types:[])}catch{if(!e)return;e8([])}}catch(t){if(!e)return;F(t instanceof Error?t.message:"Failed to load form data."),t8([]),t9([]),it([]),ia([]),iD([]),id(!1),iv([]),e6([]),e4([]),e8([]),e9([]),tt([])}finally{if(!e)return;C(!1)}}}(),()=>{e=!1}},[S]),(0,i.useEffect)(()=>{eg(e=>""===e.trim()?N:e)},[N]);let iM=async e=>{if("string"!=typeof S||0===S.length)return[];try{let t=new URLSearchParams,i=e.trim();t.set("limit",i?"50":"10"),i&&t.set("q",i);let a=await (0,p.apiFetch)(`/api/${S}/app/repairbuddy/devices?${t.toString()}`);return(Array.isArray(a.devices)?a.devices:[]).map(e=>({value:e.id,label:e.model}))}catch{return[]}},iT=(0,i.useMemo)(()=>ie.slice().sort((e,t)=>`${e.name}`.localeCompare(`${t.name}`)),[ie]),ik=(0,i.useMemo)(()=>iT.map(e=>({value:e.id,label:e.email?`${e.name} (${e.email})`:e.name})),[iT]),iR=(0,i.useMemo)(()=>ib.slice().sort((e,t)=>`${e.model}`.localeCompare(`${t.model}`)).map(e=>({value:e.id,label:e.model})),[ib]),iB=(0,i.useMemo)(()=>{let e=ev.map(e=>e.option).filter(e=>!!e&&"number"==typeof e?.value),t=new Map;for(let i of e)t.set(i.value,i);return Array.from(t.values())},[ev]),iO=(0,i.useMemo)(()=>e2.slice().sort((e,t)=>`${e.name}`.localeCompare(`${t.name}`)).map(e=>({value:e.id,label:e.name,code:e.code,capacity:e.capacity})),[e2]),iq=(0,i.useMemo)(()=>e3.slice().sort((e,t)=>`${e.name}`.localeCompare(`${t.name}`)).map(e=>({value:e.id,label:e.name})),[e3]),iE=(0,i.useMemo)(()=>ii.slice().sort((e,t)=>`${e.name}`.localeCompare(`${t.name}`)),[ii]),iU=(0,i.useMemo)(()=>iE.map(e=>({value:e.id,label:e.email?`${e.name} (${e.email})`:e.name})),[iE]),iL=(0,i.useMemo)(()=>{if(0===eP.length)return[];let e=new Set(eP);return iU.filter(t=>e.has(t.value))},[eP,iU]),iH=(0,i.useMemo)(()=>"new"===i$?iI:iL.length>0?iL[0]:null,[iL,i$,iI]);(0,i.useMemo)(()=>is.slice().sort((e,t)=>`${e.label}`.localeCompare(`${t.label}`)).map(e=>({value:e.id,label:e.serial?`${e.label} (Serial: ${e.serial})`:e.label})),[is]),(0,i.useEffect)(()=>{let t=!0;return async function(){if("string"==typeof S&&0!==S.length){if("number"!=typeof q){ir([]),eT([]),eR(null);return}if(!e.can("customer_devices.view")){ir([]),eT([]),eR("You do not have permission to view customer devices.");return}try{let e=await (0,p.apiFetch)(`/api/${S}/app/repairbuddy/customer-devices?customer_id=${encodeURIComponent(String(q))}&limit=200`);if(!t)return;ir(Array.isArray(e.customer_devices)?e.customer_devices:[]),eR(null)}catch{if(!t)return;ir([]),eR("Failed to load customer devices.")}}}(),()=>{t=!1}},[e,q,S]);let iJ=async e=>{if("string"!=typeof S||0===S.length)return[];try{let t=new URLSearchParams;t.set("limit","50");let i=e.trim();i&&t.set("query",i);let a=await (0,p.apiFetch)(`/api/${S}/app/clients?${t.toString()}`);return(Array.isArray(a.clients)?a.clients:[]).map(e=>({value:e.id,label:e.email?`${e.name} (${e.email})`:e.name}))}catch{return[]}};async function iK(e){if(e.preventDefault(),"string"!=typeof S||0===S.length||w)return;let t=e.nativeEvent,i=t?.submitter,a=i?.getAttribute?.("id")??"";if(3===$&&"rb_job_save"===a){F(null),A(!0);try{let e="new"===H;if(e){if(""===K.trim())return void F("Customer name is required.");if(""===V.trim())return void F("Customer email is required.")}let t=P.trim(),i={devices:ev.length>0?ev.filter(e=>"number"==typeof e.device_id).map(e=>({device_id:e.device_id,serial:""!==e.serial.trim()?e.serial.trim():null,pin:""!==e.pin.trim()?e.pin.trim():null,notes:""!==e.notes.trim()?e.notes.trim():null,extra_fields:Array.isArray(e.extra_fields)&&e.extra_fields.length>0?e.extra_fields.map(e=>({key:"string"==typeof e?.key?e.key:"",label:"string"==typeof e?.label?e.label:"",value_text:"string"==typeof e?.value_text?e.value_text:""})).filter(e=>e.key&&e.label):[]})):[],case_number:""!==ey.trim()?ey.trim():null,title:""!==t?t:null,status_slug:""!==M.trim()?M:null,payment_status_slug:""!==k.trim()?k:null,priority:""!==B.trim()?B.trim():null,customer_id:e||"number"!=typeof q?null:q,pickup_date:""!==ej.trim()?ej:null,delivery_date:""!==eS.trim()?eS:null,next_service_date:il&&""!==e_.trim()?e_:null,case_detail:""!==ew.trim()?ew.trim():null,assigned_technician_id:eP.length>0?eP[0]:null,assigned_technician_ids:eP,job_devices:eM.length>0?eM.map(e=>({customer_device_id:e.customer_device_id,serial:""!==e.serial.trim()?e.serial.trim():null,notes:""!==e.notes.trim()?e.notes.trim():null})):[],wc_order_note:""!==eI.trim()?eI.trim():null};e&&(i.customer_create={name:K.trim(),email:V.trim(),phone:""!==W.trim()?W.trim():null,company:""!==X.trim()?X.trim():null,address_line1:""!==ee.trim()?ee.trim():null,address_line2:""!==ei.trim()?ei.trim():null,address_city:""!==es.trim()?es.trim():null,address_state:""!==el.trim()?el.trim():null,address_postal_code:""!==ed.trim()?ed.trim():null,address_country:""!==eo.trim()?eo.trim():null});let a=new FormData;a.append("payload_json",JSON.stringify(i)),e$&&a.append("job_file",e$);let s=await (0,p.apiFetch)(`/api/${S}/app/repairbuddy/jobs`,{method:"POST",body:a}),r=s.job?.id;if("number"==typeof r){try{for(let e of t2){let t=Math.round(Number(e.qty)),i=Number.isFinite(t)&&t>0?t:1,a=e.price.trim(),s=a.length>0?Number(a):NaN,l=Number.isFinite(s)?Math.round(100*s):void 0;await (0,p.apiFetch)(`/api/${S}/app/repairbuddy/jobs/${r}/items`,{method:"POST",body:{item_type:"service",ref_id:e.service_id,qty:i,..."number"==typeof l?{unit_price_amount_cents:l}:{},meta:{..."number"==typeof e.device_id?{device_id:e.device_id}:{}}}})}for(let e of t3){let t=e.name.trim();if(""===t)continue;let i=Math.round(Number(e.qty)),a=Number.isFinite(i)&&i>0?i:1,s=e.price.trim(),l=s.length>0?Number(s):NaN,n=Number.isFinite(l)?Math.round(100*l):void 0;"number"==typeof n&&await (0,p.apiFetch)(`/api/${S}/app/repairbuddy/jobs/${r}/items`,{method:"POST",body:{item_type:n<0?"discount":"fee",name:t,qty:a,unit_price_amount_cents:n}})}for(let e of t0){let t=Math.round(Number(e.qty)),i=Number.isFinite(t)&&t>0?t:1,a=e.price.trim(),s=a.length>0?Number(a):NaN,l=Number.isFinite(s)?Math.round(100*s):void 0;await (0,p.apiFetch)(`/api/${S}/app/repairbuddy/jobs/${r}/items`,{method:"POST",body:{item_type:"part",ref_id:e.part_id,qty:i,..."number"==typeof l?{unit_price_amount_cents:l}:{},meta:{..."number"==typeof e.device_id?{device_id:e.device_id}:{}}}})}}catch(e){x.notify.error(e instanceof p.ApiError?e.message:"Job created, but failed to attach items.")}x.notify.success("Job created."),j.replace(`/app/${S}/jobs/${r}`)}else x.notify.success("Job created."),j.replace(`/app/${S}/jobs`)}catch(e){e instanceof p.ApiError?F(e.message):F("Failed to create job.")}finally{A(!1)}}}let iQ=w||_,iV=1===$,iY=2===$;return(0,t.jsx)(l.RequireAuth,{requiredPermission:"jobs.view",children:(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(d.PageHeader,{title:"New job",description:"Create a new repair job.",actions:(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(c.Button,{variant:"outline",size:"sm",onClick:()=>{"string"==typeof S&&0!==S.length&&j.push(`/app/${S}/jobs`)},disabled:w,children:"Cancel"})})}),I?(0,t.jsx)("div",{className:"text-sm text-red-600",children:I}):null,(0,t.jsx)(y.CustomerCreateModal,{open:em,title:"Add customer",className:"max-w-3xl",disabled:iQ,error:ex,setError:eb,name:K,setName:Q,email:V,setEmail:Y,phone:W,setPhone:G,company:X,setCompany:Z,addressLine1:ee,setAddressLine1:et,addressLine2:ei,setAddressLine2:ea,addressCity:es,setAddressCity:er,addressState:el,setAddressState:en,addressPostalCode:ed,setAddressPostalCode:ec,addressCountry:eo,setAddressCountry:eu,onClose:()=>ep(!1),onSave:({name:e,email:t,phone:i,company:a,address_line1:s,address_line2:r,address_city:l,address_state:n,address_postal_code:d,address_country:c})=>{J("new"),E(null),L({value:-1,label:`${e} (${t})`}),eT([]),G(i),Z(a),et(s??""),ea(r??""),er(l??""),en(n??""),ec(d??""),eu(c??""),ep(!1)}}),(0,t.jsx)(m.Modal,{open:tP,title:"Add service",onClose:()=>{tZ(null),tD(!1)},className:"max-w-3xl",footer:(0,t.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,t.jsx)(c.Button,{type:"button",variant:"outline",onClick:()=>{tZ(null),tD(!1)},children:"Cancel"}),(0,t.jsx)(c.Button,{type:"button",variant:"primary",disabled:iQ,onClick:()=>{if(!tH)return void tZ("Please select a service.");if(!tK)return void tZ("Please select a device.");let e=e3.find(e=>e.id===tH.value);if(!e)return void tZ("Selected service not found.");let t=globalThis.crypto,i="function"==typeof t?.randomUUID?t.randomUUID():`js-${Date.now()}-${Math.random().toString(16).slice(2)}`;t6(t=>[{id:i,service_id:e.id,service:e,device_id:tK.value,qty:tV,price:tW},...t]),tZ(null),tY("1"),tG(""),tD(!1)},children:"Add"})]}),children:(0,t.jsxs)("div",{className:"space-y-4",children:[tX?(0,t.jsx)("div",{className:"text-sm text-red-600",children:tX}):null,(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Service"}),(0,t.jsx)(s.default,{instanceId:"job_service_select",inputId:"job_service_select",isSearchable:!0,isClearable:!0,options:iq,value:tH,onChange:e=>{tZ(null),tJ(e??null)},isDisabled:iQ,placeholder:iq.length>0?"Search services...":"No services yet",classNamePrefix:"rb-select",styles:{control:e=>({...e,borderRadius:"var(--rb-radius-sm)",borderColor:"#d4d4d8",minHeight:40,boxShadow:"none"}),menu:e=>({...e,zIndex:50})}})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Device"}),(0,t.jsx)(s.default,{instanceId:"job_service_device_select",inputId:"job_service_device_select",isSearchable:!0,isClearable:!0,options:iB,value:tK,onChange:e=>{tZ(null),tQ(e??null)},isDisabled:iQ,placeholder:iB.length>0?"Select device...":"No devices selected",classNamePrefix:"rb-select",styles:{control:e=>({...e,borderRadius:"var(--rb-radius-sm)",borderColor:"#d4d4d8",minHeight:40,boxShadow:"none"}),menu:e=>({...e,zIndex:50})}})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Qty"}),(0,t.jsx)(o.Input,{type:"number",min:0,value:tV,disabled:iQ,onChange:e=>{tZ(null),tY(e.target.value)}})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Price (optional override)"}),(0,t.jsx)(o.Input,{type:"number",min:0,step:"0.01",value:tW,disabled:iQ,onChange:e=>{tZ(null),tG(e.target.value)}})]})]})]})}),(0,t.jsx)(m.Modal,{open:t$,title:"Add part",onClose:()=>{tL(null),tz(!1)},className:"max-w-3xl",footer:(0,t.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,t.jsx)(c.Button,{type:"button",variant:"outline",onClick:()=>{tL(null),tz(!1)},children:"Cancel"}),(0,t.jsx)(c.Button,{type:"button",variant:"primary",disabled:iQ,onClick:()=>{if(!tM)return void tL("Please select a part.");if(!tk)return void tL("Please select a device.");let e=e2.find(e=>e.id===tM.value);if(!e)return void tL("Selected part not found.");let t=globalThis.crypto,i="function"==typeof t?.randomUUID?t.randomUUID():`jp-${Date.now()}-${Math.random().toString(16).slice(2)}`;t1(t=>[{id:i,part_id:e.id,part:e,device_id:tk.value,qty:tB,price:tq},...t]),tL(null),tO("1"),tE(""),tz(!1)},children:"Add"})]}),children:(0,t.jsxs)("div",{className:"space-y-4",children:[tU?(0,t.jsx)("div",{className:"text-sm text-red-600",children:tU}):null,(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Select part"}),(0,t.jsx)(s.default,{instanceId:"job_part_select",isSearchable:!0,isClearable:!0,options:iO,value:tM,onChange:e=>{tL(null),tT(e??null)},isDisabled:iQ,placeholder:iO.length>0?"Search parts...":"No parts yet",classNamePrefix:"rb-select",styles:{control:e=>({...e,borderRadius:"var(--rb-radius-sm)",borderColor:"#d4d4d8",minHeight:40,boxShadow:"none"}),menu:e=>({...e,zIndex:50})}})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Device"}),(0,t.jsx)(s.default,{instanceId:"job_part_device",isSearchable:!0,isClearable:!0,options:iB,value:tk,onChange:e=>{tL(null),tR(e??null)},isDisabled:iQ,placeholder:iB.length>0?"Select device...":"No devices selected",classNamePrefix:"rb-select",styles:{control:e=>({...e,borderRadius:"var(--rb-radius-sm)",borderColor:"#d4d4d8",minHeight:40,boxShadow:"none"}),menu:e=>({...e,zIndex:50})}})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Qty"}),(0,t.jsx)(o.Input,{type:"number",min:0,value:tB,disabled:iQ,onChange:e=>{tL(null),tO(e.target.value)}})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Price"}),(0,t.jsx)(o.Input,{type:"number",min:0,step:"0.01",value:tq,disabled:iQ,onChange:e=>{tL(null),tE(e.target.value)}})]})]})]})}),(0,t.jsx)(m.Modal,{open:ty,title:"Create new service",onClose:()=>{tf(null),tg(!1)},className:"max-w-2xl",footer:(0,t.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,t.jsx)(c.Button,{type:"button",variant:"outline",onClick:()=>{tf(null),tg(!1)},children:"Cancel"}),(0,t.jsx)(c.Button,{type:"button",variant:"primary",disabled:iQ,onClick:async()=>{if(w||"string"!=typeof S||0===S.length)return;let e=tS.trim();if(0===e.length)return void tf("Service name is required.");let t=tI.trim(),i=t.length>0?Number(t):NaN,a=Number.isFinite(i)?Math.round(100*i):null;if(t.length>0&&null===a)return void tf("Base price is invalid.");let s=t_.trim(),r=""!==s?Number(s):NaN,l=Number.isFinite(r)&&r>0?Math.trunc(r):null;if(e5.length>0&&null===l)return void tf("Service type is required.");let n=tw.trim();A(!0),tf(null);try{let t=(await (0,p.apiFetch)(`/api/${S}/app/repairbuddy/services`,{method:"POST",body:{name:e,..."number"==typeof l?{service_type_id:l}:{},...""!==n?{service_code:n}:{},..."number"==typeof a?{base_price_amount_cents:a}:{}}})).service;if(!t||"number"!=typeof t.id)return void tf("Failed to create service.");let i={id:t.id,name:t.name};e4(e=>[i,...e.filter(e=>e.id!==i.id)]),tJ({value:i.id,label:i.name}),tN(""),tC(""),tA(""),tF(""),tg(!1),x.notify.success("Service created.")}catch(e){e instanceof p.ApiError?tf(e.message):tf("Failed to create service.")}finally{A(!1)}},children:"Save"})]}),children:(0,t.jsxs)("div",{className:"space-y-4",children:[tj?(0,t.jsx)("div",{className:"text-sm text-red-600",children:tj}):null,(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Service name"}),(0,t.jsx)(o.Input,{value:tS,onChange:e=>tN(e.target.value),disabled:iQ})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Select type"}),(0,t.jsxs)("select",{className:"w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)]",value:t_,onChange:e=>{tf(null),tC(e.target.value)},disabled:iQ||0===e5.length,children:[(0,t.jsx)("option",{value:"",children:e5.length>0?"Select type...":"No types available"}),e5.map(e=>(0,t.jsx)("option",{value:String(e.id),children:e.name},e.id))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Service code"}),(0,t.jsx)(o.Input,{value:tw,onChange:e=>{tf(null),tA(e.target.value)},disabled:iQ})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Service price"}),(0,t.jsx)(o.Input,{type:"number",min:0,step:"0.01",value:tI,onChange:e=>{tf(null),tF(e.target.value)},disabled:iQ})]})]})]})}),(0,t.jsx)(m.Modal,{open:ti,title:"Create new part",onClose:()=>{tr(null),ta(!1)},className:"max-w-2xl",footer:(0,t.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,t.jsx)(c.Button,{type:"button",variant:"outline",onClick:()=>{tr(null),ta(!1)},children:"Cancel"}),(0,t.jsx)(c.Button,{type:"button",variant:"primary",disabled:iQ,onClick:async()=>{if(w||"string"!=typeof S||0===S.length)return;let e=tl.trim();if(0===e.length)return void tr("Part name is required.");let t=td.trim();if(0===t.length)return void tr("Part price is required.");let i=Number(t),a=Number.isFinite(i)?Math.round(100*i):null;if(null===a||a<0)return void tr("Part price is invalid.");let s=tm.trim(),r=""!==s?Number(s):NaN,l=Number.isFinite(r)&&r>0?Math.trunc(r):null;if(e7.length>0&&null===l)return void tr("Part type is required.");let n=to.trim(),d=""!==n?Number(n):NaN,c=Number.isFinite(d)&&d>0?Math.trunc(d):null;if(te.length>0&&null===c)return void tr("Part brand is required.");let o=tx.trim(),u=tv.trim();A(!0),tr(null);try{let t=(await (0,p.apiFetch)(`/api/${S}/app/repairbuddy/parts`,{method:"POST",body:{name:e,price_amount_cents:a,..."number"==typeof l?{part_type_id:l}:{},..."number"==typeof c?{part_brand_id:c}:{},manufacturing_code:""!==o?o:null,stock_code:""!==u?u:null}})).part;if(!t||"number"!=typeof t.id)return void tr("Failed to create part.");let i={id:t.id,name:t.name,code:t.manufacturing_code??"",capacity:t.capacity??""};e6(e=>[i,...e.filter(e=>e.id!==i.id)]),tT({value:i.id,label:i.name,code:i.code,capacity:i.capacity}),tn(""),tc(""),tu(""),tp(""),tb(""),th(""),ta(!1),x.notify.success("Part created.")}catch(e){e instanceof p.ApiError?tr(e.message):tr("Failed to create part.")}finally{A(!1)}},children:"Save"})]}),children:(0,t.jsxs)("div",{className:"space-y-4",children:[ts?(0,t.jsx)("div",{className:"text-sm text-red-600",children:ts}):null,(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Part name"}),(0,t.jsx)(o.Input,{value:tl,onChange:e=>{tr(null),tn(e.target.value)},disabled:iQ})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Part price"}),(0,t.jsx)(o.Input,{type:"number",min:0,step:"0.01",value:td,onChange:e=>{tr(null),tc(e.target.value)},disabled:iQ})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Select brand"}),(0,t.jsxs)("select",{className:"w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)]",value:to,onChange:e=>{tr(null),tu(e.target.value)},disabled:iQ||0===te.length,children:[(0,t.jsx)("option",{value:"",children:te.length>0?"Select brand...":"No brands available"}),te.map(e=>(0,t.jsx)("option",{value:String(e.id),children:e.name},e.id))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Select type"}),(0,t.jsxs)("select",{className:"w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)]",value:tm,onChange:e=>{tr(null),tp(e.target.value)},disabled:iQ||0===e7.length,children:[(0,t.jsx)("option",{value:"",children:e7.length>0?"Select type...":"No types available"}),e7.map(e=>(0,t.jsx)("option",{value:String(e.id),children:e.name},e.id))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Manufacturing code"}),(0,t.jsx)(o.Input,{value:tx,onChange:e=>{tr(null),tb(e.target.value)},disabled:iQ})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Stock code"}),(0,t.jsx)(o.Input,{value:tv,onChange:e=>{tr(null),th(e.target.value)},disabled:iQ})]})]})]})}),(0,t.jsx)(m.Modal,{open:eq,title:"Add extra field",onClose:()=>{eL(null),eE(!1)},className:"max-w-3xl",footer:(0,t.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,t.jsx)(c.Button,{type:"button",variant:"outline",onClick:()=>{eL(null),eE(!1)},children:"Cancel"}),(0,t.jsx)(c.Button,{type:"button",onClick:()=>{let e=eK.trim(),t=eV.trim();""===e?eL("Field label is required."):""===t?eL("Field data is required."):(eO(i=>[...i,{id:String(Date.now()),datetime:eH,label:e,data:t,description:eW.trim(),visibility:eX,file:e0}]),eL(null),eJ(""),eQ(""),eY(""),eG(""),eZ("internal"),e1(null),eE(!1))},children:"Save"})]}),children:(0,t.jsxs)("div",{className:"space-y-4",children:[eU?(0,t.jsx)("div",{className:"text-sm text-red-600",children:eU}):null,(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Date & time"}),(0,t.jsx)(o.Input,{type:"datetime-local",value:eH,onChange:e=>eJ(e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Visibility"}),(0,t.jsxs)("select",{className:"w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)]",value:eX,onChange:e=>eZ(e.target.value),children:[(0,t.jsx)("option",{value:"internal",children:"Internal"}),(0,t.jsx)("option",{value:"customer",children:"Customer"})]})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Field label"}),(0,t.jsx)(o.Input,{value:eK,onChange:e=>eQ(e.target.value)})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Field data"}),(0,t.jsx)("textarea",{value:eV,onChange:e=>eY(e.target.value),rows:3,className:"w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)]"})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Field description"}),(0,t.jsx)("textarea",{value:eW,onChange:e=>eG(e.target.value),rows:2,className:"w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)]"})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"File"}),(0,t.jsx)(o.Input,{type:"file",onChange:e=>{e1(e.target.files?.[0]??null)}})]})]})]})}),(0,t.jsx)(m.Modal,{open:ih,title:"Add technician",onClose:()=>{ij(null),iy(!1)},footer:(0,t.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,t.jsx)(c.Button,{type:"button",variant:"outline",onClick:()=>{ij(null),iy(!1)},children:"Cancel"}),(0,t.jsx)(c.Button,{type:"button",disabled:iQ,onClick:async()=>{if(w||"string"!=typeof S||0===S.length)return;let e=iS.trim(),t=i_.trim();if(""===e)return void ij("Technician name is required.");if(""===t)return void ij("Technician email is required.");let i=iw.filter(e=>"number"==typeof e&&e>0);if(0===i.length)return void ij("Please select at least one shop.");A(!0),ij(null);try{let a=(await (0,p.apiFetch)(`/api/${S}/app/technicians`,{method:"POST",body:{name:e,email:t,branch_ids:i}})).user;if(!a||"number"!=typeof a.id)return void ij("Failed to create technician.");ia(e=>[a,...e.filter(e=>e.id!==a.id)]),iz("existing"),iF(null),eD([a.id]),iN(""),iC(""),iA([]),iy(!1),x.notify.success("Technician created.")}catch(e){e instanceof p.ApiError?ij(e.message):ij("Failed to create technician.")}finally{A(!1)}},children:"Save"})]}),children:(0,t.jsxs)("div",{className:"space-y-4",children:[ig?(0,t.jsx)("div",{className:"text-sm text-red-600",children:ig}):null,(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Name"}),(0,t.jsx)(o.Input,{value:iS,onChange:e=>{ij(null),iN(e.target.value)},disabled:iQ})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Email"}),(0,t.jsx)(o.Input,{value:i_,onChange:e=>{ij(null),iC(e.target.value)},disabled:iQ})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Shops"}),(0,t.jsxs)("select",{multiple:!0,className:"w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)]",value:iw.map(String),onChange:e=>{ij(null),iA(Array.from(e.target.selectedOptions).map(e=>Number(e.value)).filter(e=>Number.isFinite(e)&&e>0).map(e=>Math.trunc(e)))},disabled:iQ||0===iP.length,children:[0===iP.length?(0,t.jsx)("option",{value:"",children:"No shops available"}):null,iP.map(e=>(0,t.jsx)("option",{value:String(e.id),children:e.name},e.id))]}),(0,t.jsx)("div",{className:"mt-1 text-xs text-zinc-500",children:"Hold Ctrl / Cmd to select multiple shops."})]})]})]})}),(0,t.jsx)("form",{id:"rb_job_new_form",className:"space-y-6",onSubmit:iK,children:(0,t.jsx)(v.WizardShell,{steps:[{id:1,navTitle:"Customer & devices",navDescription:"Case, dates, customer, technician, description, devices.",pageTitle:"Customer & devices",pageDescription:"Enter the customer, technician, description and devices.",footerTitle:"Customer & devices"},{id:2,navTitle:"Job Items and services",navDescription:"Attach extra fields and files for this job.",pageTitle:"Job Items and services",pageDescription:"Attach extra fields and files for the job.",footerTitle:"Job Items and services"},{id:3,navTitle:"Order information",navDescription:"Status, payment, priority, notes.",pageTitle:"Order information",pageDescription:"Finalize status, payment, priority and notes.",footerTitle:"Order information"}],step:$,disabled:iQ,sidebarTitle:"Job steps",sidebarDescription:"Complete the steps to create the job.",sidebarAriaLabel:"Job steps",onStepChange:e=>{F(null),z(e)},footerRight:(0,t.jsx)(c.Button,{id:"rb_job_save",variant:"primary",disabled:iQ,type:"submit",children:w?"Saving...":"Save"}),children:iV?(0,t.jsxs)("div",{className:"space-y-5",children:[(0,t.jsx)(u.FormRow,{label:"Case number",fieldId:"job_case_number",children:(0,t.jsx)(o.Input,{id:"job_case_number",value:ey,onChange:e=>eg(e.target.value),disabled:iQ})}),(0,t.jsx)(u.FormRow,{label:"Dates",fieldId:"job_dates",children:(0,t.jsxs)("div",{className:il?"grid grid-cols-1 gap-3 md:grid-cols-3":"grid grid-cols-1 gap-3 md:grid-cols-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Pickup date"}),(0,t.jsx)(o.Input,{id:"job_pickup_date",type:"date",value:ej,onChange:e=>ef(e.target.value),disabled:iQ})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Delivery date"}),(0,t.jsx)(o.Input,{id:"job_delivery_date",type:"date",value:eS,onChange:e=>eN(e.target.value),disabled:iQ})]}),il?(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"mb-1 text-xs text-zinc-600",children:"Next service date"}),(0,t.jsx)(o.Input,{id:"job_next_service_date",type:"date",value:e_,onChange:e=>eC(e.target.value),disabled:iQ})]}):null]})}),(0,t.jsx)(u.FormRow,{label:"Customer",fieldId:"job_customer",children:(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[(0,t.jsx)("div",{className:"min-w-0 flex-1",children:(0,t.jsx)(r.default,{inputId:"job_customer",instanceId:"job_customer",cacheOptions:!0,defaultOptions:ik,loadOptions:iJ,isClearable:!0,isSearchable:!0,value:U,onChange:e=>{let t=e??null;J("existing"),L(t),E("number"==typeof t?.value&&t.value>0?t.value:null),eT([])},isDisabled:iQ,placeholder:"Search customers...",classNamePrefix:"rb-select",styles:{control:e=>({...e,borderRadius:"var(--rb-radius-sm)",borderColor:"#d4d4d8",minHeight:40,boxShadow:"none"}),menu:e=>({...e,zIndex:50})}})}),(0,t.jsx)(c.Button,{type:"button",variant:"primary",size:"md",className:"w-10 px-0",disabled:iQ,onClick:()=>{eb(null),ep(!0)},children:"+"})]}),"new"===H?(0,t.jsx)("div",{className:"text-xs text-zinc-600",children:"This job will create a new customer."}):null]})}),(0,t.jsx)(u.FormRow,{label:"Technician",fieldId:"job_technician",children:(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[(0,t.jsx)("div",{className:"min-w-0 flex-1",children:(0,t.jsx)(s.default,{inputId:"job_technician",instanceId:"job_technician",isSearchable:!0,isClearable:!0,options:iU,value:iH,onChange:e=>{let t=e??null;iz("existing"),iF(null),eD("number"==typeof t?.value&&t.value>0?[t.value]:[])},isDisabled:iQ||0===iU.length,placeholder:iU.length>0?"Select technician...":"No technicians available",classNamePrefix:"rb-select",styles:{control:e=>({...e,borderRadius:"var(--rb-radius-sm)",borderColor:"#d4d4d8",minHeight:40,boxShadow:"none"}),menu:e=>({...e,zIndex:50})}})}),(0,t.jsx)(c.Button,{type:"button",variant:"primary",size:"md",className:"w-10 px-0",disabled:iQ,onClick:()=>{ij(null),iy(!0)},children:"+"})]}),"new"===i$?(0,t.jsx)("div",{className:"text-xs text-zinc-600",children:"This job will create a new technician."}):null]})}),(0,t.jsx)(u.FormRow,{label:"Job description",fieldId:"job_case_detail",children:(0,t.jsx)("textarea",{id:"job_case_detail",value:ew,onChange:e=>eA(e.target.value),disabled:iQ,rows:4,placeholder:"Enter job description.",className:"w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)]"})}),(0,t.jsx)(u.FormRow,{label:"Add devices to this job",fieldId:"job_devices_admin",children:(0,t.jsx)(h.DevicesAdminEditor,{value:ev,onChange:e=>eh(e),deviceOptions:iR,loadDeviceOptions:iM,disabled:iQ,idPrefix:"job",showPin:iu,serialLabel:"Device ID / IMEI",pinLabel:ip,notesLabel:"Device note",addButtonLabel:"Add device",additionalFields:ic,createEmptyRow:()=>({device_id:null,option:null,serial:"",pin:"",notes:"",extra_fields:ic.map(e=>({key:e.key,label:e.label,value_text:""}))})})})]}):iY?(0,t.jsxs)("div",{className:"space-y-5",children:[(0,t.jsx)(g.ItemsStep,{deviceContextOptions:iB.map(e=>({value:e.value,label:e.label})),disabled:iQ,services:t2,setServices:t6,parts:t0,setParts:t1,otherItems:t3,setOtherItems:t4,onAddService:()=>{tZ(null),!tK&&iB.length>0&&tQ(iB[0]),tD(!0)},serviceAddLabel:"Add service",onCreateService:()=>{tf(null),tg(!0)},serviceCreateLabel:"Create new service",onAddPart:()=>{tL(null),!tk&&iB.length>0&&tR(iB[0]),tz(!0)},partAddLabel:"Add part",onCreatePart:()=>{tr(null),ta(!0)},partCreateLabel:"Create new part",otherItemsTitle:"Other items",otherItemsDescription:"Add custom line items like rent, used cable, etc.",otherItemsAddLabel:"Add other item",createOtherItem:()=>({id:"u">typeof crypto&&"randomUUID"in crypto?crypto.randomUUID():`oi-${Date.now()}-${Math.random().toString(16).slice(2)}`,name:"",qty:"1",price:""}),otherItemNamePlaceholder:"e.g. Rent, Used cable",otherItemPricePlaceholder:"e.g. 10.00 (use -10.00 for discount)"}),(0,t.jsx)("div",{className:"rounded-[var(--rb-radius-md)] border border-[var(--rb-border)] bg-white px-4 py-3",children:(0,t.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:"Attach Fields & Files"}),(0,t.jsx)("div",{className:"mt-1 text-xs text-zinc-600",children:"Add extra fields and optionally attach a file."})]}),(0,t.jsx)("div",{children:(0,t.jsx)(c.Button,{type:"button",variant:"outline",size:"sm",disabled:iQ,onClick:()=>{eL(null),eE(!0)},children:"Add extra field"})})]})}),eB.length>0?(0,t.jsx)("div",{className:"space-y-2",children:eB.map(e=>(0,t.jsxs)("div",{className:"flex flex-col gap-2 rounded-[var(--rb-radius-md)] border border-[var(--rb-border)] bg-white px-4 py-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsx)("div",{className:"truncate text-sm font-semibold text-[var(--rb-text)]",children:e.label}),(0,t.jsxs)("div",{className:"mt-1 text-xs text-zinc-600",children:[e.datetime?e.datetime:"—",(0,t.jsx)("span",{className:"mx-2",children:"•"}),e.visibility,e.file?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"mx-2",children:"•"}),e.file.name]}):null]}),e.description?(0,t.jsx)("div",{className:"mt-1 text-xs text-zinc-500",children:e.description}):null]}),(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsx)(c.Button,{type:"button",variant:"outline",size:"sm",disabled:iQ,onClick:()=>{eO(t=>t.filter(t=>t.id!==e.id))},children:"Remove"})})]},e.id))}):(0,t.jsx)("div",{className:"text-sm text-zinc-600",children:"No extra fields added yet."})]}):(0,t.jsxs)("div",{className:"space-y-5",children:[(0,t.jsx)(u.FormRow,{label:"Status",fieldId:"job_status",required:!0,children:(0,t.jsx)("select",{id:"job_status",className:"w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)]",value:M,onChange:e=>T(e.target.value),disabled:iQ||0===t5.length,children:t5.map(e=>(0,t.jsx)("option",{value:e.slug,children:e.label},e.slug))})}),(0,t.jsx)(u.FormRow,{label:"Payment status",fieldId:"job_payment",children:(0,t.jsxs)("select",{id:"job_payment",className:"w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)]",value:k,onChange:e=>R(e.target.value),disabled:iQ||0===t7.length,children:[(0,t.jsx)("option",{value:"",children:"—"}),t7.map(e=>(0,t.jsx)("option",{value:e.slug,children:e.label},e.slug))]})}),(0,t.jsx)(u.FormRow,{label:"Priority",fieldId:"job_priority",children:(0,t.jsxs)("select",{id:"job_priority",className:"w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)]",value:B,onChange:e=>O(e.target.value),disabled:iQ,children:[(0,t.jsx)("option",{value:"",children:"—"}),(0,t.jsx)("option",{value:"low",children:"Low"}),(0,t.jsx)("option",{value:"normal",children:"Normal"}),(0,t.jsx)("option",{value:"high",children:"High"}),(0,t.jsx)("option",{value:"urgent",children:"Urgent"})]})}),(0,t.jsx)(u.FormRow,{label:"Order notes",fieldId:"job_order_note",description:"Visible to customer.",children:(0,t.jsx)("textarea",{id:"job_order_note",value:eI,onChange:e=>eF(e.target.value),disabled:iQ,rows:3,placeholder:"Add a note for the customer...",className:"w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)]"})})]})})})]})})}e.s(["default",()=>j])}]);