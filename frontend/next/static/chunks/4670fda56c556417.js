(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,66474,e=>{"use strict";var r=e.i(48277),t=e.i(30668),a=e.i(14575);function s({open:e,onClose:s,title:i,children:l,footer:n,position:d="center",variant:c="glass",className:o}){if((0,t.useEffect)(()=>{function r(r){e&&"Escape"===r.key&&s()}return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[s,e]),!e)return null;let m="solid"===c?(0,a.cn)("relative w-full max-w-lg overflow-hidden rounded-[var(--rb-radius-lg)]","border border-[var(--rb-border)]","bg-white","shadow-[var(--rb-shadow)]"):(0,a.cn)("relative w-full max-w-lg overflow-hidden rounded-[var(--rb-radius-lg)]","border border-[color:color-mix(in_srgb,var(--rb-border),white_55%)]","bg-white/75 backdrop-blur-xl","shadow-[0_18px_55px_-18px_rgba(0,0,0,0.55)]","ring-1 ring-white/25");return(0,r.jsxs)("div",{className:"top-center"===d?"fixed inset-0 z-50 flex items-start justify-center px-4 pt-8":"fixed inset-0 z-50 flex items-center justify-center px-4",children:[(0,r.jsx)("button",{type:"button",className:(0,a.cn)("absolute inset-0","bg-black/35 backdrop-blur-md","bg-[radial-gradient(900px_600px_at_20%_20%,color-mix(in_srgb,#16a34a,transparent_82%)_0%,transparent_60%),radial-gradient(900px_600px_at_80%_30%,color-mix(in_srgb,var(--rb-blue),transparent_82%)_0%,transparent_60%),radial-gradient(900px_600px_at_50%_85%,color-mix(in_srgb,var(--rb-orange),transparent_85%)_0%,transparent_65%)]"),"aria-label":"Close",onClick:s}),(0,r.jsxs)("div",{role:"dialog","aria-modal":"true",className:(0,a.cn)(m,o),children:["glass"===c?(0,r.jsx)("div",{className:"pointer-events-none absolute inset-0 bg-[radial-gradient(650px_420px_at_20%_15%,color-mix(in_srgb,#16a34a,transparent_88%)_0%,transparent_60%),radial-gradient(650px_420px_at_80%_5%,color-mix(in_srgb,var(--rb-blue),transparent_90%)_0%,transparent_60%)]"}):null,i?(0,r.jsx)("div",{className:(0,a.cn)("relative px-5 py-4","solid"===c?"border-b border-[var(--rb-border)]":"border-b border-[color:color-mix(in_srgb,var(--rb-border),white_60%)]"),children:(0,r.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:i})}):null,(0,r.jsx)("div",{className:"relative px-5 py-4",children:l}),n?(0,r.jsx)("div",{className:(0,a.cn)("relative px-5 py-4","solid"===c?"border-t border-[var(--rb-border)]":"border-t border-[color:color-mix(in_srgb,var(--rb-border),white_60%)]"),children:n}):null]})]})}e.s(["Modal",()=>s])},64998,e=>{"use strict";var r=e.i(48277),t=e.i(66474),a=e.i(9693);function s({open:e,title:s,message:i,confirmText:l="Confirm",confirmVariant:n="primary",cancelText:d="Cancel",busy:c=!1,onCancel:o,onConfirm:m}){return(0,r.jsx)(t.Modal,{open:e,onClose:()=>{c||o()},title:s,footer:(0,r.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,r.jsx)(a.Button,{variant:"outline",onClick:o,disabled:c,children:d}),(0,r.jsx)(a.Button,{variant:n,onClick:m,disabled:c,children:c?"Working...":l})]}),children:(0,r.jsx)("div",{className:"text-sm text-zinc-700",children:i})})}e.s(["ConfirmDialog",()=>s])},30765,e=>{"use strict";function r(e){let r=e.amountCents,t=e.currency?.toUpperCase()??null;if("number"!=typeof r||!Number.isFinite(r))return e.fallback??"—";let a=r/100;if(!t||3!==t.length)return`${a.toFixed(2)}`;try{return new Intl.NumberFormat(void 0,{style:"currency",currency:t,minimumFractionDigits:2,maximumFractionDigits:2}).format(a)}catch{return`${t} ${a.toFixed(2)}`}}e.s(["formatMoney",()=>r])},19463,e=>{"use strict";var r=e.i(48277),t=e.i(14575);function a({title:e,description:a,actions:s,className:i}){return(0,r.jsxs)("div",{className:(0,t.cn)("flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between",i),children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-xl font-semibold text-[var(--rb-text)]",children:e}),a?(0,r.jsx)("p",{className:"mt-1 text-sm text-zinc-600",children:a}):null]}),s?(0,r.jsx)("div",{className:"flex items-center gap-2",children:s}):null]})}e.s(["PageHeader",()=>a])},63571,e=>{"use strict";var r=e.i(48277),t=e.i(14575);function a({variant:e,className:a}){let s="h-4 w-4 shrink-0";return"success"===e?(0,r.jsx)("svg",{viewBox:"0 0 24 24",className:(0,t.cn)(s,a),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:(0,r.jsx)("path",{d:"M20 6L9 17l-5-5"})}):"warning"===e?(0,r.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,t.cn)(s,a),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,r.jsx)("path",{d:"M12 9v4"}),(0,r.jsx)("path",{d:"M12 17h.01"}),(0,r.jsx)("path",{d:"M10.3 3.6l-8.3 14.3A2 2 0 0 0 3.7 21h16.6a2 2 0 0 0 1.7-3.1L13.7 3.6a2 2 0 0 0-3.4 0z"})]}):"danger"===e?(0,r.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,t.cn)(s,a),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,r.jsx)("path",{d:"M18 6L6 18"}),(0,r.jsx)("path",{d:"M6 6l12 12"})]}):(0,r.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,t.cn)(s,a),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,r.jsx)("path",{d:"M12 16v-4"}),(0,r.jsx)("path",{d:"M12 8h.01"}),(0,r.jsx)("path",{d:"M12 22a10 10 0 1 0-10-10 10 10 0 0 0 10 10z"})]})}function s({className:e,variant:s="info",title:i,children:l,...n}){let d={info:{wrapper:"border-[color:color-mix(in_srgb,var(--rb-blue),white_75%)] bg-[color:color-mix(in_srgb,var(--rb-blue),white_92%)] text-[var(--rb-text)]",icon:"text-[var(--rb-blue)]",title:"text-[var(--rb-blue)]"},success:{wrapper:"border-[color:color-mix(in_srgb,#16a34a,white_75%)] bg-[color:color-mix(in_srgb,#16a34a,white_92%)] text-[var(--rb-text)]",icon:"text-[#166534]",title:"text-[#166534]"},warning:{wrapper:"border-[color:color-mix(in_srgb,var(--rb-orange),white_70%)] bg-[color:color-mix(in_srgb,var(--rb-orange),white_92%)] text-[var(--rb-text)]",icon:"text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)]",title:"text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)]"},danger:{wrapper:"border-[color:color-mix(in_srgb,#dc2626,white_75%)] bg-[color:color-mix(in_srgb,#dc2626,white_92%)] text-[var(--rb-text)]",icon:"text-[#991b1b]",title:"text-[#991b1b]"}}[s];return(0,r.jsx)("div",{role:"alert",className:(0,t.cn)("rounded-[var(--rb-radius-md)] border px-4 py-3",d.wrapper,e),...n,children:(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)(a,{variant:s,className:(0,t.cn)("mt-0.5",d.icon)}),(0,r.jsxs)("div",{className:"min-w-0",children:[i?(0,r.jsx)("div",{className:(0,t.cn)("text-sm font-semibold",d.title),children:i}):null,l?(0,r.jsx)("div",{className:(0,t.cn)("text-sm text-zinc-700",i?"mt-1":""),children:l}):null]})]})})}e.s(["Alert",()=>s])},43901,e=>{"use strict";var r=e.i(48277),t=e.i(14575),a=e.i(72015);function s({className:e,"aria-hidden":a=!0,...s}){return(0,r.jsx)("div",{"aria-hidden":a,className:(0,t.cn)("rb-skeleton",e),...s})}function i({lines:e=3,className:i}){let l=Math.max(1,Math.min(e,12));return(0,r.jsx)(a.Card,{className:(0,t.cn)("overflow-hidden",i),children:(0,r.jsxs)(a.CardContent,{className:"space-y-3 pt-5",children:[(0,r.jsx)(s,{className:"h-4 w-32 rounded-[var(--rb-radius-sm)]"}),Array.from({length:l}).map((e,a)=>(0,r.jsx)(s,{className:(0,t.cn)("h-3 rounded-[var(--rb-radius-sm)]",a===l-1?"w-3/5":"w-full")},a))]})})}function l({rows:e=6,columns:a=5,className:i}){let l=Math.max(1,Math.min(e,20)),n=Math.max(1,Math.min(a,10));return(0,r.jsxs)("div",{className:(0,t.cn)("overflow-hidden rounded-[var(--rb-radius-lg)] border border-[var(--rb-border)] bg-white shadow-[var(--rb-shadow)]",i),children:[(0,r.jsx)("div",{className:"border-b border-[var(--rb-border)] px-5 py-4",children:(0,r.jsx)("div",{className:"grid gap-3",style:{gridTemplateColumns:`repeat(${n}, minmax(0, 1fr))`},children:Array.from({length:n}).map((e,t)=>(0,r.jsx)(s,{className:"h-3 w-full rounded-[var(--rb-radius-sm)]"},t))})}),(0,r.jsx)("div",{className:"px-5 pb-5 pt-4",children:(0,r.jsx)("div",{className:"space-y-3",children:Array.from({length:l}).map((e,a)=>(0,r.jsx)("div",{className:"grid gap-3",style:{gridTemplateColumns:`repeat(${n}, minmax(0, 1fr))`},children:Array.from({length:n}).map((e,a)=>(0,r.jsx)(s,{className:(0,t.cn)("h-3 rounded-[var(--rb-radius-sm)]",0===a?"w-3/4":"w-full")},a))},a))})})]})}e.s(["CardSkeleton",()=>i,"Skeleton",()=>s,"TableSkeleton",()=>l])},37574,e=>{"use strict";var r=e.i(48277),t=e.i(30668),a=e.i(14575),s=e.i(9693),i=e.i(33441),l=e.i(43901),n=e.i(1831);function d({title:e,data:d,columns:c,getRowId:o,loading:m=!1,emptyMessage:u="No data.",search:x,filters:h=[],pageSizeOptions:b=[10,25,50],initialPageSize:p=10,server:v,exportConfig:g,columnVisibilityKey:f,onRowClick:j,className:N}){let[w,y]=(0,t.useState)(""),[_,S]=(0,t.useState)(0),[C,k]=(0,t.useState)(p),[M,z]=(0,t.useState)(null),[D,A]=(0,t.useState)(null),[$,B]=(0,t.useState)(0),I=(0,t.useId)(),F=!!v,L=F?v.query:w,E=F?v.onQueryChange:y,P=F?v.pageIndex:_,T=F?v.onPageIndexChange:S,R=F?v.pageSize:C,q=F?v.onPageSizeChange:k,O=F?v.sort??null:null,U=F?v.onSortChange:void 0,W=(0,t.useMemo)(()=>{let e=Array.isArray(c)?c:[];if(!f){let r=e.filter(e=>!e.hiddenByDefault);return r.length>0?r:e.slice(0,1)}try{let r=window.localStorage.getItem(f);if(!r){let r=e.filter(e=>!e.hiddenByDefault);return r.length>0?r:e.slice(0,1)}let t=JSON.parse(r),a=e.filter(e=>{let r=t[e.id];return"boolean"==typeof r?r:!e.hiddenByDefault});return a.length>0?a:e.slice(0,1)}catch{let r=e.filter(e=>!e.hiddenByDefault);return r.length>0?r:e.slice(0,1)}},[f,c,$]),Q=(0,t.useMemo)(()=>{if(F)return Array.isArray(d)?d:[];let e=L.trim().toLowerCase();return(Array.isArray(d)?d:[]).filter(r=>{if(x&&x.getSearchText&&e.length>0&&!x.getSearchText(r).toLowerCase().includes(e))return!1;for(let e of h)if(e.predicate&&!e.predicate(r,e.value))return!1;return!0})},[d,h,F,L,x]),H=F?v.totalRows:Q.length,J=Math.max(1,Math.ceil(H/R)),K=Math.min(P,J-1),Y=Math.max(1,Math.min(8,R||10)),G=(0,t.useMemo)(()=>{if(F)return Q;let e=K*R,r=e+R;return Q.slice(e,r)},[K,Q,F,R]),V=K>0,X=K<J-1,Z=!!x||h.length>0||!!g||!!f;function ee(e,r){if(f&&(r||!(W.length<=1)))try{let t=window.localStorage.getItem(f),a=(t?JSON.parse(t):{})??{};a[e]=r,window.localStorage.setItem(f,JSON.stringify(a)),B(e=>e+1)}catch{}}async function er(e){if(g&&!M){A(null),z(e);try{let r=new URLSearchParams;for(let e of(L.trim().length>0&&r.set("q",L.trim()),h)){let t=e.value;null!=t&&0!==String(t).length&&r.set(e.id,String(t))}if(F&&O?.id&&O?.dir&&(r.set("sort",O.id),r.set("dir",O.dir)),r.set("format",e),g.extraQuery)for(let[e,t]of Object.entries(g.extraQuery))null!=t&&r.set(e,String(t));let t=`${g.url}${g.url.includes("?")?"&":"?"}${r.toString()}`,a=g.filename?.({format:e});await (0,n.apiDownload)(t,{filename:a})}catch(e){A(e instanceof Error?e.message:"Export failed.")}finally{z(null)}}}return(0,r.jsxs)("div",{className:(0,a.cn)("space-y-3",N),children:[e?(0,r.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:e}):null,Z?(0,r.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-end md:justify-between",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-end",children:[x?(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm font-medium",htmlFor:`${I}_datatable_search`,children:"Search"}),(0,r.jsx)("input",{id:`${I}_datatable_search`,className:"w-full min-w-[220px] rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:L,onChange:e=>{E(e.target.value),T(0)},placeholder:x.placeholder??"Search..."})]}):null,h.map(e=>(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm font-medium",htmlFor:`${I}_datatable_filter_${e.id}`,children:e.label}),(0,r.jsx)("select",{id:`${I}_datatable_filter_${e.id}`,className:"w-full min-w-[180px] rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:String(e.value),onChange:r=>{let t=e.options.find(e=>String(e.value)===r.target.value),a=t?t.value:r.target.value;e.onChange(a),T(0)},children:e.options.map(e=>(0,r.jsx)("option",{value:String(e.value),children:e.label},String(e.value)))})]},e.id))]}),(0,r.jsxs)("div",{className:"flex flex-col items-start gap-2 md:items-end",children:[(0,r.jsxs)("div",{className:"text-sm text-zinc-600",children:[H," result(s)"]}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[g?(0,r.jsx)(i.DropdownMenu,{align:"right",trigger:({toggle:e})=>(0,r.jsx)(s.Button,{variant:"outline",size:"sm",onClick:e,disabled:!!M,children:M?"Exporting...":"Export"}),children:({close:e})=>{let t=g.formats??["csv","xlsx","pdf"];return(0,r.jsx)(r.Fragment,{children:t.map(t=>(0,r.jsxs)(i.DropdownMenuItem,{onSelect:()=>{e(),er(t)},disabled:!!M,children:["Export ",t.toUpperCase()]},t))})}}):null,f?(0,r.jsx)(i.DropdownMenu,{align:"right",trigger:({toggle:e})=>(0,r.jsx)(s.Button,{variant:"outline",size:"sm",onClick:e,children:"Columns"}),children:({close:e})=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.DropdownMenuItem,{onSelect:()=>{for(let r of(e(),c))ee(r.id,!0)},children:"Show all"}),(0,r.jsx)(i.DropdownMenuItem,{onSelect:()=>{for(let r of(e(),c))ee(r.id,!r.hiddenByDefault)},children:"Reset defaults"}),(0,r.jsx)(i.DropdownMenuSeparator,{}),c.map(e=>{let t=W.some(r=>r.id===e.id);return(0,r.jsxs)(i.DropdownMenuItem,{onSelect:()=>{ee(e.id,!t)},children:[(0,r.jsx)("span",{className:"mr-2 inline-block w-4",children:t?"✓":""}),"string"==typeof e.header?e.header:e.id]},e.id)})]})}):null]})]})]}):null,D?(0,r.jsx)("div",{className:"text-sm text-red-600",children:D}):null,(0,r.jsx)("div",{className:"overflow-x-auto rounded-[var(--rb-radius-md)] border border-[var(--rb-border)] bg-white",children:(0,r.jsxs)("table",{className:"min-w-full border-collapse text-left text-sm",children:[(0,r.jsx)("thead",{className:"bg-[var(--rb-surface-muted)]",children:(0,r.jsx)("tr",{children:W.map(e=>(0,r.jsx)("th",{className:(0,a.cn)("whitespace-nowrap border-b border-[var(--rb-border)] px-3 py-2 text-xs font-semibold uppercase tracking-wide text-zinc-600",e.headerClassName),children:F&&e.sortId&&U?(0,r.jsxs)("button",{type:"button",onClick:()=>(function(e){if(F&&e.sortId&&U){if(!O||O.id!==e.sortId){U({id:e.sortId,dir:"asc"}),T(0);return}if("asc"===O.dir){U({id:e.sortId,dir:"desc"}),T(0);return}U(null),T(0)}})(e),className:"inline-flex items-center gap-1 hover:text-zinc-900",children:[(0,r.jsx)("span",{children:e.header}),F&&e.sortId?O&&O.id===e.sortId?"asc"===O.dir?(0,r.jsx)("span",{className:"ml-1 text-zinc-700",children:"↑"}):(0,r.jsx)("span",{className:"ml-1 text-zinc-700",children:"↓"}):(0,r.jsx)("span",{className:"ml-1 text-zinc-400",children:"↕"}):null]}):e.header},e.id))})}),(0,r.jsx)("tbody",{children:m?Array.from({length:Y}).map((e,t)=>(0,r.jsx)("tr",{className:"border-t border-[var(--rb-border)]",children:W.map((e,t)=>(0,r.jsx)("td",{className:(0,a.cn)("px-3 py-2 align-middle",e.className),children:(0,r.jsx)(l.Skeleton,{className:(0,a.cn)("h-3 rounded-[var(--rb-radius-sm)]",0===t?"w-3/4":t===W.length-1?"w-16":"w-full")})},e.id))},`loading_${t}`)):0===G.length?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{className:"px-3 py-3 text-sm text-zinc-600",colSpan:Math.max(1,W.length),children:u})}):G.map(e=>(0,r.jsx)("tr",{className:(0,a.cn)("border-t border-[var(--rb-border)]",j?"cursor-pointer hover:bg-[var(--rb-surface-muted)]":null),tabIndex:j?0:void 0,role:j?"button":void 0,onClick:j?()=>{j(e)}:void 0,onKeyDown:j?r=>{("Enter"===r.key||" "===r.key)&&(r.preventDefault(),j(e))}:void 0,children:W.map(t=>(0,r.jsx)("td",{className:(0,a.cn)("px-3 py-2 align-middle",t.className),children:t.cell(e)},t.id))},String(o(e))))})]})}),(0,r.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(s.Button,{variant:"outline",size:"sm",onClick:function(){T(Math.max(0,K-1))},disabled:!V,children:"Prev"}),(0,r.jsx)(s.Button,{variant:"outline",size:"sm",onClick:function(){T(Math.min(J-1,K+1))},disabled:!X,children:"Next"}),(0,r.jsxs)("div",{className:"text-sm text-zinc-600",children:["Page ",K+1," / ",J]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"text-sm text-zinc-600",children:"Rows per page"}),(0,r.jsx)("select",{className:"rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:String(R),onChange:e=>{q(Number(e.target.value)),T(0)},children:b.map(e=>(0,r.jsx)("option",{value:e,children:e},e))})]})]})]})}e.s(["DataTable",()=>d])},48650,e=>{"use strict";var r=e.i(48277),t=e.i(19463),a=e.i(63571),s=e.i(72015);function i({title:e,description:i,actions:l,filters:n,loading:d,loadingFallback:c,error:o,empty:m,emptyTitle:u="Nothing here yet",emptyDescription:x="No items to display.",children:h}){return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)(t.PageHeader,{title:e,description:i,actions:l}),n?(0,r.jsx)(s.Card,{className:"shadow-none",children:(0,r.jsx)(s.CardContent,{className:"pt-5",children:n})}):null,o?(0,r.jsx)(a.Alert,{variant:"danger",title:"Something went wrong",children:o}):null,d?c??(0,r.jsx)("div",{className:"text-sm text-zinc-500",children:"Loading..."}):null,d||o||!m?null:(0,r.jsx)(s.Card,{className:"shadow-none",children:(0,r.jsxs)(s.CardContent,{className:"pt-5",children:[(0,r.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:u}),(0,r.jsx)("div",{className:"mt-1 text-sm text-zinc-600",children:x})]})}),d||o||m?null:h]})}e.s(["ListPageShell",()=>i])},45586,e=>{"use strict";var r=e.i(48277),t=e.i(30668),a=e.i(96086),s=e.i(77252),i=e.i(1314),l=e.i(9693),n=e.i(72015),d=e.i(64998),c=e.i(37574),o=e.i(33441),m=e.i(48650),u=e.i(1831),x=e.i(30765);function h(){let e=(0,i.useAuth)(),h=(0,a.useRouter)(),b=(0,a.useParams)(),p=b.business??b.tenant,[v,g]=t.default.useState(!0),[f,j]=t.default.useState(null),[N,w]=t.default.useState(null),[y,_]=t.default.useState(!1),[S,C]=t.default.useState([]),[k,M]=t.default.useState([]),[z,D]=t.default.useState(""),[A,$]=t.default.useState(0),[B,I]=t.default.useState(10),[F,L]=t.default.useState(null),[E,P]=t.default.useState(""),[T,R]=t.default.useState(""),[q,O]=t.default.useState(null),[U,W]=t.default.useState(""),[Q,H]=t.default.useState(""),[J,K]=t.default.useState(""),[Y,G]=t.default.useState(!1),[V,X]=t.default.useState(!1),[Z,ee]=t.default.useState(""),[er,et]=t.default.useState(!0),[ea,es]=t.default.useState(!1),[ei,el]=t.default.useState(""),[en,ed]=t.default.useState(""),[ec,eo]=t.default.useState(null),em=e.can("services.manage");function eu(){L(null),P(""),R(""),O(null),W(""),H(""),K(""),G(!1),X(!1),ee(""),et(!0)}async function ex(e){if((e.preventDefault(),!y)&&"string"==typeof p&&0!==p.length){if(!em)return void j("Forbidden.");_(!0),j(null),w(null);try{let e=E.trim();if(0===e.length)return void j("Name is required.");let r=Z.trim(),t=r.length>0?Math.round(100*Number(r)):null;if(r.length>0&&(!Number.isFinite(Number(r))||null===t))return void j("Base price is invalid.");let a={name:e,description:T.trim().length>0?T.trim():null,service_type_id:"number"==typeof q?q:null,service_code:U.trim().length>0?U.trim():null,time_required:Q.trim().length>0?Q.trim():null,warranty:J.trim().length>0?J.trim():null,pick_up_delivery_available:!!Y,laptop_rental_available:!!V,base_price_amount_cents:"number"==typeof t?t:null,is_active:!!er};if(F){let e=await (0,u.apiFetch)(`/api/${p}/app/repairbuddy/services/${F}`,{method:"PATCH",body:a});w("Service updated."),C(r=>r.map(r=>r.id===F?e.service??r:r))}else{let e=await (0,u.apiFetch)(`/api/${p}/app/repairbuddy/services`,{method:"POST",body:a});w("Service created."),e.service&&C(r=>[e.service,...r])}eu(),$(0)}catch(e){e instanceof u.ApiError?j(e.message):j(F?"Failed to update service.":"Failed to create service.")}finally{_(!1)}}}async function eh(e){if(!y&&"string"==typeof p&&0!==p.length){var t;if(!em)return void j("Forbidden.");t={title:"Delete service",message:(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{children:["You are about to delete ",(0,r.jsx)("span",{className:"font-semibold",children:e.name}),"."]}),(0,r.jsx)("div",{className:"text-sm text-zinc-600",children:"This action cannot be undone."})]}),action:async()=>{_(!0),j(null),w(null);try{await (0,u.apiFetch)(`/api/${p}/app/repairbuddy/services/${e.id}`,{method:"DELETE"}),C(r=>r.filter(r=>r.id!==e.id)),w("Service deleted."),$(0),F===e.id&&eu()}catch(e){e instanceof u.ApiError?j(e.message):j("Failed to delete service.")}finally{_(!1)}}},el(t.title),ed(t.message),eo(()=>t.action),es(!0)}}t.default.useEffect(()=>{let e=!0;return async function(){try{if(g(!0),j(null),w(null),"string"!=typeof p||0===p.length)throw Error("Business is missing.");let[r,t]=await Promise.all([(0,u.apiFetch)(`/api/${p}/app/repairbuddy/services`),(0,u.apiFetch)(`/api/${p}/app/repairbuddy/service-types?limit=200`)]);if(!e)return;C(Array.isArray(r?.services)?r.services:[]),M(Array.isArray(t?.service_types)?t.service_types:[])}catch(r){if(!e)return;if(r instanceof u.ApiError&&428===r.status&&"string"==typeof p&&p.length>0){let e=`/app/${p}/services`;h.replace(`/app/${p}/branches/select?next=${encodeURIComponent(e)}`);return}j(r instanceof Error?r.message:"Failed to load services.")}finally{if(!e)return;g(!1)}}(),()=>{e=!1}},[h,p]);let eb=t.default.useMemo(()=>{let e=z.trim().toLowerCase();return e?S.filter(r=>`${r.name} ${r.description??""} ${r.id}`.toLowerCase().includes(e)):S},[z,S]),ep=eb.length,ev=t.default.useMemo(()=>{let e=A*B,r=e+B;return eb.slice(e,r)},[eb,A,B]),eg=t.default.useMemo(()=>[{id:"name",header:"Service",cell:e=>(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsx)("div",{className:"truncate font-semibold text-[var(--rb-text)]",children:e.name}),(0,r.jsx)("div",{className:"truncate text-xs text-zinc-600",children:e.id})]}),className:"min-w-[220px]"},{id:"desc",header:"Description",cell:e=>(0,r.jsx)("div",{className:"text-sm text-zinc-700",children:e.description??"—"}),className:"min-w-[280px]"},{id:"price",header:"Base price",cell:e=>e.base_price?(0,r.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)] whitespace-nowrap",children:(0,x.formatMoney)({amountCents:e.base_price.amount_cents,currency:e.base_price.currency})}):(0,r.jsx)("div",{className:"text-sm text-zinc-600",children:"—"}),className:"whitespace-nowrap"},{id:"actions",header:"",cell:e=>em?(0,r.jsx)(o.DropdownMenu,{trigger:({toggle:e})=>(0,r.jsx)(l.Button,{size:"sm",variant:"outline",disabled:y,onClick:e,children:"Actions"}),children:({close:t})=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.DropdownMenuItem,{onSelect:()=>{t(),em&&(L(e.id),P(e.name),R(e.description??""),O("number"==typeof e.service_type_id?e.service_type_id:null),W(e.service_code??""),H(e.time_required??""),K(e.warranty??""),G(!!e.pick_up_delivery_available),X(!!e.laptop_rental_available),ee(e.base_price?String(e.base_price.amount_cents/100):""),et(!!e.is_active),j(null),w(null))},children:"Edit"}),(0,r.jsx)(o.DropdownMenuSeparator,{}),(0,r.jsx)(o.DropdownMenuItem,{destructive:!0,onSelect:()=>{t(),eh(e)},children:"Delete"})]})}):null,className:"w-[1%] whitespace-nowrap"}],[y,em]);return(0,r.jsx)(s.RequireAuth,{children:(0,r.jsxs)(m.ListPageShell,{title:"Services",description:"Service catalog used for estimates and jobs.",filters:(0,r.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,r.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:"Search"}),(0,r.jsx)("input",{value:z,onChange:e=>{D(e.target.value),$(0)},placeholder:"Search services...",className:"h-10 w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 text-sm sm:max-w-[420px]"})]}),loading:v,error:f,empty:!v&&!f&&0===eb.length,emptyTitle:"No services",emptyDescription:"Add services to standardize pricing.",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3",children:[(0,r.jsx)(n.Card,{className:"shadow-none lg:col-span-1",children:(0,r.jsxs)(n.CardContent,{className:"pt-5",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsx)("div",{className:"truncate text-sm font-semibold text-[var(--rb-text)]",children:F?"Edit service":"New service"}),(0,r.jsx)("div",{className:"mt-1 text-sm text-zinc-600",children:"Create or update a service record."})]}),(0,r.jsx)(l.Button,{variant:"outline",size:"sm",onClick:function(){em&&(eu(),j(null),w(null))},disabled:!em||y,children:"New"})]}),(0,r.jsxs)("form",{className:"mt-5 space-y-4",onSubmit:ex,children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:"Name"}),(0,r.jsx)("input",{value:E,onChange:e=>P(e.target.value),placeholder:"e.g., Screen replacement",className:"h-10 w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 text-sm",disabled:!em||y})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:"Description"}),(0,r.jsx)("textarea",{value:T,onChange:e=>R(e.target.value),rows:3,className:"w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",disabled:!em||y})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:"Service type"}),(0,r.jsxs)("select",{value:"number"==typeof q?String(q):"",onChange:e=>{let r=e.target.value;O(r?Number(r):null)},className:"h-10 w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 text-sm",disabled:!em||y,children:[(0,r.jsx)("option",{value:"",children:"—"}),k.filter(e=>!!e.is_active||"number"==typeof q&&e.id===q).map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2 lg:grid-cols-1",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:"Service code"}),(0,r.jsx)("input",{value:U,onChange:e=>W(e.target.value),className:"h-10 w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 text-sm",disabled:!em||y})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:"Base price"}),(0,r.jsx)("input",{value:Z,onChange:e=>ee(e.target.value),placeholder:"e.g., 49.99",className:"h-10 w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 text-sm",disabled:!em||y})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2 lg:grid-cols-1",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:"Time required"}),(0,r.jsx)("input",{value:Q,onChange:e=>H(e.target.value),placeholder:"e.g., 30 min",className:"h-10 w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 text-sm",disabled:!em||y})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:"Warranty"}),(0,r.jsx)("input",{value:J,onChange:e=>K(e.target.value),placeholder:"e.g., 90 days",className:"h-10 w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 text-sm",disabled:!em||y})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:"Status"}),(0,r.jsxs)("label",{className:"flex h-10 items-center gap-2 rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 text-sm",children:[(0,r.jsx)("input",{type:"checkbox",checked:er,onChange:e=>et(e.target.checked),className:"h-4 w-4",disabled:!em||y}),"Active"]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-3",children:[(0,r.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,r.jsx)("input",{type:"checkbox",checked:Y,onChange:e=>G(e.target.checked),className:"h-4 w-4",disabled:!em||y}),"Pick-up / delivery available"]}),(0,r.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,r.jsx)("input",{type:"checkbox",checked:V,onChange:e=>X(e.target.checked),className:"h-4 w-4",disabled:!em||y}),"Laptop rental available"]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-end gap-2 pt-2",children:[(0,r.jsx)(l.Button,{type:"button",variant:"outline",onClick:eu,disabled:!em||y,children:"Clear"}),(0,r.jsx)(l.Button,{type:"submit",disabled:!em||y,children:F?"Save":"Create"})]})]}),N?(0,r.jsx)("div",{className:"mt-4 text-sm text-emerald-700",children:N}):null]})}),(0,r.jsx)(n.Card,{className:"shadow-none lg:col-span-2",children:(0,r.jsx)(n.CardContent,{className:"pt-5",children:(0,r.jsx)(c.DataTable,{title:"string"==typeof p?`Services \xb7 ${p}`:"Services",data:ev,loading:v,emptyMessage:"No services.",columns:eg,getRowId:e=>e.id,server:{query:z,onQueryChange:e=>{D(e),$(0)},pageIndex:A,onPageIndexChange:$,pageSize:B,onPageSizeChange:e=>{I(e),$(0)},totalRows:ep}})})})]}),(0,r.jsx)(d.ConfirmDialog,{open:ea,title:ei,message:en,confirmText:"Confirm",busy:y,onCancel:()=>es(!1),onConfirm:function(){(async()=>{ec&&(await ec(),es(!1))})()}})]})})}e.s(["default",()=>h])}]);