(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,63571,e=>{"use strict";var r=e.i(48277),t=e.i(14575);function a({variant:e,className:a}){let i="h-4 w-4 shrink-0";return"success"===e?(0,r.jsx)("svg",{viewBox:"0 0 24 24",className:(0,t.cn)(i,a),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:(0,r.jsx)("path",{d:"M20 6L9 17l-5-5"})}):"warning"===e?(0,r.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,t.cn)(i,a),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,r.jsx)("path",{d:"M12 9v4"}),(0,r.jsx)("path",{d:"M12 17h.01"}),(0,r.jsx)("path",{d:"M10.3 3.6l-8.3 14.3A2 2 0 0 0 3.7 21h16.6a2 2 0 0 0 1.7-3.1L13.7 3.6a2 2 0 0 0-3.4 0z"})]}):"danger"===e?(0,r.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,t.cn)(i,a),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,r.jsx)("path",{d:"M18 6L6 18"}),(0,r.jsx)("path",{d:"M6 6l12 12"})]}):(0,r.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,t.cn)(i,a),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,r.jsx)("path",{d:"M12 16v-4"}),(0,r.jsx)("path",{d:"M12 8h.01"}),(0,r.jsx)("path",{d:"M12 22a10 10 0 1 0-10-10 10 10 0 0 0 10 10z"})]})}function i({className:e,variant:i="info",title:s,children:l,...n}){let d={info:{wrapper:"border-[color:color-mix(in_srgb,var(--rb-blue),white_75%)] bg-[color:color-mix(in_srgb,var(--rb-blue),white_92%)] text-[var(--rb-text)]",icon:"text-[var(--rb-blue)]",title:"text-[var(--rb-blue)]"},success:{wrapper:"border-[color:color-mix(in_srgb,#16a34a,white_75%)] bg-[color:color-mix(in_srgb,#16a34a,white_92%)] text-[var(--rb-text)]",icon:"text-[#166534]",title:"text-[#166534]"},warning:{wrapper:"border-[color:color-mix(in_srgb,var(--rb-orange),white_70%)] bg-[color:color-mix(in_srgb,var(--rb-orange),white_92%)] text-[var(--rb-text)]",icon:"text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)]",title:"text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)]"},danger:{wrapper:"border-[color:color-mix(in_srgb,#dc2626,white_75%)] bg-[color:color-mix(in_srgb,#dc2626,white_92%)] text-[var(--rb-text)]",icon:"text-[#991b1b]",title:"text-[#991b1b]"}}[i];return(0,r.jsx)("div",{role:"alert",className:(0,t.cn)("rounded-[var(--rb-radius-md)] border px-4 py-3",d.wrapper,e),...n,children:(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)(a,{variant:i,className:(0,t.cn)("mt-0.5",d.icon)}),(0,r.jsxs)("div",{className:"min-w-0",children:[s?(0,r.jsx)("div",{className:(0,t.cn)("text-sm font-semibold",d.title),children:s}):null,l?(0,r.jsx)("div",{className:(0,t.cn)("text-sm text-zinc-700",s?"mt-1":""),children:l}):null]})]})})}e.s(["Alert",()=>i])},68501,e=>{"use strict";var r=e.i(48277),t=e.i(14575);function a({className:e,variant:a="default",...i}){return(0,r.jsx)("span",{className:(0,t.cn)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-medium",{default:"bg-[var(--rb-surface-muted)] text-[var(--rb-text)] border-[var(--rb-border)]",info:"bg-[color:color-mix(in_srgb,var(--rb-blue),white_85%)] text-[var(--rb-blue)] border-[color:color-mix(in_srgb,var(--rb-blue),white_70%)]",success:"bg-[color:color-mix(in_srgb,#16a34a,white_85%)] text-[#166534] border-[color:color-mix(in_srgb,#16a34a,white_70%)]",warning:"bg-[color:color-mix(in_srgb,var(--rb-orange),white_85%)] text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)] border-[color:color-mix(in_srgb,var(--rb-orange),white_70%)]",danger:"bg-[color:color-mix(in_srgb,#dc2626,white_85%)] text-[#991b1b] border-[color:color-mix(in_srgb,#dc2626,white_70%)]"}[a],e),...i})}e.s(["Badge",()=>a])},66474,e=>{"use strict";var r=e.i(48277),t=e.i(30668),a=e.i(14575);function i({open:e,onClose:i,title:s,children:l,footer:n,position:d="center",variant:o="glass",className:c}){if((0,t.useEffect)(()=>{function r(r){e&&"Escape"===r.key&&i()}return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[i,e]),!e)return null;let u="solid"===o?(0,a.cn)("relative w-full max-w-lg overflow-hidden rounded-[var(--rb-radius-lg)]","border border-[var(--rb-border)]","bg-white","shadow-[var(--rb-shadow)]"):(0,a.cn)("relative w-full max-w-lg overflow-hidden rounded-[var(--rb-radius-lg)]","border border-[color:color-mix(in_srgb,var(--rb-border),white_55%)]","bg-white/75 backdrop-blur-xl","shadow-[0_18px_55px_-18px_rgba(0,0,0,0.55)]","ring-1 ring-white/25");return(0,r.jsxs)("div",{className:"top-center"===d?"fixed inset-0 z-50 flex items-start justify-center px-4 pt-8":"fixed inset-0 z-50 flex items-center justify-center px-4",children:[(0,r.jsx)("button",{type:"button",className:(0,a.cn)("absolute inset-0","bg-black/35 backdrop-blur-md","bg-[radial-gradient(900px_600px_at_20%_20%,color-mix(in_srgb,#16a34a,transparent_82%)_0%,transparent_60%),radial-gradient(900px_600px_at_80%_30%,color-mix(in_srgb,var(--rb-blue),transparent_82%)_0%,transparent_60%),radial-gradient(900px_600px_at_50%_85%,color-mix(in_srgb,var(--rb-orange),transparent_85%)_0%,transparent_65%)]"),"aria-label":"Close",onClick:i}),(0,r.jsxs)("div",{role:"dialog","aria-modal":"true",className:(0,a.cn)(u,c),children:["glass"===o?(0,r.jsx)("div",{className:"pointer-events-none absolute inset-0 bg-[radial-gradient(650px_420px_at_20%_15%,color-mix(in_srgb,#16a34a,transparent_88%)_0%,transparent_60%),radial-gradient(650px_420px_at_80%_5%,color-mix(in_srgb,var(--rb-blue),transparent_90%)_0%,transparent_60%)]"}):null,s?(0,r.jsx)("div",{className:(0,a.cn)("relative px-5 py-4","solid"===o?"border-b border-[var(--rb-border)]":"border-b border-[color:color-mix(in_srgb,var(--rb-border),white_60%)]"),children:(0,r.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:s})}):null,(0,r.jsx)("div",{className:"relative px-5 py-4",children:l}),n?(0,r.jsx)("div",{className:(0,a.cn)("relative px-5 py-4","solid"===o?"border-t border-[var(--rb-border)]":"border-t border-[color:color-mix(in_srgb,var(--rb-border),white_60%)]"),children:n}):null]})]})}e.s(["Modal",()=>i])},64998,e=>{"use strict";var r=e.i(48277),t=e.i(66474),a=e.i(9693);function i({open:e,title:i,message:s,confirmText:l="Confirm",confirmVariant:n="primary",cancelText:d="Cancel",busy:o=!1,onCancel:c,onConfirm:u}){return(0,r.jsx)(t.Modal,{open:e,onClose:()=>{o||c()},title:i,footer:(0,r.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,r.jsx)(a.Button,{variant:"outline",onClick:c,disabled:o,children:d}),(0,r.jsx)(a.Button,{variant:n,onClick:u,disabled:o,children:o?"Working...":l})]}),children:(0,r.jsx)("div",{className:"text-sm text-zinc-700",children:s})})}e.s(["ConfirmDialog",()=>i])},19463,e=>{"use strict";var r=e.i(48277),t=e.i(14575);function a({title:e,description:a,actions:i,className:s}){return(0,r.jsxs)("div",{className:(0,t.cn)("flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between",s),children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-xl font-semibold text-[var(--rb-text)]",children:e}),a?(0,r.jsx)("p",{className:"mt-1 text-sm text-zinc-600",children:a}):null]}),i?(0,r.jsx)("div",{className:"flex items-center gap-2",children:i}):null]})}e.s(["PageHeader",()=>a])},43901,e=>{"use strict";var r=e.i(48277),t=e.i(14575),a=e.i(72015);function i({className:e,"aria-hidden":a=!0,...i}){return(0,r.jsx)("div",{"aria-hidden":a,className:(0,t.cn)("rb-skeleton",e),...i})}function s({lines:e=3,className:s}){let l=Math.max(1,Math.min(e,12));return(0,r.jsx)(a.Card,{className:(0,t.cn)("overflow-hidden",s),children:(0,r.jsxs)(a.CardContent,{className:"space-y-3 pt-5",children:[(0,r.jsx)(i,{className:"h-4 w-32 rounded-[var(--rb-radius-sm)]"}),Array.from({length:l}).map((e,a)=>(0,r.jsx)(i,{className:(0,t.cn)("h-3 rounded-[var(--rb-radius-sm)]",a===l-1?"w-3/5":"w-full")},a))]})})}function l({rows:e=6,columns:a=5,className:s}){let l=Math.max(1,Math.min(e,20)),n=Math.max(1,Math.min(a,10));return(0,r.jsxs)("div",{className:(0,t.cn)("overflow-hidden rounded-[var(--rb-radius-lg)] border border-[var(--rb-border)] bg-white shadow-[var(--rb-shadow)]",s),children:[(0,r.jsx)("div",{className:"border-b border-[var(--rb-border)] px-5 py-4",children:(0,r.jsx)("div",{className:"grid gap-3",style:{gridTemplateColumns:`repeat(${n}, minmax(0, 1fr))`},children:Array.from({length:n}).map((e,t)=>(0,r.jsx)(i,{className:"h-3 w-full rounded-[var(--rb-radius-sm)]"},t))})}),(0,r.jsx)("div",{className:"px-5 pb-5 pt-4",children:(0,r.jsx)("div",{className:"space-y-3",children:Array.from({length:l}).map((e,a)=>(0,r.jsx)("div",{className:"grid gap-3",style:{gridTemplateColumns:`repeat(${n}, minmax(0, 1fr))`},children:Array.from({length:n}).map((e,a)=>(0,r.jsx)(i,{className:(0,t.cn)("h-3 rounded-[var(--rb-radius-sm)]",0===a?"w-3/4":"w-full")},a))},a))})})]})}e.s(["CardSkeleton",()=>s,"Skeleton",()=>i,"TableSkeleton",()=>l])},37574,e=>{"use strict";var r=e.i(48277),t=e.i(30668),a=e.i(14575),i=e.i(9693),s=e.i(33441),l=e.i(43901),n=e.i(1831);function d({title:e,data:d,columns:o,getRowId:c,loading:u=!1,emptyMessage:m="No data.",search:x,filters:h=[],pageSizeOptions:b=[10,25,50],initialPageSize:p=10,server:v,exportConfig:f,columnVisibilityKey:g,onRowClick:j,className:w}){let[y,_]=(0,t.useState)(""),[N,C]=(0,t.useState)(0),[S,D]=(0,t.useState)(p),[M,k]=(0,t.useState)(null),[$,A]=(0,t.useState)(null),[z,F]=(0,t.useState)(0),B=(0,t.useId)(),E=!!v,I=E?v.query:y,L=E?v.onQueryChange:_,P=E?v.pageIndex:N,T=E?v.onPageIndexChange:C,R=E?v.pageSize:S,q=E?v.onPageSizeChange:D,O=E?v.sort??null:null,U=E?v.onSortChange:void 0,W=(0,t.useMemo)(()=>{let e=Array.isArray(o)?o:[];if(!g){let r=e.filter(e=>!e.hiddenByDefault);return r.length>0?r:e.slice(0,1)}try{let r=window.localStorage.getItem(g);if(!r){let r=e.filter(e=>!e.hiddenByDefault);return r.length>0?r:e.slice(0,1)}let t=JSON.parse(r),a=e.filter(e=>{let r=t[e.id];return"boolean"==typeof r?r:!e.hiddenByDefault});return a.length>0?a:e.slice(0,1)}catch{let r=e.filter(e=>!e.hiddenByDefault);return r.length>0?r:e.slice(0,1)}},[g,o,z]),Q=(0,t.useMemo)(()=>{if(E)return Array.isArray(d)?d:[];let e=I.trim().toLowerCase();return(Array.isArray(d)?d:[]).filter(r=>{if(x&&x.getSearchText&&e.length>0&&!x.getSearchText(r).toLowerCase().includes(e))return!1;for(let e of h)if(e.predicate&&!e.predicate(r,e.value))return!1;return!0})},[d,h,E,I,x]),H=E?v.totalRows:Q.length,J=Math.max(1,Math.ceil(H/R)),K=Math.min(P,J-1),V=Math.max(1,Math.min(8,R||10)),G=(0,t.useMemo)(()=>{if(E)return Q;let e=K*R,r=e+R;return Q.slice(e,r)},[K,Q,E,R]),X=K>0,Y=K<J-1,Z=!!x||h.length>0||!!f||!!g;function ee(e,r){if(g&&(r||!(W.length<=1)))try{let t=window.localStorage.getItem(g),a=(t?JSON.parse(t):{})??{};a[e]=r,window.localStorage.setItem(g,JSON.stringify(a)),F(e=>e+1)}catch{}}async function er(e){if(f&&!M){A(null),k(e);try{let r=new URLSearchParams;for(let e of(I.trim().length>0&&r.set("q",I.trim()),h)){let t=e.value;null!=t&&0!==String(t).length&&r.set(e.id,String(t))}if(E&&O?.id&&O?.dir&&(r.set("sort",O.id),r.set("dir",O.dir)),r.set("format",e),f.extraQuery)for(let[e,t]of Object.entries(f.extraQuery))null!=t&&r.set(e,String(t));let t=`${f.url}${f.url.includes("?")?"&":"?"}${r.toString()}`,a=f.filename?.({format:e});await (0,n.apiDownload)(t,{filename:a})}catch(e){A(e instanceof Error?e.message:"Export failed.")}finally{k(null)}}}return(0,r.jsxs)("div",{className:(0,a.cn)("space-y-3",w),children:[e?(0,r.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:e}):null,Z?(0,r.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-end md:justify-between",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-end",children:[x?(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm font-medium",htmlFor:`${B}_datatable_search`,children:"Search"}),(0,r.jsx)("input",{id:`${B}_datatable_search`,className:"w-full min-w-[220px] rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:I,onChange:e=>{L(e.target.value),T(0)},placeholder:x.placeholder??"Search..."})]}):null,h.map(e=>(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm font-medium",htmlFor:`${B}_datatable_filter_${e.id}`,children:e.label}),(0,r.jsx)("select",{id:`${B}_datatable_filter_${e.id}`,className:"w-full min-w-[180px] rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:String(e.value),onChange:r=>{let t=e.options.find(e=>String(e.value)===r.target.value),a=t?t.value:r.target.value;e.onChange(a),T(0)},children:e.options.map(e=>(0,r.jsx)("option",{value:String(e.value),children:e.label},String(e.value)))})]},e.id))]}),(0,r.jsxs)("div",{className:"flex flex-col items-start gap-2 md:items-end",children:[(0,r.jsxs)("div",{className:"text-sm text-zinc-600",children:[H," result(s)"]}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[f?(0,r.jsx)(s.DropdownMenu,{align:"right",trigger:({toggle:e})=>(0,r.jsx)(i.Button,{variant:"outline",size:"sm",onClick:e,disabled:!!M,children:M?"Exporting...":"Export"}),children:({close:e})=>{let t=f.formats??["csv","xlsx","pdf"];return(0,r.jsx)(r.Fragment,{children:t.map(t=>(0,r.jsxs)(s.DropdownMenuItem,{onSelect:()=>{e(),er(t)},disabled:!!M,children:["Export ",t.toUpperCase()]},t))})}}):null,g?(0,r.jsx)(s.DropdownMenu,{align:"right",trigger:({toggle:e})=>(0,r.jsx)(i.Button,{variant:"outline",size:"sm",onClick:e,children:"Columns"}),children:({close:e})=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.DropdownMenuItem,{onSelect:()=>{for(let r of(e(),o))ee(r.id,!0)},children:"Show all"}),(0,r.jsx)(s.DropdownMenuItem,{onSelect:()=>{for(let r of(e(),o))ee(r.id,!r.hiddenByDefault)},children:"Reset defaults"}),(0,r.jsx)(s.DropdownMenuSeparator,{}),o.map(e=>{let t=W.some(r=>r.id===e.id);return(0,r.jsxs)(s.DropdownMenuItem,{onSelect:()=>{ee(e.id,!t)},children:[(0,r.jsx)("span",{className:"mr-2 inline-block w-4",children:t?"✓":""}),"string"==typeof e.header?e.header:e.id]},e.id)})]})}):null]})]})]}):null,$?(0,r.jsx)("div",{className:"text-sm text-red-600",children:$}):null,(0,r.jsx)("div",{className:"overflow-x-auto rounded-[var(--rb-radius-md)] border border-[var(--rb-border)] bg-white",children:(0,r.jsxs)("table",{className:"min-w-full border-collapse text-left text-sm",children:[(0,r.jsx)("thead",{className:"bg-[var(--rb-surface-muted)]",children:(0,r.jsx)("tr",{children:W.map(e=>(0,r.jsx)("th",{className:(0,a.cn)("whitespace-nowrap border-b border-[var(--rb-border)] px-3 py-2 text-xs font-semibold uppercase tracking-wide text-zinc-600",e.headerClassName),children:E&&e.sortId&&U?(0,r.jsxs)("button",{type:"button",onClick:()=>(function(e){if(E&&e.sortId&&U){if(!O||O.id!==e.sortId){U({id:e.sortId,dir:"asc"}),T(0);return}if("asc"===O.dir){U({id:e.sortId,dir:"desc"}),T(0);return}U(null),T(0)}})(e),className:"inline-flex items-center gap-1 hover:text-zinc-900",children:[(0,r.jsx)("span",{children:e.header}),E&&e.sortId?O&&O.id===e.sortId?"asc"===O.dir?(0,r.jsx)("span",{className:"ml-1 text-zinc-700",children:"↑"}):(0,r.jsx)("span",{className:"ml-1 text-zinc-700",children:"↓"}):(0,r.jsx)("span",{className:"ml-1 text-zinc-400",children:"↕"}):null]}):e.header},e.id))})}),(0,r.jsx)("tbody",{children:u?Array.from({length:V}).map((e,t)=>(0,r.jsx)("tr",{className:"border-t border-[var(--rb-border)]",children:W.map((e,t)=>(0,r.jsx)("td",{className:(0,a.cn)("px-3 py-2 align-middle",e.className),children:(0,r.jsx)(l.Skeleton,{className:(0,a.cn)("h-3 rounded-[var(--rb-radius-sm)]",0===t?"w-3/4":t===W.length-1?"w-16":"w-full")})},e.id))},`loading_${t}`)):0===G.length?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{className:"px-3 py-3 text-sm text-zinc-600",colSpan:Math.max(1,W.length),children:m})}):G.map(e=>(0,r.jsx)("tr",{className:(0,a.cn)("border-t border-[var(--rb-border)]",j?"cursor-pointer hover:bg-[var(--rb-surface-muted)]":null),tabIndex:j?0:void 0,role:j?"button":void 0,onClick:j?()=>{j(e)}:void 0,onKeyDown:j?r=>{("Enter"===r.key||" "===r.key)&&(r.preventDefault(),j(e))}:void 0,children:W.map(t=>(0,r.jsx)("td",{className:(0,a.cn)("px-3 py-2 align-middle",t.className),children:t.cell(e)},t.id))},String(c(e))))})]})}),(0,r.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(i.Button,{variant:"outline",size:"sm",onClick:function(){T(Math.max(0,K-1))},disabled:!X,children:"Prev"}),(0,r.jsx)(i.Button,{variant:"outline",size:"sm",onClick:function(){T(Math.min(J-1,K+1))},disabled:!Y,children:"Next"}),(0,r.jsxs)("div",{className:"text-sm text-zinc-600",children:["Page ",K+1," / ",J]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"text-sm text-zinc-600",children:"Rows per page"}),(0,r.jsx)("select",{className:"rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:String(R),onChange:e=>{q(Number(e.target.value)),T(0)},children:b.map(e=>(0,r.jsx)("option",{value:e,children:e},e))})]})]})]})}e.s(["DataTable",()=>d])},48650,e=>{"use strict";var r=e.i(48277),t=e.i(19463),a=e.i(63571),i=e.i(72015);function s({title:e,description:s,actions:l,filters:n,loading:d,loadingFallback:o,error:c,empty:u,emptyTitle:m="Nothing here yet",emptyDescription:x="No items to display.",children:h}){return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)(t.PageHeader,{title:e,description:s,actions:l}),n?(0,r.jsx)(i.Card,{className:"shadow-none",children:(0,r.jsx)(i.CardContent,{className:"pt-5",children:n})}):null,c?(0,r.jsx)(a.Alert,{variant:"danger",title:"Something went wrong",children:c}):null,d?o??(0,r.jsx)("div",{className:"text-sm text-zinc-500",children:"Loading..."}):null,d||c||!u?null:(0,r.jsx)(i.Card,{className:"shadow-none",children:(0,r.jsxs)(i.CardContent,{className:"pt-5",children:[(0,r.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:m}),(0,r.jsx)("div",{className:"mt-1 text-sm text-zinc-600",children:x})]})}),d||c||u?null:h]})}e.s(["ListPageShell",()=>s])},33153,e=>{"use strict";var r=e.i(48277),t=e.i(30668),a=e.i(96086),i=e.i(77252),s=e.i(1314),l=e.i(9693),n=e.i(68501),d=e.i(63571),o=e.i(72015),c=e.i(64998),u=e.i(37574),m=e.i(33441),x=e.i(66474),h=e.i(48650),b=e.i(1831);function p(){let e=(0,s.useAuth)(),p=(0,a.useRouter)(),v=(0,a.useParams)(),f=v.business??v.tenant,[g,j]=t.default.useState(!0),[w,y]=t.default.useState(null),[_,N]=t.default.useState(null),[C,S]=t.default.useState(!1),[D,M]=t.default.useState([]),[k,$]=t.default.useState([]),[A,z]=t.default.useState([]),[F,B]=t.default.useState([]),[E,I]=t.default.useState([]),[L,P]=t.default.useState(""),[T,R]=t.default.useState(0),[q,O]=t.default.useState(10),[U,W]=t.default.useState(!1),[Q,H]=t.default.useState(null),[J,K]=t.default.useState(null),[V,G]=t.default.useState(null),[X,Y]=t.default.useState(""),[Z,ee]=t.default.useState(""),[er,et]=t.default.useState(""),[ea,ei]=t.default.useState(""),[es,el]=t.default.useState(!1),[en,ed]=t.default.useState(""),[eo,ec]=t.default.useState(""),[eu,em]=t.default.useState(null),[ex,eh]=t.default.useState(!1),[eb,ep]=t.default.useState(!1),[ev,ef]=t.default.useState(null),[eg,ej]=t.default.useState(null),[ew,ey]=t.default.useState(null),[e_,eN]=t.default.useState([]),eC=e.can("customer_devices.manage"),eS=t.default.useCallback(async()=>{try{if(j(!0),y(null),"string"!=typeof f||0===f.length)throw Error("Business is missing.");let[e,r,t,a,i]=await Promise.all([(0,b.apiFetch)(`/api/${f}/app/repairbuddy/customer-devices?limit=200`),(0,b.apiFetch)(`/api/${f}/app/clients?limit=200`),(0,b.apiFetch)(`/api/${f}/app/repairbuddy/devices?limit=200`),(0,b.apiFetch)(`/api/${f}/app/repairbuddy/device-brands?limit=200`),(0,b.apiFetch)(`/api/${f}/app/repairbuddy/device-types?limit=200`)]);M(Array.isArray(e?.customer_devices)?e.customer_devices:[]),$(Array.isArray(r?.clients)?r.clients:[]),z(Array.isArray(t?.devices)?t.devices:[]),B(Array.isArray(a?.device_brands)?a.device_brands:[]),I(Array.isArray(i?.device_types)?i.device_types:[])}catch(e){if(e instanceof b.ApiError&&428===e.status&&"string"==typeof f&&f.length>0){let e=`/app/${f}/customer-devices`;p.replace(`/app/${f}/branches/select?next=${encodeURIComponent(e)}`);return}y(e instanceof Error?e.message:"Failed to load customer devices.")}finally{j(!1)}},[p,f]);async function eD(e){if((e.preventDefault(),!C)&&"string"==typeof f&&0!==f.length){if(!eC)return void y("Forbidden.");S(!0),y(null),N(null);try{if("number"!=typeof J)return void y("Client is required.");let e=X.trim();if(0===e.length)return void y("Label is required.");let r={customer_id:J,device_id:V,label:e,serial:Z.trim().length>0?Z.trim():null,pin:er.trim().length>0?er.trim():null,notes:ea.trim().length>0?ea.trim():null};Q?(await (0,b.apiFetch)(`/api/${f}/app/repairbuddy/customer-devices/${Q}`,{method:"PATCH",body:r}),N("Customer device updated.")):(await (0,b.apiFetch)(`/api/${f}/app/repairbuddy/customer-devices`,{method:"POST",body:r}),N("Customer device created.")),W(!1),R(0),await eS()}catch(e){e instanceof b.ApiError?y(e.message):y(Q?"Failed to update customer device.":"Failed to create customer device.")}finally{S(!1)}}}async function eM(e){var t;if(C||"string"!=typeof f||0===f.length)return;if(!eC)return void y("Forbidden.");let a=e.device?`${e.brand?.name??""} ${e.device.model}`.trim():e.customerDevice.label;t={title:"Delete customer device",message:(0,r.jsxs)("div",{children:["Delete ",(0,r.jsx)("span",{className:"font-semibold",children:a}),"?"]}),action:async()=>{S(!0),y(null),N(null);try{await (0,b.apiFetch)(`/api/${f}/app/repairbuddy/customer-devices/${e.customerDevice.id}`,{method:"DELETE"}),N("Customer device deleted."),R(0),await eS()}catch(e){e instanceof b.ApiError?y(e.message):y("Failed to delete customer device.")}finally{S(!1)}}},ed(t.title),ec(t.message),em(()=>t.action),el(!0)}async function ek(e){if(ef(null),ej(null),"string"!=typeof f||0===f.length)return void ef("Business is missing.");ey(e),eh(!0),ep(!0);try{let r=await (0,b.apiFetch)(`/api/${f}/app/repairbuddy/customer-devices/${e.customerDevice.id}/extra-fields`);eN(Array.isArray(r?.extra_fields)?r.extra_fields:[])}catch(e){if(e instanceof b.ApiError&&428===e.status&&"string"==typeof f&&f.length>0){let e=`/app/${f}/customer-devices`;p.replace(`/app/${f}/branches/select?next=${encodeURIComponent(e)}`);return}ef(e instanceof Error?e.message:"Failed to load extra fields."),eN([])}finally{ep(!1)}}async function e$(){if(ef(null),ej(null),!ew)return void ef("No customer device selected.");if("string"!=typeof f||0===f.length)return void ef("Business is missing.");ep(!0);try{let e=await (0,b.apiFetch)(`/api/${f}/app/repairbuddy/customer-devices/${ew.customerDevice.id}/extra-fields`,{method:"PUT",body:{values:e_.map(e=>({field_definition_id:e.field_definition_id,value_text:e.value_text}))}});eN(Array.isArray(e?.extra_fields)?e.extra_fields:[]),ej("Saved.")}catch(e){ef(e instanceof Error?e.message:"Failed to save extra fields.")}finally{ep(!1)}}t.default.useEffect(()=>{eS()},[eS]);let eA=t.default.useMemo(()=>new Map(k.map(e=>[e.id,e])),[k]),ez=t.default.useMemo(()=>new Map(A.map(e=>[e.id,e])),[A]),eF=t.default.useMemo(()=>new Map(F.map(e=>[e.id,e])),[F]),eB=t.default.useMemo(()=>new Map(E.map(e=>[e.id,e])),[E]),eE=t.default.useMemo(()=>D.map(e=>{let r=eA.get(e.customer_id)??null,t="number"==typeof e.device_id?ez.get(e.device_id)??null:null,a=t?eF.get(t.device_brand_id)??null:null,i=t?eB.get(t.device_type_id)??null:null;return{customerDevice:e,client:r,device:t,brand:a,type:i}}),[eF,eA,D,ez,eB]),eI=t.default.useMemo(()=>{let e=L.trim().toLowerCase();return e?eE.filter(r=>{let t=r.device?`${r.brand?.name??""} ${r.device.model}`.trim():r.customerDevice.label;return`${r.customerDevice.id} ${t} ${r.client?.name??""} ${r.customerDevice.serial??""}`.toLowerCase().includes(e)}):eE},[L,eE]),eL=eI.length,eP=t.default.useMemo(()=>{let e=T*q,r=e+q;return eI.slice(e,r)},[eI,T,q]),eT=t.default.useMemo(()=>[{id:"device",header:"Device",cell:e=>(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsx)("div",{className:"truncate font-semibold text-[var(--rb-text)]",children:e.device?`${e.brand?.name??""} ${e.device.model}`.trim():e.customerDevice.label}),(0,r.jsx)("div",{className:"truncate text-xs text-zinc-600",children:e.customerDevice.id})]}),className:"min-w-[280px]"},{id:"client",header:"Client",cell:e=>(0,r.jsx)("div",{className:"text-sm text-zinc-700",children:e.client?.name??e.customerDevice.customer_id}),className:"min-w-[220px]"},{id:"type",header:"Type",cell:e=>(0,r.jsx)("div",{className:"text-sm text-zinc-700",children:e.type?.name??"—"}),className:"min-w-[160px]"},{id:"serial",header:"Serial",cell:e=>(0,r.jsx)(n.Badge,{variant:"default",children:e.customerDevice.serial??"—"}),className:"whitespace-nowrap"},{id:"actions",header:"",headerClassName:"text-right",className:"w-[160px] whitespace-nowrap text-right",cell:e=>eC?(0,r.jsx)(m.DropdownMenu,{align:"right",trigger:({toggle:e})=>(0,r.jsx)(l.Button,{variant:"ghost",size:"sm",onClick:e,disabled:C,className:"px-2",children:"Actions"}),children:({close:t})=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.DropdownMenuItem,{onSelect:()=>{t(),eC&&(H(e.customerDevice.id),K(e.customerDevice.customer_id),G("number"==typeof e.customerDevice.device_id?e.customerDevice.device_id:null),Y(e.customerDevice.label??""),ee(e.customerDevice.serial??""),et(e.customerDevice.pin??""),ei(e.customerDevice.notes??""),W(!0),y(null),N(null))},disabled:C,children:"Edit"}),(0,r.jsx)(m.DropdownMenuItem,{onSelect:()=>{t(),ek(e)},disabled:C,children:"Extra fields"}),(0,r.jsx)(m.DropdownMenuSeparator,{}),(0,r.jsx)(m.DropdownMenuItem,{destructive:!0,onSelect:()=>{t(),eM(e)},disabled:C,children:"Delete"})]})}):(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)(l.Button,{variant:"outline",size:"sm",onClick:()=>void ek(e),children:"Extra fields"})})}],[C,eC,f]);return(0,r.jsx)(i.RequireAuth,{requiredPermission:"customer_devices.view",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)(c.ConfirmDialog,{open:es,title:en,message:eo,busy:C,confirmText:"Delete",confirmVariant:"secondary",onCancel:()=>{C||(el(!1),em(null))},onConfirm:()=>{eu&&(async()=>{await eu(),el(!1),em(null)})()}}),(0,r.jsx)(x.Modal,{open:U,onClose:()=>{C||W(!1)},title:Q?"Edit customer device":"Add customer device",footer:(0,r.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,r.jsx)(l.Button,{variant:"outline",onClick:()=>W(!1),disabled:C,children:"Cancel"}),(0,r.jsx)(l.Button,{disabled:C,type:"submit",form:"rb_customer_device_form",children:C?"Saving...":"Save"})]}),children:(0,r.jsxs)("form",{id:"rb_customer_device_form",className:"space-y-3",onSubmit:eD,children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm font-medium",htmlFor:"cd_customer",children:"Client"}),(0,r.jsx)("select",{id:"cd_customer",className:"w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:J??"",onChange:e=>{let r=e.target.value;if(!r)return void K(null);let t=Number(r);K(Number.isFinite(t)?t:null)},disabled:C,children:k.slice().sort((e,r)=>e.name.localeCompare(r.name)).map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm font-medium",htmlFor:"cd_device",children:"Device model (optional)"}),(0,r.jsxs)("select",{id:"cd_device",className:"w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:V??"",onChange:e=>{let r=e.target.value;if(!r)return void G(null);let t=Number(r);G(Number.isFinite(t)?t:null)},disabled:C,children:[(0,r.jsx)("option",{value:"",children:"(none)"}),A.slice().sort((e,r)=>e.model.localeCompare(r.model)).map(e=>(0,r.jsx)("option",{value:e.id,children:e.model},e.id))]})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm font-medium",htmlFor:"cd_label",children:"Label"}),(0,r.jsx)("input",{id:"cd_label",className:"w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:X,onChange:e=>Y(e.target.value),disabled:C,required:!0})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm font-medium",htmlFor:"cd_serial",children:"Serial"}),(0,r.jsx)("input",{id:"cd_serial",className:"w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:Z,onChange:e=>ee(e.target.value),disabled:C})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm font-medium",htmlFor:"cd_pin",children:"PIN"}),(0,r.jsx)("input",{id:"cd_pin",className:"w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:er,onChange:e=>et(e.target.value),disabled:C})]})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm font-medium",htmlFor:"cd_notes",children:"Notes"}),(0,r.jsx)("textarea",{id:"cd_notes",className:"w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:ea,onChange:e=>ei(e.target.value),disabled:C,rows:4})]})]})}),_?(0,r.jsx)("div",{className:"text-sm text-green-700",children:_}):null,w?(0,r.jsx)("div",{className:"text-sm text-red-600",children:w}):null,(0,r.jsxs)(h.ListPageShell,{title:"Customer Devices",description:"Devices owned by clients (intake inventory).",actions:(0,r.jsx)(l.Button,{variant:"primary",size:"sm",onClick:function(){eC&&(H(null),K(k.length>0?k[0].id:null),G(null),Y(""),ee(""),et(""),ei(""),W(!0),y(null),N(null))},disabled:!eC||g||C,children:"Add device"}),loading:g,error:null,empty:!g&&!w&&0===eE.length,emptyTitle:"No customer devices",emptyDescription:"Customer devices will appear when linked to clients.",children:[(0,r.jsxs)(x.Modal,{open:ex,onClose:()=>{eb||(eh(!1),ey(null),eN([]),ef(null),ej(null))},title:ew?`Extra Fields \xb7 #${ew.customerDevice.id}`:"Extra Fields",footer:(0,r.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,r.jsx)(l.Button,{variant:"outline",onClick:()=>{eb||(eh(!1),ey(null),eN([]),ef(null),ej(null))},disabled:eb,children:"Close"}),(0,r.jsx)(l.Button,{onClick:()=>void e$(),disabled:eb,children:eb?"Saving...":"Save"})]}),children:[ev?(0,r.jsx)(d.Alert,{variant:"danger",title:"Could not load extra fields",children:ev}):null,eg?(0,r.jsx)(d.Alert,{variant:"success",title:"Success",children:eg}):null,eb&&0===e_.length?(0,r.jsx)("div",{className:"text-sm text-zinc-500",children:"Loading..."}):null,eb||0!==e_.length?null:(0,r.jsx)("div",{className:"text-sm text-zinc-600",children:"No extra fields defined."}),e_.length>0?(0,r.jsx)("div",{className:"space-y-3",children:e_.filter(e=>e.is_active).map(e=>(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-[var(--rb-text)]",children:e.label}),(0,r.jsx)("input",{className:"h-10 w-full rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 text-sm",value:e.value_text??"",onChange:r=>{let t=r.target.value;eN(r=>r.map(r=>r.field_definition_id===e.field_definition_id?{...r,value_text:t}:r))},disabled:eb})]},e.field_definition_id))}):null]}),(0,r.jsx)(o.Card,{className:"shadow-none",children:(0,r.jsx)(o.CardContent,{className:"pt-5",children:(0,r.jsx)(u.DataTable,{title:"string"==typeof f?`Customer Devices \xb7 ${f}`:"Customer Devices",data:eP,loading:g,emptyMessage:"No customer devices.",columns:eT,getRowId:e=>e.customerDevice.id,search:{placeholder:"Search devices, clients, serial..."},server:{query:L,onQueryChange:e=>{P(e),R(0)},pageIndex:T,onPageIndexChange:R,pageSize:q,onPageSizeChange:e=>{O(e),R(0)},totalRows:eL}})})})]})]})})}e.s(["default",()=>p])}]);