(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,63571,e=>{"use strict";var i=e.i(48277),t=e.i(14575);function n({variant:e,className:n}){let r="h-4 w-4 shrink-0";return"success"===e?(0,i.jsx)("svg",{viewBox:"0 0 24 24",className:(0,t.cn)(r,n),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:(0,i.jsx)("path",{d:"M20 6L9 17l-5-5"})}):"warning"===e?(0,i.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,t.cn)(r,n),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,i.jsx)("path",{d:"M12 9v4"}),(0,i.jsx)("path",{d:"M12 17h.01"}),(0,i.jsx)("path",{d:"M10.3 3.6l-8.3 14.3A2 2 0 0 0 3.7 21h16.6a2 2 0 0 0 1.7-3.1L13.7 3.6a2 2 0 0 0-3.4 0z"})]}):"danger"===e?(0,i.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,t.cn)(r,n),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,i.jsx)("path",{d:"M18 6L6 18"}),(0,i.jsx)("path",{d:"M6 6l12 12"})]}):(0,i.jsxs)("svg",{viewBox:"0 0 24 24",className:(0,t.cn)(r,n),fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[(0,i.jsx)("path",{d:"M12 16v-4"}),(0,i.jsx)("path",{d:"M12 8h.01"}),(0,i.jsx)("path",{d:"M12 22a10 10 0 1 0-10-10 10 10 0 0 0 10 10z"})]})}function r({className:e,variant:r="info",title:a,children:s,...l}){let o={info:{wrapper:"border-[color:color-mix(in_srgb,var(--rb-blue),white_75%)] bg-[color:color-mix(in_srgb,var(--rb-blue),white_92%)] text-[var(--rb-text)]",icon:"text-[var(--rb-blue)]",title:"text-[var(--rb-blue)]"},success:{wrapper:"border-[color:color-mix(in_srgb,#16a34a,white_75%)] bg-[color:color-mix(in_srgb,#16a34a,white_92%)] text-[var(--rb-text)]",icon:"text-[#166534]",title:"text-[#166534]"},warning:{wrapper:"border-[color:color-mix(in_srgb,var(--rb-orange),white_70%)] bg-[color:color-mix(in_srgb,var(--rb-orange),white_92%)] text-[var(--rb-text)]",icon:"text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)]",title:"text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)]"},danger:{wrapper:"border-[color:color-mix(in_srgb,#dc2626,white_75%)] bg-[color:color-mix(in_srgb,#dc2626,white_92%)] text-[var(--rb-text)]",icon:"text-[#991b1b]",title:"text-[#991b1b]"}}[r];return(0,i.jsx)("div",{role:"alert",className:(0,t.cn)("rounded-[var(--rb-radius-md)] border px-4 py-3",o.wrapper,e),...l,children:(0,i.jsxs)("div",{className:"flex gap-3",children:[(0,i.jsx)(n,{variant:r,className:(0,t.cn)("mt-0.5",o.icon)}),(0,i.jsxs)("div",{className:"min-w-0",children:[a?(0,i.jsx)("div",{className:(0,t.cn)("text-sm font-semibold",o.title),children:a}):null,s?(0,i.jsx)("div",{className:(0,t.cn)("text-sm text-zinc-700",a?"mt-1":""),children:s}):null]})]})})}e.s(["Alert",()=>r])},68501,e=>{"use strict";var i=e.i(48277),t=e.i(14575);function n({className:e,variant:n="default",...r}){return(0,i.jsx)("span",{className:(0,t.cn)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-medium",{default:"bg-[var(--rb-surface-muted)] text-[var(--rb-text)] border-[var(--rb-border)]",info:"bg-[color:color-mix(in_srgb,var(--rb-blue),white_85%)] text-[var(--rb-blue)] border-[color:color-mix(in_srgb,var(--rb-blue),white_70%)]",success:"bg-[color:color-mix(in_srgb,#16a34a,white_85%)] text-[#166534] border-[color:color-mix(in_srgb,#16a34a,white_70%)]",warning:"bg-[color:color-mix(in_srgb,var(--rb-orange),white_85%)] text-[color:color-mix(in_srgb,var(--rb-orange),black_20%)] border-[color:color-mix(in_srgb,var(--rb-orange),white_70%)]",danger:"bg-[color:color-mix(in_srgb,#dc2626,white_85%)] text-[#991b1b] border-[color:color-mix(in_srgb,#dc2626,white_70%)]"}[n],e),...r})}e.s(["Badge",()=>n])},26550,e=>{"use strict";var i=e.i(48277),t=e.i(14575);function n({className:e,type:n,...r}){return(0,i.jsx)("input",{type:n,className:(0,t.cn)("w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)] outline-none transition","placeholder:text-zinc-400","focus-visible:ring-2 focus-visible:ring-[color:color-mix(in_srgb,var(--rb-orange),white_65%)] focus-visible:ring-offset-2 focus-visible:ring-offset-white","disabled:cursor-not-allowed disabled:bg-[var(--rb-surface-muted)] disabled:opacity-70",e),...r})}e.s(["Input",()=>n])},43901,e=>{"use strict";var i=e.i(48277),t=e.i(14575),n=e.i(72015);function r({className:e,"aria-hidden":n=!0,...r}){return(0,i.jsx)("div",{"aria-hidden":n,className:(0,t.cn)("rb-skeleton",e),...r})}function a({lines:e=3,className:a}){let s=Math.max(1,Math.min(e,12));return(0,i.jsx)(n.Card,{className:(0,t.cn)("overflow-hidden",a),children:(0,i.jsxs)(n.CardContent,{className:"space-y-3 pt-5",children:[(0,i.jsx)(r,{className:"h-4 w-32 rounded-[var(--rb-radius-sm)]"}),Array.from({length:s}).map((e,n)=>(0,i.jsx)(r,{className:(0,t.cn)("h-3 rounded-[var(--rb-radius-sm)]",n===s-1?"w-3/5":"w-full")},n))]})})}function s({rows:e=6,columns:n=5,className:a}){let s=Math.max(1,Math.min(e,20)),l=Math.max(1,Math.min(n,10));return(0,i.jsxs)("div",{className:(0,t.cn)("overflow-hidden rounded-[var(--rb-radius-lg)] border border-[var(--rb-border)] bg-white shadow-[var(--rb-shadow)]",a),children:[(0,i.jsx)("div",{className:"border-b border-[var(--rb-border)] px-5 py-4",children:(0,i.jsx)("div",{className:"grid gap-3",style:{gridTemplateColumns:`repeat(${l}, minmax(0, 1fr))`},children:Array.from({length:l}).map((e,t)=>(0,i.jsx)(r,{className:"h-3 w-full rounded-[var(--rb-radius-sm)]"},t))})}),(0,i.jsx)("div",{className:"px-5 pb-5 pt-4",children:(0,i.jsx)("div",{className:"space-y-3",children:Array.from({length:s}).map((e,n)=>(0,i.jsx)("div",{className:"grid gap-3",style:{gridTemplateColumns:`repeat(${l}, minmax(0, 1fr))`},children:Array.from({length:l}).map((e,n)=>(0,i.jsx)(r,{className:(0,t.cn)("h-3 rounded-[var(--rb-radius-sm)]",0===n?"w-3/4":"w-full")},n))},n))})})]})}e.s(["CardSkeleton",()=>a,"Skeleton",()=>r,"TableSkeleton",()=>s])},37574,e=>{"use strict";var i=e.i(48277),t=e.i(30668),n=e.i(14575),r=e.i(9693),a=e.i(33441),s=e.i(43901),l=e.i(1831);function o({title:e,data:o,columns:d,getRowId:c,loading:u=!1,emptyMessage:m="No data.",search:v,filters:b=[],pageSizeOptions:h=[10,25,50],initialPageSize:x=10,server:p,exportConfig:g,columnVisibilityKey:f,onRowClick:y,className:j}){let[_,w]=(0,t.useState)(""),[N,S]=(0,t.useState)(0),[I,C]=(0,t.useState)(x),[k,A]=(0,t.useState)(null),[P,B]=(0,t.useState)(null),[$,M]=(0,t.useState)(0),T=(0,t.useId)(),D=!!p,F=D?p.query:_,E=D?p.onQueryChange:w,z=D?p.pageIndex:N,L=D?p.onPageIndexChange:S,O=D?p.pageSize:I,R=D?p.onPageSizeChange:C,U=D?p.sort??null:null,q=D?p.onSortChange:void 0,H=(0,t.useMemo)(()=>{let e=Array.isArray(d)?d:[];if(!f){let i=e.filter(e=>!e.hiddenByDefault);return i.length>0?i:e.slice(0,1)}try{let i=window.localStorage.getItem(f);if(!i){let i=e.filter(e=>!e.hiddenByDefault);return i.length>0?i:e.slice(0,1)}let t=JSON.parse(i),n=e.filter(e=>{let i=t[e.id];return"boolean"==typeof i?i:!e.hiddenByDefault});return n.length>0?n:e.slice(0,1)}catch{let i=e.filter(e=>!e.hiddenByDefault);return i.length>0?i:e.slice(0,1)}},[f,d,$]),V=(0,t.useMemo)(()=>{if(D)return Array.isArray(o)?o:[];let e=F.trim().toLowerCase();return(Array.isArray(o)?o:[]).filter(i=>{if(v&&v.getSearchText&&e.length>0&&!v.getSearchText(i).toLowerCase().includes(e))return!1;for(let e of b)if(e.predicate&&!e.predicate(i,e.value))return!1;return!0})},[o,b,D,F,v]),W=D?p.totalRows:V.length,Q=Math.max(1,Math.ceil(W/O)),J=Math.min(z,Q-1),K=Math.max(1,Math.min(8,O||10)),Y=(0,t.useMemo)(()=>{if(D)return V;let e=J*O,i=e+O;return V.slice(e,i)},[J,V,D,O]),G=J>0,X=J<Q-1,Z=!!v||b.length>0||!!g||!!f;function ee(e,i){if(f&&(i||!(H.length<=1)))try{let t=window.localStorage.getItem(f),n=(t?JSON.parse(t):{})??{};n[e]=i,window.localStorage.setItem(f,JSON.stringify(n)),M(e=>e+1)}catch{}}async function ei(e){if(g&&!k){B(null),A(e);try{let i=new URLSearchParams;for(let e of(F.trim().length>0&&i.set("q",F.trim()),b)){let t=e.value;null!=t&&0!==String(t).length&&i.set(e.id,String(t))}if(D&&U?.id&&U?.dir&&(i.set("sort",U.id),i.set("dir",U.dir)),i.set("format",e),g.extraQuery)for(let[e,t]of Object.entries(g.extraQuery))null!=t&&i.set(e,String(t));let t=`${g.url}${g.url.includes("?")?"&":"?"}${i.toString()}`,n=g.filename?.({format:e});await (0,l.apiDownload)(t,{filename:n})}catch(e){B(e instanceof Error?e.message:"Export failed.")}finally{A(null)}}}return(0,i.jsxs)("div",{className:(0,n.cn)("space-y-3",j),children:[e?(0,i.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:e}):null,Z?(0,i.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-end md:justify-between",children:[(0,i.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-end",children:[v?(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsx)("label",{className:"text-sm font-medium",htmlFor:`${T}_datatable_search`,children:"Search"}),(0,i.jsx)("input",{id:`${T}_datatable_search`,className:"w-full min-w-[220px] rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:F,onChange:e=>{E(e.target.value),L(0)},placeholder:v.placeholder??"Search..."})]}):null,b.map(e=>(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsx)("label",{className:"text-sm font-medium",htmlFor:`${T}_datatable_filter_${e.id}`,children:e.label}),(0,i.jsx)("select",{id:`${T}_datatable_filter_${e.id}`,className:"w-full min-w-[180px] rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:String(e.value),onChange:i=>{let t=e.options.find(e=>String(e.value)===i.target.value),n=t?t.value:i.target.value;e.onChange(n),L(0)},children:e.options.map(e=>(0,i.jsx)("option",{value:String(e.value),children:e.label},String(e.value)))})]},e.id))]}),(0,i.jsxs)("div",{className:"flex flex-col items-start gap-2 md:items-end",children:[(0,i.jsxs)("div",{className:"text-sm text-zinc-600",children:[W," result(s)"]}),(0,i.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[g?(0,i.jsx)(a.DropdownMenu,{align:"right",trigger:({toggle:e})=>(0,i.jsx)(r.Button,{variant:"outline",size:"sm",onClick:e,disabled:!!k,children:k?"Exporting...":"Export"}),children:({close:e})=>{let t=g.formats??["csv","xlsx","pdf"];return(0,i.jsx)(i.Fragment,{children:t.map(t=>(0,i.jsxs)(a.DropdownMenuItem,{onSelect:()=>{e(),ei(t)},disabled:!!k,children:["Export ",t.toUpperCase()]},t))})}}):null,f?(0,i.jsx)(a.DropdownMenu,{align:"right",trigger:({toggle:e})=>(0,i.jsx)(r.Button,{variant:"outline",size:"sm",onClick:e,children:"Columns"}),children:({close:e})=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.DropdownMenuItem,{onSelect:()=>{for(let i of(e(),d))ee(i.id,!0)},children:"Show all"}),(0,i.jsx)(a.DropdownMenuItem,{onSelect:()=>{for(let i of(e(),d))ee(i.id,!i.hiddenByDefault)},children:"Reset defaults"}),(0,i.jsx)(a.DropdownMenuSeparator,{}),d.map(e=>{let t=H.some(i=>i.id===e.id);return(0,i.jsxs)(a.DropdownMenuItem,{onSelect:()=>{ee(e.id,!t)},children:[(0,i.jsx)("span",{className:"mr-2 inline-block w-4",children:t?"✓":""}),"string"==typeof e.header?e.header:e.id]},e.id)})]})}):null]})]})]}):null,P?(0,i.jsx)("div",{className:"text-sm text-red-600",children:P}):null,(0,i.jsx)("div",{className:"overflow-x-auto rounded-[var(--rb-radius-md)] border border-[var(--rb-border)] bg-white",children:(0,i.jsxs)("table",{className:"min-w-full border-collapse text-left text-sm",children:[(0,i.jsx)("thead",{className:"bg-[var(--rb-surface-muted)]",children:(0,i.jsx)("tr",{children:H.map(e=>(0,i.jsx)("th",{className:(0,n.cn)("whitespace-nowrap border-b border-[var(--rb-border)] px-3 py-2 text-xs font-semibold uppercase tracking-wide text-zinc-600",e.headerClassName),children:D&&e.sortId&&q?(0,i.jsxs)("button",{type:"button",onClick:()=>(function(e){if(D&&e.sortId&&q){if(!U||U.id!==e.sortId){q({id:e.sortId,dir:"asc"}),L(0);return}if("asc"===U.dir){q({id:e.sortId,dir:"desc"}),L(0);return}q(null),L(0)}})(e),className:"inline-flex items-center gap-1 hover:text-zinc-900",children:[(0,i.jsx)("span",{children:e.header}),D&&e.sortId?U&&U.id===e.sortId?"asc"===U.dir?(0,i.jsx)("span",{className:"ml-1 text-zinc-700",children:"↑"}):(0,i.jsx)("span",{className:"ml-1 text-zinc-700",children:"↓"}):(0,i.jsx)("span",{className:"ml-1 text-zinc-400",children:"↕"}):null]}):e.header},e.id))})}),(0,i.jsx)("tbody",{children:u?Array.from({length:K}).map((e,t)=>(0,i.jsx)("tr",{className:"border-t border-[var(--rb-border)]",children:H.map((e,t)=>(0,i.jsx)("td",{className:(0,n.cn)("px-3 py-2 align-middle",e.className),children:(0,i.jsx)(s.Skeleton,{className:(0,n.cn)("h-3 rounded-[var(--rb-radius-sm)]",0===t?"w-3/4":t===H.length-1?"w-16":"w-full")})},e.id))},`loading_${t}`)):0===Y.length?(0,i.jsx)("tr",{children:(0,i.jsx)("td",{className:"px-3 py-3 text-sm text-zinc-600",colSpan:Math.max(1,H.length),children:m})}):Y.map(e=>(0,i.jsx)("tr",{className:(0,n.cn)("border-t border-[var(--rb-border)]",y?"cursor-pointer hover:bg-[var(--rb-surface-muted)]":null),tabIndex:y?0:void 0,role:y?"button":void 0,onClick:y?()=>{y(e)}:void 0,onKeyDown:y?i=>{("Enter"===i.key||" "===i.key)&&(i.preventDefault(),y(e))}:void 0,children:H.map(t=>(0,i.jsx)("td",{className:(0,n.cn)("px-3 py-2 align-middle",t.className),children:t.cell(e)},t.id))},String(c(e))))})]})}),(0,i.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(r.Button,{variant:"outline",size:"sm",onClick:function(){L(Math.max(0,J-1))},disabled:!G,children:"Prev"}),(0,i.jsx)(r.Button,{variant:"outline",size:"sm",onClick:function(){L(Math.min(Q-1,J+1))},disabled:!X,children:"Next"}),(0,i.jsxs)("div",{className:"text-sm text-zinc-600",children:["Page ",J+1," / ",Q]})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("div",{className:"text-sm text-zinc-600",children:"Rows per page"}),(0,i.jsx)("select",{className:"rounded-[var(--rb-radius-sm)] border border-[var(--rb-border)] bg-white px-3 py-2 text-sm",value:String(O),onChange:e=>{R(Number(e.target.value)),L(0)},children:h.map(e=>(0,i.jsx)("option",{value:e,children:e},e))})]})]})]})}e.s(["DataTable",()=>o])},66474,e=>{"use strict";var i=e.i(48277),t=e.i(30668),n=e.i(14575);function r({open:e,onClose:r,title:a,children:s,footer:l,position:o="center",variant:d="glass",className:c}){if((0,t.useEffect)(()=>{function i(i){e&&"Escape"===i.key&&r()}return document.addEventListener("keydown",i),()=>document.removeEventListener("keydown",i)},[r,e]),!e)return null;let u="solid"===d?(0,n.cn)("relative w-full max-w-lg overflow-hidden rounded-[var(--rb-radius-lg)]","border border-[var(--rb-border)]","bg-white","shadow-[var(--rb-shadow)]"):(0,n.cn)("relative w-full max-w-lg overflow-hidden rounded-[var(--rb-radius-lg)]","border border-[color:color-mix(in_srgb,var(--rb-border),white_55%)]","bg-white/75 backdrop-blur-xl","shadow-[0_18px_55px_-18px_rgba(0,0,0,0.55)]","ring-1 ring-white/25");return(0,i.jsxs)("div",{className:"top-center"===o?"fixed inset-0 z-50 flex items-start justify-center px-4 pt-8":"fixed inset-0 z-50 flex items-center justify-center px-4",children:[(0,i.jsx)("button",{type:"button",className:(0,n.cn)("absolute inset-0","bg-black/35 backdrop-blur-md","bg-[radial-gradient(900px_600px_at_20%_20%,color-mix(in_srgb,#16a34a,transparent_82%)_0%,transparent_60%),radial-gradient(900px_600px_at_80%_30%,color-mix(in_srgb,var(--rb-blue),transparent_82%)_0%,transparent_60%),radial-gradient(900px_600px_at_50%_85%,color-mix(in_srgb,var(--rb-orange),transparent_85%)_0%,transparent_65%)]"),"aria-label":"Close",onClick:r}),(0,i.jsxs)("div",{role:"dialog","aria-modal":"true",className:(0,n.cn)(u,c),children:["glass"===d?(0,i.jsx)("div",{className:"pointer-events-none absolute inset-0 bg-[radial-gradient(650px_420px_at_20%_15%,color-mix(in_srgb,#16a34a,transparent_88%)_0%,transparent_60%),radial-gradient(650px_420px_at_80%_5%,color-mix(in_srgb,var(--rb-blue),transparent_90%)_0%,transparent_60%)]"}):null,a?(0,i.jsx)("div",{className:(0,n.cn)("relative px-5 py-4","solid"===d?"border-b border-[var(--rb-border)]":"border-b border-[color:color-mix(in_srgb,var(--rb-border),white_60%)]"),children:(0,i.jsx)("div",{className:"text-sm font-semibold text-[var(--rb-text)]",children:a})}):null,(0,i.jsx)("div",{className:"relative px-5 py-4",children:s}),l?(0,i.jsx)("div",{className:(0,n.cn)("relative px-5 py-4","solid"===d?"border-t border-[var(--rb-border)]":"border-t border-[color:color-mix(in_srgb,var(--rb-border),white_60%)]"),children:l}):null]})]})}e.s(["Modal",()=>r])},64998,e=>{"use strict";var i=e.i(48277),t=e.i(66474),n=e.i(9693);function r({open:e,title:r,message:a,confirmText:s="Confirm",confirmVariant:l="primary",cancelText:o="Cancel",busy:d=!1,onCancel:c,onConfirm:u}){return(0,i.jsx)(t.Modal,{open:e,onClose:()=>{d||c()},title:r,footer:(0,i.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,i.jsx)(n.Button,{variant:"outline",onClick:c,disabled:d,children:o}),(0,i.jsx)(n.Button,{variant:l,onClick:u,disabled:d,children:d?"Working...":s})]}),children:(0,i.jsx)("div",{className:"text-sm text-zinc-700",children:a})})}e.s(["ConfirmDialog",()=>r])},21190,e=>{"use strict";var i=e.i(1831);async function t(e){let t=new URLSearchParams;return"boolean"==typeof e?.includeInactive&&t.set("include_inactive",e.includeInactive?"1":"0"),(0,i.apiFetch)(`/api/admin/billing/catalog${t.toString()?`?${t.toString()}`:""}`)}async function n(e){let t=new URLSearchParams;return"boolean"==typeof e?.includeInactive&&t.set("include_inactive",e.includeInactive?"1":"0"),(0,i.apiFetch)(`/api/admin/billing/intervals${t.toString()?`?${t.toString()}`:""}`)}async function r(e){return(0,i.apiFetch)("/api/admin/billing/intervals",{method:"POST",body:{code:e.code?.trim()||void 0,name:e.name,months:e.months,is_active:"boolean"==typeof e.isActive?e.isActive:void 0}})}async function a(e){return(0,i.apiFetch)(`/api/admin/billing/intervals/${e.intervalId}`,{method:"PUT",body:{code:e.code,name:e.name,months:e.months,is_active:"boolean"==typeof e.isActive?e.isActive:void 0,reason:e.reason}})}async function s(e){return(0,i.apiFetch)(`/api/admin/billing/intervals/${e.intervalId}/active`,{method:"PATCH",body:{is_active:e.isActive,reason:e.reason}})}async function l(e){return(0,i.apiFetch)("/api/admin/billing/plans",{method:"POST",body:{name:e.name,code:e.code?.trim()||void 0,description:e.description?.trim()||void 0,is_active:"boolean"==typeof e.isActive?e.isActive:void 0}})}async function o(e){return(0,i.apiFetch)(`/api/admin/billing/plans/${e.planId}`,{method:"PUT",body:{name:e.name,code:e.code,description:e.description?.trim()||void 0,is_active:"boolean"==typeof e.isActive?e.isActive:void 0,reason:e.reason}})}async function d(e){return(0,i.apiFetch)(`/api/admin/billing/plans/${e.planId}/versions/draft-from-active`,{method:"POST",body:{reason:e.reason}})}async function c(e){try{return await (0,i.apiFetch)(`/api/admin/billing/versions/${e.versionId}/validate`,{method:"POST",body:{reason:e.reason}})}catch(e){if(e instanceof i.ApiError){let i=e.data;if(i&&"object"==typeof i){if("ok"===i.status)return{status:"ok"};if("string"==typeof i.message)return{message:i.message,errors:Array.isArray(i.errors)?i.errors.map(String):void 0}}}throw e}}async function u(e){return(0,i.apiFetch)(`/api/admin/billing/versions/${e.versionId}/entitlements/sync`,{method:"POST",body:{entitlements:e.entitlements,reason:e.reason}})}async function m(e){return(0,i.apiFetch)(`/api/admin/billing/versions/${e.versionId}/prices`,{method:"POST",body:{currency:e.currency,billing_interval_id:"number"==typeof e.billingIntervalId?e.billingIntervalId:void 0,interval:e.interval,amount_cents:e.amountCents,trial_days:"number"==typeof e.trialDays?e.trialDays:void 0,is_default:"boolean"==typeof e.isDefault?e.isDefault:void 0,reason:e.reason}})}async function v(e){return(0,i.apiFetch)(`/api/admin/billing/prices/${e.priceId}`,{method:"PATCH",body:{amount_cents:e.amountCents,trial_days:"number"==typeof e.trialDays?e.trialDays:void 0,is_default:"boolean"==typeof e.isDefault?e.isDefault:void 0,reason:e.reason}})}async function b(e){return(0,i.apiFetch)(`/api/admin/billing/prices/${e.priceId}`,{method:"DELETE",body:{reason:e.reason}})}async function h(e){return(0,i.apiFetch)(`/api/admin/billing/versions/${e.versionId}/activate`,{method:"POST",body:{confirm:e.confirm,reason:e.reason}})}async function x(e){return(0,i.apiFetch)("/api/admin/billing/entitlement-definitions",{method:"POST",body:{code:e.code?.trim()||void 0,name:e.name,value_type:e.valueType,description:e.description?.trim()||void 0,is_premium:"boolean"==typeof e.isPremium?e.isPremium:void 0}})}async function p(e){return(0,i.apiFetch)(`/api/admin/billing/entitlement-definitions/${e.id}`,{method:"PUT",body:{code:e.code,name:e.name,value_type:e.valueType,description:e.description?.trim()||void 0,is_premium:"boolean"==typeof e.isPremium?e.isPremium:void 0,reason:e.reason}})}async function g(e){return(0,i.apiFetch)(`/api/admin/billing/entitlement-definitions/${e.id}`,{method:"DELETE",body:{reason:e.reason}})}async function f(e){return(0,i.apiFetch)(`/api/admin/businesses/${e}/subscriptions`)}async function y(e){return(0,i.apiFetch)(`/api/admin/businesses/${e.tenantId}/subscriptions`,{method:"POST",body:{billing_plan_version_id:e.billingPlanVersionId,billing_price_id:e.billingPriceId,reason:e.reason}})}async function j(e){return(0,i.apiFetch)(`/api/admin/businesses/${e.tenantId}/subscriptions/${e.subscriptionId}/cancel`,{method:"POST",body:{at_period_end:"boolean"==typeof e.atPeriodEnd?e.atPeriodEnd:void 0,reason:e.reason}})}async function _(e){let t=new URLSearchParams;return e.status&&e.status.trim().length>0&&t.set("status",e.status.trim()),"number"==typeof e.limit&&Number.isFinite(e.limit)&&t.set("limit",String(e.limit)),(0,i.apiFetch)(`/api/admin/businesses/${e.tenantId}/invoices${t.toString()?`?${t.toString()}`:""}`)}async function w(e){return(0,i.apiFetch)(`/api/admin/businesses/${e.tenantId}/invoices/${e.invoiceId}`)}async function N(e){return(0,i.apiFetch)(`/api/admin/businesses/${e.tenantId}/invoices`,{method:"POST",body:{tenant_subscription_id:e.tenantSubscriptionId,reason:e.reason}})}async function S(e){return(0,i.apiFetch)(`/api/admin/businesses/${e.tenantId}/invoices/${e.invoiceId}/issue`,{method:"POST",body:{reason:e.reason}})}async function I(e){return(0,i.apiFetch)(`/api/admin/businesses/${e.tenantId}/invoices/${e.invoiceId}/paid`,{method:"POST",body:{paid_at:e.paidAt,paid_method:e.paidMethod,paid_note:e.paidNote,reason:e.reason}})}async function C(e){let t=e.invoiceNumber?`invoice_${e.invoiceNumber}.pdf`:"invoice.pdf";await (0,i.apiDownload)(`/api/admin/businesses/${e.tenantId}/invoices/${e.invoiceId}/pdf`,{filename:t})}e.s(["activateBillingPlanVersion",()=>h,"assignTenantSubscription",()=>y,"cancelTenantSubscription",()=>j,"createBillingInterval",()=>r,"createBillingPlan",()=>l,"createBillingPrice",()=>m,"createDraftBillingPlanVersionFromActive",()=>d,"createEntitlementDefinition",()=>x,"createInvoiceFromSubscription",()=>N,"deleteBillingPrice",()=>b,"deleteEntitlementDefinition",()=>g,"downloadInvoicePdf",()=>C,"getBillingCatalog",()=>t,"getTenantInvoice",()=>w,"getTenantInvoices",()=>_,"getTenantSubscriptions",()=>f,"issueInvoice",()=>S,"listBillingIntervals",()=>n,"markInvoicePaid",()=>I,"setBillingIntervalActive",()=>s,"syncBillingPlanVersionEntitlements",()=>u,"updateBillingInterval",()=>a,"updateBillingPlan",()=>o,"updateBillingPrice",()=>v,"updateEntitlementDefinition",()=>p,"validateBillingPlanVersionDraft",()=>c])},53163,e=>{"use strict";var i=e.i(48277),t=e.i(30668),n=e.i(77252),r=e.i(24273),a=e.i(63571),s=e.i(68501),l=e.i(9693),o=e.i(72015),d=e.i(64998),c=e.i(37574),u=e.i(66474),m=e.i(26550),v=e.i(1831),b=e.i(21190),h=e.i(1314);function x(){let e=(0,h.useAuth)(),x=(0,r.useDashboardHeader)(),[p,g]=(0,t.useState)(!0),[f,y]=(0,t.useState)(null),[j,_]=(0,t.useState)(null),[w,N]=(0,t.useState)(!1),[S,I]=(0,t.useState)([]),C=e.can("admin.billing.write"),[k,A]=(0,t.useState)(!1),[P,B]=(0,t.useState)(null),[$,M]=(0,t.useState)(null),[T,D]=(0,t.useState)(""),[F,E]=(0,t.useState)(""),[z,L]=(0,t.useState)("1"),[O,R]=(0,t.useState)(!0),[U,q]=(0,t.useState)(!1),[H,V]=(0,t.useState)(null);(0,t.useEffect)(()=>(x.setHeader({title:"Billing Intervals",subtitle:"Configure the available subscription billing periods."}),()=>{x.setHeader(null)}),[x]),(0,t.useEffect)(()=>{let e=!0;return async function(){try{g(!0),y(null);let i=await (0,b.listBillingIntervals)({includeInactive:!0});if(!e)return;let t=Array.isArray(i.billing_intervals)?i.billing_intervals:[];I(t)}catch(i){if(!e)return;y(i instanceof Error?i.message:"Failed to load billing intervals."),I([])}finally{if(!e)return;g(!1)}}(),()=>{e=!1}},[]);let W=(0,t.useMemo)(()=>[{id:"name",header:"Name",cell:e=>(0,i.jsxs)("div",{className:"min-w-0",children:[(0,i.jsx)("div",{className:"truncate font-medium",children:e.name}),(0,i.jsx)("div",{className:"mt-0.5 text-xs text-zinc-500",children:e.code})]})},{id:"months",header:"Months",cell:e=>(0,i.jsx)("div",{className:"text-sm",children:Number.isFinite(e.months)?e.months:"-"})},{id:"active",header:"Status",cell:e=>(0,i.jsx)(s.Badge,{variant:e.is_active?"success":"default",children:e.is_active?"Active":"Inactive"})},{id:"actions",header:"Actions",cell:e=>(0,i.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,i.jsx)(l.Button,{size:"sm",variant:"outline",onClick:()=>{B(null),M(e.id),D(String(e.name??"")),E(String(e.code??"")),L(String(Number.isFinite(e.months)?e.months:1)),R(!!e.is_active),A(!0)},disabled:!C||w,children:"Edit"}),(0,i.jsx)(l.Button,{size:"sm",variant:e.is_active?"ghost":"secondary",onClick:()=>{V(e),q(!0)},disabled:!C||w,children:e.is_active?"Deactivate":"Activate"})]})}],[w,C]);function Q(){B(null),M(null),D(""),E(""),L("1"),R(!0)}async function J(){g(!0),y(null);try{let e=await (0,b.listBillingIntervals)({includeInactive:!0}),i=Array.isArray(e.billing_intervals)?e.billing_intervals:[];I(i)}catch(e){y(e instanceof Error?e.message:"Failed to load billing intervals.")}finally{g(!1)}}async function K(){if(C&&!w){B(null),_(null),N(!0);try{let e=T.trim(),i=F.trim(),t=Number(z),n=Number.isFinite(t)?Math.max(1,Math.trunc(t)):1;if(!e)return void B("Name is required.");if($){if(!i)return void B("Code is required.");await (0,b.updateBillingInterval)({intervalId:$,code:i,name:e,months:n,isActive:O}),_("Interval updated.")}else await (0,b.createBillingInterval)({code:i||void 0,name:e,months:n,isActive:O}),_("Interval created.");A(!1),Q(),await J()}catch(e){if(e instanceof v.ApiError){let i=e.data;i&&"object"==typeof i&&"message"in i?B(String(i.message)):B(e.message)}else B(e instanceof Error?e.message:"Failed to save interval.")}finally{N(!1)}}}async function Y(){if(C&&!w&&H){_(null),y(null),N(!0);try{await (0,b.setBillingIntervalActive)({intervalId:H.id,isActive:!H.is_active}),q(!1),V(null),_(H.is_active?"Interval deactivated.":"Interval activated."),await J()}catch(e){y(e instanceof Error?e.message:"Failed to update interval.")}finally{N(!1)}}}return(0,i.jsx)(n.RequireAuth,{adminOnly:!0,requiredPermission:"admin.billing.read",children:(0,i.jsxs)("div",{className:"space-y-4",children:[f?(0,i.jsx)(a.Alert,{variant:"danger",title:"Billing intervals",children:f}):null,j?(0,i.jsx)(a.Alert,{variant:"success",title:"Billing intervals",children:j}):null,C?null:(0,i.jsx)(a.Alert,{variant:"info",title:"Read-only",children:"You have read access. Interval management requires admin billing write permission."}),(0,i.jsxs)(o.Card,{children:[(0,i.jsxs)(o.CardHeader,{className:"flex flex-row items-start justify-between gap-4",children:[(0,i.jsxs)("div",{className:"min-w-0",children:[(0,i.jsx)(o.CardTitle,{children:"Intervals"}),(0,i.jsx)("div",{className:"mt-1 text-sm text-zinc-600",children:"Used when defining price points (monthly, yearly, etc.)."})]}),C?(0,i.jsx)(l.Button,{size:"sm",variant:"secondary",onClick:()=>{Q(),A(!0)},disabled:w,children:"Add interval"}):null]}),(0,i.jsx)(o.CardContent,{children:(0,i.jsx)(c.DataTable,{title:"Billing intervals",data:S,loading:p,emptyMessage:"No intervals found.",getRowId:e=>String(e.id),columns:W})})]}),(0,i.jsxs)(u.Modal,{open:k,onClose:()=>{w||(A(!1),Q())},title:$?"Edit interval":"Add interval",footer:(0,i.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,i.jsx)(l.Button,{variant:"outline",onClick:()=>{A(!1),Q()},disabled:w,children:"Cancel"}),(0,i.jsx)(l.Button,{variant:"primary",onClick:K,disabled:w,children:w?"Saving...":"Save"})]}),children:[P?(0,i.jsx)(a.Alert,{variant:"danger",title:"Cannot save",children:P}):null,(0,i.jsxs)("div",{className:"space-y-3",children:[(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsx)("label",{className:"text-sm font-medium",children:"Name"}),(0,i.jsx)(m.Input,{value:T,onChange:e=>D(e.target.value),disabled:w}),(0,i.jsx)("div",{className:"text-xs text-zinc-500",children:"Example: Monthly, Quarterly, Yearly"})]}),(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsx)("label",{className:"text-sm font-medium",children:"Code"}),(0,i.jsx)(m.Input,{value:F,onChange:e=>E(e.target.value),disabled:w}),(0,i.jsx)("div",{className:"text-xs text-zinc-500",children:"Used internally. Leave blank to auto-generate on create."})]}),(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsx)("label",{className:"text-sm font-medium",children:"Months"}),(0,i.jsx)(m.Input,{value:z,onChange:e=>L(e.target.value),disabled:w})]}),(0,i.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,i.jsx)("input",{type:"checkbox",checked:O,onChange:e=>R(e.target.checked),disabled:w}),"Active"]})]})]}),(0,i.jsx)(d.ConfirmDialog,{open:U,title:H?.is_active?"Deactivate interval":"Activate interval",message:(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("div",{children:H?.is_active?"This will hide the interval from selection for new prices. Existing prices using it will remain unchanged.":"This will make the interval available for new prices."}),(0,i.jsx)("div",{className:"text-xs text-zinc-500",children:H?`${H.name} (${H.months} months)`:null})]}),confirmText:H?.is_active?"Deactivate":"Activate",confirmVariant:H?.is_active?"outline":"primary",busy:w,onCancel:()=>{w||(q(!1),V(null))},onConfirm:Y})]})})}e.s(["default",()=>x])}]);