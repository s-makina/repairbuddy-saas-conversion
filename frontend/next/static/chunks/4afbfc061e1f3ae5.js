(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,19463,e=>{"use strict";var i=e.i(48277),t=e.i(14575);function a({title:e,description:a,actions:s,className:r}){return(0,i.jsxs)("div",{className:(0,t.cn)("flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between",r),children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"text-xl font-semibold text-[var(--rb-text)]",children:e}),a?(0,i.jsx)("p",{className:"mt-1 text-sm text-zinc-600",children:a}):null]}),s?(0,i.jsx)("div",{className:"flex items-center gap-2",children:s}):null]})}e.s(["PageHeader",()=>a])},26550,e=>{"use strict";var i=e.i(48277),t=e.i(14575);function a({className:e,type:a,...s}){return(0,i.jsx)("input",{type:a,className:(0,t.cn)("w-full rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)] outline-none transition","placeholder:text-zinc-400","focus-visible:ring-2 focus-visible:ring-[color:color-mix(in_srgb,var(--rb-orange),white_65%)] focus-visible:ring-offset-2 focus-visible:ring-offset-white","disabled:cursor-not-allowed disabled:bg-[var(--rb-surface-muted)] disabled:opacity-70",e),...s})}e.s(["Input",()=>a])},40709,e=>{"use strict";var i=e.i(48277),t=e.i(14575);function a({className:e,children:a,...s}){return(0,i.jsx)("select",{className:(0,t.cn)("w-full appearance-none rounded-[var(--rb-radius-sm)] border border-zinc-300 bg-white px-3 py-2 text-sm text-[var(--rb-text)] outline-none transition","focus-visible:ring-2 focus-visible:ring-[color:color-mix(in_srgb,var(--rb-orange),white_65%)] focus-visible:ring-offset-2 focus-visible:ring-offset-white","disabled:cursor-not-allowed disabled:bg-[var(--rb-surface-muted)] disabled:opacity-70","bg-[right_0.75rem_center] bg-no-repeat pr-10",'[background-image:url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="%236b7280" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>\')]',e),...s,children:a})}e.s(["Select",()=>a])},44919,e=>{"use strict";var i=e.i(54976);e.s(["notify",0,{success:(e,t={})=>i.toast.success(e,t),error:(e,t={})=>i.toast.error(e,t),info:(e,t={})=>i.toast.info(e,t),warning:(e,t={})=>i.toast.warning(e,t),loading:(e,t={})=>i.toast.loading(e,t),dismiss(e){i.toast.dismiss(e)},message:(e,t,a={})=>"success"===e?i.toast.success(t,a):"error"===e?i.toast.error(t,a):"warning"===e?i.toast.warning(t,a):"loading"===e?i.toast.loading(t,a):i.toast.info(t,a)}])},59471,e=>{"use strict";var i=e.i(48277),t=e.i(14575);function a({label:e,fieldId:a,description:s,error:r,required:n,className:l,labelClassName:d,fieldClassName:c,children:o}){let u=s?`${a}__description`:void 0,m=r?`${a}__error`:void 0,p=[u,m].filter(Boolean).join(" ")||void 0,x="function"==typeof o?o({describedBy:p,descriptionId:u,errorId:m,invalid:!!r}):o;return(0,i.jsxs)("div",{className:(0,t.cn)("grid gap-1 sm:grid-cols-[220px_1fr] sm:gap-4",l),children:[(0,i.jsx)("div",{className:"sm:pt-2",children:(0,i.jsxs)("label",{className:(0,t.cn)("block text-sm font-medium text-[var(--rb-text)]",d),htmlFor:a,children:[e,n?(0,i.jsx)("span",{className:"text-red-600",children:" *"}):null]})}),(0,i.jsxs)("div",{className:(0,t.cn)("min-w-0",c),children:[x,s?(0,i.jsx)("div",{id:u,className:"mt-1 text-xs text-zinc-500",children:s}):null,r?(0,i.jsx)("div",{id:m,className:"mt-1 text-xs text-red-600",children:r}):null]})]})}e.s(["FormRow",()=>a])},63809,e=>{"use strict";var i=e.i(1831);async function t(e){return(0,i.apiFetch)(`/api/${e}/app/currencies`)}async function a(e,t){return(0,i.apiFetch)(`/api/${e}/app/currencies`,{method:"PATCH",body:{currencies:t}})}e.s(["getTenantCurrencies",()=>t,"updateTenantCurrencies",()=>a])},60038,e=>{"use strict";var i=e.i(48277),t=e.i(30668),a=e.i(96086),s=e.i(1831),r=e.i(44919),n=e.i(77252),l=e.i(19463),d=e.i(72015),c=e.i(9693),o=e.i(26550),u=e.i(40709),m=e.i(59471),p=e.i(63809);function x(){let e=(0,a.useRouter)(),x=(0,a.useParams)(),g=x.business??x.tenant,h=x.clientId,b="string"==typeof h&&h.length>0?Number(h):null,[v,f]=(0,t.useState)(!0),[y,_]=(0,t.useState)(!1),[j,w]=(0,t.useState)(null),[C,N]=(0,t.useState)(""),[I,S]=(0,t.useState)(""),[F,R]=(0,t.useState)(""),[L,U]=(0,t.useState)(""),[$,A]=(0,t.useState)(""),[T,k]=(0,t.useState)(""),[P,B]=(0,t.useState)(""),[q,z]=(0,t.useState)(""),[E,O]=(0,t.useState)(""),[D,H]=(0,t.useState)(""),[K,G]=(0,t.useState)(""),[V,Z]=(0,t.useState)(""),[J,M]=t.default.useState([]),[Q,W]=t.default.useState(null);async function X(i){if((i.preventDefault(),"string"==typeof g&&0!==g.length)&&b&&Number.isFinite(b)&&!(b<=0)){_(!0),w(null);try{let i=V.trim().toUpperCase(),t={name:C.trim(),email:I.trim(),phone:""!==F.trim()?F.trim():null,company:""!==L.trim()?L.trim():null,tax_id:""!==$.trim()?$.trim():null,address_line1:""!==T.trim()?T.trim():null,address_line2:""!==P.trim()?P.trim():null,address_city:""!==q.trim()?q.trim():null,address_state:""!==E.trim()?E.trim():null,address_postal_code:""!==D.trim()?D.trim():null,address_country:""!==K.trim()?K.trim().toUpperCase():null,currency:3===i.length?i:null};await (0,s.apiFetch)(`/api/${g}/app/clients/${b}`,{method:"PUT",body:t}),r.notify.success("Customer updated."),e.replace(`/app/${g}/clients/${b}`)}catch(e){e instanceof s.ApiError?w(e.message):w("Failed to save customer.")}finally{_(!1)}}}(0,t.useEffect)(()=>{let e=!0;return async function(){if("string"==typeof g&&0!==g.length&&b&&Number.isFinite(b)&&!(b<=0)){f(!0),w(null);try{let i=await (0,s.apiFetch)(`/api/${g}/app/clients/${b}`);if(!e)return;let t=i.client;N(t?.name??""),S(t?.email??""),R(t?.phone??""),U(t?.company??""),A(t?.tax_id??""),k(t?.address_line1??""),B(t?.address_line2??""),z(t?.address_city??""),O(t?.address_state??""),H(t?.address_postal_code??""),G(t?.address_country??""),Z("string"==typeof t?.currency?t.currency.toUpperCase():"")}catch(i){if(!e)return;w(i instanceof Error?i.message:"Failed to load customer.")}finally{if(!e)return;f(!1)}}}(),()=>{e=!1}},[b,g]),(0,t.useEffect)(()=>{let e=!0;return async function(){if("string"==typeof g&&0!==g.length)try{let i=await (0,p.getTenantCurrencies)(String(g));if(!e)return;let t=(Array.isArray(i.currencies)?i.currencies:[]).filter(e=>e&&e.is_active);M(t);let a="string"==typeof i.active_currency?i.active_currency.toUpperCase():null;W(a),Z(e=>{if(e&&3===e.length)return e;let i=t.find(e=>e.is_default)?.code??null;return a??i??t[0]?.code??e})}catch{if(!e)return;M([]),W(null)}}(),()=>{e=!1}},[g]);let Y=!b||!Number.isFinite(b)||b<=0;return(0,i.jsx)(n.RequireAuth,{requiredPermission:"clients.view",children:(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsx)(l.PageHeader,{title:"Edit customer",description:"Update this customer record.",actions:(0,i.jsx)(c.Button,{variant:"outline",size:"sm",onClick:()=>{e.back()},children:"Back"})}),Y?(0,i.jsx)("div",{className:"text-sm text-red-600",children:"Customer is invalid."}):null,j?(0,i.jsx)("div",{className:"text-sm text-red-600",children:j}):null,(0,i.jsx)(d.Card,{className:"shadow-none",children:(0,i.jsxs)(d.CardContent,{className:"pt-5",children:[v?(0,i.jsx)("div",{className:"text-sm text-zinc-600",children:"Loading..."}):null,v||Y?null:(0,i.jsxs)("form",{className:"grid gap-4",onSubmit:X,children:[(0,i.jsx)(m.FormRow,{label:"Name",fieldId:"client_name",required:!0,description:"Customer full name.",children:({describedBy:e,invalid:t})=>(0,i.jsx)(o.Input,{id:"client_name",value:C,onChange:e=>N(e.target.value),required:!0,disabled:y,maxLength:255,"aria-describedby":e,"aria-invalid":t})}),(0,i.jsx)(m.FormRow,{label:"Email",fieldId:"client_email",required:!0,description:"Used for invoices and notifications.",children:({describedBy:e,invalid:t})=>(0,i.jsx)(o.Input,{id:"client_email",type:"email",value:I,onChange:e=>S(e.target.value),required:!0,disabled:y,maxLength:255,"aria-describedby":e,"aria-invalid":t})}),(0,i.jsx)(m.FormRow,{label:"Phone",fieldId:"client_phone",description:"Optional. Include country code if needed.",children:({describedBy:e,invalid:t})=>(0,i.jsx)(o.Input,{id:"client_phone",value:F,onChange:e=>R(e.target.value),disabled:y,maxLength:64,"aria-describedby":e,"aria-invalid":t})}),(0,i.jsx)(m.FormRow,{label:"Company",fieldId:"client_company",description:"Optional company name.",children:({describedBy:e,invalid:t})=>(0,i.jsx)(o.Input,{id:"client_company",value:L,onChange:e=>U(e.target.value),disabled:y,maxLength:255,"aria-describedby":e,"aria-invalid":t})}),(0,i.jsx)(m.FormRow,{label:"Tax ID",fieldId:"client_tax_id",description:"Optional. VAT / tax identification number.",children:({describedBy:e,invalid:t})=>(0,i.jsx)(o.Input,{id:"client_tax_id",value:$,onChange:e=>A(e.target.value),disabled:y,maxLength:64,"aria-describedby":e,"aria-invalid":t})}),(0,i.jsx)(m.FormRow,{label:"Currency",fieldId:"client_currency",description:"Used for customer-level pricing, invoices, and quotes.",children:({describedBy:e,invalid:t})=>J.length>0?(0,i.jsxs)(u.Select,{value:V,onChange:e=>Z(e.target.value),disabled:y,"aria-describedby":e,"aria-invalid":t,children:[J.map(e=>(0,i.jsxs)("option",{value:e.code,children:[e.code," ",e.name?`- ${e.name}`:""]},e.code)),Q&&!J.some(e=>e.code===Q)?(0,i.jsx)("option",{value:Q,children:Q}):null]}):(0,i.jsx)(o.Input,{id:"client_currency",className:"uppercase",value:V,onChange:e=>Z(e.target.value.toUpperCase().slice(0,3)),disabled:y,maxLength:3,placeholder:"USD","aria-describedby":e,"aria-invalid":t})}),(0,i.jsx)(m.FormRow,{label:"Address line 1",fieldId:"client_address_line1",description:"Optional street address.",children:({describedBy:e,invalid:t})=>(0,i.jsx)(o.Input,{id:"client_address_line1",value:T,onChange:e=>k(e.target.value),disabled:y,maxLength:255,"aria-describedby":e,"aria-invalid":t})}),(0,i.jsx)(m.FormRow,{label:"Address line 2",fieldId:"client_address_line2",description:"Optional apartment, suite, etc.",children:({describedBy:e,invalid:t})=>(0,i.jsx)(o.Input,{id:"client_address_line2",value:P,onChange:e=>B(e.target.value),disabled:y,maxLength:255,"aria-describedby":e,"aria-invalid":t})}),(0,i.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,i.jsx)(m.FormRow,{label:"City",fieldId:"client_address_city",children:({describedBy:e,invalid:t})=>(0,i.jsx)(o.Input,{id:"client_address_city",value:q,onChange:e=>z(e.target.value),disabled:y,maxLength:255,"aria-describedby":e,"aria-invalid":t})}),(0,i.jsx)(m.FormRow,{label:"State",fieldId:"client_address_state",children:({describedBy:e,invalid:t})=>(0,i.jsx)(o.Input,{id:"client_address_state",value:E,onChange:e=>O(e.target.value),disabled:y,maxLength:255,"aria-describedby":e,"aria-invalid":t})})]}),(0,i.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,i.jsx)(m.FormRow,{label:"Postal code",fieldId:"client_address_postal_code",children:({describedBy:e,invalid:t})=>(0,i.jsx)(o.Input,{id:"client_address_postal_code",value:D,onChange:e=>H(e.target.value),disabled:y,maxLength:64,"aria-describedby":e,"aria-invalid":t})}),(0,i.jsx)(m.FormRow,{label:"Country (2-letter)",fieldId:"client_address_country",description:"Example: ZA, US, GB.",children:({describedBy:e,invalid:t})=>(0,i.jsx)(o.Input,{id:"client_address_country",className:"uppercase",value:K,onChange:e=>G(e.target.value),disabled:y,maxLength:2,"aria-describedby":e,"aria-invalid":t})})]}),(0,i.jsxs)("div",{className:"flex items-center justify-end gap-2 pt-2",children:[(0,i.jsx)(c.Button,{variant:"outline",onClick:()=>{"string"==typeof g&&g.length>0&&b&&e.push(`/app/${g}/clients/${b}`)},disabled:y,children:"Cancel"}),(0,i.jsx)(c.Button,{type:"submit",disabled:y,children:y?"Saving...":"Save"})]})]})]})})]})})}e.s(["default",()=>x])}]);